(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"+K+b":function(ze,E,o){var b=o("JHRd");function m(Y){var F=new Y.constructor(Y.byteLength);return new b(F).set(new b(Y)),F}ze.exports=m},"+Qka":function(ze,E,o){var b=o("fmRc"),m=o("t2Dn"),Y=o("cq/+"),F=o("T1AV"),i=o("GoyQ"),Z=o("mTTR"),D=o("itsj");function $(te,fe,K,Ge,pe){if(te===fe)return;Y(fe,function(Ze,Pe){if(pe||(pe=new b),i(Ze))F(te,fe,Pe,K,$,Ge,pe);else{var mt=Ge?Ge(D(te,Pe),Ze,Pe+"",te,fe,pe):void 0;mt===void 0&&(mt=Ze),m(te,Pe,mt)}},Z)}ze.exports=$},"+VLl":function(ze,E,o){"use strict";o.d(E,"a",function(){return Ze});var b=o("lSNA"),m=o.n(b),Y=o("J4zp"),F=o.n(Y),i=o("Hel2"),Z=Math.PI/3,D=[0,Z,2*Z,3*Z,4*Z,5*Z];function $(Pe){return Pe[0]}function te(Pe){return Pe[1]}var fe=function(){var Pe=0,mt=0,De=1,At=1,it=$,vt=te,Je,_t,wt;function ke(Ve){var dt={},Me=[],ht,Zt=Ve.length;for(ht=0;ht<Zt;++ht){if(isNaN(ur=+it.call(null,Qt=Ve[ht],ht,Ve))||isNaN(oe=+vt.call(null,Qt,ht,Ve)))continue;var Qt,ur,oe,Q=Math.round(oe=oe/wt),H=Math.round(ur=ur/_t-(Q&1)/2),Se=oe-Q;if(Math.abs(Se)*3>1){var be=ur-H,Te=H+(ur<H?-1:1)/2,me=Q+(oe<Q?-1:1),nt=ur-Te,Jt=oe-me;be*be+Se*Se>nt*nt+Jt*Jt&&(H=Te+(Q&1?1:-1)/2,Q=me)}var Mt=H+"-"+Q,ve=dt[Mt];ve?ve.push(Qt):(Me.push(ve=dt[Mt]=[Qt]),ve.x=(H+(Q&1)/2)*_t,ve.y=Q*wt)}return Me}function Re(Ve){var dt=0,Me=0;return D.map(function(ht){var Zt=Math.sin(ht)*Ve,Qt=-Math.cos(ht)*Ve,ur=Zt-dt,oe=Qt-Me;return dt=Zt,Me=Qt,[ur,oe]})}return ke.hexagon=function(Ve){return"m"+Re(Ve==null?Je:+Ve).join("l")+"z"},ke.centers=function(){for(var Ve=[],dt=Math.round(mt/wt),Me=Math.round(Pe/_t),ht=dt*wt;ht<At+Je;ht+=wt,++dt)for(var Zt=Me*_t+(dt&1)*_t/2;Zt<De+_t/2;Zt+=_t)Ve.push([Zt,ht]);return Ve},ke.mesh=function(){var Ve=Re(Je).slice(0,4).join("l");return ke.centers().map(function(dt){return"M"+dt+"m"+Ve}).join("")},ke.x=function(Ve){return arguments.length?(it=Ve,ke):it},ke.y=function(Ve){return arguments.length?(vt=Ve,ke):vt},ke.radius=function(Ve){return arguments.length?(Je=+Ve,_t=Je*2*Math.sin(Z),wt=Je*1.5,ke):Je},ke.size=function(Ve){return arguments.length?(Pe=mt=0,De=+Ve[0],At=+Ve[1],ke):[De-Pe,At-mt]},ke.extent=function(Ve){return arguments.length?(Pe=+Ve[0][0],mt=+Ve[0][1],De=+Ve[1][0],At=+Ve[1][1],ke):[[Pe,mt],[De,At]]},ke.radius(1)};function K(Pe,mt){var De=Object.keys(Pe);if(Object.getOwnPropertySymbols){var At=Object.getOwnPropertySymbols(Pe);mt&&(At=At.filter(function(it){return Object.getOwnPropertyDescriptor(Pe,it).enumerable})),De.push.apply(De,At)}return De}function Ge(Pe){for(var mt=1;mt<arguments.length;mt++){var De=arguments[mt]!=null?arguments[mt]:{};mt%2?K(Object(De),!0).forEach(function(At){m()(Pe,At,De[At])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Pe,Object.getOwnPropertyDescriptors(De)):K(Object(De)).forEach(function(At){Object.defineProperty(Pe,At,Object.getOwnPropertyDescriptor(De,At))})}return Pe}var pe=6378e3;function Ze(Pe,mt){var De=Pe.dataArray,At=mt.size,it=At===void 0?10:At,vt=mt.method,Je=vt===void 0?"sum":vt,_t=it/(2*Math.PI*pe)*(256<<20)/2,wt=De.map(function(dt){var Me=Object(i.d)(dt.coordinates),ht=F()(Me,2),Zt=ht[0],Qt=ht[1];return Ge(Ge({},dt),{},{coordinates:[Zt,Qt]})}),ke=fe().radius(_t).x(function(dt){return dt.coordinates[0]}).y(function(dt){return dt.coordinates[1]}),Re=ke(wt),Ve={dataArray:Re.map(function(dt,Me){var ht;if(mt.field&&Je){var Zt=i.c.getColumn(dt,mt.field);dt[Je]=i.c.statMap[Je](Zt)}return ht={},m()(ht,mt.method,dt[Je]),m()(ht,"count",dt.length),m()(ht,"rawData",dt),m()(ht,"coordinates",[dt.x,dt.y]),m()(ht,"_id",Me),ht}),radius:_t,xOffset:_t,yOffset:_t,type:"hexagon"};return Ve}},"+em5":function(ze,E,o){"use strict";o.d(E,"a",function(){return oe});var b=o("lSNA"),m=o.n(b),Y=o("yG8O"),F=o.n(Y),i=o("lwsE"),Z=o.n(i),D=o("W8MJ"),$=o.n(D),te=o("U+yc"),fe=o.n(te),K=o("1ABj"),Ge=o.n(K),pe=o("gQMU"),Ze=o.n(pe),Pe=o("J2iB"),mt=o.n(Pe),De=o("u6S6"),At=o.n(De),it=o("4cb6"),vt=o.n(it),Je=o("h1nZ"),_t=o("bB6j"),wt=o("bPkA"),ke,Re,Ve,dt,Me,ht;function Zt(Q,H){var Se=Object.keys(Q);if(Object.getOwnPropertySymbols){var be=Object.getOwnPropertySymbols(Q);H&&(be=be.filter(function(Te){return Object.getOwnPropertyDescriptor(Q,Te).enumerable})),Se.push.apply(Se,be)}return Se}function Qt(Q){for(var H=1;H<arguments.length;H++){var Se=arguments[H]!=null?arguments[H]:{};H%2?Zt(Object(Se),!0).forEach(function(be){m()(Q,be,Se[be])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Q,Object.getOwnPropertyDescriptors(Se)):Zt(Object(Se)).forEach(function(be){Object.defineProperty(Q,be,Object.getOwnPropertyDescriptor(Se,be))})}return Q}var ur=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,oe=(ke=Object(it.injectable)(),Re=Object(it.inject)(_t.a.IShaderModuleService),ke(Ve=(dt=(ht=function(){function Q(){Z()(this,Q),F()(this,"shaderModuleService",Me,this),this.rendererService=void 0,this.config=void 0,this.quad=ur,this.enabled=!0,this.renderToScreen=!1,this.model=void 0,this.name=void 0,this.optionsToUpdate={}}return $()(Q,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(Se){this.name=Se}},{key:"getType",value:function(){return wt.a.PostProcessing}},{key:"init",value:function(Se,be){this.config=be,this.rendererService=Se.getContainer().get(_t.a.IRendererService);var Te=this.rendererService,me=Te.createAttribute,nt=Te.createBuffer,Jt=Te.createModel,Mt=this.setupShaders(),ve=Mt.vs,ge=Mt.fs,He=Mt.uniforms;this.model=Jt({vs:ve,fs:ge,attributes:{a_Position:me({buffer:nt({data:[-4,-4,4,-4,0,4],type:Je.gl.FLOAT}),size:2})},uniforms:Qt(Qt({u_Texture:null},He),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(Se){var be=this,Te=Se.multiPassRenderer.getPostProcessor(),me=this.rendererService,nt=me.useFramebuffer,Jt=me.getViewportSize,Mt=me.clear,ve=Jt(),ge=ve.width,He=ve.height;nt(this.renderToScreen?null:Te.getWriteFBO(),function(){Mt({framebuffer:Te.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0}),be.model.draw({uniforms:Qt({u_Texture:Te.getReadFBO(),u_ViewportSize:[ge,He]},be.convertOptionsToUniforms(be.optionsToUpdate))})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(Se){this.enabled=Se}},{key:"setRenderToScreen",value:function(Se){this.renderToScreen=Se}},{key:"updateOptions",value:function(Se){this.optionsToUpdate=Qt(Qt({},this.optionsToUpdate),Se)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(Se){var be={};return Object.keys(Se).forEach(function(Te){mt()(Se[Te])||(be["u_".concat(Ze()(At()(Te)))]=Se[Te])}),be}}]),Q}(),ht),Me=fe()(dt.prototype,"shaderModuleService",[Re],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dt))||Ve)},"+iFO":function(ze,E,o){var b=o("dTAl"),m=o("LcsW"),Y=o("6sVZ");function F(i){return typeof i.constructor=="function"&&!Y(i)?b(m(i)):{}}ze.exports=F},"/33/":function(ze,E){},"/Uc5":function(ze,E){},"/ezw":function(ze,E,o){"use strict";var b=o("lSNA"),m=o.n(b),Y=o("pVnL"),F=o.n(Y),i=o("cDf5"),Z=o.n(i),D=o("q1tI"),$=o("TSYQ"),te=o.n($),fe=function(be){var Te=be.prefixCls,me=be.className,nt=be.width,Jt=be.style;return D.createElement("h3",{className:te()(Te,me),style:F()({width:nt},Jt)})},K=fe,Ge=o("RIqP"),pe=o.n(Ge),Ze=function(be){var Te=function(He){var ot=be.width,we=be.rows,gt=we===void 0?2:we;return Array.isArray(ot)?ot[He]:gt-1===He?ot:void 0},me=be.prefixCls,nt=be.className,Jt=be.style,Mt=be.rows,ve=pe()(Array(Mt)).map(function(ge,He){return D.createElement("li",{key:He,style:{width:Te(He)}})});return D.createElement("ul",{className:te()(me,nt),style:Jt},ve)},Pe=Ze,mt=o("H84U"),De=function(be){var Te,me,nt=be.prefixCls,Jt=be.className,Mt=be.style,ve=be.size,ge=be.shape,He=te()((Te={},m()(Te,"".concat(nt,"-lg"),ve==="large"),m()(Te,"".concat(nt,"-sm"),ve==="small"),Te)),ot=te()((me={},m()(me,"".concat(nt,"-circle"),ge==="circle"),m()(me,"".concat(nt,"-square"),ge==="square"),m()(me,"".concat(nt,"-round"),ge==="round"),me)),we=typeof ve=="number"?{width:ve,height:ve,lineHeight:"".concat(ve,"px")}:{};return D.createElement("span",{className:te()(nt,He,ot,Jt),style:F()(F()({},we),Mt)})},At=De,it=o("BGR+"),vt=function(be){var Te=function(nt){var Jt=nt.getPrefixCls,Mt=be.prefixCls,ve=be.className,ge=be.active,He=Jt("skeleton",Mt),ot=Object(it.a)(be,["prefixCls"]),we=te()(He,"".concat(He,"-element"),m()({},"".concat(He,"-active"),ge),ve);return D.createElement("div",{className:we},D.createElement(At,F()({prefixCls:"".concat(He,"-avatar")},ot)))};return D.createElement(mt.a,null,Te)};vt.defaultProps={size:"default",shape:"circle"};var Je=vt,_t=function(be){var Te=function(nt){var Jt=nt.getPrefixCls,Mt=be.prefixCls,ve=be.className,ge=be.active,He=Jt("skeleton",Mt),ot=Object(it.a)(be,["prefixCls"]),we=te()(He,"".concat(He,"-element"),m()({},"".concat(He,"-active"),ge),ve);return D.createElement("div",{className:we},D.createElement(At,F()({prefixCls:"".concat(He,"-button")},ot)))};return D.createElement(mt.a,null,Te)};_t.defaultProps={size:"default"};var wt=_t,ke=function(be){var Te=function(nt){var Jt=nt.getPrefixCls,Mt=be.prefixCls,ve=be.className,ge=be.active,He=Jt("skeleton",Mt),ot=Object(it.a)(be,["prefixCls"]),we=te()(He,"".concat(He,"-element"),m()({},"".concat(He,"-active"),ge),ve);return D.createElement("div",{className:we},D.createElement(At,F()({prefixCls:"".concat(He,"-input")},ot)))};return D.createElement(mt.a,null,Te)};ke.defaultProps={size:"default"};var Re=ke,Ve="M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z",dt=function(be){var Te=function(nt){var Jt=nt.getPrefixCls,Mt=be.prefixCls,ve=be.className,ge=be.style,He=Jt("skeleton",Mt),ot=te()(He,"".concat(He,"-element"),ve);return D.createElement("div",{className:ot},D.createElement("div",{className:te()("".concat(He,"-image"),ve),style:ge},D.createElement("svg",{viewBox:"0 0 1098 1024",xmlns:"http://www.w3.org/2000/svg",className:"".concat(He,"-image-svg")},D.createElement("path",{d:Ve,className:"".concat(He,"-image-path")}))))};return D.createElement(mt.a,null,Te)},Me=dt;function ht(Se){return Se&&Z()(Se)==="object"?Se:{}}function Zt(Se,be){return Se&&!be?{size:"large",shape:"square"}:{size:"large",shape:"circle"}}function Qt(Se,be){return!Se&&be?{width:"38%"}:Se&&be?{width:"50%"}:{}}function ur(Se,be){var Te={};return(!Se||!be)&&(Te.width="61%"),!Se&&be?Te.rows=3:Te.rows=2,Te}var oe=function(be){var Te=function(nt){var Jt=nt.getPrefixCls,Mt=nt.direction,ve=be.prefixCls,ge=be.loading,He=be.className,ot=be.children,we=be.avatar,gt=be.title,C=be.paragraph,R=be.active,q=be.round,ce=Jt("skeleton",ve);if(ge||!("loading"in be)){var We,qe=!!we,Tt=!!gt,at=!!C,Ut;if(qe){var J=F()(F()({prefixCls:"".concat(ce,"-avatar")},Zt(Tt,at)),ht(we));Ut=D.createElement("div",{className:"".concat(ce,"-header")},D.createElement(At,J))}var Qe;if(Tt||at){var ne;if(Tt){var et=F()(F()({prefixCls:"".concat(ce,"-title")},Qt(qe,at)),ht(gt));ne=D.createElement(K,et)}var kt;if(at){var dr=F()(F()({prefixCls:"".concat(ce,"-paragraph")},ur(qe,Tt)),ht(C));kt=D.createElement(Pe,dr)}Qe=D.createElement("div",{className:"".concat(ce,"-content")},ne,kt)}var Ye=te()(ce,(We={},m()(We,"".concat(ce,"-with-avatar"),qe),m()(We,"".concat(ce,"-active"),R),m()(We,"".concat(ce,"-rtl"),Mt==="rtl"),m()(We,"".concat(ce,"-round"),q),We),He);return D.createElement("div",{className:Ye},Ut,Qe)}return ot};return D.createElement(mt.a,null,Te)};oe.defaultProps={avatar:!1,title:!0,paragraph:!0},oe.Button=wt,oe.Avatar=Je,oe.Input=Re,oe.Image=Me;var Q=oe,H=E.a=Q},"/rf6":function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.earthRadius=63710088e-1,E.factors={centimeters:E.earthRadius*100,centimetres:E.earthRadius*100,degrees:E.earthRadius/111325,feet:E.earthRadius*3.28084,inches:E.earthRadius*39.37,kilometers:E.earthRadius/1e3,kilometres:E.earthRadius/1e3,meters:E.earthRadius,metres:E.earthRadius,miles:E.earthRadius/1609.344,millimeters:E.earthRadius*1e3,millimetres:E.earthRadius*1e3,nauticalmiles:E.earthRadius/1852,radians:1,yards:E.earthRadius/1.0936},E.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/E.earthRadius,yards:1/1.0936},E.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function b(Q,H,Se){Se===void 0&&(Se={});var be={type:"Feature"};return(Se.id===0||Se.id)&&(be.id=Se.id),Se.bbox&&(be.bbox=Se.bbox),be.properties=H||{},be.geometry=Q,be}E.feature=b;function m(Q,H,Se){Se===void 0&&(Se={});switch(Q){case"Point":return Y(H).geometry;case"LineString":return D(H).geometry;case"Polygon":return i(H).geometry;case"MultiPoint":return K(H).geometry;case"MultiLineString":return fe(H).geometry;case"MultiPolygon":return Ge(H).geometry;default:throw new Error(Q+" is invalid")}}E.geometry=m;function Y(Q,H,Se){Se===void 0&&(Se={});var be={type:"Point",coordinates:Q};return b(be,H,Se)}E.point=Y;function F(Q,H,Se){return Se===void 0&&(Se={}),te(Q.map(function(be){return Y(be,H)}),Se)}E.points=F;function i(Q,H,Se){Se===void 0&&(Se={});for(var be=0,Te=Q;be<Te.length;be++){var me=Te[be];if(me.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var nt=0;nt<me[me.length-1].length;nt++)if(me[me.length-1][nt]!==me[0][nt])throw new Error("First and last Position are not equivalent.")}var Jt={type:"Polygon",coordinates:Q};return b(Jt,H,Se)}E.polygon=i;function Z(Q,H,Se){return Se===void 0&&(Se={}),te(Q.map(function(be){return i(be,H)}),Se)}E.polygons=Z;function D(Q,H,Se){if(Se===void 0&&(Se={}),Q.length<2)throw new Error("coordinates must be an array of two or more positions");var be={type:"LineString",coordinates:Q};return b(be,H,Se)}E.lineString=D;function $(Q,H,Se){return Se===void 0&&(Se={}),te(Q.map(function(be){return D(be,H)}),Se)}E.lineStrings=$;function te(Q,H){H===void 0&&(H={});var Se={type:"FeatureCollection"};return H.id&&(Se.id=H.id),H.bbox&&(Se.bbox=H.bbox),Se.features=Q,Se}E.featureCollection=te;function fe(Q,H,Se){Se===void 0&&(Se={});var be={type:"MultiLineString",coordinates:Q};return b(be,H,Se)}E.multiLineString=fe;function K(Q,H,Se){Se===void 0&&(Se={});var be={type:"MultiPoint",coordinates:Q};return b(be,H,Se)}E.multiPoint=K;function Ge(Q,H,Se){Se===void 0&&(Se={});var be={type:"MultiPolygon",coordinates:Q};return b(be,H,Se)}E.multiPolygon=Ge;function pe(Q,H,Se){Se===void 0&&(Se={});var be={type:"GeometryCollection",geometries:Q};return b(be,H,Se)}E.geometryCollection=pe;function Ze(Q,H){if(H===void 0&&(H=0),H&&!(H>=0))throw new Error("precision must be a positive number");var Se=Math.pow(10,H||0);return Math.round(Q*Se)/Se}E.round=Ze;function Pe(Q,H){H===void 0&&(H="kilometers");var Se=E.factors[H];if(!Se)throw new Error(H+" units is invalid");return Q*Se}E.radiansToLength=Pe;function mt(Q,H){H===void 0&&(H="kilometers");var Se=E.factors[H];if(!Se)throw new Error(H+" units is invalid");return Q/Se}E.lengthToRadians=mt;function De(Q,H){return it(mt(Q,H))}E.lengthToDegrees=De;function At(Q){var H=Q%360;return H<0&&(H+=360),H}E.bearingToAzimuth=At;function it(Q){var H=Q%(2*Math.PI);return H*180/Math.PI}E.radiansToDegrees=it;function vt(Q){var H=Q%360;return H*Math.PI/180}E.degreesToRadians=vt;function Je(Q,H,Se){if(H===void 0&&(H="kilometers"),Se===void 0&&(Se="kilometers"),!(Q>=0))throw new Error("length must be a positive number");return Pe(mt(Q,H),Se)}E.convertLength=Je;function _t(Q,H,Se){if(H===void 0&&(H="meters"),Se===void 0&&(Se="kilometers"),!(Q>=0))throw new Error("area must be a positive number");var be=E.areaFactors[H];if(!be)throw new Error("invalid original units");var Te=E.areaFactors[Se];if(!Te)throw new Error("invalid final units");return Q/be*Te}E.convertArea=_t;function wt(Q){return!isNaN(Q)&&Q!==null&&!Array.isArray(Q)&&!/^\s*$/.test(Q)}E.isNumber=wt;function ke(Q){return!!Q&&Q.constructor===Object}E.isObject=ke;function Re(Q){if(!Q)throw new Error("bbox is required");if(!Array.isArray(Q))throw new Error("bbox must be an Array");if(Q.length!==4&&Q.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");Q.forEach(function(H){if(!wt(H))throw new Error("bbox must only contain numbers")})}E.validateBBox=Re;function Ve(Q){if(!Q)throw new Error("id is required");if(["string","number"].indexOf(typeof Q)===-1)throw new Error("id must be a number or a string")}E.validateId=Ve;function dt(){throw new Error("method has been renamed to `radiansToDegrees`")}E.radians2degrees=dt;function Me(){throw new Error("method has been renamed to `degreesToRadians`")}E.degrees2radians=Me;function ht(){throw new Error("method has been renamed to `lengthToDegrees`")}E.distanceToDegrees=ht;function Zt(){throw new Error("method has been renamed to `lengthToRadians`")}E.distanceToRadians=Zt;function Qt(){throw new Error("method has been renamed to `radiansToLength`")}E.radiansToDistance=Qt;function ur(){throw new Error("method has been renamed to `bearingToAzimuth`")}E.bearingToAngle=ur;function oe(){throw new Error("method has been renamed to `convertLength`")}E.convertDistance=oe},"0JQy":function(ze,E){var o="\\ud800-\\udfff",b="\\u0300-\\u036f",m="\\ufe20-\\ufe2f",Y="\\u20d0-\\u20ff",F=b+m+Y,i="\\ufe0e\\ufe0f",Z="["+o+"]",D="["+F+"]",$="\\ud83c[\\udffb-\\udfff]",te="(?:"+D+"|"+$+")",fe="[^"+o+"]",K="(?:\\ud83c[\\udde6-\\uddff]){2}",Ge="[\\ud800-\\udbff][\\udc00-\\udfff]",pe="\\u200d",Ze=te+"?",Pe="["+i+"]?",mt="(?:"+pe+"(?:"+[fe,K,Ge].join("|")+")"+Pe+Ze+")*",De=Pe+Ze+mt,At="(?:"+[fe+D+"?",D,K,Ge,Z].join("|")+")",it=RegExp($+"(?="+$+")|"+At+De,"g");function vt(Je){return Je.match(it)||[]}ze.exports=vt},"0ZTe":function(ze,E,o){var b=o("wy8a"),m=o("quyA"),Y=o("Em2t"),F=o("dt0z");function i(Z){return function(D){D=F(D);var $=m(D)?Y(D):void 0,te=$?$[0]:D.charAt(0),fe=$?b($,1).join(""):D.slice(1);return te[Z]()+fe}}ze.exports=i},"0eqD":function(ze,E){},"0gSV":function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("GXnB"),m=o("Ztfv");function Y(F,i){return function(Z,D,$){var te=new b.Metadata(F,i);typeof $=="number"?m.tagParameter(Z,D,$,te):m.tagProperty(Z,D,te)}}E.tagged=Y},"1+5i":function(ze,E,o){var b=o("w/wX"),m=o("sEf8"),Y=o("mdPL"),F=Y&&Y.isSet,i=F?m(F):b;ze.exports=i},"14J3":function(ze,E,o){"use strict";var b=o("cIOH"),m=o("1GLa")},"1ABj":function(ze,E){function o(b,m){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and runs after the decorators transform.")}ze.exports=o},"1gqn":function(ze,E){ze.exports=function(b){return b&&typeof b=="object"&&typeof b.copy=="function"&&typeof b.fill=="function"&&typeof b.readUInt8=="function"}},"1jvM":function(ze,E){},2:function(ze,E){},"2ajD":function(ze,E){function o(b){return b!==b}ze.exports=o},"3DfO":function(ze,E){function o(b){return b==null}ze.exports=o},"3L66":function(ze,E,o){var b=o("MMmD"),m=o("ExA7");function Y(F){return m(F)&&b(F)}ze.exports=Y},"3cYt":function(ze,E){function o(b){return function(m){return b==null?void 0:b[m]}}ze.exports=o},"406g":function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("z4Hk"),m=function(){function Y(F){this._binding=F}return Y.prototype.onActivation=function(F){return this._binding.onActivation=F,new b.BindingWhenSyntax(this._binding)},Y}();E.BindingOnSyntax=m},"4U9+":function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=function(Pe){return(0,m.default)((0,$.default)(Pe)&&Pe.length>=1,"Must merge at least 1 JSON schema."),F.default.apply(void 0,[{}].concat(Ze(Pe),[function(mt,De,At){if((0,Z.default)(mt))return;if(At==="required")return(0,fe.default)(mt.concat(De));if((0,Ge.default)(mt)){if(!(0,Ge.default)(De))throw new Error('Failed to merge schemas because "'+At+'" has different values.');return}m.default.deepEqual(mt,De,'Failed to merge schemas because "'+At+'" has different values: '+JSON.stringify(mt)+" and "+JSON.stringify(De)+".")}]))};var b=o("9lTW"),m=pe(b),Y=o("qd8s"),F=pe(Y),i=o("3DfO"),Z=pe(i),D=o("WFAs"),$=pe(D),te=o("w26f"),fe=pe(te),K=o("zZPE"),Ge=pe(K);function pe(Pe){return Pe&&Pe.__esModule?Pe:{default:Pe}}function Ze(Pe){if(Array.isArray(Pe)){for(var mt=0,De=Array(Pe.length);mt<Pe.length;mt++)De[mt]=Pe[mt];return De}else return Array.from(Pe)}ze.exports=E.default},"4ZJM":function(ze,E,o){(function(b,m){ze.exports=m()})(this,function(){"use strict";var b,m,Y;function F(i,Z){if(!b)b=Z;else if(!m)m=Z;else{var D="var sharedChunk = {}; ("+b+")(sharedChunk); ("+m+")(sharedChunk);",$={};b($),Y=Z($),typeof window!="undefined"&&(Y.workerUrl=window.URL.createObjectURL(new Blob([D],{type:"text/javascript"})))}}return F(["exports"],function(i){"use strict";function Z(e,t){return e(t={exports:{}},t.exports),t.exports}var D=$;function $(e,t,r,u){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(u-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=u,this.p2x=r,this.p2y=u}$.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},$.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},$.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},$.prototype.solveCurveX=function(e,t){var r,u,f,v,S;for(t===void 0&&(t=1e-6),f=e,S=0;S<8;S++){if(v=this.sampleCurveX(f)-e,Math.abs(v)<t)return f;var P=this.sampleCurveDerivativeX(f);if(Math.abs(P)<1e-6)break;f-=v/P}if((f=e)<(r=0))return r;if(f>(u=1))return u;for(;r<u;){if(v=this.sampleCurveX(f),Math.abs(v-e)<t)return f;e>v?r=f:u=f,f=.5*(u-r)+r}return f},$.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var te=fe;function fe(e,t){this.x=e,this.y=t}fe.prototype={clone:function(){return new fe(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,r){return this.clone()._rotateAround(t,r)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var r=t.x-this.x,u=t.y-this.y;return r*r+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,r){return Math.atan2(this.x*r-this.y*t,this.x*t+this.y*r)},_matMult:function(t){var r=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var r=Math.cos(t),u=Math.sin(t),f=u*this.x+r*this.y;return this.x=r*this.x-u*this.y,this.y=f,this},_rotateAround:function(t,r){var u=Math.cos(t),f=Math.sin(t),v=r.y+f*(this.x-r.x)+u*(this.y-r.y);return this.x=r.x+u*(this.x-r.x)-f*(this.y-r.y),this.y=v,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},fe.convert=function(e){return e instanceof fe?e:Array.isArray(e)?new fe(e[0],e[1]):e};var K=typeof self!="undefined"?self:{},Ge=Math.pow(2,53)-1;function pe(e,t,r,u){var f=new D(e,t,r,u);return function(v){return f.solve(v)}}var Ze=pe(.25,.1,.25,1);function Pe(e,t,r){return Math.min(r,Math.max(t,e))}function mt(e,t,r){var u=r-t,f=((e-t)%u+u)%u+t;return f===t?r:f}function De(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var u=0,f=t;u<f.length;u+=1){var v=f[u];for(var S in v)e[S]=v[S]}return e}var At=1;function it(){return At++}function vt(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function Je(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function _t(e,t){e.forEach(function(r){t[r]&&(t[r]=t[r].bind(t))})}function wt(e,t){return e.indexOf(t,e.length-t.length)!==-1}function ke(e,t,r){var u={};for(var f in e)u[f]=t.call(r||this,e[f],f,e);return u}function Re(e,t,r){var u={};for(var f in e)t.call(r||this,e[f],f,e)&&(u[f]=e[f]);return u}function Ve(e){return Array.isArray(e)?e.map(Ve):typeof e=="object"&&e?ke(e,Ve):e}var dt={};function Me(e){dt[e]||(typeof console!="undefined"&&console.warn(e),dt[e]=!0)}function ht(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function Zt(e){for(var t=0,r=0,u=e.length,f=u-1,v=void 0,S=void 0;r<u;f=r++)t+=((S=e[f]).x-(v=e[r]).x)*(v.y+S.y);return t}function Qt(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function ur(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(u,f,v,S){var P=v||S;return t[f]=!P||P.toLowerCase(),""}),t["max-age"]){var r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}var oe=null;function Q(e){if(oe==null){var t=e.navigator?e.navigator.userAgent:null;oe=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return oe}function H(e){try{var t=K[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(r){return!1}}var Se,be,Te,me,nt=K.performance&&K.performance.now?K.performance.now.bind(K.performance):Date.now.bind(Date),Jt=K.requestAnimationFrame||K.mozRequestAnimationFrame||K.webkitRequestAnimationFrame||K.msRequestAnimationFrame,Mt=K.cancelAnimationFrame||K.mozCancelAnimationFrame||K.webkitCancelAnimationFrame||K.msCancelAnimationFrame,ve={now:nt,frame:function(t){var r=Jt(t);return{cancel:function(){return Mt(r)}}},getImageData:function(t,r){r===void 0&&(r=0);var u=K.document.createElement("canvas"),f=u.getContext("2d");if(!f)throw new Error("failed to create canvas 2d context");return u.width=t.width,u.height=t.height,f.drawImage(t,0,0,t.width,t.height),f.getImageData(-r,-r,t.width+2*r,t.height+2*r)},resolveURL:function(t){return Se||(Se=K.document.createElement("a")),Se.href=t,Se.href},hardwareConcurrency:K.navigator&&K.navigator.hardwareConcurrency||4,get devicePixelRatio(){return K.devicePixelRatio},get prefersReducedMotion(){return!!K.matchMedia&&(be==null&&(be=K.matchMedia("(prefers-reduced-motion: reduce)")),be.matches)}},ge={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},He={supported:!1,testSupport:function(t){!ot&&me&&(we?gt(t):Te=t)}},ot=!1,we=!1;function gt(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,me),e.isContextLost())return;He.supported=!0}catch(r){}e.deleteTexture(t),ot=!0}K.document&&((me=K.document.createElement("img")).onload=function(){Te&&gt(Te),Te=null,we=!0},me.onerror=function(){ot=!0,Te=null},me.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var C="01",R=function(t,r){this._transformRequestFn=t,this._customAccessToken=r,this._createSkuToken()};function q(e){return e.indexOf("mapbox:")===0}R.prototype._createSkuToken=function(){var e=function(){for(var t="",r=0;r<10;r++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",C,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},R.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},R.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},R.prototype.normalizeStyleURL=function(e,t){if(!q(e))return e;var r=Tt(e);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},R.prototype.normalizeGlyphsURL=function(e,t){if(!q(e))return e;var r=Tt(e);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},R.prototype.normalizeSourceURL=function(e,t){if(!q(e))return e;var r=Tt(e);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||t)},R.prototype.normalizeSpriteURL=function(e,t,r,u){var f=Tt(e);return q(e)?(f.path="/styles/v1"+f.path+"/sprite"+t+r,this._makeAPIURL(f,this._customAccessToken||u)):(f.path+=""+t+r,at(f))},R.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!q(e))return e;var r=Tt(e);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(ve.devicePixelRatio>=2||t===512?"@2x":"")+(He.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var u=this._customAccessToken||function(f){for(var v=0,S=f;v<S.length;v+=1){var P=S[v].match(/^access_token=(.*)$/);if(P)return P[1]}return null}(r.params)||ge.ACCESS_TOKEN;return ge.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,u)},R.prototype.canonicalizeTileURL=function(e,t){var r=Tt(e);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return e;var u="mapbox://tiles/";u+=r.path.replace("/v4/","");var f=r.params;return t&&(f=f.filter(function(v){return!v.match(/^access_token=/)})),f.length&&(u+="?"+f.join("&")),u},R.prototype.canonicalizeTileset=function(e,t){for(var r=!!t&&q(t),u=[],f=0,v=e.tiles||[];f<v.length;f+=1){var S=v[f];We(S)?u.push(this.canonicalizeTileURL(S,r)):u.push(S)}return u},R.prototype._makeAPIURL=function(e,t){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",u=Tt(ge.API_URL);if(e.protocol=u.protocol,e.authority=u.authority,e.protocol==="http"){var f=e.params.indexOf("secure");f>=0&&e.params.splice(f,1)}if(u.path!=="/"&&(e.path=""+u.path+e.path),!ge.REQUIRE_ACCESS_TOKEN)return at(e);if(!(t=t||ge.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return e.params=e.params.filter(function(v){return v.indexOf("access_token")===-1}),e.params.push("access_token="+t),at(e)};var ce=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function We(e){return ce.test(e)}var qe=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Tt(e){var t=e.match(qe);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function at(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function Ut(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(K.atob(t[1]).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(r){return null}}var J=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};J.prototype.getStorageKey=function(e){var t,r=Ut(ge.ACCESS_TOKEN);return t=r&&r.u?K.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,function(u,f){return String.fromCharCode(Number("0x"+f))})):ge.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},J.prototype.fetchEventData=function(){var e=H("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{var u=K.localStorage.getItem(t);u&&(this.eventData=JSON.parse(u));var f=K.localStorage.getItem(r);f&&(this.anonId=f)}catch(v){Me("Unable to read from LocalStorage")}},J.prototype.saveEventData=function(){var e=H("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{K.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&K.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(u){Me("Unable to write to LocalStorage")}},J.prototype.processRequests=function(e){},J.prototype.postEvent=function(e,t,r,u){var f=this;if(ge.EVENTS_URL){var v=Tt(ge.EVENTS_URL);v.params.push("access_token="+(u||ge.ACCESS_TOKEN||""));var S={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.0",skuId:C,userId:this.anonId},P=t?De(S,t):S,V={url:at(v),headers:{"Content-Type":"text/plain"},body:JSON.stringify([P])};this.pendingRequest=On(V,function(ee){f.pendingRequest=null,r(ee),f.saveEventData(),f.processRequests(u)})}},J.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var Qe,ne,et=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(r,u,f,v){this.skuToken=f,(ge.EVENTS_URL&&v||ge.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(S){return q(S)||We(S)}))&&this.queueRequest({id:u,timestamp:Date.now()},v)},t.prototype.processRequests=function(r){var u=this;if(!this.pendingRequest&&this.queue.length!==0){var f=this.queue.shift(),v=f.id,S=f.timestamp;v&&this.success[v]||(this.anonId||this.fetchEventData(),Je(this.anonId)||(this.anonId=vt()),this.postEvent(S,{skuToken:this.skuToken},function(P){P||v&&(u.success[v]=!0)},r))}},t}(J),kt=new(function(e){function t(r){e.call(this,"appUserTurnstile"),this._customAccessToken=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(r,u){ge.EVENTS_URL&&ge.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(f){return q(f)||We(f)})&&this.queueRequest(Date.now(),u)},t.prototype.processRequests=function(r){var u=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var f=Ut(ge.ACCESS_TOKEN),v=f?f.u:ge.ACCESS_TOKEN,S=v!==this.eventData.tokenU;Je(this.anonId)||(this.anonId=vt(),S=!0);var P=this.queue.shift();if(this.eventData.lastSuccess){var V=new Date(this.eventData.lastSuccess),ee=new Date(P),he=(P-this.eventData.lastSuccess)/864e5;S=S||he>=1||he<-1||V.getDate()!==ee.getDate()}else S=!0;if(!S)return this.processRequests();this.postEvent(P,{"enabled.telemetry":!1},function(_e){_e||(u.eventData.lastSuccess=P,u.eventData.tokenU=v)},r)}},t}(J)),dr=kt.postTurnstileEvent.bind(kt),Ye=new et,xt=Ye.postMapLoadEvent.bind(Ye),bt=500,Et=50;function Fe(){K.caches&&!Qe&&(Qe=K.caches.open("mapbox-tiles"))}function pt(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var yt,Ht=1/0;function hr(){return yt==null&&(yt=K.OffscreenCanvas&&new K.OffscreenCanvas(1,1).getContext("2d")&&typeof K.createImageBitmap=="function"),yt}var Hr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Hr);var gr=function(e){function t(r,u,f){u===401&&We(f)&&(r+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,r),this.status=u,this.url=f,this.name=this.constructor.name,this.message=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),Bn=Qt()?function(){return self.worker&&self.worker.referrer}:function(){return(K.location.protocol==="blob:"?K.parent:K).location.href},zn,oa,$n=function(t,r){if(!(/^file:/.test(u=t.url)||/^file:/.test(Bn())&&!/^\w+:/.test(u))){if(K.fetch&&K.Request&&K.AbortController&&K.Request.prototype.hasOwnProperty("signal"))return function(f,v){var S,P=new K.AbortController,V=new K.Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:Bn(),signal:P.signal}),ee=!1,he=!1,_e=(S=V.url).indexOf("sku=")>0&&We(S);f.type==="json"&&V.headers.set("Accept","application/json");var Ce=function(St,Yt,Wt){if(!he){if(St&&St.message!=="SecurityError"&&Me(St),Yt&&Wt)return ut(Yt);var ir=Date.now();K.fetch(V).then(function(yr){if(yr.ok){var _r=_e?yr.clone():null;return ut(yr,_r,ir)}return v(new gr(yr.statusText,yr.status,f.url))}).catch(function(yr){yr.code!==20&&v(new Error(yr.message))})}},ut=function(St,Yt,Wt){(f.type==="arrayBuffer"?St.arrayBuffer():f.type==="json"?St.json():St.text()).then(function(ir){he||(Yt&&Wt&&function(yr,_r,kr){if(Fe(),Qe){var Dr={status:_r.status,statusText:_r.statusText,headers:new K.Headers};_r.headers.forEach(function(fn,Rn){return Dr.headers.set(Rn,fn)});var pn=ur(_r.headers.get("Cache-Control")||"");pn["no-store"]||(pn["max-age"]&&Dr.headers.set("Expires",new Date(kr+1e3*pn["max-age"]).toUTCString()),new Date(Dr.headers.get("Expires")).getTime()-kr<42e4||function(fn,Rn){if(ne===void 0)try{new Response(new ReadableStream),ne=!0}catch(Qn){ne=!1}ne?Rn(fn.body):fn.blob().then(Rn)}(_r,function(fn){var Rn=new K.Response(fn,Dr);Fe(),Qe&&Qe.then(function(Qn){return Qn.put(pt(yr.url),Rn)}).catch(function(Qn){return Me(Qn.message)})}))}}(V,Yt,Wt),ee=!0,v(null,ir,St.headers.get("Cache-Control"),St.headers.get("Expires")))}).catch(function(ir){he||v(new Error(ir.message))})};return _e?function(Pt,St){if(Fe(),!Qe)return St(null);var Yt=pt(Pt.url);Qe.then(function(Wt){Wt.match(Yt).then(function(ir){var yr=function(_r){if(!_r)return!1;var kr=new Date(_r.headers.get("Expires")||0),Dr=ur(_r.headers.get("Cache-Control")||"");return kr>Date.now()&&!Dr["no-cache"]}(ir);Wt.delete(Yt),yr&&Wt.put(Yt,ir.clone()),St(null,ir,yr)}).catch(St)}).catch(St)}(V,Ce):Ce(null,null),{cancel:function(){he=!0,ee||P.abort()}}}(t,r);if(Qt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,r,void 0,!0)}var u;return function(f,v){var S=new K.XMLHttpRequest;for(var P in S.open(f.method||"GET",f.url,!0),f.type==="arrayBuffer"&&(S.responseType="arraybuffer"),f.headers)S.setRequestHeader(P,f.headers[P]);return f.type==="json"&&(S.responseType="text",S.setRequestHeader("Accept","application/json")),S.withCredentials=f.credentials==="include",S.onerror=function(){v(new Error(S.statusText))},S.onload=function(){if((S.status>=200&&S.status<300||S.status===0)&&S.response!==null){var V=S.response;if(f.type==="json")try{V=JSON.parse(S.response)}catch(ee){return v(ee)}v(null,V,S.getResponseHeader("Cache-Control"),S.getResponseHeader("Expires"))}else v(new gr(S.statusText,S.status,f.url))},S.send(f.body),{cancel:function(){return S.abort()}}}(t,r)},Yn=function(t,r){return $n(De(t,{type:"arrayBuffer"}),r)},On=function(t,r){return $n(De(t,{method:"POST"}),r)},U="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";zn=[],oa=0;var W=function e(t,r){if(He.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),oa>=ge.MAX_PARALLEL_IMAGE_REQUESTS){var u={requestParameters:t,callback:r,cancelled:!1,cancel:function(){this.cancelled=!0}};return zn.push(u),u}oa++;var f=!1,v=function(){if(!f)for(f=!0,oa--;zn.length&&oa<ge.MAX_PARALLEL_IMAGE_REQUESTS;){var V=zn.shift();V.cancelled||(V.cancel=e(V.requestParameters,V.callback).cancel)}},S=Yn(t,function(P,V,ee,he){v(),P?r(P):V&&(hr()?function(_e,Ce){var ut=new K.Blob([new Uint8Array(_e)],{type:"image/png"});K.createImageBitmap(ut).then(function(Pt){Ce(null,Pt)}).catch(function(Pt){Ce(new Error("Could not load image because of "+Pt.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(V,r):function(_e,Ce,ut,Pt){var St=new K.Image,Yt=K.URL;St.onload=function(){Ce(null,St),Yt.revokeObjectURL(St.src),St.onload=null,St.src=U},St.onerror=function(){return Ce(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Wt=new K.Blob([new Uint8Array(_e)],{type:"image/png"});St.cacheControl=ut,St.expires=Pt,St.src=_e.byteLength?Yt.createObjectURL(Wt):U}(V,r,ee,he))});return{cancel:function(){S.cancel(),v()}}};function le(e,t,r){r[e]&&r[e].indexOf(t)!==-1||(r[e]=r[e]||[],r[e].push(t))}function xe(e,t,r){if(r&&r[e]){var u=r[e].indexOf(t);u!==-1&&r[e].splice(u,1)}}var st=function(t,r){r===void 0&&(r={}),De(this,r),this.type=t},Ct=function(e){function t(r,u){u===void 0&&(u={}),e.call(this,"error",De({error:r},u))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(st),Bt=function(){};Bt.prototype.on=function(e,t){return this._listeners=this._listeners||{},le(e,t,this._listeners),this},Bt.prototype.off=function(e,t){return xe(e,t,this._listeners),xe(e,t,this._oneTimeListeners),this},Bt.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},le(e,t,this._oneTimeListeners),this},Bt.prototype.fire=function(e,t){typeof e=="string"&&(e=new st(e,t||{}));var r=e.type;if(this.listens(r)){e.target=this;for(var u=0,f=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];u<f.length;u+=1)f[u].call(this,e);for(var v=0,S=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];v<S.length;v+=1){var P=S[v];xe(r,P,this._oneTimeListeners),P.call(this,e)}var V=this._eventedParent;V&&(De(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),V.fire(e))}else e instanceof Ct&&console.error(e.error);return this},Bt.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},Bt.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var Xe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Lt=function(t,r,u,f){this.message=(t?t+": ":"")+u,f&&(this.identifier=f),r!=null&&r.__line__&&(this.line=r.__line__)};function lr(e){var t=e.value;return t?[new Lt(e.key,t,"constants have been deprecated as of v8")]:[]}function zr(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var u=0,f=t;u<f.length;u+=1){var v=f[u];for(var S in v)e[S]=v[S]}return e}function Vr(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function cr(e){if(Array.isArray(e))return e.map(cr);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var r in e)t[r]=cr(e[r]);return t}return Vr(e)}var Ur=function(e){function t(r,u){e.call(this,u),this.message=u,this.key=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),Mn=function(t,r){r===void 0&&(r=[]),this.parent=t,this.bindings={};for(var u=0,f=r;u<f.length;u+=1){var v=f[u];this.bindings[v[0]]=v[1]}};Mn.prototype.concat=function(e){return new Mn(this,e)},Mn.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},Mn.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var ln={kind:"null"},er={kind:"number"},tn={kind:"string"},hn={kind:"boolean"},xn={kind:"color"},yn={kind:"object"},vn={kind:"value"},Pn={kind:"collator"},Va={kind:"formatted"},va={kind:"resolvedImage"};function Ma(e,t){return{kind:"array",itemType:e,N:t}}function Ia(e){if(e.kind==="array"){var t=Ia(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var Wi=[ln,er,tn,hn,xn,Va,yn,Ma(vn),va];function da(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!da(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var r=0,u=Wi;r<u.length;r+=1)if(!da(u[r],t))return null}}return"Expected "+Ia(e)+" but found "+Ia(t)+" instead."}function di(e,t){return t.some(function(r){return r.kind===e.kind})}function ga(e,t){return t.some(function(r){return r==="null"?e===null:r==="array"?Array.isArray(e):r==="object"?e&&!Array.isArray(e)&&typeof e=="object":r===typeof e})}var ya=Z(function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function u(P){return(P=Math.round(P))<0?0:P>255?255:P}function f(P){return u(P[P.length-1]==="%"?parseFloat(P)/100*255:parseInt(P))}function v(P){return(V=P[P.length-1]==="%"?parseFloat(P)/100:parseFloat(P))<0?0:V>1?1:V;var V}function S(P,V,ee){return ee<0?ee+=1:ee>1&&(ee-=1),6*ee<1?P+(V-P)*ee*6:2*ee<1?V:3*ee<2?P+(V-P)*(2/3-ee)*6:P}try{t.parseCSSColor=function(P){var V,ee=P.replace(/ /g,"").toLowerCase();if(ee in r)return r[ee].slice();if(ee[0]==="#")return ee.length===4?(V=parseInt(ee.substr(1),16))>=0&&V<=4095?[(3840&V)>>4|(3840&V)>>8,240&V|(240&V)>>4,15&V|(15&V)<<4,1]:null:ee.length===7&&(V=parseInt(ee.substr(1),16))>=0&&V<=16777215?[(16711680&V)>>16,(65280&V)>>8,255&V,1]:null;var he=ee.indexOf("("),_e=ee.indexOf(")");if(he!==-1&&_e+1===ee.length){var Ce=ee.substr(0,he),ut=ee.substr(he+1,_e-(he+1)).split(","),Pt=1;switch(Ce){case"rgba":if(ut.length!==4)return null;Pt=v(ut.pop());case"rgb":return ut.length!==3?null:[f(ut[0]),f(ut[1]),f(ut[2]),Pt];case"hsla":if(ut.length!==4)return null;Pt=v(ut.pop());case"hsl":if(ut.length!==3)return null;var St=(parseFloat(ut[0])%360+360)%360/360,Yt=v(ut[1]),Wt=v(ut[2]),ir=Wt<=.5?Wt*(Yt+1):Wt+Yt-Wt*Yt,yr=2*Wt-ir;return[u(255*S(yr,ir,St+1/3)),u(255*S(yr,ir,St)),u(255*S(yr,ir,St-1/3)),Pt];default:return null}}return null}}catch(P){}}).parseCSSColor,fa=function(t,r,u,f){f===void 0&&(f=1),this.r=t,this.g=r,this.b=u,this.a=f};fa.parse=function(e){if(e){if(e instanceof fa)return e;if(typeof e=="string"){var t=ya(e);if(t)return new fa(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},fa.prototype.toString=function(){var e=this.toArray(),t=e[1],r=e[2],u=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(r)+","+u+")"},fa.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},fa.black=new fa(0,0,0,1),fa.white=new fa(1,1,1,1),fa.transparent=new fa(0,0,0,0),fa.red=new fa(1,0,0,1);var Si=function(t,r,u){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Si.prototype.compare=function(e,t){return this.collator.compare(e,t)},Si.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var ns=function(t,r,u,f,v){this.text=t,this.image=r,this.scale=u,this.fontStack=f,this.textColor=v},Xi=function(t){this.sections=t};Xi.fromString=function(e){return new Xi([new ns(e,null,null,null,null)])},Xi.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},Xi.factory=function(e){return e instanceof Xi?e:Xi.fromString(e)},Xi.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},Xi.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var u=r[t];if(u.image)e.push(["image",u.image.name]);else{e.push(u.text);var f={};u.fontStack&&(f["text-font"]=["literal",u.fontStack.split(",")]),u.scale&&(f["font-scale"]=u.scale),u.textColor&&(f["text-color"]=["rgba"].concat(u.textColor.toArray())),e.push(f)}}return e};var Vo=function(t){this.name=t.name,this.available=t.available};function ju(e,t,r,u){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:"Invalid rgba value ["+[e,t,r,u].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof u=="number"?[e,t,r,u]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Ga(e){if(e===null)return!0;if(typeof e=="string")return!0;if(typeof e=="boolean")return!0;if(typeof e=="number")return!0;if(e instanceof fa)return!0;if(e instanceof Si)return!0;if(e instanceof Xi)return!0;if(e instanceof Vo)return!0;if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1)if(!Ga(r[t]))return!1;return!0}if(typeof e=="object"){for(var u in e)if(!Ga(e[u]))return!1;return!0}return!1}function Ai(e){if(e===null)return ln;if(typeof e=="string")return tn;if(typeof e=="boolean")return hn;if(typeof e=="number")return er;if(e instanceof fa)return xn;if(e instanceof Si)return Pn;if(e instanceof Xi)return Va;if(e instanceof Vo)return va;if(Array.isArray(e)){for(var t,r=e.length,u=0,f=e;u<f.length;u+=1){var v=Ai(f[u]);if(t){if(t===v)continue;t=vn;break}t=v}return Ma(t||vn,r)}return yn}function Ko(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof fa||e instanceof Xi||e instanceof Vo?e.toString():JSON.stringify(e)}Vo.prototype.toString=function(){return this.name},Vo.fromString=function(e){return e?new Vo({name:e,available:!1}):null},Vo.prototype.serialize=function(){return["image",this.name]};var oi=function(t,r){this.type=t,this.value=r};oi.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!Ga(e[1]))return t.error("invalid value");var r=e[1],u=Ai(r),f=t.expectedType;return u.kind!=="array"||u.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(u=f),new oi(u,r)},oi.prototype.evaluate=function(){return this.value},oi.prototype.eachChild=function(){},oi.prototype.outputDefined=function(){return!0},oi.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof fa?["rgba"].concat(this.value.toArray()):this.value instanceof Xi?this.value.serialize():this.value};var Yi=function(t){this.name="ExpressionEvaluationError",this.message=t};Yi.prototype.toJSON=function(){return this.message};var wo={string:tn,number:er,boolean:hn,object:yn},Ha=function(t,r){this.type=t,this.args=r};Ha.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r,u=1,f=e[0];if(f==="array"){var v,S;if(e.length>2){var P=e[1];if(typeof P!="string"||!(P in wo)||P==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);v=wo[P],u++}else v=vn;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);S=e[2],u++}r=Ma(v,S)}else r=wo[f];for(var V=[];u<e.length;u++){var ee=t.parse(e[u],u,vn);if(!ee)return null;V.push(ee)}return new Ha(r,V)},Ha.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!da(this.type,Ai(r)))return r;if(t===this.args.length-1)throw new Yi("Expected value to be of type "+Ia(this.type)+", but found "+Ia(Ai(r))+" instead.")}return null},Ha.prototype.eachChild=function(e){this.args.forEach(e)},Ha.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Ha.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var r=e.itemType;if(r.kind==="string"||r.kind==="number"||r.kind==="boolean"){t.push(r.kind);var u=e.N;(typeof u=="number"||this.args.length>1)&&t.push(u)}}return t.concat(this.args.map(function(f){return f.serialize()}))};var oo=function(t){this.type=Va,this.sections=t};oo.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&typeof r=="object")return t.error("First argument must be an image or text section.");for(var u=[],f=!1,v=1;v<=e.length-1;++v){var S=e[v];if(f&&typeof S=="object"&&!Array.isArray(S)){f=!1;var P=null;if(S["font-scale"]&&!(P=t.parse(S["font-scale"],1,er)))return null;var V=null;if(S["text-font"]&&!(V=t.parse(S["text-font"],1,Ma(tn))))return null;var ee=null;if(S["text-color"]&&!(ee=t.parse(S["text-color"],1,xn)))return null;var he=u[u.length-1];he.scale=P,he.font=V,he.textColor=ee}else{var _e=t.parse(e[v],1,vn);if(!_e)return null;var Ce=_e.type.kind;if(Ce!=="string"&&Ce!=="value"&&Ce!=="null"&&Ce!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,u.push({content:_e,scale:null,font:null,textColor:null})}}return new oo(u)},oo.prototype.evaluate=function(e){return new Xi(this.sections.map(function(t){var r=t.content.evaluate(e);return Ai(r)===va?new ns("",r,null,null,null):new ns(Ko(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},oo.prototype.eachChild=function(e){for(var t=0,r=this.sections;t<r.length;t+=1){var u=r[t];e(u.content),u.scale&&e(u.scale),u.font&&e(u.font),u.textColor&&e(u.textColor)}},oo.prototype.outputDefined=function(){return!1},oo.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var u=r[t];e.push(u.content.serialize());var f={};u.scale&&(f["font-scale"]=u.scale.serialize()),u.font&&(f["text-font"]=u.font.serialize()),u.textColor&&(f["text-color"]=u.textColor.serialize()),e.push(f)}return e};var so=function(t){this.type=va,this.input=t};so.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var r=t.parse(e[1],1,tn);return r?new so(r):t.error("No image name provided.")},so.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=Vo.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r},so.prototype.eachChild=function(e){e(this.input)},so.prototype.outputDefined=function(){return!1},so.prototype.serialize=function(){return["image",this.input.serialize()]};var Eu={"to-boolean":hn,"to-color":xn,"to-number":er,"to-string":tn},$o=function(t,r){this.type=t,this.args=r};$o.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[0];if((r==="to-boolean"||r==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var u=Eu[r],f=[],v=1;v<e.length;v++){var S=t.parse(e[v],v,vn);if(!S)return null;f.push(S)}return new $o(u,f)},$o.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var t,r,u=0,f=this.args;u<f.length;u+=1){if(r=null,(t=f[u].evaluate(e))instanceof fa)return t;if(typeof t=="string"){var v=e.parseColor(t);if(v)return v}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":ju(t[0],t[1],t[2],t[3])))return new fa(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Yi(r||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var S=null,P=0,V=this.args;P<V.length;P+=1){if((S=V[P].evaluate(e))===null)return 0;var ee=Number(S);if(!isNaN(ee))return ee}throw new Yi("Could not convert "+JSON.stringify(S)+" to number.")}return this.type.kind==="formatted"?Xi.fromString(Ko(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Vo.fromString(Ko(this.args[0].evaluate(e))):Ko(this.args[0].evaluate(e))},$o.prototype.eachChild=function(e){this.args.forEach(e)},$o.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},$o.prototype.serialize=function(){if(this.type.kind==="formatted")return new oo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new so(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var Kl=["Unknown","Point","LineString","Polygon"],ks=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};ks.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},ks.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Kl[this.feature.type]:this.feature.type:null},ks.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},ks.prototype.canonicalID=function(){return this.canonical},ks.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ks.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=fa.parse(e)),t};var ho=function(t,r,u,f){this.name=t,this.type=r,this._evaluate=u,this.args=f};ho.prototype.evaluate=function(e){return this._evaluate(e,this.args)},ho.prototype.eachChild=function(e){this.args.forEach(e)},ho.prototype.outputDefined=function(){return!1},ho.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},ho.parse=function(e,t){var r,u=e[0],f=ho.definitions[u];if(!f)return t.error('Unknown expression "'+u+'". If you wanted a literal array, use ["literal", [...]].',0);for(var v=Array.isArray(f)?f[0]:f.type,S=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,P=S.filter(function(Xn){var Nn=Xn[0];return!Array.isArray(Nn)||Nn.length===e.length-1}),V=null,ee=0,he=P;ee<he.length;ee+=1){var _e=he[ee],Ce=_e[0],ut=_e[1];V=new Ks(t.registry,t.path,null,t.scope);for(var Pt=[],St=!1,Yt=1;Yt<e.length;Yt++){var Wt=e[Yt],ir=Array.isArray(Ce)?Ce[Yt-1]:Ce.type,yr=V.parse(Wt,1+Pt.length,ir);if(!yr){St=!0;break}Pt.push(yr)}if(!St)if(Array.isArray(Ce)&&Ce.length!==Pt.length)V.error("Expected "+Ce.length+" arguments, but found "+Pt.length+" instead.");else{for(var _r=0;_r<Pt.length;_r++){var kr=Array.isArray(Ce)?Ce[_r]:Ce.type,Dr=Pt[_r];V.concat(_r+1).checkSubtype(kr,Dr.type)}if(V.errors.length===0)return new ho(u,v,ut,Pt)}}if(P.length===1)(r=t.errors).push.apply(r,V.errors);else{for(var pn=(P.length?P:S).map(function(Xn){var Nn;return Nn=Xn[0],Array.isArray(Nn)?"("+Nn.map(Ia).join(", ")+")":"("+Ia(Nn.type)+"...)"}).join(" | "),fn=[],Rn=1;Rn<e.length;Rn++){var Qn=t.parse(e[Rn],1+fn.length);if(!Qn)return null;fn.push(Ia(Qn.type))}t.error("Expected arguments of type "+pn+", but found ("+fn.join(", ")+") instead.")}return null},ho.register=function(e,t){for(var r in ho.definitions=t,t)e[r]=ho};var Vt=function(t,r,u){this.type=Pn,this.locale=u,this.caseSensitive=t,this.diacriticSensitive=r};function Le(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Dt(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function mr(e,t){var r=(180+e[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(r*f*8192),Math.round(u*f*8192)]}function Qr(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function En(e,t){for(var r,u,f,v,S,P,V,ee=!1,he=0,_e=t.length;he<_e;he++)for(var Ce=t[he],ut=0,Pt=Ce.length;ut<Pt-1;ut++){if((v=(r=e)[0]-(u=Ce[ut])[0])*(V=r[1]-(f=Ce[ut+1])[1])-(P=r[0]-f[0])*(S=r[1]-u[1])==0&&v*P<=0&&S*V<=0)return!1;Qr(e,Ce[ut],Ce[ut+1])&&(ee=!ee)}return ee}function Vn(e,t){for(var r=0;r<t.length;r++)if(En(e,t[r]))return!0;return!1}function Ci(e,t,r,u){var f=u[0]-r[0],v=u[1]-r[1],S=(e[0]-r[0])*v-f*(e[1]-r[1]),P=(t[0]-r[0])*v-f*(t[1]-r[1]);return S>0&&P<0||S<0&&P>0}function po(e,t,r){for(var u=0,f=r;u<f.length;u+=1)for(var v=f[u],S=0;S<v.length-1;++S)if((_e=[(he=v[S+1])[0]-(ee=v[S])[0],he[1]-ee[1]])[0]*(Ce=[(V=t)[0]-(P=e)[0],V[1]-P[1]])[1]-_e[1]*Ce[0]!=0&&Ci(P,V,ee,he)&&Ci(ee,he,P,V))return!0;var P,V,ee,he,_e,Ce;return!1}function mo(e,t){for(var r=0;r<e.length;++r)if(!En(e[r],t))return!1;for(var u=0;u<e.length-1;++u)if(po(e[u],e[u+1],t))return!1;return!0}function Oo(e,t){for(var r=0;r<t.length;r++)if(mo(e,t[r]))return!0;return!1}function Fu(e,t,r){for(var u=[],f=0;f<e.length;f++){for(var v=[],S=0;S<e[f].length;S++){var P=mr(e[f][S],r);Le(t,P),v.push(P)}u.push(v)}return u}function Ml(e,t,r){for(var u=[],f=0;f<e.length;f++){var v=Fu(e[f],t,r);u.push(v)}return u}function bs(e,t,r,u){if(e[0]<r[0]||e[0]>r[2]){var f=.5*u,v=e[0]-r[0]>f?-u:r[0]-e[0]>f?u:0;v===0&&(v=e[0]-r[2]>f?-u:r[2]-e[0]>f?u:0),e[0]+=v}Le(t,e)}function vc(e,t,r,u){for(var f=8192*Math.pow(2,u.z),v=[8192*u.x,8192*u.y],S=[],P=0,V=e;P<V.length;P+=1)for(var ee=0,he=V[P];ee<he.length;ee+=1){var _e=he[ee],Ce=[_e.x+v[0],_e.y+v[1]];bs(Ce,t,r,f),S.push(Ce)}return S}function Tu(e,t,r,u){for(var f,v=8192*Math.pow(2,u.z),S=[8192*u.x,8192*u.y],P=[],V=0,ee=e;V<ee.length;V+=1){for(var he=[],_e=0,Ce=ee[V];_e<Ce.length;_e+=1){var ut=Ce[_e],Pt=[ut.x+S[0],ut.y+S[1]];Le(t,Pt),he.push(Pt)}P.push(he)}if(t[2]-t[0]<=v/2){(f=t)[0]=f[1]=1/0,f[2]=f[3]=-1/0;for(var St=0,Yt=P;St<Yt.length;St+=1)for(var Wt=0,ir=Yt[St];Wt<ir.length;Wt+=1)bs(ir[Wt],t,r,v)}return P}Vt.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var r=e[1];if(typeof r!="object"||Array.isArray(r))return t.error("Collator options argument must be an object.");var u=t.parse(r["case-sensitive"]!==void 0&&r["case-sensitive"],1,hn);if(!u)return null;var f=t.parse(r["diacritic-sensitive"]!==void 0&&r["diacritic-sensitive"],1,hn);if(!f)return null;var v=null;return r.locale&&!(v=t.parse(r.locale,1,tn))?null:new Vt(u,f,v)},Vt.prototype.evaluate=function(e){return new Si(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},Vt.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},Vt.prototype.outputDefined=function(){return!1},Vt.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Mo=function(t,r){this.type=hn,this.geojson=t,this.geometries=r};function zu(e){if(e instanceof ho){if(e.name==="get"&&e.args.length===1)return!1;if(e.name==="feature-state")return!1;if(e.name==="has"&&e.args.length===1)return!1;if(e.name==="properties"||e.name==="geometry-type"||e.name==="id")return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof Mo)return!1;var t=!0;return e.eachChild(function(r){t&&!zu(r)&&(t=!1)}),t}function Eo(e){if(e instanceof ho&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(r){t&&!Eo(r)&&(t=!1)}),t}function Fi(e,t){if(e instanceof ho&&t.indexOf(e.name)>=0)return!1;var r=!0;return e.eachChild(function(u){r&&!Fi(u,t)&&(r=!1)}),r}Mo.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(Ga(e[1])){var r=e[1];if(r.type==="FeatureCollection")for(var u=0;u<r.features.length;++u){var f=r.features[u].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Mo(r,r.features[u].geometry)}else if(r.type==="Feature"){var v=r.geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new Mo(r,r.geometry)}else if(r.type==="Polygon"||r.type==="MultiPolygon")return new Mo(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Mo.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,r){var u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],v=t.canonicalID();if(r.type==="Polygon"){var S=Fu(r.coordinates,f,v),P=vc(t.geometry(),u,f,v);if(!Dt(u,f))return!1;for(var V=0,ee=P;V<ee.length;V+=1)if(!En(ee[V],S))return!1}if(r.type==="MultiPolygon"){var he=Ml(r.coordinates,f,v),_e=vc(t.geometry(),u,f,v);if(!Dt(u,f))return!1;for(var Ce=0,ut=_e;Ce<ut.length;Ce+=1)if(!Vn(ut[Ce],he))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,r){var u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],v=t.canonicalID();if(r.type==="Polygon"){var S=Fu(r.coordinates,f,v),P=Tu(t.geometry(),u,f,v);if(!Dt(u,f))return!1;for(var V=0,ee=P;V<ee.length;V+=1)if(!mo(ee[V],S))return!1}if(r.type==="MultiPolygon"){var he=Ml(r.coordinates,f,v),_e=Tu(t.geometry(),u,f,v);if(!Dt(u,f))return!1;for(var Ce=0,ut=_e;Ce<ut.length;Ce+=1)if(!Oo(ut[Ce],he))return!1}return!0}(e,this.geometries)}return!1},Mo.prototype.eachChild=function(){},Mo.prototype.outputDefined=function(){return!0},Mo.prototype.serialize=function(){return["within",this.geojson]};var Ys=function(t,r){this.type=r.type,this.name=t,this.boundExpression=r};Ys.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var r=e[1];return t.scope.has(r)?new Ys(r,t.scope.get(r)):t.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},Ys.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Ys.prototype.eachChild=function(){},Ys.prototype.outputDefined=function(){return!1},Ys.prototype.serialize=function(){return["var",this.name]};var Ks=function(t,r,u,f,v){r===void 0&&(r=[]),f===void 0&&(f=new Mn),v===void 0&&(v=[]),this.registry=t,this.path=r,this.key=r.map(function(S){return"["+S+"]"}).join(""),this.scope=f,this.errors=v,this.expectedType=u};function js(e,t){for(var r,u=e.length-1,f=0,v=u,S=0;f<=v;)if((r=e[S=Math.floor((f+v)/2)])<=t){if(S===u||t<e[S+1])return S;f=S+1}else{if(!(r>t))throw new Yi("Input is not a number.");v=S-1}return 0}Ks.prototype.parse=function(e,t,r,u,f){return f===void 0&&(f={}),t?this.concat(t,r,u)._parse(e,f):this._parse(e,f)},Ks.prototype._parse=function(e,t){function r(ee,he,_e){return _e==="assert"?new Ha(he,[ee]):_e==="coerce"?new $o(he,[ee]):ee}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var u=e[0];if(typeof u!="string")return this.error("Expression name must be a string, but found "+typeof u+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var f=this.registry[u];if(f){var v=f.parse(e,this);if(!v)return null;if(this.expectedType){var S=this.expectedType,P=v.type;if(S.kind!=="string"&&S.kind!=="number"&&S.kind!=="boolean"&&S.kind!=="object"&&S.kind!=="array"||P.kind!=="value")if(S.kind!=="color"&&S.kind!=="formatted"&&S.kind!=="resolvedImage"||P.kind!=="value"&&P.kind!=="string"){if(this.checkSubtype(S,P))return null}else v=r(v,S,t.typeAnnotation||"coerce");else v=r(v,S,t.typeAnnotation||"assert")}if(!(v instanceof oi)&&v.type.kind!=="resolvedImage"&&function ee(he){if(he instanceof Ys)return ee(he.boundExpression);if(he instanceof ho&&he.name==="error")return!1;if(he instanceof Vt)return!1;if(he instanceof Mo)return!1;var _e=he instanceof $o||he instanceof Ha,Ce=!0;return he.eachChild(function(ut){Ce=_e?Ce&&ee(ut):Ce&&ut instanceof oi}),!!Ce&&zu(he)&&Fi(he,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(v)){var V=new ks;try{v=new oi(v.type,v.evaluate(V))}catch(ee){return this.error(ee.message),null}}return v}return this.error('Unknown expression "'+u+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Ks.prototype.concat=function(e,t,r){var u=typeof e=="number"?this.path.concat(e):this.path,f=r?this.scope.concat(r):this.scope;return new Ks(this.registry,u,t||null,f,this.errors)},Ks.prototype.error=function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];var u=""+this.key+t.map(function(f){return"["+f+"]"}).join("");this.errors.push(new Ur(u,e))},Ks.prototype.checkSubtype=function(e,t){var r=da(e,t);return r&&this.error(r),r};var Ri=function(t,r,u){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(var f=0,v=u;f<v.length;f+=1){var S=v[f],P=S[1];this.labels.push(S[0]),this.outputs.push(P)}};function Vi(e,t,r){return e*(1-r)+t*r}Ri.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var r=t.parse(e[1],1,er);if(!r)return null;var u=[],f=null;t.expectedType&&t.expectedType.kind!=="value"&&(f=t.expectedType);for(var v=1;v<e.length;v+=2){var S=v===1?-1/0:e[v],P=e[v+1],V=v,ee=v+1;if(typeof S!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(u.length&&u[u.length-1][0]>=S)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',V);var he=t.parse(P,ee,f);if(!he)return null;f=f||he.type,u.push([S,he])}return new Ri(f,r,u)},Ri.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var u=this.input.evaluate(e);if(u<=t[0])return r[0].evaluate(e);var f=t.length;return u>=t[f-1]?r[f-1].evaluate(e):r[js(t,u)].evaluate(e)},Ri.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},Ri.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Ri.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var xs=Object.freeze({__proto__:null,number:Vi,color:function(t,r,u){return new fa(Vi(t.r,r.r,u),Vi(t.g,r.g,u),Vi(t.b,r.b,u),Vi(t.a,r.a,u))},array:function(t,r,u){return t.map(function(f,v){return Vi(f,r[v],u)})}}),vl=6/29*3*(6/29),Qu=Math.PI/180,Rt=180/Math.PI;function fr(e){return e>.008856451679035631?Math.pow(e,1/3):e/vl+4/29}function Mr(e){return e>6/29?e*e*e:vl*(e-4/29)}function Wn(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Xa(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function vi(e){var t=Xa(e.r),r=Xa(e.g),u=Xa(e.b),f=fr((.4124564*t+.3575761*r+.1804375*u)/.95047),v=fr((.2126729*t+.7151522*r+.072175*u)/1);return{l:116*v-16,a:500*(f-v),b:200*(v-fr((.0193339*t+.119192*r+.9503041*u)/1.08883)),alpha:e.a}}function Ki(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,u=isNaN(e.b)?t:t-e.b/200;return t=1*Mr(t),r=.95047*Mr(r),u=1.08883*Mr(u),new fa(Wn(3.2404542*r-1.5371385*t-.4985314*u),Wn(-.969266*r+1.8760108*t+.041556*u),Wn(.0556434*r-.2040259*t+1.0572252*u),e.alpha)}function Ya(e,t,r){var u=t-e;return e+r*(u>180||u<-180?u-360*Math.round(u/360):u)}var Ii={forward:vi,reverse:Ki,interpolate:function(t,r,u){return{l:Vi(t.l,r.l,u),a:Vi(t.a,r.a,u),b:Vi(t.b,r.b,u),alpha:Vi(t.alpha,r.alpha,u)}}},Go={forward:function(t){var r=vi(t),u=r.l,f=r.a,v=r.b,S=Math.atan2(v,f)*Rt;return{h:S<0?S+360:S,c:Math.sqrt(f*f+v*v),l:u,alpha:t.a}},reverse:function(t){var r=t.h*Qu,u=t.c;return Ki({l:t.l,a:Math.cos(r)*u,b:Math.sin(r)*u,alpha:t.alpha})},interpolate:function(t,r,u){return{h:Ya(t.h,r.h,u),c:Vi(t.c,r.c,u),l:Vi(t.l,r.l,u),alpha:Vi(t.alpha,r.alpha,u)}}},Cs=Object.freeze({__proto__:null,lab:Ii,hcl:Go}),pi=function(t,r,u,f,v){this.type=t,this.operator=r,this.interpolation=u,this.input=f,this.labels=[],this.outputs=[];for(var S=0,P=v;S<P.length;S+=1){var V=P[S],ee=V[1];this.labels.push(V[0]),this.outputs.push(ee)}};function Pl(e,t,r,u){var f=u-r,v=e-r;return f===0?0:t===1?v/f:(Math.pow(t,v)-1)/(Math.pow(t,f)-1)}pi.interpolationFactor=function(e,t,r,u){var f=0;if(e.name==="exponential")f=Pl(t,e.base,r,u);else if(e.name==="linear")f=Pl(t,1,r,u);else if(e.name==="cubic-bezier"){var v=e.controlPoints;f=new D(v[0],v[1],v[2],v[3]).solve(Pl(t,1,r,u))}return f},pi.parse=function(e,t){var r=e[0],u=e[1],f=e[2],v=e.slice(3);if(!Array.isArray(u)||u.length===0)return t.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){var S=u[1];if(typeof S!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:S}}else{if(u[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(u[0]),1,0);var P=u.slice(1);if(P.length!==4||P.some(function(Yt){return typeof Yt!="number"||Yt<0||Yt>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:P}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(f=t.parse(f,2,er)))return null;var V=[],ee=null;r==="interpolate-hcl"||r==="interpolate-lab"?ee=xn:t.expectedType&&t.expectedType.kind!=="value"&&(ee=t.expectedType);for(var he=0;he<v.length;he+=2){var _e=v[he],Ce=v[he+1],ut=he+3,Pt=he+4;if(typeof _e!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ut);if(V.length&&V[V.length-1][0]>=_e)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ut);var St=t.parse(Ce,Pt,ee);if(!St)return null;ee=ee||St.type,V.push([_e,St])}return ee.kind==="number"||ee.kind==="color"||ee.kind==="array"&&ee.itemType.kind==="number"&&typeof ee.N=="number"?new pi(ee,r,u,f,V):t.error("Type "+Ia(ee)+" is not interpolatable.")},pi.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var u=this.input.evaluate(e);if(u<=t[0])return r[0].evaluate(e);var f=t.length;if(u>=t[f-1])return r[f-1].evaluate(e);var v=js(t,u),S=pi.interpolationFactor(this.interpolation,u,t[v],t[v+1]),P=r[v].evaluate(e),V=r[v+1].evaluate(e);return this.operator==="interpolate"?xs[this.type.kind.toLowerCase()](P,V,S):this.operator==="interpolate-hcl"?Go.reverse(Go.interpolate(Go.forward(P),Go.forward(V),S)):Ii.reverse(Ii.interpolate(Ii.forward(P),Ii.forward(V),S))},pi.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},pi.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},pi.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t};var $s=function(t,r){this.type=t,this.args=r};$s.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var r=null,u=t.expectedType;u&&u.kind!=="value"&&(r=u);for(var f=[],v=0,S=e.slice(1);v<S.length;v+=1){var P=t.parse(S[v],1+f.length,r,void 0,{typeAnnotation:"omit"});if(!P)return null;r=r||P.type,f.push(P)}var V=u&&f.some(function(ee){return da(u,ee.type)});return new $s(V?vn:r,f)},$s.prototype.evaluate=function(e){for(var t,r=null,u=0,f=0,v=this.args;f<v.length&&(u++,(r=v[f].evaluate(e))&&r instanceof Vo&&!r.available&&(t||(t=r.name),r=null,u===this.args.length&&(r=t)),r===null);f+=1);return r},$s.prototype.eachChild=function(e){this.args.forEach(e)},$s.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},$s.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Es=function(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r};Es.prototype.evaluate=function(e){return this.result.evaluate(e)},Es.prototype.eachChild=function(e){for(var t=0,r=this.bindings;t<r.length;t+=1)e(r[t][1]);e(this.result)},Es.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var r=[],u=1;u<e.length-1;u+=2){var f=e[u];if(typeof f!="string")return t.error("Expected string, but found "+typeof f+" instead.",u);if(/[^a-zA-Z0-9_]/.test(f))return t.error("Variable names must contain only alphanumeric characters or '_'.",u);var v=t.parse(e[u+1],u+1);if(!v)return null;r.push([f,v])}var S=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return S?new Es(r,S):null},Es.prototype.outputDefined=function(){return this.result.outputDefined()},Es.prototype.serialize=function(){for(var e=["let"],t=0,r=this.bindings;t<r.length;t+=1){var u=r[t];e.push(u[0],u[1].serialize())}return e.push(this.result.serialize()),e};var gl=function(t,r,u){this.type=t,this.index=r,this.input=u};gl.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,er),u=t.parse(e[2],2,Ma(t.expectedType||vn));return r&&u?new gl(u.type.itemType,r,u):null},gl.prototype.evaluate=function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new Yi("Array index out of bounds: "+t+" < 0.");if(t>=r.length)throw new Yi("Array index out of bounds: "+t+" > "+(r.length-1)+".");if(t!==Math.floor(t))throw new Yi("Array index must be an integer, but found "+t+" instead.");return r[t]},gl.prototype.eachChild=function(e){e(this.index),e(this.input)},gl.prototype.outputDefined=function(){return!1},gl.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var cu=function(t,r){this.type=hn,this.needle=t,this.haystack=r};cu.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,vn),u=t.parse(e[2],2,vn);return r&&u?di(r.type,[hn,tn,er,ln,vn])?new cu(r,u):t.error("Expected first argument to be of type boolean, string, number or null, but found "+Ia(r.type)+" instead"):null},cu.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!ga(t,["boolean","string","number","null"]))throw new Yi("Expected first argument to be of type boolean, string, number or null, but found "+Ia(Ai(t))+" instead.");if(!ga(r,["string","array"]))throw new Yi("Expected second argument to be of type array or string, but found "+Ia(Ai(r))+" instead.");return r.indexOf(t)>=0},cu.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},cu.prototype.outputDefined=function(){return!0},cu.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var _u=function(t,r,u){this.type=er,this.needle=t,this.haystack=r,this.fromIndex=u};_u.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,vn),u=t.parse(e[2],2,vn);if(!r||!u)return null;if(!di(r.type,[hn,tn,er,ln,vn]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+Ia(r.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,er);return f?new _u(r,u,f):null}return new _u(r,u)},_u.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!ga(t,["boolean","string","number","null"]))throw new Yi("Expected first argument to be of type boolean, string, number or null, but found "+Ia(Ai(t))+" instead.");if(!ga(r,["string","array"]))throw new Yi("Expected second argument to be of type array or string, but found "+Ia(Ai(r))+" instead.");if(this.fromIndex){var u=this.fromIndex.evaluate(e);return r.indexOf(t,u)}return r.indexOf(t)},_u.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},_u.prototype.outputDefined=function(){return!1},_u.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var fu=function(t,r,u,f,v,S){this.inputType=t,this.type=r,this.input=u,this.cases=f,this.outputs=v,this.otherwise=S};fu.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var r,u;t.expectedType&&t.expectedType.kind!=="value"&&(u=t.expectedType);for(var f={},v=[],S=2;S<e.length-1;S+=2){var P=e[S],V=e[S+1];Array.isArray(P)||(P=[P]);var ee=t.concat(S);if(P.length===0)return ee.error("Expected at least one branch label.");for(var he=0,_e=P;he<_e.length;he+=1){var Ce=_e[he];if(typeof Ce!="number"&&typeof Ce!="string")return ee.error("Branch labels must be numbers or strings.");if(typeof Ce=="number"&&Math.abs(Ce)>Number.MAX_SAFE_INTEGER)return ee.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof Ce=="number"&&Math.floor(Ce)!==Ce)return ee.error("Numeric branch labels must be integer values.");if(r){if(ee.checkSubtype(r,Ai(Ce)))return null}else r=Ai(Ce);if(f[String(Ce)]!==void 0)return ee.error("Branch labels must be unique.");f[String(Ce)]=v.length}var ut=t.parse(V,S,u);if(!ut)return null;u=u||ut.type,v.push(ut)}var Pt=t.parse(e[1],1,vn);if(!Pt)return null;var St=t.parse(e[e.length-1],e.length-1,u);return St?Pt.type.kind!=="value"&&t.concat(1).checkSubtype(r,Pt.type)?null:new fu(r,u,Pt,f,v,St):null},fu.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(Ai(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},fu.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},fu.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},fu.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],r=[],u={},f=0,v=Object.keys(this.cases).sort();f<v.length;f+=1){var S=v[f];(_e=u[this.cases[S]])===void 0?(u[this.cases[S]]=r.length,r.push([this.cases[S],[S]])):r[_e][1].push(S)}for(var P=function(Pt){return e.inputType.kind==="number"?Number(Pt):Pt},V=0,ee=r;V<ee.length;V+=1){var he=ee[V],_e=he[0],Ce=he[1];t.push(Ce.length===1?P(Ce[0]):Ce.map(P)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var Uu=function(t,r,u){this.type=t,this.branches=r,this.otherwise=u};Uu.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var r;t.expectedType&&t.expectedType.kind!=="value"&&(r=t.expectedType);for(var u=[],f=1;f<e.length-1;f+=2){var v=t.parse(e[f],f,hn);if(!v)return null;var S=t.parse(e[f+1],f+1,r);if(!S)return null;u.push([v,S]),r=r||S.type}var P=t.parse(e[e.length-1],e.length-1,r);return P?new Uu(r,u,P):null},Uu.prototype.evaluate=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var u=r[t],f=u[1];if(u[0].evaluate(e))return f.evaluate(e)}return this.otherwise.evaluate(e)},Uu.prototype.eachChild=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var u=r[t],f=u[1];e(u[0]),e(f)}e(this.otherwise)},Uu.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},Uu.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Js=function(t,r,u,f){this.type=t,this.input=r,this.beginIndex=u,this.endIndex=f};function Rc(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function pf(e,t,r,u){return u.compare(t,r)===0}function ci(e,t,r){var u=e!=="=="&&e!=="!=";return function(){function f(v,S,P){this.type=hn,this.lhs=v,this.rhs=S,this.collator=P,this.hasUntypedArgument=v.type.kind==="value"||S.type.kind==="value"}return f.parse=function(v,S){if(v.length!==3&&v.length!==4)return S.error("Expected two or three arguments.");var P=v[0],V=S.parse(v[1],1,vn);if(!V)return null;if(!Rc(P,V.type))return S.concat(1).error('"'+P+`" comparisons are not supported for type '`+Ia(V.type)+"'.");var ee=S.parse(v[2],2,vn);if(!ee)return null;if(!Rc(P,ee.type))return S.concat(2).error('"'+P+`" comparisons are not supported for type '`+Ia(ee.type)+"'.");if(V.type.kind!==ee.type.kind&&V.type.kind!=="value"&&ee.type.kind!=="value")return S.error("Cannot compare types '"+Ia(V.type)+"' and '"+Ia(ee.type)+"'.");u&&(V.type.kind==="value"&&ee.type.kind!=="value"?V=new Ha(ee.type,[V]):V.type.kind!=="value"&&ee.type.kind==="value"&&(ee=new Ha(V.type,[ee])));var he=null;if(v.length===4){if(V.type.kind!=="string"&&ee.type.kind!=="string"&&V.type.kind!=="value"&&ee.type.kind!=="value")return S.error("Cannot use collator to compare non-string types.");if(!(he=S.parse(v[3],3,Pn)))return null}return new f(V,ee,he)},f.prototype.evaluate=function(v){var S=this.lhs.evaluate(v),P=this.rhs.evaluate(v);if(u&&this.hasUntypedArgument){var V=Ai(S),ee=Ai(P);if(V.kind!==ee.kind||V.kind!=="string"&&V.kind!=="number")throw new Yi('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+V.kind+", "+ee.kind+") instead.")}if(this.collator&&!u&&this.hasUntypedArgument){var he=Ai(S),_e=Ai(P);if(he.kind!=="string"||_e.kind!=="string")return t(v,S,P)}return this.collator?r(v,S,P,this.collator.evaluate(v)):t(v,S,P)},f.prototype.eachChild=function(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)},f.prototype.outputDefined=function(){return!0},f.prototype.serialize=function(){var v=[e];return this.eachChild(function(S){v.push(S.serialize())}),v},f}()}Js.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,vn),u=t.parse(e[2],2,er);if(!r||!u)return null;if(!di(r.type,[Ma(vn),tn,vn]))return t.error("Expected first argument to be of type array or string, but found "+Ia(r.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,er);return f?new Js(r.type,r,u,f):null}return new Js(r.type,r,u)},Js.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!ga(t,["string","array"]))throw new Yi("Expected first argument to be of type array or string, but found "+Ia(Ai(t))+" instead.");if(this.endIndex){var u=this.endIndex.evaluate(e);return t.slice(r,u)}return t.slice(r)},Js.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},Js.prototype.outputDefined=function(){return!1},Js.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Ic=ci("==",function(e,t,r){return t===r},pf),gc=ci("!=",function(e,t,r){return t!==r},function(e,t,r,u){return!pf(0,t,r,u)}),Qc=ci("<",function(e,t,r){return t<r},function(e,t,r,u){return u.compare(t,r)<0}),yl=ci(">",function(e,t,r){return t>r},function(e,t,r,u){return u.compare(t,r)>0}),qc=ci("<=",function(e,t,r){return t<=r},function(e,t,r,u){return u.compare(t,r)<=0}),$i=ci(">=",function(e,t,r){return t>=r},function(e,t,r,u){return u.compare(t,r)>=0}),Su=function(t,r,u,f,v){this.type=tn,this.number=t,this.locale=r,this.currency=u,this.minFractionDigits=f,this.maxFractionDigits=v};Su.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var r=t.parse(e[1],1,er);if(!r)return null;var u=e[2];if(typeof u!="object"||Array.isArray(u))return t.error("NumberFormat options argument must be an object.");var f=null;if(u.locale&&!(f=t.parse(u.locale,1,tn)))return null;var v=null;if(u.currency&&!(v=t.parse(u.currency,1,tn)))return null;var S=null;if(u["min-fraction-digits"]&&!(S=t.parse(u["min-fraction-digits"],1,er)))return null;var P=null;return u["max-fraction-digits"]&&!(P=t.parse(u["max-fraction-digits"],1,er))?null:new Su(r,f,v,S,P)},Su.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},Su.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},Su.prototype.outputDefined=function(){return!1},Su.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var bl=function(t){this.type=er,this.input=t};bl.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1);return r?r.type.kind!=="array"&&r.type.kind!=="string"&&r.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+Ia(r.type)+" instead."):new bl(r):null},bl.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string")return t.length;if(Array.isArray(t))return t.length;throw new Yi("Expected value to be of type string or array, but found "+Ia(Ai(t))+" instead.")},bl.prototype.eachChild=function(e){e(this.input)},bl.prototype.outputDefined=function(){return!1},bl.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var as={"==":Ic,"!=":gc,">":yl,"<":Qc,">=":$i,"<=":qc,array:Ha,at:gl,boolean:Ha,case:Uu,coalesce:$s,collator:Vt,format:oo,image:so,in:cu,"index-of":_u,interpolate:pi,"interpolate-hcl":pi,"interpolate-lab":pi,length:bl,let:Es,literal:oi,match:fu,number:Ha,"number-format":Su,object:Ha,slice:Js,step:Ri,string:Ha,"to-boolean":$o,"to-color":$o,"to-number":$o,"to-string":$o,var:Ys,within:Mo};function Dc(e,t){var r=t[0],u=t[1],f=t[2],v=t[3];r=r.evaluate(e),u=u.evaluate(e),f=f.evaluate(e);var S=v?v.evaluate(e):1,P=ju(r,u,f,S);if(P)throw new Yi(P);return new fa(r/255*S,u/255*S,f/255*S,S)}function yc(e,t){return e in t}function Ll(e,t){var r=t[e];return r===void 0?null:r}function qu(e){return{type:e}}function Nc(e){return{result:"success",value:e}}function hu(e){return{result:"error",value:e}}function Au(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function ef(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function $l(e){return!!e.expression&&e.expression.interpolated}function Ti(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function tf(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function mf(e){return e}function Jl(e,t,r){return e!==void 0?e:t!==void 0?t:r!==void 0?r:void 0}function kc(e,t,r,u,f){return Jl(typeof r===f?u[r]:void 0,e.default,t.default)}function Ql(e,t,r){if(Ti(r)!=="number")return Jl(e.default,t.default);var u=e.stops.length;if(u===1)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[u-1][0])return e.stops[u-1][1];var f=js(e.stops.map(function(v){return v[0]}),r);return e.stops[f][1]}function el(e,t,r){var u=e.base!==void 0?e.base:1;if(Ti(r)!=="number")return Jl(e.default,t.default);var f=e.stops.length;if(f===1)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[f-1][0])return e.stops[f-1][1];var v=js(e.stops.map(function(_e){return _e[0]}),r),S=function(_e,Ce,ut,Pt){var St=Pt-ut,Yt=_e-ut;return St===0?0:Ce===1?Yt/St:(Math.pow(Ce,Yt)-1)/(Math.pow(Ce,St)-1)}(r,u,e.stops[v][0],e.stops[v+1][0]),P=e.stops[v][1],V=e.stops[v+1][1],ee=xs[t.type]||mf;if(e.colorSpace&&e.colorSpace!=="rgb"){var he=Cs[e.colorSpace];ee=function(Ce,ut){return he.reverse(he.interpolate(he.forward(Ce),he.forward(ut),S))}}return typeof P.evaluate=="function"?{evaluate:function(){for(var Ce=[],ut=arguments.length;ut--;)Ce[ut]=arguments[ut];var Pt=P.evaluate.apply(void 0,Ce),St=V.evaluate.apply(void 0,Ce);if(Pt!==void 0&&St!==void 0)return ee(Pt,St,S)}}:ee(P,V,S)}function Bu(e,t,r){return t.type==="color"?r=fa.parse(r):t.type==="formatted"?r=Xi.fromString(r.toString()):t.type==="resolvedImage"?r=Vo.fromString(r.toString()):Ti(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0),Jl(r,e.default,t.default)}ho.register(as,{error:[{kind:"error"},[tn],function(e,t){throw new Yi(t[0].evaluate(e))}],typeof:[tn,[vn],function(e,t){return Ia(Ai(t[0].evaluate(e)))}],"to-rgba":[Ma(er,4),[xn],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[xn,[er,er,er],Dc],rgba:[xn,[er,er,er,er],Dc],has:{type:hn,overloads:[[[tn],function(e,t){return yc(t[0].evaluate(e),e.properties())}],[[tn,yn],function(e,t){var r=t[1];return yc(t[0].evaluate(e),r.evaluate(e))}]]},get:{type:vn,overloads:[[[tn],function(e,t){return Ll(t[0].evaluate(e),e.properties())}],[[tn,yn],function(e,t){var r=t[1];return Ll(t[0].evaluate(e),r.evaluate(e))}]]},"feature-state":[vn,[tn],function(e,t){return Ll(t[0].evaluate(e),e.featureState||{})}],properties:[yn,[],function(e){return e.properties()}],"geometry-type":[tn,[],function(e){return e.geometryType()}],id:[vn,[],function(e){return e.id()}],zoom:[er,[],function(e){return e.globals.zoom}],"heatmap-density":[er,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[er,[],function(e){return e.globals.lineProgress||0}],accumulated:[vn,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[er,qu(er),function(e,t){for(var r=0,u=0,f=t;u<f.length;u+=1)r+=f[u].evaluate(e);return r}],"*":[er,qu(er),function(e,t){for(var r=1,u=0,f=t;u<f.length;u+=1)r*=f[u].evaluate(e);return r}],"-":{type:er,overloads:[[[er,er],function(e,t){var r=t[1];return t[0].evaluate(e)-r.evaluate(e)}],[[er],function(e,t){return-t[0].evaluate(e)}]]},"/":[er,[er,er],function(e,t){var r=t[1];return t[0].evaluate(e)/r.evaluate(e)}],"%":[er,[er,er],function(e,t){var r=t[1];return t[0].evaluate(e)%r.evaluate(e)}],ln2:[er,[],function(){return Math.LN2}],pi:[er,[],function(){return Math.PI}],e:[er,[],function(){return Math.E}],"^":[er,[er,er],function(e,t){var r=t[1];return Math.pow(t[0].evaluate(e),r.evaluate(e))}],sqrt:[er,[er],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[er,[er],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[er,[er],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[er,[er],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[er,[er],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[er,[er],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[er,[er],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[er,[er],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[er,[er],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[er,[er],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[er,qu(er),function(e,t){return Math.min.apply(Math,t.map(function(r){return r.evaluate(e)}))}],max:[er,qu(er),function(e,t){return Math.max.apply(Math,t.map(function(r){return r.evaluate(e)}))}],abs:[er,[er],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[er,[er],function(e,t){var r=t[0].evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[er,[er],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[er,[er],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[hn,[tn,vn],function(e,t){var r=t[0],u=t[1];return e.properties()[r.value]===u.value}],"filter-id-==":[hn,[vn],function(e,t){var r=t[0];return e.id()===r.value}],"filter-type-==":[hn,[tn],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[hn,[tn,vn],function(e,t){var r=t[0],u=t[1],f=e.properties()[r.value],v=u.value;return typeof f==typeof v&&f<v}],"filter-id-<":[hn,[vn],function(e,t){var r=t[0],u=e.id(),f=r.value;return typeof u==typeof f&&u<f}],"filter->":[hn,[tn,vn],function(e,t){var r=t[0],u=t[1],f=e.properties()[r.value],v=u.value;return typeof f==typeof v&&f>v}],"filter-id->":[hn,[vn],function(e,t){var r=t[0],u=e.id(),f=r.value;return typeof u==typeof f&&u>f}],"filter-<=":[hn,[tn,vn],function(e,t){var r=t[0],u=t[1],f=e.properties()[r.value],v=u.value;return typeof f==typeof v&&f<=v}],"filter-id-<=":[hn,[vn],function(e,t){var r=t[0],u=e.id(),f=r.value;return typeof u==typeof f&&u<=f}],"filter->=":[hn,[tn,vn],function(e,t){var r=t[0],u=t[1],f=e.properties()[r.value],v=u.value;return typeof f==typeof v&&f>=v}],"filter-id->=":[hn,[vn],function(e,t){var r=t[0],u=e.id(),f=r.value;return typeof u==typeof f&&u>=f}],"filter-has":[hn,[vn],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[hn,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[hn,[Ma(tn)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[hn,[Ma(vn)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[hn,[tn,Ma(vn)],function(e,t){var r=t[0];return t[1].value.indexOf(e.properties()[r.value])>=0}],"filter-in-large":[hn,[tn,Ma(vn)],function(e,t){var r=t[0],u=t[1];return function(f,v,S,P){for(;S<=P;){var V=S+P>>1;if(v[V]===f)return!0;v[V]>f?P=V-1:S=V+1}return!1}(e.properties()[r.value],u.value,0,u.value.length-1)}],all:{type:hn,overloads:[[[hn,hn],function(e,t){var r=t[1];return t[0].evaluate(e)&&r.evaluate(e)}],[qu(hn),function(e,t){for(var r=0,u=t;r<u.length;r+=1)if(!u[r].evaluate(e))return!1;return!0}]]},any:{type:hn,overloads:[[[hn,hn],function(e,t){var r=t[1];return t[0].evaluate(e)||r.evaluate(e)}],[qu(hn),function(e,t){for(var r=0,u=t;r<u.length;r+=1)if(u[r].evaluate(e))return!0;return!1}]]},"!":[hn,[hn],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[hn,[tn],function(e,t){var r=e.globals&&e.globals.isSupportedScript;return!r||r(t[0].evaluate(e))}],upcase:[tn,[tn],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[tn,[tn],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[tn,qu(vn),function(e,t){return t.map(function(r){return Ko(r.evaluate(e))}).join("")}],"resolved-locale":[tn,[Pn],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var xl=function(t,r){this.expression=t,this._warningHistory={},this._evaluator=new ks,this._defaultValue=r?function(u){return u.type==="color"&&tf(u.default)?new fa(0,0,0,0):u.type==="color"?fa.parse(u.default)||null:u.default===void 0?null:u.default}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null};function Po(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in as}function ql(e,t){var r=new Ks(as,[],t?function(f){var v={color:xn,string:tn,number:er,enum:tn,boolean:hn,formatted:Va,resolvedImage:va};return f.type==="array"?Ma(v[f.value]||vn,f.length):v[f.type]}(t):void 0),u=r.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?Nc(new xl(u,t)):hu(r.errors)}xl.prototype.evaluateWithoutErrorHandling=function(e,t,r,u,f,v){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=u,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=v,this.expression.evaluate(this._evaluator)},xl.prototype.evaluate=function(e,t,r,u,f,v){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=u,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=v||null;try{var S=this.expression.evaluate(this._evaluator);if(S==null||typeof S=="number"&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new Yi("Expected value to be one of "+Object.keys(this._enumValues).map(function(P){return JSON.stringify(P)}).join(", ")+", but found "+JSON.stringify(S)+" instead.");return S}catch(P){return this._warningHistory[P.message]||(this._warningHistory[P.message]=!0,typeof console!="undefined"&&console.warn(P.message)),this._defaultValue}};var Rl=function(t,r){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!Eo(r.expression)};Rl.prototype.evaluateWithoutErrorHandling=function(e,t,r,u,f,v){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,u,f,v)},Rl.prototype.evaluate=function(e,t,r,u,f,v){return this._styleExpression.evaluate(e,t,r,u,f,v)};var Il=function(t,r,u,f){this.kind=t,this.zoomStops=u,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!Eo(r.expression),this.interpolationType=f};function jc(e,t){if((e=ql(e,t)).result==="error")return e;var r=e.value.expression,u=zu(r);if(!u&&!Au(t))return hu([new Ur("","data expressions not supported")]);var f=Fi(r,["zoom"]);if(!f&&!ef(t))return hu([new Ur("","zoom expressions not supported")]);var v=function S(P){var V=null;if(P instanceof Es)V=S(P.result);else if(P instanceof $s)for(var ee=0,he=P.args;ee<he.length&&!(V=S(he[ee]));ee+=1);else(P instanceof Ri||P instanceof pi)&&P.input instanceof ho&&P.input.name==="zoom"&&(V=P);return V instanceof Ur||P.eachChild(function(_e){var Ce=S(_e);Ce instanceof Ur?V=Ce:!V&&Ce?V=new Ur("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):V&&Ce&&V!==Ce&&(V=new Ur("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),V}(r);return v||f?v instanceof Ur?hu([v]):v instanceof pi&&!$l(t)?hu([new Ur("",'"interpolate" expressions cannot be used with this property')]):Nc(v?new Il(u?"camera":"composite",e.value,v.labels,v instanceof pi?v.interpolation:void 0):new Rl(u?"constant":"source",e.value)):hu([new Ur("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Il.prototype.evaluateWithoutErrorHandling=function(e,t,r,u,f,v){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,u,f,v)},Il.prototype.evaluate=function(e,t,r,u,f,v){return this._styleExpression.evaluate(e,t,r,u,f,v)},Il.prototype.interpolationFactor=function(e,t,r){return this.interpolationType?pi.interpolationFactor(this.interpolationType,e,t,r):0};var El=function(t,r){this._parameters=t,this._specification=r,zr(this,function u(f,v){var S,P,V,ee=v.type==="color",he=f.stops&&typeof f.stops[0][0]=="object",_e=he||!(he||f.property!==void 0),Ce=f.type||($l(v)?"exponential":"interval");if(ee&&((f=zr({},f)).stops&&(f.stops=f.stops.map(function(Xn){return[Xn[0],fa.parse(Xn[1])]})),f.default=fa.parse(f.default?f.default:v.default)),f.colorSpace&&f.colorSpace!=="rgb"&&!Cs[f.colorSpace])throw new Error("Unknown color space: "+f.colorSpace);if(Ce==="exponential")S=el;else if(Ce==="interval")S=Ql;else if(Ce==="categorical"){S=kc,P=Object.create(null);for(var ut=0,Pt=f.stops;ut<Pt.length;ut+=1){var St=Pt[ut];P[St[0]]=St[1]}V=typeof f.stops[0][0]}else{if(Ce!=="identity")throw new Error('Unknown function type "'+Ce+'"');S=Bu}if(he){for(var Yt={},Wt=[],ir=0;ir<f.stops.length;ir++){var yr=f.stops[ir],_r=yr[0].zoom;Yt[_r]===void 0&&(Yt[_r]={zoom:_r,type:f.type,property:f.property,default:f.default,stops:[]},Wt.push(_r)),Yt[_r].stops.push([yr[0].value,yr[1]])}for(var kr=[],Dr=0,pn=Wt;Dr<pn.length;Dr+=1){var fn=pn[Dr];kr.push([Yt[fn].zoom,u(Yt[fn],v)])}var Rn={name:"linear"};return{kind:"composite",interpolationType:Rn,interpolationFactor:pi.interpolationFactor.bind(void 0,Rn),zoomStops:kr.map(function(Xn){return Xn[0]}),evaluate:function(Nn,Ea){var ca=Nn.zoom;return el({stops:kr,base:f.base},v,ca).evaluate(ca,Ea)}}}if(_e){var Qn=Ce==="exponential"?{name:"exponential",base:f.base!==void 0?f.base:1}:null;return{kind:"camera",interpolationType:Qn,interpolationFactor:pi.interpolationFactor.bind(void 0,Qn),zoomStops:f.stops.map(function(Xn){return Xn[0]}),evaluate:function(Nn){return S(f,v,Nn.zoom,P,V)}}}return{kind:"source",evaluate:function(Nn,Ea){var ca=Ea&&Ea.properties?Ea.properties[f.property]:void 0;return ca===void 0?Jl(f.default,v.default):S(f,v,ca,P,V)}}}(this._parameters,this._specification))};function Qs(e){var t=e.key,r=e.value,u=e.valueSpec||{},f=e.objectElementValidators||{},v=e.style,S=e.styleSpec,P=[],V=Ti(r);if(V!=="object")return[new Lt(t,r,"object expected, "+V+" found")];for(var ee in r){var he=ee.split(".")[0],_e=u[he]||u["*"],Ce=void 0;if(f[he])Ce=f[he];else if(u[he])Ce=kn;else if(f["*"])Ce=f["*"];else{if(!u["*"]){P.push(new Lt(t,r[ee],'unknown property "'+ee+'"'));continue}Ce=kn}P=P.concat(Ce({key:(t&&t+".")+ee,value:r[ee],valueSpec:_e,style:v,styleSpec:S,object:r,objectKey:ee},r))}for(var ut in u)f[ut]||u[ut].required&&u[ut].default===void 0&&r[ut]===void 0&&P.push(new Lt(t,r,'missing required property "'+ut+'"'));return P}function eo(e){var t=e.value,r=e.valueSpec,u=e.style,f=e.styleSpec,v=e.key,S=e.arrayElementValidator||kn;if(Ti(t)!=="array")return[new Lt(v,t,"array expected, "+Ti(t)+" found")];if(r.length&&t.length!==r.length)return[new Lt(v,t,"array length "+r.length+" expected, length "+t.length+" found")];if(r["min-length"]&&t.length<r["min-length"])return[new Lt(v,t,"array length at least "+r["min-length"]+" expected, length "+t.length+" found")];var P={type:r.value,values:r.values};f.$version<7&&(P.function=r.function),Ti(r.value)==="object"&&(P=r.value);for(var V=[],ee=0;ee<t.length;ee++)V=V.concat(S({array:t,arrayIndex:ee,value:t[ee],valueSpec:P,style:u,styleSpec:f,key:v+"["+ee+"]"}));return V}function vf(e){var t=e.key,r=e.value,u=e.valueSpec,f=Ti(r);return f==="number"&&r!=r&&(f="NaN"),f!=="number"?[new Lt(t,r,"number expected, "+f+" found")]:"minimum"in u&&r<u.minimum?[new Lt(t,r,r+" is less than the minimum value "+u.minimum)]:"maximum"in u&&r>u.maximum?[new Lt(t,r,r+" is greater than the maximum value "+u.maximum)]:[]}function gf(e){var t,r,u,f=e.valueSpec,v=Vr(e.value.type),S={},P=v!=="categorical"&&e.value.property===void 0,V=!P,ee=Ti(e.value.stops)==="array"&&Ti(e.value.stops[0])==="array"&&Ti(e.value.stops[0][0])==="object",he=Qs({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(Pt){if(v==="identity")return[new Lt(Pt.key,Pt.value,'identity function may not have a "stops" property')];var St=[],Yt=Pt.value;return St=St.concat(eo({key:Pt.key,value:Yt,valueSpec:Pt.valueSpec,style:Pt.style,styleSpec:Pt.styleSpec,arrayElementValidator:_e})),Ti(Yt)==="array"&&Yt.length===0&&St.push(new Lt(Pt.key,Yt,"array must have at least one stop")),St},default:function(Pt){return kn({key:Pt.key,value:Pt.value,valueSpec:f,style:Pt.style,styleSpec:Pt.styleSpec})}}});return v==="identity"&&P&&he.push(new Lt(e.key,e.value,'missing required property "property"')),v==="identity"||e.value.stops||he.push(new Lt(e.key,e.value,'missing required property "stops"')),v==="exponential"&&e.valueSpec.expression&&!$l(e.valueSpec)&&he.push(new Lt(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(V&&!Au(e.valueSpec)?he.push(new Lt(e.key,e.value,"property functions not supported")):P&&!ef(e.valueSpec)&&he.push(new Lt(e.key,e.value,"zoom functions not supported"))),v!=="categorical"&&!ee||e.value.property!==void 0||he.push(new Lt(e.key,e.value,'"property" property is required')),he;function _e(ut){var Pt=[],St=ut.value,Yt=ut.key;if(Ti(St)!=="array")return[new Lt(Yt,St,"array expected, "+Ti(St)+" found")];if(St.length!==2)return[new Lt(Yt,St,"array length 2 expected, length "+St.length+" found")];if(ee){if(Ti(St[0])!=="object")return[new Lt(Yt,St,"object expected, "+Ti(St[0])+" found")];if(St[0].zoom===void 0)return[new Lt(Yt,St,"object stop key must have zoom")];if(St[0].value===void 0)return[new Lt(Yt,St,"object stop key must have value")];if(u&&u>Vr(St[0].zoom))return[new Lt(Yt,St[0].zoom,"stop zoom values must appear in ascending order")];Vr(St[0].zoom)!==u&&(u=Vr(St[0].zoom),r=void 0,S={}),Pt=Pt.concat(Qs({key:Yt+"[0]",value:St[0],valueSpec:{zoom:{}},style:ut.style,styleSpec:ut.styleSpec,objectElementValidators:{zoom:vf,value:Ce}}))}else Pt=Pt.concat(Ce({key:Yt+"[0]",value:St[0],valueSpec:{},style:ut.style,styleSpec:ut.styleSpec},St));return Po(cr(St[1]))?Pt.concat([new Lt(Yt+"[1]",St[1],"expressions are not allowed in function stops.")]):Pt.concat(kn({key:Yt+"[1]",value:St[1],valueSpec:f,style:ut.style,styleSpec:ut.styleSpec}))}function Ce(ut,Pt){var St=Ti(ut.value),Yt=Vr(ut.value),Wt=ut.value!==null?ut.value:Pt;if(t){if(St!==t)return[new Lt(ut.key,Wt,St+" stop domain type must match previous stop domain type "+t)]}else t=St;if(St!=="number"&&St!=="string"&&St!=="boolean")return[new Lt(ut.key,Wt,"stop domain value must be a number, string, or boolean")];if(St!=="number"&&v!=="categorical"){var ir="number expected, "+St+" found";return Au(f)&&v===void 0&&(ir+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Lt(ut.key,Wt,ir)]}return v!=="categorical"||St!=="number"||isFinite(Yt)&&Math.floor(Yt)===Yt?v!=="categorical"&&St==="number"&&r!==void 0&&Yt<r?[new Lt(ut.key,Wt,"stop domain values must appear in ascending order")]:(r=Yt,v==="categorical"&&Yt in S?[new Lt(ut.key,Wt,"stop domain values must be unique")]:(S[Yt]=!0,[])):[new Lt(ut.key,Wt,"integer expected, found "+Yt)]}}function Tl(e){var t=(e.expressionContext==="property"?jc:ql)(cr(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(u){return new Lt(""+e.key+u.key,e.value,u.message)});var r=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!r.outputDefined())return[new Lt(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!Eo(r))return[new Lt(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!Eo(r))return[new Lt(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!Fi(r,["zoom","feature-state"]))return[new Lt(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!zu(r))return[new Lt(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ec(e){var t=e.key,r=e.value,u=e.valueSpec,f=[];return Array.isArray(u.values)?u.values.indexOf(Vr(r))===-1&&f.push(new Lt(t,r,"expected one of ["+u.values.join(", ")+"], "+JSON.stringify(r)+" found")):Object.keys(u.values).indexOf(Vr(r))===-1&&f.push(new Lt(t,r,"expected one of ["+Object.keys(u.values).join(", ")+"], "+JSON.stringify(r)+" found")),f}function tl(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var u=r[t];if(!tl(u)&&typeof u!="boolean")return!1}return!0;default:return!0}}El.deserialize=function(e){return new El(e._parameters,e._specification)},El.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Dl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function bc(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};tl(e)||(e=rl(e));var t=ql(e,Dl);if(t.result==="error")throw new Error(t.value.map(function(r){return r.key+": "+r.message}).join(", "));return{filter:function(u,f,v){return t.value.evaluate(u,f,{},v)},needGeometry:function r(u){if(!Array.isArray(u))return!1;if(u[0]==="within")return!0;for(var f=1;f<u.length;f++)if(r(u[f]))return!0;return!1}(e)}}function xc(e,t){return e<t?-1:e>t?1:0}function rl(e){if(!e)return!0;var t,r=e[0];return e.length<=1?r!=="any":r==="=="?rf(e[1],e[2],"=="):r==="!="?_l(rf(e[1],e[2],"==")):r==="<"||r===">"||r==="<="||r===">="?rf(e[1],e[2],r):r==="any"?(t=e.slice(1),["any"].concat(t.map(rl))):r==="all"?["all"].concat(e.slice(1).map(rl)):r==="none"?["all"].concat(e.slice(1).map(rl).map(_l)):r==="in"?nl(e[1],e.slice(2)):r==="!in"?_l(nl(e[1],e.slice(2))):r==="has"?qs(e[1]):r==="!has"?_l(qs(e[1])):r!=="within"||e}function rf(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function nl(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(r){return typeof r!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(xc)]]:["filter-in-small",e,["literal",t]]}}function qs(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function _l(e){return["!",e]}function tc(e){return tl(cr(e.value))?Tl(zr({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(r){var u=r.value,f=r.key;if(Ti(u)!=="array")return[new Lt(f,u,"array expected, "+Ti(u)+" found")];var v,S=r.styleSpec,P=[];if(u.length<1)return[new Lt(f,u,"filter array must have at least 1 element")];switch(P=P.concat(ec({key:f+"[0]",value:u[0],valueSpec:S.filter_operator,style:r.style,styleSpec:r.styleSpec})),Vr(u[0])){case"<":case"<=":case">":case">=":u.length>=2&&Vr(u[1])==="$type"&&P.push(new Lt(f,u,'"$type" cannot be use with operator "'+u[0]+'"'));case"==":case"!=":u.length!==3&&P.push(new Lt(f,u,'filter array for operator "'+u[0]+'" must have 3 elements'));case"in":case"!in":u.length>=2&&(v=Ti(u[1]))!=="string"&&P.push(new Lt(f+"[1]",u[1],"string expected, "+v+" found"));for(var V=2;V<u.length;V++)v=Ti(u[V]),Vr(u[1])==="$type"?P=P.concat(ec({key:f+"["+V+"]",value:u[V],valueSpec:S.geometry_type,style:r.style,styleSpec:r.styleSpec})):v!=="string"&&v!=="number"&&v!=="boolean"&&P.push(new Lt(f+"["+V+"]",u[V],"string, number, or boolean expected, "+v+" found"));break;case"any":case"all":case"none":for(var ee=1;ee<u.length;ee++)P=P.concat(t({key:f+"["+ee+"]",value:u[ee],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":v=Ti(u[1]),u.length!==2?P.push(new Lt(f,u,'filter array for "'+u[0]+'" operator must have 2 elements')):v!=="string"&&P.push(new Lt(f+"[1]",u[1],"string expected, "+v+" found"));break;case"within":v=Ti(u[1]),u.length!==2?P.push(new Lt(f,u,'filter array for "'+u[0]+'" operator must have 2 elements')):v!=="object"&&P.push(new Lt(f+"[1]",u[1],"object expected, "+v+" found"))}return P}(e)}function Fc(e,t){var r=e.key,u=e.style,f=e.styleSpec,v=e.value,S=e.objectKey,P=f[t+"_"+e.layerType];if(!P)return[];var V=S.match(/^(.*)-transition$/);if(t==="paint"&&V&&P[V[1]]&&P[V[1]].transition)return kn({key:r,value:v,valueSpec:f.transition,style:u,styleSpec:f});var ee,he=e.valueSpec||P[S];if(!he)return[new Lt(r,v,'unknown property "'+S+'"')];if(Ti(v)==="string"&&Au(he)&&!he.tokens&&(ee=/^{([^}]+)}$/.exec(v)))return[new Lt(r,v,'"'+S+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(ee[1])+" }`.")];var _e=[];return e.layerType==="symbol"&&(S==="text-field"&&u&&!u.glyphs&&_e.push(new Lt(r,v,'use of "text-field" requires a style "glyphs" property')),S==="text-font"&&tf(cr(v))&&Vr(v.type)==="identity"&&_e.push(new Lt(r,v,'"text-font" does not support identity functions'))),_e.concat(kn({key:e.key,value:v,valueSpec:he,style:u,styleSpec:f,expressionContext:"property",propertyType:t,propertyKey:S}))}function nf(e){return Fc(e,"paint")}function Fs(e){return Fc(e,"layout")}function yf(e){var t=[],r=e.value,u=e.key,f=e.style,v=e.styleSpec;r.type||r.ref||t.push(new Lt(u,r,'either "type" or "ref" is required'));var S,P=Vr(r.type),V=Vr(r.ref);if(r.id)for(var ee=Vr(r.id),he=0;he<e.arrayIndex;he++){var _e=f.layers[he];Vr(_e.id)===ee&&t.push(new Lt(u,r.id,'duplicate layer id "'+r.id+'", previously used at line '+_e.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(Pt){Pt in r&&t.push(new Lt(u,r[Pt],'"'+Pt+'" is prohibited for ref layers'))}),f.layers.forEach(function(Pt){Vr(Pt.id)===V&&(S=Pt)}),S?S.ref?t.push(new Lt(u,r.ref,"ref cannot reference another ref layer")):P=Vr(S.type):t.push(new Lt(u,r.ref,'ref layer "'+V+'" not found'));else if(P!=="background")if(r.source){var Ce=f.sources&&f.sources[r.source],ut=Ce&&Vr(Ce.type);Ce?ut==="vector"&&P==="raster"?t.push(new Lt(u,r.source,'layer "'+r.id+'" requires a raster source')):ut==="raster"&&P!=="raster"?t.push(new Lt(u,r.source,'layer "'+r.id+'" requires a vector source')):ut!=="vector"||r["source-layer"]?ut==="raster-dem"&&P!=="hillshade"?t.push(new Lt(u,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):P!=="line"||!r.paint||!r.paint["line-gradient"]||ut==="geojson"&&Ce.lineMetrics||t.push(new Lt(u,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new Lt(u,r,'layer "'+r.id+'" must specify a "source-layer"')):t.push(new Lt(u,r.source,'source "'+r.source+'" not found'))}else t.push(new Lt(u,r,'missing required property "source"'));return t=t.concat(Qs({key:u,value:r,valueSpec:v.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return kn({key:u+".type",value:r.type,valueSpec:v.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:tc,layout:function(St){return Qs({layer:r,key:St.key,value:St.value,style:St.style,styleSpec:St.styleSpec,objectElementValidators:{"*":function(Wt){return Fs(zr({layerType:P},Wt))}}})},paint:function(St){return Qs({layer:r,key:St.key,value:St.value,style:St.style,styleSpec:St.styleSpec,objectElementValidators:{"*":function(Wt){return nf(zr({layerType:P},Wt))}}})}}}))}function al(e){var t=e.value,r=e.key,u=Ti(t);return u!=="string"?[new Lt(r,t,"string expected, "+u+" found")]:[]}var wi={promoteId:function(t){var r=t.key,u=t.value;if(Ti(u)==="string")return al({key:r,value:u});var f=[];for(var v in u)f.push.apply(f,al({key:r+"."+v,value:u[v]}));return f}};function il(e){var t=e.value,r=e.key,u=e.styleSpec,f=e.style;if(!t.type)return[new Lt(r,t,'"type" is required')];var v,S=Vr(t.type);switch(S){case"vector":case"raster":case"raster-dem":return Qs({key:r,value:t,valueSpec:u["source_"+S.replace("-","_")],style:e.style,styleSpec:u,objectElementValidators:wi});case"geojson":if(v=Qs({key:r,value:t,valueSpec:u.source_geojson,style:f,styleSpec:u,objectElementValidators:wi}),t.cluster)for(var P in t.clusterProperties){var V=t.clusterProperties[P],ee=V[0],he=typeof ee=="string"?[ee,["accumulated"],["get",P]]:ee;v.push.apply(v,Tl({key:r+"."+P+".map",value:V[1],expressionContext:"cluster-map"})),v.push.apply(v,Tl({key:r+"."+P+".reduce",value:he,expressionContext:"cluster-reduce"}))}return v;case"video":return Qs({key:r,value:t,valueSpec:u.source_video,style:f,styleSpec:u});case"image":return Qs({key:r,value:t,valueSpec:u.source_image,style:f,styleSpec:u});case"canvas":return[new Lt(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ec({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,styleSpec:u})}}function Vu(e){var t=e.value,r=e.styleSpec,u=r.light,f=e.style,v=[],S=Ti(t);if(t===void 0)return v;if(S!=="object")return v.concat([new Lt("light",t,"object expected, "+S+" found")]);for(var P in t){var V=P.match(/^(.*)-transition$/);v=v.concat(V&&u[V[1]]&&u[V[1]].transition?kn({key:P,value:t[P],valueSpec:r.transition,style:f,styleSpec:r}):u[P]?kn({key:P,value:t[P],valueSpec:u[P],style:f,styleSpec:r}):[new Lt(P,t[P],'unknown property "'+P+'"')])}return v}var ui={"*":function(){return[]},array:eo,boolean:function(t){var r=t.value,u=t.key,f=Ti(r);return f!=="boolean"?[new Lt(u,r,"boolean expected, "+f+" found")]:[]},number:vf,color:function(t){var r=t.key,u=t.value,f=Ti(u);return f!=="string"?[new Lt(r,u,"color expected, "+f+" found")]:ya(u)===null?[new Lt(r,u,'color expected, "'+u+'" found')]:[]},constants:lr,enum:ec,filter:tc,function:gf,layer:yf,object:Qs,source:il,light:Vu,string:al,formatted:function(t){return al(t).length===0?[]:Tl(t)},resolvedImage:function(t){return al(t).length===0?[]:Tl(t)}};function kn(e){var t=e.value,r=e.valueSpec,u=e.styleSpec;return r.expression&&tf(Vr(t))?gf(e):r.expression&&Po(cr(t))?Tl(e):r.type&&ui[r.type]?ui[r.type](e):Qs(zr({},e,{valueSpec:r.type?u[r.type]:r}))}function Oi(e){var t=e.value,r=e.key,u=al(e);return u.length||(t.indexOf("{fontstack}")===-1&&u.push(new Lt(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&u.push(new Lt(r,t,'"glyphs" url must include a "{range}" token'))),u}function ws(e,t){t===void 0&&(t=Xe);var r=[];return r=r.concat(kn({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Oi,"*":function(){return[]}}})),e.constants&&(r=r.concat(lr({key:"constants",value:e.constants,style:e,styleSpec:t}))),Nl(r)}function Nl(e){return[].concat(e).sort(function(t,r){return t.line-r.line})}function Gu(e){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return Nl(e.apply(this,t))}}ws.source=Gu(il),ws.light=Gu(Vu),ws.layer=Gu(yf),ws.filter=Gu(tc),ws.paintProperty=Gu(nf),ws.layoutProperty=Gu(Fs);var ol=ws,bf=ol.light,is=ol.paintProperty,Sl=ol.layoutProperty;function sl(e,t){var r=!1;if(t&&t.length)for(var u=0,f=t;u<f.length;u+=1)e.fire(new Ct(new Error(f[u].message))),r=!0;return r}var ul=zi;function zi(e,t,r){var u=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var f=new Int32Array(this.arrayBuffer);e=f[0],this.d=(t=f[1])+2*(r=f[2]);for(var v=0;v<this.d*this.d;v++){var S=f[3+v],P=f[3+v+1];u.push(S===P?null:f.subarray(S,P))}var V=f[3+u.length+1];this.keys=f.subarray(f[3+u.length],V),this.bboxes=f.subarray(V),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var ee=0;ee<this.d*this.d;ee++)u.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var he=r/t*e;this.min=-he,this.max=e+he}zi.prototype.insert=function(e,t,r,u,f){this._forEachCell(t,r,u,f,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(u),this.bboxes.push(f)},zi.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},zi.prototype._insertCell=function(e,t,r,u,f,v){this.cells[f].push(v)},zi.prototype.query=function(e,t,r,u,f){var v=this.min,S=this.max;if(e<=v&&t<=v&&S<=r&&S<=u&&!f)return Array.prototype.slice.call(this.keys);var P=[];return this._forEachCell(e,t,r,u,this._queryCell,P,{},f),P},zi.prototype._queryCell=function(e,t,r,u,f,v,S,P){var V=this.cells[f];if(V!==null)for(var ee=this.keys,he=this.bboxes,_e=0;_e<V.length;_e++){var Ce=V[_e];if(S[Ce]===void 0){var ut=4*Ce;(P?P(he[ut+0],he[ut+1],he[ut+2],he[ut+3]):e<=he[ut+2]&&t<=he[ut+3]&&r>=he[ut+0]&&u>=he[ut+1])?(S[Ce]=!0,v.push(ee[Ce])):S[Ce]=!1}}},zi.prototype._forEachCell=function(e,t,r,u,f,v,S,P){for(var V=this._convertToCellCoord(e),ee=this._convertToCellCoord(t),he=this._convertToCellCoord(r),_e=this._convertToCellCoord(u),Ce=V;Ce<=he;Ce++)for(var ut=ee;ut<=_e;ut++){var Pt=this.d*ut+Ce;if((!P||P(this._convertFromCellCoord(Ce),this._convertFromCellCoord(ut),this._convertFromCellCoord(Ce+1),this._convertFromCellCoord(ut+1)))&&f.call(this,e,t,r,u,Pt,v,S,P))return}},zi.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},zi.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},zi.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,r=0,u=0;u<this.cells.length;u++)r+=this.cells[u].length;var f=new Int32Array(t+r+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var v=t,S=0;S<e.length;S++){var P=e[S];f[3+S]=v,f.set(P,v),v+=P.length}return f[3+e.length]=v,f.set(this.keys,v),f[3+e.length+1]=v+=this.keys.length,f.set(this.bboxes,v),v+=this.bboxes.length,f.buffer};var Ts=K.ImageData,kl=K.ImageBitmap,to={};function In(e,t,r){r===void 0&&(r={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),to[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}for(var zs in In("Object",Object),ul.serialize=function(e,t){var r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}},ul.deserialize=function(e){return new ul(e.buffer)},In("Grid",ul),In("Color",fa),In("Error",Error),In("ResolvedImage",Vo),In("StylePropertyFunction",El),In("StyleExpression",xl,{omit:["_evaluator"]}),In("ZoomDependentExpression",Il),In("ZoomConstantExpression",Rl),In("CompoundExpression",ho,{omit:["_evaluate"]}),as)as[zs]._classRegistryKey||In("Expression_"+zs,as[zs]);function ti(e){return e&&typeof ArrayBuffer!="undefined"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function jl(e){return kl&&e instanceof kl}function du(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(ti(e)||jl(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var r=e;return t&&t.push(r.buffer),r}if(e instanceof Ts)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var u=[],f=0,v=e;f<v.length;f+=1)u.push(du(v[f],t));return u}if(typeof e=="object"){var S=e.constructor,P=S._classRegistryKey;if(!P)throw new Error("can't serialize object of unregistered class");var V=S.serialize?S.serialize(e,t):{};if(!S.serialize){for(var ee in e)if(e.hasOwnProperty(ee)&&!(to[P].omit.indexOf(ee)>=0)){var he=e[ee];V[ee]=to[P].shallow.indexOf(ee)>=0?he:du(he,t)}e instanceof Error&&(V.message=e.message)}if(V.$name)throw new Error("$name property is reserved for worker serialization logic.");return P!=="Object"&&(V.$name=P),V}throw new Error("can't serialize object of type "+typeof e)}function Us(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||ti(e)||jl(e)||ArrayBuffer.isView(e)||e instanceof Ts)return e;if(Array.isArray(e))return e.map(Us);if(typeof e=="object"){var t=e.$name||"Object",r=to[t].klass;if(!r)throw new Error("can't deserialize unregistered class "+t);if(r.deserialize)return r.deserialize(e);for(var u=Object.create(r.prototype),f=0,v=Object.keys(e);f<v.length;f+=1){var S=v[f];if(S!=="$name"){var P=e[S];u[S]=to[t].shallow.indexOf(S)>=0?P:Us(P)}}return u}throw new Error("can't deserialize object of type "+typeof e)}var ll=function(){this.first=!0};ll.prototype.update=function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))};var qr={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function Ec(e){for(var t=0,r=e;t<r.length;t+=1)if(os(r[t].charCodeAt(0)))return!0;return!1}function os(e){return!(e!==746&&e!==747&&(e<4352||!(qr["Bopomofo Extended"](e)||qr.Bopomofo(e)||qr["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||qr["CJK Compatibility Ideographs"](e)||qr["CJK Compatibility"](e)||qr["CJK Radicals Supplement"](e)||qr["CJK Strokes"](e)||!(!qr["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||qr["CJK Unified Ideographs Extension A"](e)||qr["CJK Unified Ideographs"](e)||qr["Enclosed CJK Letters and Months"](e)||qr["Hangul Compatibility Jamo"](e)||qr["Hangul Jamo Extended-A"](e)||qr["Hangul Jamo Extended-B"](e)||qr["Hangul Jamo"](e)||qr["Hangul Syllables"](e)||qr.Hiragana(e)||qr["Ideographic Description Characters"](e)||qr.Kanbun(e)||qr["Kangxi Radicals"](e)||qr["Katakana Phonetic Extensions"](e)||qr.Katakana(e)&&e!==12540||!(!qr["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!qr["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||qr["Unified Canadian Aboriginal Syllabics"](e)||qr["Unified Canadian Aboriginal Syllabics Extended"](e)||qr["Vertical Forms"](e)||qr["Yijing Hexagram Symbols"](e)||qr["Yi Syllables"](e)||qr["Yi Radicals"](e))))}function ro(e){return!(os(e)||function(t){return!!(qr["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||qr["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||qr["Letterlike Symbols"](t)||qr["Number Forms"](t)||qr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||qr["Control Pictures"](t)&&t!==9251||qr["Optical Character Recognition"](t)||qr["Enclosed Alphanumerics"](t)||qr["Geometric Shapes"](t)||qr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||qr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||qr["CJK Symbols and Punctuation"](t)||qr.Katakana(t)||qr["Private Use Area"](t)||qr["CJK Compatibility Forms"](t)||qr["Small Form Variants"](t)||qr["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function Jo(e){return e>=1424&&e<=2303||qr["Arabic Presentation Forms-A"](e)||qr["Arabic Presentation Forms-B"](e)}function Os(e,t){return!(!t&&Jo(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||qr.Khmer(e))}function Fl(e){for(var t=0,r=e;t<r.length;t+=1)if(Jo(r[t].charCodeAt(0)))return!0;return!1}var zc=null,Bs="unavailable",Cu=null,zl=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(Bs="error"),zc&&zc(t)};function Ul(){af.fire(new st("pluginStateChange",{pluginStatus:Bs,pluginURL:Cu}))}var af=new Bt,Uc=function(){return Bs},Lo=function(){if(Bs!=="deferred"||!Cu)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Bs="loading",Ul(),Cu&&Yn({url:Cu},function(t){t?zl(t):(Bs="loaded",Ul())})},ss={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Bs==="loaded"||ss.applyArabicShaping!=null},isLoading:function(){return Bs==="loading"},setState:function(t){Bs=t.pluginStatus,Cu=t.pluginURL},isParsed:function(){return ss.applyArabicShaping!=null&&ss.processBidirectionalText!=null&&ss.processStyledBidirectionalText!=null},getPluginURL:function(){return Cu}},Pa=function(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ll,this.transition={})};Pa.prototype.isSupportedScript=function(e){return function(t,r){for(var u=0,f=t;u<f.length;u+=1)if(!Os(f[u].charCodeAt(0),r))return!1;return!0}(e,ss.isLoaded())},Pa.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Pa.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}};var eu=function(t,r){this.property=t,this.value=r,this.expression=function(u,f){if(tf(u))return new El(u,f);if(Po(u)){var v=jc(u,f);if(v.result==="error")throw new Error(v.value.map(function(P){return P.key+": "+P.message}).join(", "));return v.value}var S=u;return typeof u=="string"&&f.type==="color"&&(S=fa.parse(u)),{kind:"constant",evaluate:function(){return S}}}(r===void 0?t.specification.default:r,t.specification)};eu.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},eu.prototype.possiblyEvaluate=function(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)};var Ro=function(t){this.property=t,this.value=new eu(t,void 0)};Ro.prototype.transitioned=function(e,t){return new Al(this.property,this.value,t,De({},e.transition,this.transition),e.now)},Ro.prototype.untransitioned=function(){return new Al(this.property,this.value,null,{},0)};var To=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};To.prototype.getValue=function(e){return Ve(this._values[e].value.value)},To.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Ro(this._values[e].property)),this._values[e].value=new eu(this._values[e].property,t===null?void 0:Ve(t))},To.prototype.getTransition=function(e){return Ve(this._values[e].transition)},To.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Ro(this._values[e].property)),this._values[e].transition=Ve(t)||void 0},To.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var u=r[t],f=this.getValue(u);f!==void 0&&(e[u]=f);var v=this.getTransition(u);v!==void 0&&(e[u+"-transition"]=v)}return e},To.prototype.transitioned=function(e,t){for(var r=new cl(this._properties),u=0,f=Object.keys(this._values);u<f.length;u+=1){var v=f[u];r._values[v]=this._values[v].transitioned(e,t._values[v])}return r},To.prototype.untransitioned=function(){for(var e=new cl(this._properties),t=0,r=Object.keys(this._values);t<r.length;t+=1){var u=r[t];e._values[u]=this._values[u].untransitioned()}return e};var Al=function(t,r,u,f,v){this.property=t,this.value=r,this.begin=v+f.delay||0,this.end=this.begin+f.duration||0,t.specification.transition&&(f.delay||f.duration)&&(this.prior=u)};Al.prototype.possiblyEvaluate=function(e,t,r){var u=e.now||0,f=this.value.possiblyEvaluate(e,t,r),v=this.prior;if(v){if(u>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(u<this.begin)return v.possiblyEvaluate(e,t,r);var S=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(e,t,r),f,function(P){if(P<=0)return 0;if(P>=1)return 1;var V=P*P,ee=V*P;return 4*(P<.5?ee:3*(P-V)+ee-.75)}(S))}return f};var cl=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};cl.prototype.possiblyEvaluate=function(e,t,r){for(var u=new Tc(this._properties),f=0,v=Object.keys(this._values);f<v.length;f+=1){var S=v[f];u._values[S]=this._values[S].possiblyEvaluate(e,t,r)}return u},cl.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var pu=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};pu.prototype.getValue=function(e){return Ve(this._values[e].value)},pu.prototype.setValue=function(e,t){this._values[e]=new eu(this._values[e].property,t===null?void 0:Ve(t))},pu.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var u=r[t],f=this.getValue(u);f!==void 0&&(e[u]=f)}return e},pu.prototype.possiblyEvaluate=function(e,t,r){for(var u=new Tc(this._properties),f=0,v=Object.keys(this._values);f<v.length;f+=1){var S=v[f];u._values[S]=this._values[S].possiblyEvaluate(e,t,r)}return u};var _s=function(t,r,u){this.property=t,this.value=r,this.parameters=u};_s.prototype.isConstant=function(){return this.value.kind==="constant"},_s.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},_s.prototype.evaluate=function(e,t,r,u){return this.property.evaluate(this.value,this.parameters,e,t,r,u)};var Tc=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};Tc.prototype.get=function(e){return this._values[e]};var Jn=function(t){this.specification=t};Jn.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},Jn.prototype.interpolate=function(e,t,r){var u=xs[this.specification.type];return u?u(e,t,r):e};var jn=function(t,r){this.specification=t,this.overrides=r};jn.prototype.possiblyEvaluate=function(e,t,r,u){return new _s(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},r,u)}:e.expression,t)},jn.prototype.interpolate=function(e,t,r){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new _s(this,{kind:"constant",value:void 0},e.parameters);var u=xs[this.specification.type];return u?new _s(this,{kind:"constant",value:u(e.value.value,t.value.value,r)},e.parameters):e},jn.prototype.evaluate=function(e,t,r,u,f,v){return e.kind==="constant"?e.value:e.evaluate(t,r,u,f,v)};var _c=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,u,f,v){if(r.value===void 0)return new _s(this,{kind:"constant",value:void 0},u);if(r.expression.kind==="constant"){var S=r.expression.evaluate(u,null,{},f,v),P=r.property.specification.type==="resolvedImage"&&typeof S!="string"?S.name:S,V=this._calculate(P,P,P,u);return new _s(this,{kind:"constant",value:V},u)}if(r.expression.kind==="camera"){var ee=this._calculate(r.expression.evaluate({zoom:u.zoom-1}),r.expression.evaluate({zoom:u.zoom}),r.expression.evaluate({zoom:u.zoom+1}),u);return new _s(this,{kind:"constant",value:ee},u)}return new _s(this,r.expression,u)},t.prototype.evaluate=function(r,u,f,v,S,P){if(r.kind==="source"){var V=r.evaluate(u,f,v,S,P);return this._calculate(V,V,V,u)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(u.zoom)-1},f,v),r.evaluate({zoom:Math.floor(u.zoom)},f,v),r.evaluate({zoom:Math.floor(u.zoom)+1},f,v),u):r.value},t.prototype._calculate=function(r,u,f,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:r,to:u}:{from:f,to:u}},t.prototype.interpolate=function(r){return r},t}(jn),us=function(t){this.specification=t};us.prototype.possiblyEvaluate=function(e,t,r,u){if(e.value!==void 0){if(e.expression.kind==="constant"){var f=e.expression.evaluate(t,null,{},r,u);return this._calculate(f,f,f,t)}return this._calculate(e.expression.evaluate(new Pa(Math.floor(t.zoom-1),t)),e.expression.evaluate(new Pa(Math.floor(t.zoom),t)),e.expression.evaluate(new Pa(Math.floor(t.zoom+1),t)),t)}},us.prototype._calculate=function(e,t,r,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},us.prototype.interpolate=function(e){return e};var Io=function(t){this.specification=t};Io.prototype.possiblyEvaluate=function(e,t,r,u){return!!e.expression.evaluate(t,null,{},r,u)},Io.prototype.interpolate=function(){return!1};var vo=function(t){for(var r in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var u=t[r];u.specification.overridable&&this.overridableProperties.push(r);var f=this.defaultPropertyValues[r]=new eu(u,void 0),v=this.defaultTransitionablePropertyValues[r]=new Ro(u);this.defaultTransitioningPropertyValues[r]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=f.possiblyEvaluate({})}};In("DataDrivenProperty",jn),In("DataConstantProperty",Jn),In("CrossFadedDataDrivenProperty",_c),In("CrossFadedProperty",us),In("ColorRampProperty",Io);var Ss=function(e){function t(r,u){if(e.call(this),this.id=r.id,this.type=r.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},r.type!=="custom"&&(this.metadata=(r=r).metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),u.layout&&(this._unevaluatedLayout=new pu(u.layout)),u.paint)){for(var f in this._transitionablePaint=new To(u.paint),r.paint)this.setPaintProperty(f,r.paint[f],{validate:!1});for(var v in r.layout)this.setLayoutProperty(v,r.layout[v],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Tc(u.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)},t.prototype.setLayoutProperty=function(r,u,f){f===void 0&&(f={}),u!=null&&this._validate(Sl,"layers."+this.id+".layout."+r,r,u,f)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,u):this.visibility=u)},t.prototype.getPaintProperty=function(r){return wt(r,"-transition")?this._transitionablePaint.getTransition(r.slice(0,-"-transition".length)):this._transitionablePaint.getValue(r)},t.prototype.setPaintProperty=function(r,u,f){if(f===void 0&&(f={}),u!=null&&this._validate(is,"layers."+this.id+".paint."+r,r,u,f))return!1;if(wt(r,"-transition"))return this._transitionablePaint.setTransition(r.slice(0,-"-transition".length),u||void 0),!1;var v=this._transitionablePaint._values[r],S=v.property.specification["property-type"]==="cross-faded-data-driven",P=v.value.isDataDriven(),V=v.value;this._transitionablePaint.setValue(r,u),this._handleSpecialPaintPropertyUpdate(r);var ee=this._transitionablePaint._values[r].value;return ee.isDataDriven()||P||S||this._handleOverridablePaintPropertyUpdate(r,V,ee)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){},t.prototype._handleOverridablePaintPropertyUpdate=function(r,u,f){return!1},t.prototype.isHidden=function(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(r,u){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,u)},t.prototype.serialize=function(){var r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),Re(r,function(u,f){return!(u===void 0||f==="layout"&&!Object.keys(u).length||f==="paint"&&!Object.keys(u).length)})},t.prototype._validate=function(r,u,f,v,S){return S===void 0&&(S={}),(!S||S.validate!==!1)&&sl(this,r.call(ol,{key:u,layerType:this.type,objectKey:f,value:v,styleSpec:Xe,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var r in this.paint._values){var u=this.paint.get(r);if(u instanceof _s&&Au(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1},t}(Bt),wu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},rc=function(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Ka=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function no(e,t){t===void 0&&(t=1);var r=0,u=0;return{members:e.map(function(f){var v=wu[f.type].BYTES_PER_ELEMENT,S=r=fl(r,Math.max(t,v)),P=f.components||1;return u=Math.max(u,v),r+=v*P,{name:f.name,type:f.type,components:P,offset:S}}),size:fl(r,Math.max(u,t)),alignment:t}}function fl(e,t){return Math.ceil(e/t)*t}Ka.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},Ka.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},Ka.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Ka.prototype.clear=function(){this.length=0},Ka.prototype.resize=function(e){this.reserve(e),this.length=e},Ka.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},Ka.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var mu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u){var f=this.length;return this.resize(f+1),this.emplace(f,r,u)},t.prototype.emplace=function(r,u,f){var v=2*r;return this.int16[v+0]=u,this.int16[v+1]=f,r},t}(Ka);mu.prototype.bytesPerElement=4,In("StructArrayLayout2i4",mu);var hl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,v){var S=this.length;return this.resize(S+1),this.emplace(S,r,u,f,v)},t.prototype.emplace=function(r,u,f,v,S){var P=4*r;return this.int16[P+0]=u,this.int16[P+1]=f,this.int16[P+2]=v,this.int16[P+3]=S,r},t}(Ka);hl.prototype.bytesPerElement=8,In("StructArrayLayout4i8",hl);var Ou=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,v,S,P){var V=this.length;return this.resize(V+1),this.emplace(V,r,u,f,v,S,P)},t.prototype.emplace=function(r,u,f,v,S,P,V){var ee=6*r;return this.int16[ee+0]=u,this.int16[ee+1]=f,this.int16[ee+2]=v,this.int16[ee+3]=S,this.int16[ee+4]=P,this.int16[ee+5]=V,r},t}(Ka);Ou.prototype.bytesPerElement=12,In("StructArrayLayout2i4i12",Ou);var Ms=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,v,S,P){var V=this.length;return this.resize(V+1),this.emplace(V,r,u,f,v,S,P)},t.prototype.emplace=function(r,u,f,v,S,P,V){var ee=4*r,he=8*r;return this.int16[ee+0]=u,this.int16[ee+1]=f,this.uint8[he+4]=v,this.uint8[he+5]=S,this.uint8[he+6]=P,this.uint8[he+7]=V,r},t}(Ka);Ms.prototype.bytesPerElement=8,In("StructArrayLayout2i4ub8",Ms);var Bc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u){var f=this.length;return this.resize(f+1),this.emplace(f,r,u)},t.prototype.emplace=function(r,u,f){var v=2*r;return this.float32[v+0]=u,this.float32[v+1]=f,r},t}(Ka);Bc.prototype.bytesPerElement=8,In("StructArrayLayout2f8",Bc);var Vs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,v,S,P,V,ee,he,_e){var Ce=this.length;return this.resize(Ce+1),this.emplace(Ce,r,u,f,v,S,P,V,ee,he,_e)},t.prototype.emplace=function(r,u,f,v,S,P,V,ee,he,_e,Ce){var ut=10*r;return this.uint16[ut+0]=u,this.uint16[ut+1]=f,this.uint16[ut+2]=v,this.uint16[ut+3]=S,this.uint16[ut+4]=P,this.uint16[ut+5]=V,this.uint16[ut+6]=ee,this.uint16[ut+7]=he,this.uint16[ut+8]=_e,this.uint16[ut+9]=Ce,r},t}(Ka);Vs.prototype.bytesPerElement=20,In("StructArrayLayout10ui20",Vs);var xf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,v,S,P,V,ee,he,_e,Ce,ut){var Pt=this.length;return this.resize(Pt+1),this.emplace(Pt,r,u,f,v,S,P,V,ee,he,_e,Ce,ut)},t.prototype.emplace=function(r,u,f,v,S,P,V,ee,he,_e,Ce,ut,Pt){var St=12*r;return this.int16[St+0]=u,this.int16[St+1]=f,this.int16[St+2]=v,this.int16[St+3]=S,this.uint16[St+4]=P,this.uint16[St+5]=V,this.uint16[St+6]=ee,this.uint16[St+7]=he,this.int16[St+8]=_e,this.int16[St+9]=Ce,this.int16[St+10]=ut,this.int16[St+11]=Pt,r},t}(Ka);xf.prototype.bytesPerElement=24,In("StructArrayLayout4i4ui4i24",xf);var Bl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f){var v=this.length;return this.resize(v+1),this.emplace(v,r,u,f)},t.prototype.emplace=function(r,u,f,v){var S=3*r;return this.float32[S+0]=u,this.float32[S+1]=f,this.float32[S+2]=v,r},t}(Ka);Bl.prototype.bytesPerElement=12,In("StructArrayLayout3f12",Bl);var Vl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var u=this.length;return this.resize(u+1),this.emplace(u,r)},t.prototype.emplace=function(r,u){return this.uint32[1*r+0]=u,r},t}(Ka);Vl.prototype.bytesPerElement=4,In("StructArrayLayout1ul4",Vl);var Sc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,v,S,P,V,ee,he){var _e=this.length;return this.resize(_e+1),this.emplace(_e,r,u,f,v,S,P,V,ee,he)},t.prototype.emplace=function(r,u,f,v,S,P,V,ee,he,_e){var Ce=10*r,ut=5*r;return this.int16[Ce+0]=u,this.int16[Ce+1]=f,this.int16[Ce+2]=v,this.int16[Ce+3]=S,this.int16[Ce+4]=P,this.int16[Ce+5]=V,this.uint32[ut+3]=ee,this.uint16[Ce+8]=he,this.uint16[Ce+9]=_e,r},t}(Ka);Sc.prototype.bytesPerElement=20,In("StructArrayLayout6i1ul2ui20",Sc);var ls=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,v,S,P){var V=this.length;return this.resize(V+1),this.emplace(V,r,u,f,v,S,P)},t.prototype.emplace=function(r,u,f,v,S,P,V){var ee=6*r;return this.int16[ee+0]=u,this.int16[ee+1]=f,this.int16[ee+2]=v,this.int16[ee+3]=S,this.int16[ee+4]=P,this.int16[ee+5]=V,r},t}(Ka);ls.prototype.bytesPerElement=12,In("StructArrayLayout2i2i2i12",ls);var Hu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,v,S){var P=this.length;return this.resize(P+1),this.emplace(P,r,u,f,v,S)},t.prototype.emplace=function(r,u,f,v,S,P){var V=4*r,ee=8*r;return this.float32[V+0]=u,this.float32[V+1]=f,this.float32[V+2]=v,this.int16[ee+6]=S,this.int16[ee+7]=P,r},t}(Ka);Hu.prototype.bytesPerElement=16,In("StructArrayLayout2f1f2i16",Hu);var Vc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,v){var S=this.length;return this.resize(S+1),this.emplace(S,r,u,f,v)},t.prototype.emplace=function(r,u,f,v,S){var P=12*r,V=3*r;return this.uint8[P+0]=u,this.uint8[P+1]=f,this.float32[V+1]=v,this.float32[V+2]=S,r},t}(Ka);Vc.prototype.bytesPerElement=12,In("StructArrayLayout2ub2f12",Vc);var Cl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f){var v=this.length;return this.resize(v+1),this.emplace(v,r,u,f)},t.prototype.emplace=function(r,u,f,v){var S=3*r;return this.uint16[S+0]=u,this.uint16[S+1]=f,this.uint16[S+2]=v,r},t}(Ka);Cl.prototype.bytesPerElement=6,In("StructArrayLayout3ui6",Cl);var Zu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,v,S,P,V,ee,he,_e,Ce,ut,Pt,St,Yt,Wt,ir){var yr=this.length;return this.resize(yr+1),this.emplace(yr,r,u,f,v,S,P,V,ee,he,_e,Ce,ut,Pt,St,Yt,Wt,ir)},t.prototype.emplace=function(r,u,f,v,S,P,V,ee,he,_e,Ce,ut,Pt,St,Yt,Wt,ir,yr){var _r=24*r,kr=12*r,Dr=48*r;return this.int16[_r+0]=u,this.int16[_r+1]=f,this.uint16[_r+2]=v,this.uint16[_r+3]=S,this.uint32[kr+2]=P,this.uint32[kr+3]=V,this.uint32[kr+4]=ee,this.uint16[_r+10]=he,this.uint16[_r+11]=_e,this.uint16[_r+12]=Ce,this.float32[kr+7]=ut,this.float32[kr+8]=Pt,this.uint8[Dr+36]=St,this.uint8[Dr+37]=Yt,this.uint8[Dr+38]=Wt,this.uint32[kr+10]=ir,this.int16[_r+22]=yr,r},t}(Ka);Zu.prototype.bytesPerElement=48,In("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Zu);var nc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,v,S,P,V,ee,he,_e,Ce,ut,Pt,St,Yt,Wt,ir,yr,_r,kr,Dr,pn,fn,Rn,Qn,Xn,Nn,Ea){var ca=this.length;return this.resize(ca+1),this.emplace(ca,r,u,f,v,S,P,V,ee,he,_e,Ce,ut,Pt,St,Yt,Wt,ir,yr,_r,kr,Dr,pn,fn,Rn,Qn,Xn,Nn,Ea)},t.prototype.emplace=function(r,u,f,v,S,P,V,ee,he,_e,Ce,ut,Pt,St,Yt,Wt,ir,yr,_r,kr,Dr,pn,fn,Rn,Qn,Xn,Nn,Ea,ca){var ra=34*r,$a=17*r;return this.int16[ra+0]=u,this.int16[ra+1]=f,this.int16[ra+2]=v,this.int16[ra+3]=S,this.int16[ra+4]=P,this.int16[ra+5]=V,this.int16[ra+6]=ee,this.int16[ra+7]=he,this.uint16[ra+8]=_e,this.uint16[ra+9]=Ce,this.uint16[ra+10]=ut,this.uint16[ra+11]=Pt,this.uint16[ra+12]=St,this.uint16[ra+13]=Yt,this.uint16[ra+14]=Wt,this.uint16[ra+15]=ir,this.uint16[ra+16]=yr,this.uint16[ra+17]=_r,this.uint16[ra+18]=kr,this.uint16[ra+19]=Dr,this.uint16[ra+20]=pn,this.uint16[ra+21]=fn,this.uint16[ra+22]=Rn,this.uint32[$a+12]=Qn,this.float32[$a+13]=Xn,this.float32[$a+14]=Nn,this.float32[$a+15]=Ea,this.float32[$a+16]=ca,r},t}(Ka);nc.prototype.bytesPerElement=68,In("StructArrayLayout8i15ui1ul4f68",nc);var Wu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var u=this.length;return this.resize(u+1),this.emplace(u,r)},t.prototype.emplace=function(r,u){return this.float32[1*r+0]=u,r},t}(Ka);Wu.prototype.bytesPerElement=4,In("StructArrayLayout1f4",Wu);var Ps=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f){var v=this.length;return this.resize(v+1),this.emplace(v,r,u,f)},t.prototype.emplace=function(r,u,f,v){var S=3*r;return this.int16[S+0]=u,this.int16[S+1]=f,this.int16[S+2]=v,r},t}(Ka);Ps.prototype.bytesPerElement=6,In("StructArrayLayout3i6",Ps);var of=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f){var v=this.length;return this.resize(v+1),this.emplace(v,r,u,f)},t.prototype.emplace=function(r,u,f,v){var S=4*r;return this.uint32[2*r+0]=u,this.uint16[S+2]=f,this.uint16[S+3]=v,r},t}(Ka);of.prototype.bytesPerElement=8,In("StructArrayLayout1ul2ui8",of);var ac=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u){var f=this.length;return this.resize(f+1),this.emplace(f,r,u)},t.prototype.emplace=function(r,u,f){var v=2*r;return this.uint16[v+0]=u,this.uint16[v+1]=f,r},t}(Ka);ac.prototype.bytesPerElement=4,In("StructArrayLayout2ui4",ac);var ic=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var u=this.length;return this.resize(u+1),this.emplace(u,r)},t.prototype.emplace=function(r,u){return this.uint16[1*r+0]=u,r},t}(Ka);ic.prototype.bytesPerElement=2,In("StructArrayLayout1ui2",ic);var oc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,v){var S=this.length;return this.resize(S+1),this.emplace(S,r,u,f,v)},t.prototype.emplace=function(r,u,f,v,S){var P=4*r;return this.float32[P+0]=u,this.float32[P+1]=f,this.float32[P+2]=v,this.float32[P+3]=S,r},t}(Ka);oc.prototype.bytesPerElement=16,In("StructArrayLayout4f16",oc);var s=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new te(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,r),t}(rc);s.prototype.size=20;var a=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new s(this,r)},t}(Sc);In("CollisionBoxArray",a);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(u){this._structArray.uint8[this._pos1+37]=u},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(u){this._structArray.uint8[this._pos1+38]=u},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(u){this._structArray.uint32[this._pos4+10]=u},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,r),t}(rc);n.prototype.size=48;var l=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new n(this,r)},t}(Zu);In("PlacedSymbolArray",l);var g=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(u){this._structArray.uint32[this._pos4+12]=u},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,r),t}(rc);g.prototype.size=68;var w=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new g(this,r)},t}(nc);In("SymbolInstanceArray",w);var L=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(r){return this.float32[1*r+0]},t}(Wu);In("GlyphOffsetArray",L);var z=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(r){return this.int16[3*r+0]},t.prototype.gety=function(r){return this.int16[3*r+1]},t.prototype.gettileUnitDistanceFromAnchor=function(r){return this.int16[3*r+2]},t}(Ps);In("SymbolLineVertexArray",z);var ue=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,r),t}(rc);ue.prototype.size=8;var Ee=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new ue(this,r)},t}(of);In("FeatureIndexArray",Ee);var Ke=no([{name:"a_pos",components:2,type:"Int16"}],4).members,tt=function(t){t===void 0&&(t=[]),this.segments=t};function rt(e,t){return 256*(e=Pe(Math.floor(e),0,255))+Pe(Math.floor(t),0,255)}tt.prototype.prepareSegment=function(e,t,r,u){var f=this.segments[this.segments.length-1];return e>tt.MAX_VERTEX_ARRAY_LENGTH&&Me("Max vertices per segment is "+tt.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!f||f.vertexLength+e>tt.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==u)&&(f={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},u!==void 0&&(f.sortKey=u),this.segments.push(f)),f},tt.prototype.get=function(){return this.segments},tt.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var r=t[e];for(var u in r.vaos)r.vaos[u].destroy()}},tt.simpleSegment=function(e,t,r,u){return new tt([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:u,vaos:{},sortKey:0}])},tt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,In("SegmentVector",tt);var Ft=no([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Nt=Z(function(e){e.exports=function(t,r){var u,f,v,S,P,V,ee,he;for(f=t.length-(u=3&t.length),v=r,P=3432918353,V=461845907,he=0;he<f;)ee=255&t.charCodeAt(he)|(255&t.charCodeAt(++he))<<8|(255&t.charCodeAt(++he))<<16|(255&t.charCodeAt(++he))<<24,++he,v=27492+(65535&(S=5*(65535&(v=(v^=ee=(65535&(ee=(ee=(65535&ee)*P+(((ee>>>16)*P&65535)<<16)&4294967295)<<15|ee>>>17))*V+(((ee>>>16)*V&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(S>>>16)&65535)<<16);switch(ee=0,u){case 3:ee^=(255&t.charCodeAt(he+2))<<16;case 2:ee^=(255&t.charCodeAt(he+1))<<8;case 1:v^=ee=(65535&(ee=(ee=(65535&(ee^=255&t.charCodeAt(he)))*P+(((ee>>>16)*P&65535)<<16)&4294967295)<<15|ee>>>17))*V+(((ee>>>16)*V&65535)<<16)&4294967295}return v^=t.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0}}),Kt=Z(function(e){e.exports=function(t,r){for(var u,f=t.length,v=r^f,S=0;f>=4;)u=1540483477*(65535&(u=255&t.charCodeAt(S)|(255&t.charCodeAt(++S))<<8|(255&t.charCodeAt(++S))<<16|(255&t.charCodeAt(++S))<<24))+((1540483477*(u>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),f-=4,++S;switch(f){case 3:v^=(255&t.charCodeAt(S+2))<<16;case 2:v^=(255&t.charCodeAt(S+1))<<8;case 1:v=1540483477*(65535&(v^=255&t.charCodeAt(S)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0}}),jt=Nt,Gt=Kt;jt.murmur3=Nt,jt.murmur2=Gt;var nr=function(){this.ids=[],this.positions=[],this.indexed=!1};nr.prototype.add=function(e,t,r,u){this.ids.push(Lr(e)),this.positions.push(t,r,u)},nr.prototype.getPositions=function(e){for(var t=Lr(e),r=0,u=this.ids.length-1;r<u;){var f=r+u>>1;this.ids[f]>=t?u=f:r=f+1}for(var v=[];this.ids[r]===t;)v.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return v},nr.serialize=function(e,t){var r=new Float64Array(e.ids),u=new Uint32Array(e.positions);return function f(v,S,P,V){for(;P<V;){for(var ee=v[P+V>>1],he=P-1,_e=V+1;;){do he++;while(v[he]<ee);do _e--;while(v[_e]>ee);if(he>=_e)break;vr(v,he,_e),vr(S,3*he,3*_e),vr(S,3*he+1,3*_e+1),vr(S,3*he+2,3*_e+2)}_e-P<V-_e?(f(v,S,P,_e),P=_e+1):(f(v,S,_e+1,V),V=_e)}}(r,u,0,r.length-1),t&&t.push(r.buffer,u.buffer),{ids:r,positions:u}},nr.deserialize=function(e){var t=new nr;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var rr=Math.pow(2,53)-1;function Lr(e){var t=+e;return!isNaN(t)&&t<=rr?t:jt(String(e))}function vr(e,t,r){var u=e[t];e[t]=e[r],e[r]=u}In("FeaturePositionMap",nr);var Sr=function(t,r){this.gl=t.gl,this.location=r},Ar=function(e){function t(r,u){e.call(this,r,u),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))},t}(Sr),rn=function(e){function t(r,u){e.call(this,r,u),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))},t}(Sr),Xr=function(e){function t(r,u){e.call(this,r,u),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))},t}(Sr),mn=function(e){function t(r,u){e.call(this,r,u),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))},t}(Sr),Ln=function(e){function t(r,u){e.call(this,r,u),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))},t}(Sr),qn=function(e){function t(r,u){e.call(this,r,u),this.current=fa.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))},t}(Sr),sa=new Float32Array(16),Sa=function(e){function t(r,u){e.call(this,r,u),this.current=sa}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(var u=1;u<16;u++)if(r[u]!==this.current[u]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}},t}(Sr);function Za(e){return[rt(255*e.r,255*e.g),rt(255*e.b,255*e.a)]}var Sn=function(t,r,u){this.value=t,this.uniformNames=r.map(function(f){return"u_"+f}),this.type=u};Sn.prototype.setUniform=function(e,t,r){e.set(r.constantOr(this.value))},Sn.prototype.getBinding=function(e,t,r){return this.type==="color"?new qn(e,t):new rn(e,t)};var ua=function(t,r){this.uniformNames=r.map(function(u){return"u_"+u}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ua.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},ua.prototype.setUniform=function(e,t,r,u){var f=u==="u_pattern_to"?this.patternTo:u==="u_pattern_from"?this.patternFrom:u==="u_pixel_ratio_to"?this.pixelRatioTo:u==="u_pixel_ratio_from"?this.pixelRatioFrom:null;f&&e.set(f)},ua.prototype.getBinding=function(e,t,r){return r.substr(0,9)==="u_pattern"?new Ln(e,t):new rn(e,t)};var ba=function(t,r,u,f){this.expression=t,this.type=u,this.maxValue=0,this.paintVertexAttributes=r.map(function(v){return{name:"a_"+v,type:"Float32",components:u==="color"?2:1,offset:0}}),this.paintVertexArray=new f};ba.prototype.populatePaintArray=function(e,t,r,u,f){var v=this.paintVertexArray.length,S=this.expression.evaluate(new Pa(0),t,{},u,[],f);this.paintVertexArray.resize(e),this._setPaintValue(v,e,S)},ba.prototype.updatePaintArray=function(e,t,r,u){var f=this.expression.evaluate({zoom:0},r,u);this._setPaintValue(e,t,f)},ba.prototype._setPaintValue=function(e,t,r){if(this.type==="color")for(var u=Za(r),f=e;f<t;f++)this.paintVertexArray.emplace(f,u[0],u[1]);else{for(var v=e;v<t;v++)this.paintVertexArray.emplace(v,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},ba.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ba.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Zn=function(t,r,u,f,v,S){this.expression=t,this.uniformNames=r.map(function(P){return"u_"+P+"_t"}),this.type=u,this.useIntegerZoom=f,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=r.map(function(P){return{name:"a_"+P,type:"Float32",components:u==="color"?4:2,offset:0}}),this.paintVertexArray=new S};Zn.prototype.populatePaintArray=function(e,t,r,u,f){var v=this.expression.evaluate(new Pa(this.zoom),t,{},u,[],f),S=this.expression.evaluate(new Pa(this.zoom+1),t,{},u,[],f),P=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(P,e,v,S)},Zn.prototype.updatePaintArray=function(e,t,r,u){var f=this.expression.evaluate({zoom:this.zoom},r,u),v=this.expression.evaluate({zoom:this.zoom+1},r,u);this._setPaintValue(e,t,f,v)},Zn.prototype._setPaintValue=function(e,t,r,u){if(this.type==="color")for(var f=Za(r),v=Za(u),S=e;S<t;S++)this.paintVertexArray.emplace(S,f[0],f[1],v[0],v[1]);else{for(var P=e;P<t;P++)this.paintVertexArray.emplace(P,r,u);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(u))}},Zn.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Zn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Zn.prototype.setUniform=function(e,t){var r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,u=Pe(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(u)},Zn.prototype.getBinding=function(e,t,r){return new rn(e,t)};var Aa=function(t,r,u,f,v,S){this.expression=t,this.type=r,this.useIntegerZoom=u,this.zoom=f,this.layerId=S,this.zoomInPaintVertexArray=new v,this.zoomOutPaintVertexArray=new v};Aa.prototype.populatePaintArray=function(e,t,r){var u=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(u,e,t.patterns&&t.patterns[this.layerId],r)},Aa.prototype.updatePaintArray=function(e,t,r,u,f){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],f)},Aa.prototype._setPaintValues=function(e,t,r,u){if(u&&r){var f=u[r.min],v=u[r.mid],S=u[r.max];if(f&&v&&S)for(var P=e;P<t;P++)this.zoomInPaintVertexArray.emplace(P,v.tl[0],v.tl[1],v.br[0],v.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],v.pixelRatio,f.pixelRatio),this.zoomOutPaintVertexArray.emplace(P,v.tl[0],v.tl[1],v.br[0],v.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],v.pixelRatio,S.pixelRatio)}},Aa.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Ft.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Ft.members,this.expression.isStateDependent))},Aa.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var na=function(t,r,u){this.binders={},this._buffers=[];var f=[];for(var v in t.paint._values)if(u(v)){var S=t.paint.get(v);if(S instanceof _s&&Au(S.property.specification)){var P=za(v,t.type),V=S.value,ee=S.property.specification.type,he=S.property.useIntegerZoom,_e=S.property.specification["property-type"],Ce=_e==="cross-faded"||_e==="cross-faded-data-driven";if(V.kind==="constant")this.binders[v]=Ce?new ua(V.value,P):new Sn(V.value,P,ee),f.push("/u_"+v);else if(V.kind==="source"||Ce){var ut=Gi(v,ee,"source");this.binders[v]=Ce?new Aa(V,ee,he,r,ut,t.id):new ba(V,P,ee,ut),f.push("/a_"+v)}else{var Pt=Gi(v,ee,"composite");this.binders[v]=new Zn(V,P,ee,he,r,Pt),f.push("/z_"+v)}}}this.cacheKey=f.sort().join("")};na.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof ba||t instanceof Zn?t.maxValue:0},na.prototype.populatePaintArrays=function(e,t,r,u,f){for(var v in this.binders){var S=this.binders[v];(S instanceof ba||S instanceof Zn||S instanceof Aa)&&S.populatePaintArray(e,t,r,u,f)}},na.prototype.setConstantPatternPositions=function(e,t){for(var r in this.binders){var u=this.binders[r];u instanceof ua&&u.setConstantPatternPositions(e,t)}},na.prototype.updatePaintArrays=function(e,t,r,u,f){var v=!1;for(var S in e)for(var P=0,V=t.getPositions(S);P<V.length;P+=1){var ee=V[P],he=r.feature(ee.index);for(var _e in this.binders){var Ce=this.binders[_e];if((Ce instanceof ba||Ce instanceof Zn||Ce instanceof Aa)&&Ce.expression.isStateDependent===!0){var ut=u.paint.get(_e);Ce.expression=ut.value,Ce.updatePaintArray(ee.start,ee.end,he,e[S],f),v=!0}}}return v},na.prototype.defines=function(){var e=[];for(var t in this.binders){var r=this.binders[t];(r instanceof Sn||r instanceof ua)&&e.push.apply(e,r.uniformNames.map(function(u){return"#define HAS_UNIFORM_"+u}))}return e},na.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof ba||r instanceof Zn)for(var u=0;u<r.paintVertexAttributes.length;u++)e.push(r.paintVertexAttributes[u].name);else if(r instanceof Aa)for(var f=0;f<Ft.members.length;f++)e.push(Ft.members[f].name)}return e},na.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof Sn||r instanceof ua||r instanceof Zn)for(var u=0,f=r.uniformNames;u<f.length;u+=1)e.push(f[u])}return e},na.prototype.getPaintVertexBuffers=function(){return this._buffers},na.prototype.getUniforms=function(e,t){var r=[];for(var u in this.binders){var f=this.binders[u];if(f instanceof Sn||f instanceof ua||f instanceof Zn)for(var v=0,S=f.uniformNames;v<S.length;v+=1){var P=S[v];if(t[P]){var V=f.getBinding(e,t[P],P);r.push({name:P,property:u,binding:V})}}}return r},na.prototype.setUniforms=function(e,t,r,u){for(var f=0,v=t;f<v.length;f+=1){var S=v[f],P=S.name,V=S.property;this.binders[V].setUniform(S.binding,u,r.get(V),P)}},na.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var r=this.binders[t];if(e&&r instanceof Aa){var u=e.fromScale===2?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;u&&this._buffers.push(u)}else(r instanceof ba||r instanceof Zn)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},na.prototype.upload=function(e){for(var t in this.binders){var r=this.binders[t];(r instanceof ba||r instanceof Zn||r instanceof Aa)&&r.upload(e)}this.updatePaintBuffers()},na.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof ba||t instanceof Zn||t instanceof Aa)&&t.destroy()}};var La=function(t,r,u){u===void 0&&(u=function(){return!0}),this.programConfigurations={};for(var f=0,v=t;f<v.length;f+=1){var S=v[f];this.programConfigurations[S.id]=new na(S,r,u)}this.needsUpload=!1,this._featureMap=new nr,this._bufferOffset=0};function za(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function Gi(e,t,r){var u={color:{source:Bc,composite:oc},number:{source:Wu,composite:Bc}},f=function(v){return{"line-pattern":{source:Vs,composite:Vs},"fill-pattern":{source:Vs,composite:Vs},"fill-extrusion-pattern":{source:Vs,composite:Vs}}[v]}(e);return f&&f[r]||u[t][r]}La.prototype.populatePaintArrays=function(e,t,r,u,f,v){for(var S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(e,t,u,f,v);t.id!==void 0&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},La.prototype.updatePaintArrays=function(e,t,r,u){for(var f=0,v=r;f<v.length;f+=1){var S=v[f];this.needsUpload=this.programConfigurations[S.id].updatePaintArrays(e,this._featureMap,t,S,u)||this.needsUpload}},La.prototype.get=function(e){return this.programConfigurations[e]},La.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},La.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},In("ConstantBinder",Sn),In("CrossFadedConstantBinder",ua),In("SourceExpressionBinder",ba),In("CrossFadedCompositeBinder",Aa),In("CompositeExpressionBinder",Zn),In("ProgramConfiguration",na,{omit:["_buffers"]}),In("ProgramConfigurationSet",La);var _i=Math.pow(2,14)-1,Di=-_i-1;function gi(e){for(var t=8192/e.extent,r=e.loadGeometry(),u=0;u<r.length;u++)for(var f=r[u],v=0;v<f.length;v++){var S=f[v],P=Math.round(S.x*t),V=Math.round(S.y*t);S.x=Pe(P,Di,_i),S.y=Pe(V,Di,_i),(P<S.x||P>S.x+1||V<S.y||V>S.y+1)&&Me("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function Ui(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?gi(e):[]}}function Qo(e,t,r,u,f){e.emplaceBack(2*t+(u+1)/2,2*r+(f+1)/2)}var qo=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new mu,this.indexArray=new Cl,this.segments=new tt,this.programConfigurations=new La(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function vu(e,t){for(var r=0;r<e.length;r++)if(ru(t,e[r]))return!0;for(var u=0;u<t.length;u++)if(ru(e,t[u]))return!0;return!!Pu(e,t)}function Mu(e,t,r){return!!ru(e,t)||!!tu(t,e,r)}function cs(e,t){if(e.length===1)return uc(t,e[0]);for(var r=0;r<t.length;r++)for(var u=t[r],f=0;f<u.length;f++)if(ru(e,u[f]))return!0;for(var v=0;v<e.length;v++)if(uc(t,e[v]))return!0;for(var S=0;S<t.length;S++)if(Pu(e,t[S]))return!0;return!1}function Gs(e,t,r){if(e.length>1){if(Pu(e,t))return!0;for(var u=0;u<t.length;u++)if(tu(t[u],e,r))return!0}for(var f=0;f<e.length;f++)if(tu(e[f],t,r))return!0;return!1}function Pu(e,t){if(e.length===0||t.length===0)return!1;for(var r=0;r<e.length-1;r++)for(var u=e[r],f=e[r+1],v=0;v<t.length-1;v++)if(sc(u,f,t[v],t[v+1]))return!0;return!1}function sc(e,t,r,u){return ht(e,r,u)!==ht(t,r,u)&&ht(e,t,r)!==ht(e,t,u)}function tu(e,t,r){var u=r*r;if(t.length===1)return e.distSqr(t[0])<u;for(var f=1;f<t.length;f++)if(Xu(e,t[f-1],t[f])<u)return!0;return!1}function Xu(e,t,r){var u=t.distSqr(r);if(u===0)return e.distSqr(t);var f=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/u;return e.distSqr(f<0?t:f>1?r:r.sub(t)._mult(f)._add(t))}function uc(e,t){for(var r,u,f,v=!1,S=0;S<e.length;S++)for(var P=0,V=(r=e[S]).length-1;P<r.length;V=P++)(u=r[P]).y>t.y!=(f=r[V]).y>t.y&&t.x<(f.x-u.x)*(t.y-u.y)/(f.y-u.y)+u.x&&(v=!v);return v}function ru(e,t){for(var r=!1,u=0,f=e.length-1;u<e.length;f=u++){var v=e[u],S=e[f];v.y>t.y!=S.y>t.y&&t.x<(S.x-v.x)*(t.y-v.y)/(S.y-v.y)+v.x&&(r=!r)}return r}function Lu(e,t,r){var u=r[0],f=r[2];if(e.x<u.x&&t.x<u.x||e.x>f.x&&t.x>f.x||e.y<u.y&&t.y<u.y||e.y>f.y&&t.y>f.y)return!1;var v=ht(e,t,r[0]);return v!==ht(e,t,r[1])||v!==ht(e,t,r[2])||v!==ht(e,t,r[3])}function fs(e,t,r){var u=t.paint.get(e).value;return u.kind==="constant"?u.value:r.programConfigurations.get(t.id).getMaxValue(e)}function ao(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Yu(e,t,r,u,f){if(!t[0]&&!t[1])return e;var v=te.convert(t)._mult(f);r==="viewport"&&v._rotate(-u);for(var S=[],P=0;P<e.length;P++)S.push(e[P].sub(v));return S}qo.prototype.populate=function(e,t,r){var u=this.layers[0],f=[],v=null;u.type==="circle"&&(v=u.layout.get("circle-sort-key"));for(var S=0,P=e;S<P.length;S+=1){var V=P[S],ee=V.feature,he=V.id,_e=V.index,Ce=V.sourceLayerIndex,ut=this.layers[0]._featureFilter.needGeometry,Pt=Ui(ee,ut);if(this.layers[0]._featureFilter.filter(new Pa(this.zoom),Pt,r)){var St=v?v.evaluate(Pt,{},r):void 0,Yt={id:he,properties:ee.properties,type:ee.type,sourceLayerIndex:Ce,index:_e,geometry:ut?Pt.geometry:gi(ee),patterns:{},sortKey:St};f.push(Yt)}}v&&f.sort(function(fn,Rn){return fn.sortKey-Rn.sortKey});for(var Wt=0,ir=f;Wt<ir.length;Wt+=1){var yr=ir[Wt],_r=yr.geometry,kr=yr.index,Dr=yr.sourceLayerIndex,pn=e[kr].feature;this.addFeature(yr,_r,kr,r),t.featureIndex.insert(pn,_r,kr,Dr,this.index)}},qo.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},qo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},qo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},qo.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ke),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},qo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},qo.prototype.addFeature=function(e,t,r,u){for(var f=0,v=t;f<v.length;f+=1)for(var S=0,P=v[f];S<P.length;S+=1){var V=P[S],ee=V.x,he=V.y;if(!(ee<0||ee>=8192||he<0||he>=8192)){var _e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),Ce=_e.vertexLength;Qo(this.layoutVertexArray,ee,he,-1,-1),Qo(this.layoutVertexArray,ee,he,1,-1),Qo(this.layoutVertexArray,ee,he,1,1),Qo(this.layoutVertexArray,ee,he,-1,1),this.indexArray.emplaceBack(Ce,Ce+1,Ce+2),this.indexArray.emplaceBack(Ce,Ce+3,Ce+2),_e.vertexLength+=4,_e.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},u)},In("CircleBucket",qo,{omit:["layers"]});var Gl=new vo({"circle-sort-key":new jn(Xe.layout_circle["circle-sort-key"])}),hs={paint:new vo({"circle-radius":new jn(Xe.paint_circle["circle-radius"]),"circle-color":new jn(Xe.paint_circle["circle-color"]),"circle-blur":new jn(Xe.paint_circle["circle-blur"]),"circle-opacity":new jn(Xe.paint_circle["circle-opacity"]),"circle-translate":new Jn(Xe.paint_circle["circle-translate"]),"circle-translate-anchor":new Jn(Xe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Jn(Xe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Jn(Xe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new jn(Xe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new jn(Xe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new jn(Xe.paint_circle["circle-stroke-opacity"])}),layout:Gl},Do=typeof Float32Array!="undefined"?Float32Array:Array;function No(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ho(e,t,r){var u=t[0],f=t[1],v=t[2],S=t[3],P=t[4],V=t[5],ee=t[6],he=t[7],_e=t[8],Ce=t[9],ut=t[10],Pt=t[11],St=t[12],Yt=t[13],Wt=t[14],ir=t[15],yr=r[0],_r=r[1],kr=r[2],Dr=r[3];return e[0]=yr*u+_r*P+kr*_e+Dr*St,e[1]=yr*f+_r*V+kr*Ce+Dr*Yt,e[2]=yr*v+_r*ee+kr*ut+Dr*Wt,e[3]=yr*S+_r*he+kr*Pt+Dr*ir,e[4]=(yr=r[4])*u+(_r=r[5])*P+(kr=r[6])*_e+(Dr=r[7])*St,e[5]=yr*f+_r*V+kr*Ce+Dr*Yt,e[6]=yr*v+_r*ee+kr*ut+Dr*Wt,e[7]=yr*S+_r*he+kr*Pt+Dr*ir,e[8]=(yr=r[8])*u+(_r=r[9])*P+(kr=r[10])*_e+(Dr=r[11])*St,e[9]=yr*f+_r*V+kr*Ce+Dr*Yt,e[10]=yr*v+_r*ee+kr*ut+Dr*Wt,e[11]=yr*S+_r*he+kr*Pt+Dr*ir,e[12]=(yr=r[12])*u+(_r=r[13])*P+(kr=r[14])*_e+(Dr=r[15])*St,e[13]=yr*f+_r*V+kr*Ce+Dr*Yt,e[14]=yr*v+_r*ee+kr*ut+Dr*Wt,e[15]=yr*S+_r*he+kr*Pt+Dr*ir,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,r=arguments.length;r--;)t+=e[r]*e[r];return Math.sqrt(t)});var _o,uo=Ho;function Ls(e,t,r){var u=t[0],f=t[1],v=t[2],S=t[3];return e[0]=r[0]*u+r[4]*f+r[8]*v+r[12]*S,e[1]=r[1]*u+r[5]*f+r[9]*v+r[13]*S,e[2]=r[2]*u+r[6]*f+r[10]*v+r[14]*S,e[3]=r[3]*u+r[7]*f+r[11]*v+r[15]*S,e}_o=new Do(3),Do!=Float32Array&&(_o[0]=0,_o[1]=0,_o[2]=0),function(){var e=new Do(4);Do!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var nu=(function(){var e=new Do(2);Do!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(r){e.call(this,r,hs)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new qo(r)},t.prototype.queryRadius=function(r){var u=r;return fs("circle-radius",this,u)+fs("circle-stroke-width",this,u)+ao(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(r,u,f,v,S,P,V,ee){for(var he=Yu(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),P.angle,V),_e=this.paint.get("circle-radius").evaluate(u,f)+this.paint.get("circle-stroke-width").evaluate(u,f),Ce=this.paint.get("circle-pitch-alignment")==="map",ut=Ce?he:function(pn,fn){return pn.map(function(Rn){return Hl(Rn,fn)})}(he,ee),Pt=Ce?_e*V:_e,St=0,Yt=v;St<Yt.length;St+=1)for(var Wt=0,ir=Yt[St];Wt<ir.length;Wt+=1){var yr=ir[Wt],_r=Ce?yr:Hl(yr,ee),kr=Pt,Dr=Ls([],[yr.x,yr.y,0,1],ee);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?kr*=Dr[3]/P.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(kr*=P.cameraToCenterDistance/Dr[3]),Mu(ut,_r,kr))return!0}return!1},t}(Ss));function Hl(e,t){var r=Ls([],[e.x,e.y,0,1],t);return new te(r[0]/r[3],r[1]/r[3])}var Gc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(qo);function dl(e,t,r,u){var f=t.width,v=t.height;if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==f*v*r)throw new RangeError("mismatched image size")}else u=new Uint8Array(f*v*r);return e.width=f,e.height=v,e.data=u,e}function lc(e,t,r){var u=t.width,f=t.height;if(u!==e.width||f!==e.height){var v=dl({},{width:u,height:f},r);pl(e,v,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,u),height:Math.min(e.height,f)},r),e.width=u,e.height=f,e.data=v.data}}function pl(e,t,r,u,f,v){if(f.width===0||f.height===0)return t;if(f.width>e.width||f.height>e.height||r.x>e.width-f.width||r.y>e.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||u.x>t.width-f.width||u.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");for(var S=e.data,P=t.data,V=0;V<f.height;V++)for(var ee=((r.y+V)*e.width+r.x)*v,he=((u.y+V)*t.width+u.x)*v,_e=0;_e<f.width*v;_e++)P[he+_e]=S[ee+_e];return t}In("HeatmapBucket",Gc,{omit:["layers"]});var Rs=function(t,r){dl(this,t,1,r)};Rs.prototype.resize=function(e){lc(this,e,1)},Rs.prototype.clone=function(){return new Rs({width:this.width,height:this.height},new Uint8Array(this.data))},Rs.copy=function(e,t,r,u,f){pl(e,t,r,u,f,1)};var go=function(t,r){dl(this,t,4,r)};go.prototype.resize=function(e){lc(this,e,4)},go.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},go.prototype.clone=function(){return new go({width:this.width,height:this.height},new Uint8Array(this.data))},go.copy=function(e,t,r,u,f){pl(e,t,r,u,f,4)},In("AlphaImage",Rs),In("RGBAImage",go);var Ac={paint:new vo({"heatmap-radius":new jn(Xe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new jn(Xe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Jn(Xe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Io(Xe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Jn(Xe.paint_heatmap["heatmap-opacity"])})};function ds(e){var t={},r=e.resolution||256,u=e.clips?e.clips.length:1,f=e.image||new go({width:r,height:u}),v=function(St,Yt,Wt){t[e.evaluationKey]=Wt;var ir=e.expression.evaluate(t);f.data[St+Yt+0]=Math.floor(255*ir.r/ir.a),f.data[St+Yt+1]=Math.floor(255*ir.g/ir.a),f.data[St+Yt+2]=Math.floor(255*ir.b/ir.a),f.data[St+Yt+3]=Math.floor(255*ir.a)};if(e.clips)for(var S=0,P=0;S<u;++S,P+=4*r)for(var V=0,ee=0;V<r;V++,ee+=4){var he=V/(r-1),_e=e.clips[S];v(P,ee,_e.start*(1-he)+_e.end*he)}else for(var Ce=0,ut=0;Ce<r;Ce++,ut+=4)v(0,ut,Ce/(r-1));return f}var sf=function(e){function t(r){e.call(this,r,Ac),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Gc(r)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=ds({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(Ss),Cf={paint:new vo({"hillshade-illumination-direction":new Jn(Xe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Jn(Xe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Jn(Xe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Jn(Xe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Jn(Xe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Jn(Xe.paint_hillshade["hillshade-accent-color"])})},wf=function(e){function t(r){e.call(this,r,Cf)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(Ss),Cc=no([{name:"a_pos",components:2,type:"Int16"}],4).members,Ku=uf,Ef=uf;function uf(e,t,r){r=r||2;var u,f,v,S,P,V,ee,he=t&&t.length,_e=he?t[0]*r:e.length,Ce=Of(e,0,_e,r,!0),ut=[];if(!Ce||Ce.next===Ce.prev)return ut;if(he&&(Ce=function(St,Yt,Wt,ir){var yr,_r,kr,Dr=[];for(yr=0,_r=Yt.length;yr<_r;yr++)(kr=Of(St,Yt[yr]*ir,yr<_r-1?Yt[yr+1]*ir:St.length,ir,!1))===kr.next&&(kr.steiner=!0),Dr.push(rh(kr));for(Dr.sort(qf),yr=0;yr<Dr.length;yr++)eh(Dr[yr],Wt),Wt=Ru(Wt,Wt.next);return Wt}(e,t,Ce,r)),e.length>80*r){u=v=e[0],f=S=e[1];for(var Pt=r;Pt<_e;Pt+=r)(P=e[Pt])<u&&(u=P),(V=e[Pt+1])<f&&(f=V),P>v&&(v=P),V>S&&(S=V);ee=(ee=Math.max(v-u,S-f))!==0?1/ee:0}return cc(Ce,ut,r,u,f,ee),ut}function Of(e,t,r,u,f){var v,S;if(f===Wc(e,t,r,u)>0)for(v=t;v<r;v+=u)S=Nf(v,e[v],e[v+1],S);else for(v=r-u;v>=t;v-=u)S=Nf(v,e[v],e[v+1],S);return S&&fc(S,S.next)&&(Zc(S),S=S.next),S}function Ru(e,t){if(!e)return e;t||(t=e);var r,u=e;do if(r=!1,u.steiner||!fc(u,u.next)&&io(u.prev,u,u.next)!==0)u=u.next;else{if(Zc(u),(u=t=u.prev)===u.next)break;r=!0}while(r||u!==t);return t}function cc(e,t,r,u,f,v,S){if(e){!S&&v&&function(he,_e,Ce,ut){var Pt=he;do Pt.z===null&&(Pt.z=Mf(Pt.x,Pt.y,_e,Ce,ut)),Pt.prevZ=Pt.prev,Pt.nextZ=Pt.next,Pt=Pt.next;while(Pt!==he);Pt.prevZ.nextZ=null,Pt.prevZ=null,function(St){var Yt,Wt,ir,yr,_r,kr,Dr,pn,fn=1;do{for(Wt=St,St=null,_r=null,kr=0;Wt;){for(kr++,ir=Wt,Dr=0,Yt=0;Yt<fn&&(Dr++,ir=ir.nextZ);Yt++);for(pn=fn;Dr>0||pn>0&&ir;)Dr!==0&&(pn===0||!ir||Wt.z<=ir.z)?(yr=Wt,Wt=Wt.nextZ,Dr--):(yr=ir,ir=ir.nextZ,pn--),_r?_r.nextZ=yr:St=yr,yr.prevZ=_r,_r=yr;Wt=ir}_r.nextZ=null,fn*=2}while(kr>1)}(Pt)}(e,u,f,v);for(var P,V,ee=e;e.prev!==e.next;)if(P=e.prev,V=e.next,v?Hc(e,u,f,v):Df(e))t.push(P.i/r),t.push(e.i/r),t.push(V.i/r),Zc(e),e=V.next,ee=V.next;else if((e=V)===ee){S?S===1?cc(e=wc(Ru(e),t,r),t,r,u,f,v,2):S===2&&Qf(e,t,r,u,f,v):cc(Ru(e),t,r,u,f,v,1);break}}}function Df(e){var t=e.prev,r=e,u=e.next;if(io(t,r,u)>=0)return!1;for(var f=e.next.next;f!==e.prev;){if(Zl(t.x,t.y,r.x,r.y,u.x,u.y,f.x,f.y)&&io(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Hc(e,t,r,u){var f=e.prev,v=e,S=e.next;if(io(f,v,S)>=0)return!1;for(var P=f.x>v.x?f.x>S.x?f.x:S.x:v.x>S.x?v.x:S.x,V=f.y>v.y?f.y>S.y?f.y:S.y:v.y>S.y?v.y:S.y,ee=Mf(f.x<v.x?f.x<S.x?f.x:S.x:v.x<S.x?v.x:S.x,f.y<v.y?f.y<S.y?f.y:S.y:v.y<S.y?v.y:S.y,t,r,u),he=Mf(P,V,t,r,u),_e=e.prevZ,Ce=e.nextZ;_e&&_e.z>=ee&&Ce&&Ce.z<=he;){if(_e!==e.prev&&_e!==e.next&&Zl(f.x,f.y,v.x,v.y,S.x,S.y,_e.x,_e.y)&&io(_e.prev,_e,_e.next)>=0)return!1;if(_e=_e.prevZ,Ce!==e.prev&&Ce!==e.next&&Zl(f.x,f.y,v.x,v.y,S.x,S.y,Ce.x,Ce.y)&&io(Ce.prev,Ce,Ce.next)>=0)return!1;Ce=Ce.nextZ}for(;_e&&_e.z>=ee;){if(_e!==e.prev&&_e!==e.next&&Zl(f.x,f.y,v.x,v.y,S.x,S.y,_e.x,_e.y)&&io(_e.prev,_e,_e.next)>=0)return!1;_e=_e.prevZ}for(;Ce&&Ce.z<=he;){if(Ce!==e.prev&&Ce!==e.next&&Zl(f.x,f.y,v.x,v.y,S.x,S.y,Ce.x,Ce.y)&&io(Ce.prev,Ce,Ce.next)>=0)return!1;Ce=Ce.nextZ}return!0}function wc(e,t,r){var u=e;do{var f=u.prev,v=u.next.next;!fc(f,v)&&Tf(f,u,u.next,v)&&wl(f,v)&&wl(v,f)&&(t.push(f.i/r),t.push(u.i/r),t.push(v.i/r),Zc(u),Zc(u.next),u=e=v),u=u.next}while(u!==e);return Ru(u)}function Qf(e,t,r,u,f,v){var S=e;do{for(var P=S.next.next;P!==S.prev;){if(S.i!==P.i&&lf(S,P)){var V=_f(S,P);return S=Ru(S,S.next),V=Ru(V,V.next),cc(S,t,r,u,f,v),void cc(V,t,r,u,f,v)}P=P.next}S=S.next}while(S!==e)}function qf(e,t){return e.x-t.x}function eh(e,t){if(t=function(u,f){var v,S=f,P=u.x,V=u.y,ee=-1/0;do{if(V<=S.y&&V>=S.next.y&&S.next.y!==S.y){var he=S.x+(V-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(he<=P&&he>ee){if(ee=he,he===P){if(V===S.y)return S;if(V===S.next.y)return S.next}v=S.x<S.next.x?S:S.next}}S=S.next}while(S!==f);if(!v)return null;if(P===ee)return v;var _e,Ce=v,ut=v.x,Pt=v.y,St=1/0;S=v;do P>=S.x&&S.x>=ut&&P!==S.x&&Zl(V<Pt?P:ee,V,ut,Pt,V<Pt?ee:P,V,S.x,S.y)&&(_e=Math.abs(V-S.y)/(P-S.x),wl(S,u)&&(_e<St||_e===St&&(S.x>v.x||S.x===v.x&&th(v,S)))&&(v=S,St=_e)),S=S.next;while(S!==Ce);return v}(e,t)){var r=_f(t,e);Ru(t,t.next),Ru(r,r.next)}}function th(e,t){return io(e.prev,e,t.prev)<0&&io(t.next,e,e.next)<0}function Mf(e,t,r,u,f){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*f)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-u)*f)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function rh(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function Zl(e,t,r,u,f,v,S,P){return(f-S)*(t-P)-(e-S)*(v-P)>=0&&(e-S)*(u-P)-(r-S)*(t-P)>=0&&(r-S)*(v-P)-(f-S)*(u-P)>=0}function lf(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(r,u){var f=r;do{if(f.i!==r.i&&f.next.i!==r.i&&f.i!==u.i&&f.next.i!==u.i&&Tf(f,f.next,r,u))return!0;f=f.next}while(f!==r);return!1}(e,t)&&(wl(e,t)&&wl(t,e)&&function(r,u){var f=r,v=!1,S=(r.x+u.x)/2,P=(r.y+u.y)/2;do f.y>P!=f.next.y>P&&f.next.y!==f.y&&S<(f.next.x-f.x)*(P-f.y)/(f.next.y-f.y)+f.x&&(v=!v),f=f.next;while(f!==r);return v}(e,t)&&(io(e.prev,e,t.prev)||io(e,t.prev,t))||fc(e,t)&&io(e.prev,e,e.next)>0&&io(t.prev,t,t.next)>0)}function io(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function fc(e,t){return e.x===t.x&&e.y===t.y}function Tf(e,t,r,u){var f=au(io(e,t,r)),v=au(io(e,t,u)),S=au(io(r,u,e)),P=au(io(r,u,t));return f!==v&&S!==P||!(f!==0||!Oc(e,r,t))||!(v!==0||!Oc(e,u,t))||!(S!==0||!Oc(r,e,u))||!(P!==0||!Oc(r,t,u))}function Oc(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function au(e){return e>0?1:e<0?-1:0}function wl(e,t){return io(e.prev,e,e.next)<0?io(e,t,e.next)>=0&&io(e,e.prev,t)>=0:io(e,t,e.prev)<0||io(e,e.next,t)<0}function _f(e,t){var r=new cf(e.i,e.x,e.y),u=new cf(t.i,t.x,t.y),f=e.next,v=t.prev;return e.next=t,t.prev=e,r.next=f,f.prev=r,u.next=r,r.prev=u,v.next=u,u.prev=v,u}function Nf(e,t,r,u){var f=new cf(e,t,r);return u?(f.next=u.next,f.prev=u,u.next.prev=f,u.next=f):(f.prev=f,f.next=f),f}function Zc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function cf(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Wc(e,t,r,u){for(var f=0,v=t,S=r-u;v<r;v+=u)f+=(e[S]-e[v])*(e[v+1]+e[S+1]),S=v;return f}function ml(e,t,r,u,f){!function v(S,P,V,ee,he){for(;ee>V;){if(ee-V>600){var _e=ee-V+1,Ce=P-V+1,ut=Math.log(_e),Pt=.5*Math.exp(2*ut/3),St=.5*Math.sqrt(ut*Pt*(_e-Pt)/_e)*(Ce-_e/2<0?-1:1);v(S,P,Math.max(V,Math.floor(P-Ce*Pt/_e+St)),Math.min(ee,Math.floor(P+(_e-Ce)*Pt/_e+St)),he)}var Yt=S[P],Wt=V,ir=ee;for(re(S,V,P),he(S[ee],Yt)>0&&re(S,V,ee);Wt<ir;){for(re(S,Wt,ir),Wt++,ir--;he(S[Wt],Yt)<0;)Wt++;for(;he(S[ir],Yt)>0;)ir--}he(S[V],Yt)===0?re(S,V,ir):re(S,++ir,ee),ir<=P&&(V=ir+1),P<=ir&&(ee=ir-1)}}(e,t,r||0,u||e.length-1,f||se)}function re(e,t,r){var u=e[t];e[t]=e[r],e[r]=u}function se(e,t){return e<t?-1:e>t?1:0}function N(e,t){var r=e.length;if(r<=1)return[e];for(var u,f,v=[],S=0;S<r;S++){var P=Zt(e[S]);P!==0&&(e[S].area=Math.abs(P),f===void 0&&(f=P<0),f===P<0?(u&&v.push(u),u=[e[S]]):u.push(e[S]))}if(u&&v.push(u),t>1)for(var V=0;V<v.length;V++)v[V].length<=t||(ml(v[V],t,1,v[V].length-1,G),v[V]=v[V].slice(0,t));return v}function G(e,t){return t.area-e.area}function Ae(e,t,r){for(var u=r.patternDependencies,f=!1,v=0,S=t;v<S.length;v+=1){var P=S[v].paint.get(e+"-pattern");P.isConstant()||(f=!0);var V=P.constantOr(null);V&&(f=!0,u[V.to]=!0,u[V.from]=!0)}return f}function ct(e,t,r,u,f){for(var v=f.patternDependencies,S=0,P=t;S<P.length;S+=1){var V=P[S],ee=V.paint.get(e+"-pattern").value;if(ee.kind!=="constant"){var he=ee.evaluate({zoom:u-1},r,{},f.availableImages),_e=ee.evaluate({zoom:u},r,{},f.availableImages),Ce=ee.evaluate({zoom:u+1},r,{},f.availableImages);_e=_e&&_e.name?_e.name:_e,Ce=Ce&&Ce.name?Ce.name:Ce,v[he=he&&he.name?he.name:he]=!0,v[_e]=!0,v[Ce]=!0,r.patterns[V.id]={min:he,mid:_e,max:Ce}}}return r}uf.deviation=function(e,t,r,u){var f=t&&t.length,v=Math.abs(Wc(e,0,f?t[0]*r:e.length,r));if(f)for(var S=0,P=t.length;S<P;S++)v-=Math.abs(Wc(e,t[S]*r,S<P-1?t[S+1]*r:e.length,r));var V=0;for(S=0;S<u.length;S+=3){var ee=u[S]*r,he=u[S+1]*r,_e=u[S+2]*r;V+=Math.abs((e[ee]-e[_e])*(e[he+1]-e[ee+1])-(e[ee]-e[he])*(e[_e+1]-e[ee+1]))}return v===0&&V===0?0:Math.abs((V-v)/v)},uf.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},u=0,f=0;f<e.length;f++){for(var v=0;v<e[f].length;v++)for(var S=0;S<t;S++)r.vertices.push(e[f][v][S]);f>0&&r.holes.push(u+=e[f-1].length)}return r},Ku.default=Ef;var Xt=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new mu,this.indexArray=new Cl,this.indexArray2=new ac,this.programConfigurations=new La(t.layers,t.zoom),this.segments=new tt,this.segments2=new tt,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};Xt.prototype.populate=function(e,t,r){this.hasPattern=Ae("fill",this.layers,t);for(var u=this.layers[0].layout.get("fill-sort-key"),f=[],v=0,S=e;v<S.length;v+=1){var P=S[v],V=P.feature,ee=P.id,he=P.index,_e=P.sourceLayerIndex,Ce=this.layers[0]._featureFilter.needGeometry,ut=Ui(V,Ce);if(this.layers[0]._featureFilter.filter(new Pa(this.zoom),ut,r)){var Pt=u?u.evaluate(ut,{},r,t.availableImages):void 0,St={id:ee,properties:V.properties,type:V.type,sourceLayerIndex:_e,index:he,geometry:Ce?ut.geometry:gi(V),patterns:{},sortKey:Pt};f.push(St)}}u&&f.sort(function(pn,fn){return pn.sortKey-fn.sortKey});for(var Yt=0,Wt=f;Yt<Wt.length;Yt+=1){var ir=Wt[Yt],yr=ir.geometry,_r=ir.index,kr=ir.sourceLayerIndex;if(this.hasPattern){var Dr=ct("fill",this.layers,ir,this.zoom,t);this.patternFeatures.push(Dr)}else this.addFeature(ir,yr,_r,r,{});t.featureIndex.insert(e[_r].feature,yr,_r,kr,this.index)}},Xt.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Xt.prototype.addFeatures=function(e,t,r){for(var u=0,f=this.patternFeatures;u<f.length;u+=1){var v=f[u];this.addFeature(v,v.geometry,v.index,t,r)}},Xt.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Xt.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Xt.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Cc),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Xt.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Xt.prototype.addFeature=function(e,t,r,u,f){for(var v=0,S=N(t,500);v<S.length;v+=1){for(var P=S[v],V=0,ee=0,he=P;ee<he.length;ee+=1)V+=he[ee].length;for(var _e=this.segments.prepareSegment(V,this.layoutVertexArray,this.indexArray),Ce=_e.vertexLength,ut=[],Pt=[],St=0,Yt=P;St<Yt.length;St+=1){var Wt=Yt[St];if(Wt.length!==0){Wt!==P[0]&&Pt.push(ut.length/2);var ir=this.segments2.prepareSegment(Wt.length,this.layoutVertexArray,this.indexArray2),yr=ir.vertexLength;this.layoutVertexArray.emplaceBack(Wt[0].x,Wt[0].y),this.indexArray2.emplaceBack(yr+Wt.length-1,yr),ut.push(Wt[0].x),ut.push(Wt[0].y);for(var _r=1;_r<Wt.length;_r++)this.layoutVertexArray.emplaceBack(Wt[_r].x,Wt[_r].y),this.indexArray2.emplaceBack(yr+_r-1,yr+_r),ut.push(Wt[_r].x),ut.push(Wt[_r].y);ir.vertexLength+=Wt.length,ir.primitiveLength+=Wt.length}}for(var kr=Ku(ut,Pt),Dr=0;Dr<kr.length;Dr+=3)this.indexArray.emplaceBack(Ce+kr[Dr],Ce+kr[Dr+1],Ce+kr[Dr+2]);_e.vertexLength+=V,_e.primitiveLength+=kr.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,u)},In("FillBucket",Xt,{omit:["layers","patternFeatures"]});var sr=new vo({"fill-sort-key":new jn(Xe.layout_fill["fill-sort-key"])}),or={paint:new vo({"fill-antialias":new Jn(Xe.paint_fill["fill-antialias"]),"fill-opacity":new jn(Xe.paint_fill["fill-opacity"]),"fill-color":new jn(Xe.paint_fill["fill-color"]),"fill-outline-color":new jn(Xe.paint_fill["fill-outline-color"]),"fill-translate":new Jn(Xe.paint_fill["fill-translate"]),"fill-translate-anchor":new Jn(Xe.paint_fill["fill-translate-anchor"]),"fill-pattern":new _c(Xe.paint_fill["fill-pattern"])}),layout:sr},Ir=function(e){function t(r){e.call(this,r,or)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,u){e.prototype.recalculate.call(this,r,u);var f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(r){return new Xt(r)},t.prototype.queryRadius=function(){return ao(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(r,u,f,v,S,P,V){return cs(Yu(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),P.angle,V),v)},t.prototype.isTileClipped=function(){return!0},t}(Ss),an=no([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Gn=ea;function ea(e,t,r,u,f){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=u,this._values=f,e.readFields(la,this,t)}function la(e,t,r){e==1?t.id=r.readVarint():e==2?function(u,f){for(var v=u.readVarint()+u.pos;u.pos<v;){var S=f._keys[u.readVarint()],P=f._values[u.readVarint()];f.properties[S]=P}}(r,t):e==3?t.type=r.readVarint():e==4&&(t._geometry=r.pos)}function qa(e){for(var t,r,u=0,f=0,v=e.length,S=v-1;f<v;S=f++)u+=((r=e[S]).x-(t=e[f]).x)*(t.y+r.y);return u}ea.types=["Unknown","Point","LineString","Polygon"],ea.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,u=1,f=0,v=0,S=0,P=[];e.pos<r;){if(f<=0){var V=e.readVarint();u=7&V,f=V>>3}if(f--,u===1||u===2)v+=e.readSVarint(),S+=e.readSVarint(),u===1&&(t&&P.push(t),t=[]),t.push(new te(v,S));else{if(u!==7)throw new Error("unknown command "+u);t&&t.push(t[0].clone())}}return t&&P.push(t),P},ea.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,u=0,f=0,v=0,S=1/0,P=-1/0,V=1/0,ee=-1/0;e.pos<t;){if(u<=0){var he=e.readVarint();r=7&he,u=he>>3}if(u--,r===1||r===2)(f+=e.readSVarint())<S&&(S=f),f>P&&(P=f),(v+=e.readSVarint())<V&&(V=v),v>ee&&(ee=v);else if(r!==7)throw new Error("unknown command "+r)}return[S,V,P,ee]},ea.prototype.toGeoJSON=function(e,t,r){var u,f,v=this.extent*Math.pow(2,r),S=this.extent*e,P=this.extent*t,V=this.loadGeometry(),ee=ea.types[this.type];function he(ut){for(var Pt=0;Pt<ut.length;Pt++){var St=ut[Pt];ut[Pt]=[360*(St.x+S)/v-180,360/Math.PI*Math.atan(Math.exp((180-360*(St.y+P)/v)*Math.PI/180))-90]}}switch(this.type){case 1:var _e=[];for(u=0;u<V.length;u++)_e[u]=V[u][0];he(V=_e);break;case 2:for(u=0;u<V.length;u++)he(V[u]);break;case 3:for(V=function(ut){var Pt=ut.length;if(Pt<=1)return[ut];for(var St,Yt,Wt=[],ir=0;ir<Pt;ir++){var yr=qa(ut[ir]);yr!==0&&(Yt===void 0&&(Yt=yr<0),Yt===yr<0?(St&&Wt.push(St),St=[ut[ir]]):St.push(ut[ir]))}return St&&Wt.push(St),Wt}(V),u=0;u<V.length;u++)for(f=0;f<V[u].length;f++)he(V[u][f])}V.length===1?V=V[0]:ee="Multi"+ee;var Ce={type:"Feature",geometry:{type:ee,coordinates:V},properties:this.properties};return"id"in this&&(Ce.id=this.id),Ce};var Fa=yi;function yi(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Ja,this,t),this.length=this._features.length}function Ja(e,t,r){e===15?t.version=r.readVarint():e===1?t.name=r.readString():e===5?t.extent=r.readVarint():e===2?t._features.push(r.pos):e===3?t._keys.push(r.readString()):e===4&&t._values.push(function(u){for(var f=null,v=u.readVarint()+u.pos;u.pos<v;){var S=u.readVarint()>>3;f=S===1?u.readString():S===2?u.readFloat():S===3?u.readDouble():S===4?u.readVarint64():S===5?u.readVarint():S===6?u.readSVarint():S===7?u.readBoolean():null}return f}(r))}function Bi(e,t,r){if(e===3){var u=new Fa(r,r.readVarint()+r.pos);u.length&&(t[u.name]=u)}}yi.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new Gn(this._pbf,t,this.extent,this._keys,this._values)};var So={VectorTile:function(t,r){this.layers=t.readFields(Bi,{},r)},VectorTileFeature:Gn,VectorTileLayer:Fa},yo=So.VectorTileFeature.types,Hi=Math.pow(2,13);function ko(e,t,r,u,f,v,S,P){e.emplaceBack(t,r,2*Math.floor(u*Hi)+S,f*Hi*2,v*Hi*2,Math.round(P))}var Qa=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Ou,this.indexArray=new Cl,this.programConfigurations=new La(t.layers,t.zoom),this.segments=new tt,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function lo(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}Qa.prototype.populate=function(e,t,r){this.features=[],this.hasPattern=Ae("fill-extrusion",this.layers,t);for(var u=0,f=e;u<f.length;u+=1){var v=f[u],S=v.feature,P=v.id,V=v.index,ee=v.sourceLayerIndex,he=this.layers[0]._featureFilter.needGeometry,_e=Ui(S,he);if(this.layers[0]._featureFilter.filter(new Pa(this.zoom),_e,r)){var Ce={id:P,sourceLayerIndex:ee,index:V,geometry:he?_e.geometry:gi(S),properties:S.properties,type:S.type,patterns:{}};this.hasPattern?this.features.push(ct("fill-extrusion",this.layers,Ce,this.zoom,t)):this.addFeature(Ce,Ce.geometry,V,r,{}),t.featureIndex.insert(S,Ce.geometry,V,ee,this.index,!0)}}},Qa.prototype.addFeatures=function(e,t,r){for(var u=0,f=this.features;u<f.length;u+=1){var v=f[u];this.addFeature(v,v.geometry,v.index,t,r)}},Qa.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Qa.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Qa.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Qa.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,an),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Qa.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Qa.prototype.addFeature=function(e,t,r,u,f){for(var v=0,S=N(t,500);v<S.length;v+=1){for(var P=S[v],V=0,ee=0,he=P;ee<he.length;ee+=1)V+=he[ee].length;for(var _e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),Ce=0,ut=P;Ce<ut.length;Ce+=1){var Pt=ut[Ce];if(Pt.length!==0&&!(($a=Pt).every(function(Na){return Na.x<0})||$a.every(function(Na){return Na.x>8192})||$a.every(function(Na){return Na.y<0})||$a.every(function(Na){return Na.y>8192})))for(var St=0,Yt=0;Yt<Pt.length;Yt++){var Wt=Pt[Yt];if(Yt>=1){var ir=Pt[Yt-1];if(!lo(Wt,ir)){_e.vertexLength+4>tt.MAX_VERTEX_ARRAY_LENGTH&&(_e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var yr=Wt.sub(ir)._perp()._unit(),_r=ir.dist(Wt);St+_r>32768&&(St=0),ko(this.layoutVertexArray,Wt.x,Wt.y,yr.x,yr.y,0,0,St),ko(this.layoutVertexArray,Wt.x,Wt.y,yr.x,yr.y,0,1,St),ko(this.layoutVertexArray,ir.x,ir.y,yr.x,yr.y,0,0,St+=_r),ko(this.layoutVertexArray,ir.x,ir.y,yr.x,yr.y,0,1,St);var kr=_e.vertexLength;this.indexArray.emplaceBack(kr,kr+2,kr+1),this.indexArray.emplaceBack(kr+1,kr+2,kr+3),_e.vertexLength+=4,_e.primitiveLength+=2}}}}if(_e.vertexLength+V>tt.MAX_VERTEX_ARRAY_LENGTH&&(_e=this.segments.prepareSegment(V,this.layoutVertexArray,this.indexArray)),yo[e.type]==="Polygon"){for(var Dr=[],pn=[],fn=_e.vertexLength,Rn=0,Qn=P;Rn<Qn.length;Rn+=1){var Xn=Qn[Rn];if(Xn.length!==0){Xn!==P[0]&&pn.push(Dr.length/2);for(var Nn=0;Nn<Xn.length;Nn++){var Ea=Xn[Nn];ko(this.layoutVertexArray,Ea.x,Ea.y,0,0,1,1,0),Dr.push(Ea.x),Dr.push(Ea.y)}}}for(var ca=Ku(Dr,pn),ra=0;ra<ca.length;ra+=3)this.indexArray.emplaceBack(fn+ca[ra],fn+ca[ra+2],fn+ca[ra+1]);_e.primitiveLength+=ca.length/3,_e.vertexLength+=V}}var $a;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,u)},In("FillExtrusionBucket",Qa,{omit:["layers","features"]});var iu={paint:new vo({"fill-extrusion-opacity":new Jn(Xe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new jn(Xe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Jn(Xe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Jn(Xe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new _c(Xe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new jn(Xe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new jn(Xe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Jn(Xe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},bi=function(e){function t(r){e.call(this,r,iu)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Qa(r)},t.prototype.queryRadius=function(){return ao(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(r,u,f,v,S,P,V,ee){var he=Yu(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),P.angle,V),_e=this.paint.get("fill-extrusion-height").evaluate(u,f),Ce=this.paint.get("fill-extrusion-base").evaluate(u,f),ut=function(St,Yt,Wt,ir){for(var yr=[],_r=0,kr=St;_r<kr.length;_r+=1){var Dr=kr[_r],pn=[Dr.x,Dr.y,0,1];Ls(pn,pn,Yt),yr.push(new te(pn[0]/pn[3],pn[1]/pn[3]))}return yr}(he,ee),Pt=function(St,Yt,Wt,ir){for(var yr=[],_r=[],kr=ir[8]*Yt,Dr=ir[9]*Yt,pn=ir[10]*Yt,fn=ir[11]*Yt,Rn=ir[8]*Wt,Qn=ir[9]*Wt,Xn=ir[10]*Wt,Nn=ir[11]*Wt,Ea=0,ca=St;Ea<ca.length;Ea+=1){for(var ra=[],$a=[],Na=0,ki=ca[Ea];Na<ki.length;Na+=1){var ma=ki[Na],ri=ma.x,Fo=ma.y,mi=ir[0]*ri+ir[4]*Fo+ir[12],zo=ir[1]*ri+ir[5]*Fo+ir[13],Uo=ir[2]*ri+ir[6]*Fo+ir[14],ts=ir[3]*ri+ir[7]*Fo+ir[15],bu=Uo+pn,rs=ts+fn,$u=mi+Rn,su=zo+Qn,Ju=Uo+Xn,uu=ts+Nn,Ws=new te((mi+kr)/rs,(zo+Dr)/rs);Ws.z=bu/rs,ra.push(Ws);var lu=new te($u/uu,su/uu);lu.z=Ju/uu,$a.push(lu)}yr.push(ra),_r.push($a)}return[yr,_r]}(v,Ce,_e,ee);return function(St,Yt,Wt){var ir=1/0;cs(Wt,Yt)&&(ir=xa(Wt,Yt[0]));for(var yr=0;yr<Yt.length;yr++)for(var _r=Yt[yr],kr=St[yr],Dr=0;Dr<_r.length-1;Dr++){var pn=_r[Dr],fn=[pn,_r[Dr+1],kr[Dr+1],kr[Dr],pn];vu(Wt,fn)&&(ir=Math.min(ir,xa(Wt,fn)))}return ir!==1/0&&ir}(Pt[0],Pt[1],ut)},t}(Ss);function Ni(e,t){return e.x*t.x+e.y*t.y}function xa(e,t){if(e.length===1){for(var r,u=0,f=t[u++];!r||f.equals(r);)if(!(r=t[u++]))return 1/0;for(;u<t.length;u++){var v=t[u],S=e[0],P=r.sub(f),V=v.sub(f),ee=S.sub(f),he=Ni(P,P),_e=Ni(P,V),Ce=Ni(V,V),ut=Ni(ee,P),Pt=Ni(ee,V),St=he*Ce-_e*_e,Yt=(Ce*ut-_e*Pt)/St,Wt=(he*Pt-_e*ut)/St,ir=f.z*(1-Yt-Wt)+r.z*Yt+v.z*Wt;if(isFinite(ir))return ir}return 1/0}for(var yr=1/0,_r=0,kr=t;_r<kr.length;_r+=1)yr=Math.min(yr,kr[_r].z);return yr}var Ao=no([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,hc=no([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,kf=So.VectorTileFeature.types,uh=Math.cos(Math.PI/180*37.5),jf=Math.pow(2,14)/.5,Iu=function(t){var r=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(u){r.gradients[u.id]={}}),this.layoutVertexArray=new Ms,this.layoutVertexArray2=new Bc,this.indexArray=new Cl,this.programConfigurations=new La(t.layers,t.zoom),this.segments=new tt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};Iu.prototype.populate=function(e,t,r){this.hasPattern=Ae("line",this.layers,t);for(var u=this.layers[0].layout.get("line-sort-key"),f=[],v=0,S=e;v<S.length;v+=1){var P=S[v],V=P.feature,ee=P.id,he=P.index,_e=P.sourceLayerIndex,Ce=this.layers[0]._featureFilter.needGeometry,ut=Ui(V,Ce);if(this.layers[0]._featureFilter.filter(new Pa(this.zoom),ut,r)){var Pt=u?u.evaluate(ut,{},r):void 0,St={id:ee,properties:V.properties,type:V.type,sourceLayerIndex:_e,index:he,geometry:Ce?ut.geometry:gi(V),patterns:{},sortKey:Pt};f.push(St)}}u&&f.sort(function(pn,fn){return pn.sortKey-fn.sortKey});for(var Yt=0,Wt=f;Yt<Wt.length;Yt+=1){var ir=Wt[Yt],yr=ir.geometry,_r=ir.index,kr=ir.sourceLayerIndex;if(this.hasPattern){var Dr=ct("line",this.layers,ir,this.zoom,t);this.patternFeatures.push(Dr)}else this.addFeature(ir,yr,_r,r,{});t.featureIndex.insert(e[_r].feature,yr,_r,kr,this.index)}},Iu.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Iu.prototype.addFeatures=function(e,t,r){for(var u=0,f=this.patternFeatures;u<f.length;u+=1){var v=f[u];this.addFeature(v,v.geometry,v.index,t,r)}},Iu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Iu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Iu.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,hc)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ao),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Iu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Iu.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Iu.prototype.addFeature=function(e,t,r,u,f){var v=this.layers[0].layout,S=v.get("line-join").evaluate(e,{}),P=v.get("line-cap"),V=v.get("line-miter-limit"),ee=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var he=0,_e=t;he<_e.length;he+=1)this.addLine(_e[he],e,S,P,V,ee);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,u)},Iu.prototype.addLine=function(e,t,r,u,f,v){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var S=0;S<e.length-1;S++)this.totalDistance+=e[S].dist(e[S+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var P=kf[t.type]==="Polygon",V=e.length;V>=2&&e[V-1].equals(e[V-2]);)V--;for(var ee=0;ee<V-1&&e[ee].equals(e[ee+1]);)ee++;if(!(V<(P?3:2))){r==="bevel"&&(f=1.05);var he,_e=this.overscaling<=16?122880/(512*this.overscaling):0,Ce=this.segments.prepareSegment(10*V,this.layoutVertexArray,this.indexArray),ut=void 0,Pt=void 0,St=void 0,Yt=void 0;this.e1=this.e2=-1,P&&(Yt=e[ee].sub(he=e[V-2])._unit()._perp());for(var Wt=ee;Wt<V;Wt++)if(!(Pt=Wt===V-1?P?e[ee+1]:void 0:e[Wt+1])||!e[Wt].equals(Pt)){Yt&&(St=Yt),he&&(ut=he),he=e[Wt],Yt=Pt?Pt.sub(he)._unit()._perp():St;var ir=(St=St||Yt).add(Yt);ir.x===0&&ir.y===0||ir._unit();var yr=St.x*Yt.x+St.y*Yt.y,_r=ir.x*Yt.x+ir.y*Yt.y,kr=_r!==0?1/_r:1/0,Dr=2*Math.sqrt(2-2*_r),pn=_r<uh&&ut&&Pt,fn=St.x*Yt.y-St.y*Yt.x>0;if(pn&&Wt>ee){var Rn=he.dist(ut);if(Rn>2*_e){var Qn=he.sub(he.sub(ut)._mult(_e/Rn)._round());this.updateDistance(ut,Qn),this.addCurrentVertex(Qn,St,0,0,Ce),ut=Qn}}var Xn=ut&&Pt,Nn=Xn?r:P?"butt":u;if(Xn&&Nn==="round"&&(kr<v?Nn="miter":kr<=2&&(Nn="fakeround")),Nn==="miter"&&kr>f&&(Nn="bevel"),Nn==="bevel"&&(kr>2&&(Nn="flipbevel"),kr<f&&(Nn="miter")),ut&&this.updateDistance(ut,he),Nn==="miter")ir._mult(kr),this.addCurrentVertex(he,ir,0,0,Ce);else if(Nn==="flipbevel"){if(kr>100)ir=Yt.mult(-1);else{var Ea=kr*St.add(Yt).mag()/St.sub(Yt).mag();ir._perp()._mult(Ea*(fn?-1:1))}this.addCurrentVertex(he,ir,0,0,Ce),this.addCurrentVertex(he,ir.mult(-1),0,0,Ce)}else if(Nn==="bevel"||Nn==="fakeround"){var ca=-Math.sqrt(kr*kr-1),ra=fn?ca:0,$a=fn?0:ca;if(ut&&this.addCurrentVertex(he,St,ra,$a,Ce),Nn==="fakeround")for(var Na=Math.round(180*Dr/Math.PI/20),ki=1;ki<Na;ki++){var ma=ki/Na;if(ma!==.5){var ri=ma-.5;ma+=ma*ri*(ma-1)*((1.0904+yr*(yr*(3.55645-1.43519*yr)-3.2452))*ri*ri+(.848013+yr*(.215638*yr-1.06021)))}var Fo=Yt.sub(St)._mult(ma)._add(St)._unit()._mult(fn?-1:1);this.addHalfVertex(he,Fo.x,Fo.y,!1,fn,0,Ce)}Pt&&this.addCurrentVertex(he,Yt,-ra,-$a,Ce)}else if(Nn==="butt")this.addCurrentVertex(he,ir,0,0,Ce);else if(Nn==="square"){var mi=ut?1:-1;this.addCurrentVertex(he,ir,mi,mi,Ce)}else Nn==="round"&&(ut&&(this.addCurrentVertex(he,St,0,0,Ce),this.addCurrentVertex(he,St,1,1,Ce,!0)),Pt&&(this.addCurrentVertex(he,Yt,-1,-1,Ce,!0),this.addCurrentVertex(he,Yt,0,0,Ce)));if(pn&&Wt<V-1){var zo=he.dist(Pt);if(zo>2*_e){var Uo=he.add(Pt.sub(he)._mult(_e/zo)._round());this.updateDistance(he,Uo),this.addCurrentVertex(Uo,Yt,0,0,Ce),he=Uo}}}}},Iu.prototype.addCurrentVertex=function(e,t,r,u,f,v){v===void 0&&(v=!1);var S=t.y*u-t.x,P=-t.y-t.x*u;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,v,!1,r,f),this.addHalfVertex(e,S,P,v,!0,-u,f),this.distance>jf/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,r,u,f,v))},Iu.prototype.addHalfVertex=function(e,t,r,u,f,v,S){var P=.5*(this.lineClips?this.scaledDistance*(jf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(u?1:0),(e.y<<1)+(f?1:0),Math.round(63*t)+128,Math.round(63*r)+128,1+(v===0?0:v<0?-1:1)|(63&P)<<2,P>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var V=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,V),S.primitiveLength++),f?this.e2=V:this.e1=V},Iu.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Iu.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},In("LineBucket",Iu,{omit:["layers","patternFeatures"]});var Ff=new vo({"line-cap":new Jn(Xe.layout_line["line-cap"]),"line-join":new jn(Xe.layout_line["line-join"]),"line-miter-limit":new Jn(Xe.layout_line["line-miter-limit"]),"line-round-limit":new Jn(Xe.layout_line["line-round-limit"]),"line-sort-key":new jn(Xe.layout_line["line-sort-key"])}),ff={paint:new vo({"line-opacity":new jn(Xe.paint_line["line-opacity"]),"line-color":new jn(Xe.paint_line["line-color"]),"line-translate":new Jn(Xe.paint_line["line-translate"]),"line-translate-anchor":new Jn(Xe.paint_line["line-translate-anchor"]),"line-width":new jn(Xe.paint_line["line-width"]),"line-gap-width":new jn(Xe.paint_line["line-gap-width"]),"line-offset":new jn(Xe.paint_line["line-offset"]),"line-blur":new jn(Xe.paint_line["line-blur"]),"line-dasharray":new us(Xe.paint_line["line-dasharray"]),"line-pattern":new _c(Xe.paint_line["line-pattern"]),"line-gradient":new Io(Xe.paint_line["line-gradient"])}),layout:Ff},zf=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,u){return u=new Pa(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,zoomHistory:u.zoomHistory,transition:u.transition}),e.prototype.possiblyEvaluate.call(this,r,u)},t.prototype.evaluate=function(r,u,f,v){return u=De({},u,{zoom:Math.floor(u.zoom)}),e.prototype.evaluate.call(this,r,u,f,v)},t}(jn))(ff.paint.properties["line-width"].specification);zf.useIntegerZoom=!0;var Th=function(e){function t(r){e.call(this,r,ff),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Ri,this.gradientVersion=(this.gradientVersion+1)%Ge)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(r,u){e.prototype.recalculate.call(this,r,u),this.paint._values["line-floorwidth"]=zf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)},t.prototype.createBucket=function(r){return new Iu(r)},t.prototype.queryRadius=function(r){var u=r,f=lh(fs("line-width",this,u),fs("line-gap-width",this,u)),v=fs("line-offset",this,u);return f/2+Math.abs(v)+ao(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(r,u,f,v,S,P,V){var ee=Yu(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),P.angle,V),he=V/2*lh(this.paint.get("line-width").evaluate(u,f),this.paint.get("line-gap-width").evaluate(u,f)),_e=this.paint.get("line-offset").evaluate(u,f);return _e&&(v=function(Ce,ut){for(var Pt=[],St=new te(0,0),Yt=0;Yt<Ce.length;Yt++){for(var Wt=Ce[Yt],ir=[],yr=0;yr<Wt.length;yr++){var _r=Wt[yr],kr=Wt[yr+1],Dr=yr===0?St:_r.sub(Wt[yr-1])._unit()._perp(),pn=yr===Wt.length-1?St:kr.sub(_r)._unit()._perp(),fn=Dr._add(pn)._unit();fn._mult(1/(fn.x*pn.x+fn.y*pn.y)),ir.push(fn._mult(ut)._add(_r))}Pt.push(ir)}return Pt}(v,_e*V)),function(Ce,ut,Pt){for(var St=0;St<ut.length;St++){var Yt=ut[St];if(Ce.length>=3){for(var Wt=0;Wt<Yt.length;Wt++)if(ru(Ce,Yt[Wt]))return!0}if(Gs(Ce,Yt,Pt))return!0}return!1}(ee,v,he)},t.prototype.isTileClipped=function(){return!0},t}(Ss);function lh(e,t){return t>0?t+2*e:e}var Sf=no([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Uf=no([{name:"a_projected_pos",components:3,type:"Float32"}],4),Bf=(no([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),no([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),ch=(no([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),no([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Vf=no([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Pf(e,t,r){return e.sections.forEach(function(u){u.text=function(f,v,S){var P=v.layout.get("text-transform").evaluate(S,{});return P==="uppercase"?f=f.toLocaleUpperCase():P==="lowercase"&&(f=f.toLocaleLowerCase()),ss.applyArabicShaping&&(f=ss.applyArabicShaping(f)),f}(u.text,t,r)}),e}no([{name:"triangle",components:3,type:"Uint16"}]),no([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),no([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),no([{type:"Float32",name:"offsetX"}]),no([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Wl={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Dh=function(t,r,u,f,v){var S,P,V=8*v-f-1,ee=(1<<V)-1,he=ee>>1,_e=-7,Ce=u?v-1:0,ut=u?-1:1,Pt=t[r+Ce];for(Ce+=ut,S=Pt&(1<<-_e)-1,Pt>>=-_e,_e+=V;_e>0;S=256*S+t[r+Ce],Ce+=ut,_e-=8);for(P=S&(1<<-_e)-1,S>>=-_e,_e+=f;_e>0;P=256*P+t[r+Ce],Ce+=ut,_e-=8);if(S===0)S=1-he;else{if(S===ee)return P?NaN:1/0*(Pt?-1:1);P+=Math.pow(2,f),S-=he}return(Pt?-1:1)*P*Math.pow(2,S-f)},ye=function(t,r,u,f,v,S){var P,V,ee,he=8*S-v-1,_e=(1<<he)-1,Ce=_e>>1,ut=v===23?Math.pow(2,-24)-Math.pow(2,-77):0,Pt=f?0:S-1,St=f?1:-1,Yt=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(V=isNaN(r)?1:0,P=_e):(P=Math.floor(Math.log(r)/Math.LN2),r*(ee=Math.pow(2,-P))<1&&(P--,ee*=2),(r+=P+Ce>=1?ut/ee:ut*Math.pow(2,1-Ce))*ee>=2&&(P++,ee/=2),P+Ce>=_e?(V=0,P=_e):P+Ce>=1?(V=(r*ee-1)*Math.pow(2,v),P+=Ce):(V=r*Math.pow(2,Ce-1)*Math.pow(2,v),P=0));v>=8;t[u+Pt]=255&V,Pt+=St,V/=256,v-=8);for(P=P<<v|V,he+=v;he>0;t[u+Pt]=255&P,Pt+=St,P/=256,he-=8);t[u+Pt-St]|=128*Yt},je=Ot;function Ot(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Ot.Varint=0,Ot.Fixed64=1,Ot.Bytes=2,Ot.Fixed32=5;var xr=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Pr(e){return e.type===Ot.Bytes?e.readVarint()+e.pos:e.pos+1}function Cr(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function Er(e,t,r){var u=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(u);for(var f=r.pos-1;f>=e;f--)r.buf[f+u]=r.buf[f]}function Zr(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function on(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function en(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function Yr(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function cn(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function Tn(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function dn(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function nn(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function Tr(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function br(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function Wr(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function wn(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Rr(e,t,r){e===1&&r.readMessage(ta,t)}function ta(e,t,r){if(e===3){var u=r.readMessage(Jr,{}),f=u.width,v=u.height,S=u.left,P=u.top,V=u.advance;t.push({id:u.id,bitmap:new Rs({width:f+6,height:v+6},u.bitmap),metrics:{width:f,height:v,left:S,top:P,advance:V}})}}function Jr(e,t,r){e===1?t.id=r.readVarint():e===2?t.bitmap=r.readBytes():e===3?t.width=r.readVarint():e===4?t.height=r.readVarint():e===5?t.left=r.readSVarint():e===6?t.top=r.readSVarint():e===7&&(t.advance=r.readVarint())}function Br(e){for(var t=0,r=0,u=0,f=e;u<f.length;u+=1){var v=f[u];t+=v.w*v.h,r=Math.max(r,v.w)}e.sort(function(St,Yt){return Yt.h-St.h});for(var S=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],P=0,V=0,ee=0,he=e;ee<he.length;ee+=1)for(var _e=he[ee],Ce=S.length-1;Ce>=0;Ce--){var ut=S[Ce];if(!(_e.w>ut.w||_e.h>ut.h)){if(_e.x=ut.x,_e.y=ut.y,V=Math.max(V,_e.y+_e.h),P=Math.max(P,_e.x+_e.w),_e.w===ut.w&&_e.h===ut.h){var Pt=S.pop();Ce<S.length&&(S[Ce]=Pt)}else _e.h===ut.h?(ut.x+=_e.w,ut.w-=_e.w):_e.w===ut.w?(ut.y+=_e.h,ut.h-=_e.h):(S.push({x:ut.x+_e.w,y:ut.y,w:ut.w-_e.w,h:_e.h}),ut.y+=_e.h,ut.h-=_e.h);break}}return{w:P,h:V,fill:t/(P*V)||0}}Ot.prototype={destroy:function(){this.buf=null},readFields:function(t,r,u){for(u=u||this.length;this.pos<u;){var f=this.readVarint(),v=f>>3,S=this.pos;this.type=7&f,t(v,r,this),this.pos===S&&this.skip(f)}return r},readMessage:function(t,r){return this.readFields(t,r,this.readVarint()+this.pos)},readFixed32:function(){var t=br(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=wn(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=br(this.buf,this.pos)+4294967296*br(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=br(this.buf,this.pos)+4294967296*wn(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=Dh(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Dh(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var r,u,f=this.buf;return r=127&(u=f[this.pos++]),u<128?r:(r|=(127&(u=f[this.pos++]))<<7,u<128?r:(r|=(127&(u=f[this.pos++]))<<14,u<128?r:(r|=(127&(u=f[this.pos++]))<<21,u<128?r:function(v,S,P){var V,ee,he=P.buf;if(V=(112&(ee=he[P.pos++]))>>4,ee<128)return Cr(v,V,S);if(V|=(127&(ee=he[P.pos++]))<<3,ee<128)return Cr(v,V,S);if(V|=(127&(ee=he[P.pos++]))<<10,ee<128)return Cr(v,V,S);if(V|=(127&(ee=he[P.pos++]))<<17,ee<128)return Cr(v,V,S);if(V|=(127&(ee=he[P.pos++]))<<24,ee<128)return Cr(v,V,S);if(V|=(1&(ee=he[P.pos++]))<<31,ee<128)return Cr(v,V,S);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(u=f[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,r=this.pos;return this.pos=t,t-r>=12&&xr?function(u,f,v){return xr.decode(u.subarray(f,v))}(this.buf,r,t):function(u,f,v){for(var S="",P=f;P<v;){var V,ee,he,_e=u[P],Ce=null,ut=_e>239?4:_e>223?3:_e>191?2:1;if(P+ut>v)break;ut===1?_e<128&&(Ce=_e):ut===2?(192&(V=u[P+1]))==128&&(Ce=(31&_e)<<6|63&V)<=127&&(Ce=null):ut===3?(ee=u[P+2],(192&(V=u[P+1]))==128&&(192&ee)==128&&((Ce=(15&_e)<<12|(63&V)<<6|63&ee)<=2047||Ce>=55296&&Ce<=57343)&&(Ce=null)):ut===4&&(ee=u[P+2],he=u[P+3],(192&(V=u[P+1]))==128&&(192&ee)==128&&(192&he)==128&&((Ce=(15&_e)<<18|(63&V)<<12|(63&ee)<<6|63&he)<=65535||Ce>=1114112)&&(Ce=null)),Ce===null?(Ce=65533,ut=1):Ce>65535&&(Ce-=65536,S+=String.fromCharCode(Ce>>>10&1023|55296),Ce=56320|1023&Ce),S+=String.fromCharCode(Ce),P+=ut}return S}(this.buf,r,t)},readBytes:function(){var t=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,t);return this.pos=t,r},readPackedVarint:function(t,r){if(this.type!==Ot.Bytes)return t.push(this.readVarint(r));var u=Pr(this);for(t=t||[];this.pos<u;)t.push(this.readVarint(r));return t},readPackedSVarint:function(t){if(this.type!==Ot.Bytes)return t.push(this.readSVarint());var r=Pr(this);for(t=t||[];this.pos<r;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Ot.Bytes)return t.push(this.readBoolean());var r=Pr(this);for(t=t||[];this.pos<r;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Ot.Bytes)return t.push(this.readFloat());var r=Pr(this);for(t=t||[];this.pos<r;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Ot.Bytes)return t.push(this.readDouble());var r=Pr(this);for(t=t||[];this.pos<r;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Ot.Bytes)return t.push(this.readFixed32());var r=Pr(this);for(t=t||[];this.pos<r;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Ot.Bytes)return t.push(this.readSFixed32());var r=Pr(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Ot.Bytes)return t.push(this.readFixed64());var r=Pr(this);for(t=t||[];this.pos<r;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Ot.Bytes)return t.push(this.readSFixed64());var r=Pr(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed64());return t},skip:function(t){var r=7&t;if(r===Ot.Varint)for(;this.buf[this.pos++]>127;);else if(r===Ot.Bytes)this.pos=this.readVarint()+this.pos;else if(r===Ot.Fixed32)this.pos+=4;else{if(r!==Ot.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(t,r){this.writeVarint(t<<3|r)},realloc:function(t){for(var r=this.length||16;r<this.pos+t;)r*=2;if(r!==this.length){var u=new Uint8Array(r);u.set(this.buf),this.buf=u,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Wr(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Wr(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Wr(this.buf,-1&t,this.pos),Wr(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Wr(this.buf,-1&t,this.pos),Wr(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(r,u){var f,v;if(r>=0?(f=r%4294967296|0,v=r/4294967296|0):(v=~(-r/4294967296),4294967295^(f=~(-r%4294967296))?f=f+1|0:(f=0,v=v+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),function(S,P,V){V.buf[V.pos++]=127&S|128,S>>>=7,V.buf[V.pos++]=127&S|128,S>>>=7,V.buf[V.pos++]=127&S|128,S>>>=7,V.buf[V.pos++]=127&S|128,V.buf[V.pos]=127&(S>>>=7)}(f,0,u),function(S,P){var V=(7&S)<<4;P.buf[P.pos++]|=V|((S>>>=3)?128:0),S&&(P.buf[P.pos++]=127&S|((S>>>=7)?128:0),S&&(P.buf[P.pos++]=127&S|((S>>>=7)?128:0),S&&(P.buf[P.pos++]=127&S|((S>>>=7)?128:0),S&&(P.buf[P.pos++]=127&S|((S>>>=7)?128:0),S&&(P.buf[P.pos++]=127&S)))))}(v,u)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var r=this.pos;this.pos=function(f,v,S){for(var P,V,ee=0;ee<v.length;ee++){if((P=v.charCodeAt(ee))>55295&&P<57344){if(!V){P>56319||ee+1===v.length?(f[S++]=239,f[S++]=191,f[S++]=189):V=P;continue}if(P<56320){f[S++]=239,f[S++]=191,f[S++]=189,V=P;continue}P=V-55296<<10|P-56320|65536,V=null}else V&&(f[S++]=239,f[S++]=191,f[S++]=189,V=null);P<128?f[S++]=P:(P<2048?f[S++]=P>>6|192:(P<65536?f[S++]=P>>12|224:(f[S++]=P>>18|240,f[S++]=P>>12&63|128),f[S++]=P>>6&63|128),f[S++]=63&P|128)}return S}(this.buf,t,this.pos);var u=this.pos-r;u>=128&&Er(r,u,this),this.pos=r-1,this.writeVarint(u),this.pos+=u},writeFloat:function(t){this.realloc(4),ye(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),ye(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var r=t.length;this.writeVarint(r),this.realloc(r);for(var u=0;u<r;u++)this.buf[this.pos++]=t[u]},writeRawMessage:function(t,r){this.pos++;var u=this.pos;t(r,this);var f=this.pos-u;f>=128&&Er(u,f,this),this.pos=u-1,this.writeVarint(f),this.pos+=f},writeMessage:function(t,r,u){this.writeTag(t,Ot.Bytes),this.writeRawMessage(r,u)},writePackedVarint:function(t,r){r.length&&this.writeMessage(t,Zr,r)},writePackedSVarint:function(t,r){r.length&&this.writeMessage(t,on,r)},writePackedBoolean:function(t,r){r.length&&this.writeMessage(t,cn,r)},writePackedFloat:function(t,r){r.length&&this.writeMessage(t,en,r)},writePackedDouble:function(t,r){r.length&&this.writeMessage(t,Yr,r)},writePackedFixed32:function(t,r){r.length&&this.writeMessage(t,Tn,r)},writePackedSFixed32:function(t,r){r.length&&this.writeMessage(t,dn,r)},writePackedFixed64:function(t,r){r.length&&this.writeMessage(t,nn,r)},writePackedSFixed64:function(t,r){r.length&&this.writeMessage(t,Tr,r)},writeBytesField:function(t,r){this.writeTag(t,Ot.Bytes),this.writeBytes(r)},writeFixed32Field:function(t,r){this.writeTag(t,Ot.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(t,r){this.writeTag(t,Ot.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(t,r){this.writeTag(t,Ot.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(t,r){this.writeTag(t,Ot.Fixed64),this.writeSFixed64(r)},writeVarintField:function(t,r){this.writeTag(t,Ot.Varint),this.writeVarint(r)},writeSVarintField:function(t,r){this.writeTag(t,Ot.Varint),this.writeSVarint(r)},writeStringField:function(t,r){this.writeTag(t,Ot.Bytes),this.writeString(r)},writeFloatField:function(t,r){this.writeTag(t,Ot.Fixed32),this.writeFloat(r)},writeDoubleField:function(t,r){this.writeTag(t,Ot.Fixed64),this.writeDouble(r)},writeBooleanField:function(t,r){this.writeVarintField(t,Boolean(r))}};var Fr=function(t,r){var u=r.pixelRatio,f=r.version,v=r.stretchX,S=r.stretchY,P=r.content;this.paddedRect=t,this.pixelRatio=u,this.stretchX=v,this.stretchY=S,this.content=P,this.version=f},Kr={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Kr.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Kr.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Kr.tlbr.get=function(){return this.tl.concat(this.br)},Kr.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Fr.prototype,Kr);var Hn=function(t,r){var u={},f={};this.haveRenderCallbacks=[];var v=[];this.addImages(t,u,v),this.addImages(r,f,v);var S=Br(v),P=new go({width:S.w||1,height:S.h||1});for(var V in t){var ee=t[V],he=u[V].paddedRect;go.copy(ee.data,P,{x:0,y:0},{x:he.x+1,y:he.y+1},ee.data)}for(var _e in r){var Ce=r[_e],ut=f[_e].paddedRect,Pt=ut.x+1,St=ut.y+1,Yt=Ce.data.width,Wt=Ce.data.height;go.copy(Ce.data,P,{x:0,y:0},{x:Pt,y:St},Ce.data),go.copy(Ce.data,P,{x:0,y:Wt-1},{x:Pt,y:St-1},{width:Yt,height:1}),go.copy(Ce.data,P,{x:0,y:0},{x:Pt,y:St+Wt},{width:Yt,height:1}),go.copy(Ce.data,P,{x:Yt-1,y:0},{x:Pt-1,y:St},{width:1,height:Wt}),go.copy(Ce.data,P,{x:0,y:0},{x:Pt+Yt,y:St},{width:1,height:Wt})}this.image=P,this.iconPositions=u,this.patternPositions=f};Hn.prototype.addImages=function(e,t,r){for(var u in e){var f=e[u],v={x:0,y:0,w:f.data.width+2,h:f.data.height+2};r.push(v),t[u]=new Fr(v,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(u)}},Hn.prototype.patchUpdatedImages=function(e,t){for(var r in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)},Hn.prototype.patchUpdatedImage=function(e,t,r){if(e&&t&&e.version!==t.version){e.version=t.version;var u=e.tl;r.update(t.data,void 0,{x:u[0],y:u[1]})}},In("ImagePosition",Fr),In("ImageAtlas",Hn);var aa={horizontal:1,vertical:2,horizontalOnly:3},sn=function(){this.scale=1,this.fontStack="",this.imageName=null};sn.forText=function(e,t){var r=new sn;return r.scale=e||1,r.fontStack=t,r},sn.forImage=function(e){var t=new sn;return t.imageName=e,t};var Gr=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function jr(e,t,r,u,f,v,S,P,V,ee,he,_e,Ce,ut,Pt,St){var Yt,Wt=Gr.fromFeature(e,f);_e===aa.vertical&&Wt.verticalizePunctuation();var ir=ss.processBidirectionalText,yr=ss.processStyledBidirectionalText;if(ir&&Wt.sections.length===1){Yt=[];for(var _r=0,kr=ir(Wt.toString(),fi(Wt,ee,v,t,u,ut,Pt));_r<kr.length;_r+=1){var Dr=kr[_r],pn=new Gr;pn.text=Dr,pn.sections=Wt.sections;for(var fn=0;fn<Dr.length;fn++)pn.sectionIndex.push(0);Yt.push(pn)}}else if(yr){Yt=[];for(var Rn=0,Qn=yr(Wt.text,Wt.sectionIndex,fi(Wt,ee,v,t,u,ut,Pt));Rn<Qn.length;Rn+=1){var Xn=Qn[Rn],Nn=new Gr;Nn.text=Xn[0],Nn.sectionIndex=Xn[1],Nn.sections=Wt.sections,Yt.push(Nn)}}else Yt=function(ra,$a){for(var Na=[],ki=ra.text,ma=0,ri=0,Fo=$a;ri<Fo.length;ri+=1){var mi=Fo[ri];Na.push(ra.substring(ma,mi)),ma=mi}return ma<ki.length&&Na.push(ra.substring(ma,ki.length)),Na}(Wt,fi(Wt,ee,v,t,u,ut,Pt));var Ea=[],ca={positionedLines:Ea,text:Wt.toString(),top:he[1],bottom:he[1],left:he[0],right:he[0],writingMode:_e,iconsInText:!1,verticalizable:!1};return function(ra,$a,Na,ki,ma,ri,Fo,mi,zo,Uo,ts,bu){for(var rs=0,$u=-17,su=0,Ju=0,uu=mi==="right"?1:mi==="left"?0:.5,Ws=0,lu=0,hi=ma;lu<hi.length;lu+=1){var ni=hi[lu];ni.trim();var Ji=ni.getMaxScale(),fo=24*(Ji-1),xu={positionedGlyphs:[],lineOffset:0};ra.positionedLines[Ws]=xu;var bo=xu.positionedGlyphs,Bo=0;if(ni.length()){for(var Nu=0;Nu<ni.length();Nu++){var li=ni.getSection(Nu),Xf=ni.getSectionIndex(Nu),Xc=ni.getCharCode(Nu),hf=0,mc=null,ku=null,Lf=null,Rf=24,Yf=!(zo===aa.horizontal||!ts&&!os(Xc)||ts&&(ha[Xc]||(ph=Xc,qr.Arabic(ph)||qr["Arabic Supplement"](ph)||qr["Arabic Extended-A"](ph)||qr["Arabic Presentation Forms-A"](ph)||qr["Arabic Presentation Forms-B"](ph))));if(li.imageName){var Sh=ki[li.imageName];if(!Sh)continue;Lf=li.imageName,ra.iconsInText=ra.iconsInText||!0,ku=Sh.paddedRect;var Af=Sh.displaySize;li.scale=24*li.scale/bu,hf=fo+(24-Af[1]*li.scale),Rf=(mc={width:Af[0],height:Af[1],left:1,top:-3,advance:Yf?Af[1]:Af[0]}).advance;var Ah=Yf?Af[0]*li.scale-24*Ji:Af[1]*li.scale-24*Ji;Ah>0&&Ah>Bo&&(Bo=Ah)}else{var Kf=Na[li.fontStack],dh=Kf&&Kf[Xc];if(dh&&dh.rect)ku=dh.rect,mc=dh.metrics;else{var Zh=$a[li.fontStack],jh=Zh&&Zh[Xc];if(!jh)continue;mc=jh.metrics}hf=24*(Ji-li.scale)}Yf?(ra.verticalizable=!0,bo.push({glyph:Xc,imageName:Lf,x:rs,y:$u+hf,vertical:Yf,scale:li.scale,fontStack:li.fontStack,sectionIndex:Xf,metrics:mc,rect:ku}),rs+=Rf*li.scale+Uo):(bo.push({glyph:Xc,imageName:Lf,x:rs,y:$u+hf,vertical:Yf,scale:li.scale,fontStack:li.fontStack,sectionIndex:Xf,metrics:mc,rect:ku}),rs+=mc.advance*li.scale+Uo)}bo.length!==0&&(su=Math.max(rs-Uo,su),ps(bo,0,bo.length-1,uu,Bo)),rs=0;var Wh=ri*Ji+Bo;xu.lineOffset=Math.max(Bo,fo),$u+=Wh,Ju=Math.max(Wh,Ju),++Ws}else $u+=ri,++Ws}var ph,Ch=$u- -17,Xh=jo(Fo),mh=Xh.horizontalAlign,$f=Xh.verticalAlign;(function(ih,Yh,Fh,vh,zh,wh,gh,Uh,Bh){var Oh,Mh=(Yh-Fh)*zh;Oh=wh!==gh?-Uh*vh- -17:(-vh*Bh+.5)*gh;for(var yh=0,Ph=ih;yh<Ph.length;yh+=1)for(var bh=0,If=Ph[yh].positionedGlyphs;bh<If.length;bh+=1){var Lh=If[bh];Lh.x+=Mh,Lh.y+=Oh}})(ra.positionedLines,uu,mh,$f,su,Ju,ri,Ch,ma.length),ra.top+=-$f*Ch,ra.bottom=ra.top+Ch,ra.left+=-mh*su,ra.right=ra.left+su}(ca,t,r,u,Yt,S,P,V,_e,ee,Ce,St),!function(ra){for(var $a=0,Na=ra;$a<Na.length;$a+=1)if(Na[$a].positionedGlyphs.length!==0)return!1;return!0}(Ea)&&ca}Gr.fromFeature=function(e,t){for(var r=new Gr,u=0;u<e.sections.length;u++){var f=e.sections[u];f.image?r.addImageSection(f):r.addTextSection(f,t)}return r},Gr.prototype.length=function(){return this.text.length},Gr.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},Gr.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},Gr.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},Gr.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",r=0;r<e.length;r++){var u=e.charCodeAt(r+1)||null,f=e.charCodeAt(r-1)||null;t+=u&&ro(u)&&!Wl[e[r+1]]||f&&ro(f)&&!Wl[e[r-1]]||!Wl[e[r]]?e[r]:Wl[e[r]]}return t}(this.text)},Gr.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&ha[this.text.charCodeAt(t)];t++)e++;for(var r=this.text.length,u=this.text.length-1;u>=0&&u>=e&&ha[this.text.charCodeAt(u)];u--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)},Gr.prototype.substring=function(e,t){var r=new Gr;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r},Gr.prototype.toString=function(){return this.text},Gr.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,r){return Math.max(t,e.sections[r].scale)},0)},Gr.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(sn.forText(e.scale,e.fontStack||t));for(var r=this.sections.length-1,u=0;u<e.text.length;++u)this.sectionIndex.push(r)},Gr.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(sn.forImage(t)),this.sectionIndex.push(this.sections.length-1)):Me("Reached maximum number of images 6401")}else Me("Can't add FormattedSection with an empty image.")},Gr.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var ha={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},pa={};function Un(e,t,r,u,f,v){if(t.imageName){var S=u[t.imageName];return S?S.displaySize[0]*t.scale*24/v+f:0}var P=r[t.fontStack],V=P&&P[e];return V?V.metrics.advance*t.scale+f:0}function Ua(e,t,r,u){var f=Math.pow(e-t,2);return u?e<t?f/2:2*f:f+Math.abs(r)*r}function Oa(e,t,r){var u=0;return e===10&&(u-=1e4),r&&(u+=150),e!==40&&e!==65288||(u+=50),t!==41&&t!==65289||(u+=50),u}function Da(e,t,r,u,f,v){for(var S=null,P=Ua(t,r,f,v),V=0,ee=u;V<ee.length;V+=1){var he=ee[V],_e=Ua(t-he.x,r,f,v)+he.badness;_e<=P&&(S=he,P=_e)}return{index:e,x:t,priorBreak:S,badness:P}}function fi(e,t,r,u,f,v,S){if(v!=="point")return[];if(!e)return[];for(var P,V=[],ee=function(Yt,Wt,ir,yr,_r,kr){for(var Dr=0,pn=0;pn<Yt.length();pn++){var fn=Yt.getSection(pn);Dr+=Un(Yt.getCharCode(pn),fn,yr,_r,Wt,kr)}return Dr/Math.max(1,Math.ceil(Dr/ir))}(e,t,r,u,f,S),he=e.text.indexOf("\u200B")>=0,_e=0,Ce=0;Ce<e.length();Ce++){var ut=e.getSection(Ce),Pt=e.getCharCode(Ce);if(ha[Pt]||(_e+=Un(Pt,ut,u,f,t,S)),Ce<e.length()-1){var St=!((P=Pt)<11904||!(qr["Bopomofo Extended"](P)||qr.Bopomofo(P)||qr["CJK Compatibility Forms"](P)||qr["CJK Compatibility Ideographs"](P)||qr["CJK Compatibility"](P)||qr["CJK Radicals Supplement"](P)||qr["CJK Strokes"](P)||qr["CJK Symbols and Punctuation"](P)||qr["CJK Unified Ideographs Extension A"](P)||qr["CJK Unified Ideographs"](P)||qr["Enclosed CJK Letters and Months"](P)||qr["Halfwidth and Fullwidth Forms"](P)||qr.Hiragana(P)||qr["Ideographic Description Characters"](P)||qr["Kangxi Radicals"](P)||qr["Katakana Phonetic Extensions"](P)||qr.Katakana(P)||qr["Vertical Forms"](P)||qr["Yi Radicals"](P)||qr["Yi Syllables"](P)));(pa[Pt]||St||ut.imageName)&&V.push(Da(Ce+1,_e,ee,V,Oa(Pt,e.getCharCode(Ce+1),St&&he),!1))}}return function Yt(Wt){return Wt?Yt(Wt.priorBreak).concat(Wt.index):[]}(Da(e.length(),_e,ee,V,0,!0))}function jo(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function ps(e,t,r,u,f){if(u||f)for(var v=e[r],S=(e[r].x+v.metrics.advance*v.scale)*u,P=t;P<=r;P++)e[P].x-=S,e[P].y+=f}function ei(e,t,r,u,f,v){var S,P=e.image;if(P.content){var V=P.content,ee=P.pixelRatio||1;S=[V[0]/ee,V[1]/ee,P.displaySize[0]-V[2]/ee,P.displaySize[1]-V[3]/ee]}var he,_e,Ce,ut,Pt=t.left*v,St=t.right*v;r==="width"||r==="both"?(ut=f[0]+Pt-u[3],_e=f[0]+St+u[1]):_e=(ut=f[0]+(Pt+St-P.displaySize[0])/2)+P.displaySize[0];var Yt=t.top*v,Wt=t.bottom*v;return r==="height"||r==="both"?(he=f[1]+Yt-u[0],Ce=f[1]+Wt+u[2]):Ce=(he=f[1]+(Yt+Wt-P.displaySize[1])/2)+P.displaySize[1],{image:P,top:he,right:_e,bottom:Ce,left:ut,collisionPadding:S}}pa[10]=!0,pa[32]=!0,pa[38]=!0,pa[40]=!0,pa[41]=!0,pa[43]=!0,pa[45]=!0,pa[47]=!0,pa[173]=!0,pa[183]=!0,pa[8203]=!0,pa[8208]=!0,pa[8211]=!0,pa[8231]=!0;var co=function(e){function t(r,u,f,v){e.call(this,r,u),this.angle=f,v!==void 0&&(this.segment=v)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(te);function Mi(e,t){var r=t.expression;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Pa(e+1))};if(r.kind==="source")return{kind:"source"};for(var u=r.zoomStops,f=r.interpolationType,v=0;v<u.length&&u[v]<=e;)v++;for(var S=v=Math.max(0,v-1);S<u.length&&u[S]<e+1;)S++;S=Math.min(u.length-1,S);var P=u[v],V=u[S];return r.kind==="composite"?{kind:"composite",minZoom:P,maxZoom:V,interpolationType:f}:{kind:"camera",minZoom:P,maxZoom:V,minSize:r.evaluate(new Pa(P)),maxSize:r.evaluate(new Pa(V)),interpolationType:f}}function ms(e,t,r){var u=t.uSize,f=r.lowerSize;return e.kind==="source"?f/128:e.kind==="composite"?Vi(f/128,r.upperSize/128,t.uSizeT):u}function Zo(e,t){var r=0,u=0;if(e.kind==="constant")u=e.layoutSize;else if(e.kind!=="source"){var f=e.interpolationType,v=f?Pe(pi.interpolationFactor(f,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?u=Vi(e.minSize,e.maxSize,v):r=v}return{uSizeT:r,uSize:u}}In("Anchor",co);var Wo=Object.freeze({__proto__:null,getSizeData:Mi,evaluateSizeForFeature:ms,evaluateSizeForZoom:Zo,SIZE_PACK_FACTOR:128});function es(e,t,r,u,f){if(t.segment===void 0)return!0;for(var v=t,S=t.segment+1,P=0;P>-r/2;){if(--S<0)return!1;P-=e[S].dist(v),v=e[S]}P+=e[S].dist(e[S+1]),S++;for(var V=[],ee=0;P<r/2;){var he=e[S],_e=e[S+1];if(!_e)return!1;var Ce=e[S-1].angleTo(he)-he.angleTo(_e);for(Ce=Math.abs((Ce+3*Math.PI)%(2*Math.PI)-Math.PI),V.push({distance:P,angleDelta:Ce}),ee+=Ce;P-V[0].distance>u;)ee-=V.shift().angleDelta;if(ee>f)return!1;S++,P+=he.dist(_e)}return!0}function Is(e){for(var t=0,r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function Zi(e,t,r){return e?.6*t*r:0}function ia(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Hs(e,t,r,u,f,v){for(var S=Zi(r,f,v),P=ia(r,u)*v,V=0,ee=Is(e)/2,he=0;he<e.length-1;he++){var _e=e[he],Ce=e[he+1],ut=_e.dist(Ce);if(V+ut>ee){var Pt=(ee-V)/ut,St=Vi(_e.x,Ce.x,Pt),Yt=Vi(_e.y,Ce.y,Pt),Wt=new co(St,Yt,Ce.angleTo(_e),he);return Wt._round(),!S||es(e,Wt,P,S,t)?Wt:void 0}V+=ut}}function xi(e,t,r,u,f,v,S,P,V){var ee=Zi(u,v,S),he=ia(u,f),_e=he*S,Ce=e[0].x===0||e[0].x===V||e[0].y===0||e[0].y===V;return t-_e<t/4&&(t=_e+t/4),function ut(Pt,St,Yt,Wt,ir,yr,_r,kr,Dr){for(var pn=yr/2,fn=Is(Pt),Rn=0,Qn=St-Yt,Xn=[],Nn=0;Nn<Pt.length-1;Nn++){for(var Ea=Pt[Nn],ca=Pt[Nn+1],ra=Ea.dist(ca),$a=ca.angleTo(Ea);Qn+Yt<Rn+ra;){var Na=((Qn+=Yt)-Rn)/ra,ki=Vi(Ea.x,ca.x,Na),ma=Vi(Ea.y,ca.y,Na);if(ki>=0&&ki<Dr&&ma>=0&&ma<Dr&&Qn-pn>=0&&Qn+pn<=fn){var ri=new co(ki,ma,$a,Nn);ri._round(),Wt&&!es(Pt,ri,yr,Wt,ir)||Xn.push(ri)}}Rn+=ra}return kr||Xn.length||_r||(Xn=ut(Pt,Rn/2,Yt,Wt,ir,yr,_r,!0,Dr)),Xn}(e,Ce?t/2*P%t:(he/2+2*v)*S*P%t,t,ee,r,_e,Ce,!1,V)}function An(e,t,r,u,f){for(var v=[],S=0;S<e.length;S++)for(var P=e[S],V=void 0,ee=0;ee<P.length-1;ee++){var he=P[ee],_e=P[ee+1];he.x<t&&_e.x<t||(he.x<t?he=new te(t,he.y+(t-he.x)/(_e.x-he.x)*(_e.y-he.y))._round():_e.x<t&&(_e=new te(t,he.y+(t-he.x)/(_e.x-he.x)*(_e.y-he.y))._round()),he.y<r&&_e.y<r||(he.y<r?he=new te(he.x+(r-he.y)/(_e.y-he.y)*(_e.x-he.x),r)._round():_e.y<r&&(_e=new te(he.x+(r-he.y)/(_e.y-he.y)*(_e.x-he.x),r)._round()),he.x>=u&&_e.x>=u||(he.x>=u?he=new te(u,he.y+(u-he.x)/(_e.x-he.x)*(_e.y-he.y))._round():_e.x>=u&&(_e=new te(u,he.y+(u-he.x)/(_e.x-he.x)*(_e.y-he.y))._round()),he.y>=f&&_e.y>=f||(he.y>=f?he=new te(he.x+(f-he.y)/(_e.y-he.y)*(_e.x-he.x),f)._round():_e.y>=f&&(_e=new te(he.x+(f-he.y)/(_e.y-he.y)*(_e.x-he.x),f)._round()),V&&he.equals(V[V.length-1])||v.push(V=[he]),V.push(_e)))))}return v}function Ra(e,t,r,u){var f=[],v=e.image,S=v.pixelRatio,P=v.paddedRect.w-2,V=v.paddedRect.h-2,ee=e.right-e.left,he=e.bottom-e.top,_e=v.stretchX||[[0,P]],Ce=v.stretchY||[[0,V]],ut=function(ma,ri){return ma+ri[1]-ri[0]},Pt=_e.reduce(ut,0),St=Ce.reduce(ut,0),Yt=P-Pt,Wt=V-St,ir=0,yr=Pt,_r=0,kr=St,Dr=0,pn=Yt,fn=0,Rn=Wt;if(v.content&&u){var Qn=v.content;ir=Ba(_e,0,Qn[0]),_r=Ba(Ce,0,Qn[1]),yr=Ba(_e,Qn[0],Qn[2]),kr=Ba(Ce,Qn[1],Qn[3]),Dr=Qn[0]-ir,fn=Qn[1]-_r,pn=Qn[2]-Qn[0]-yr,Rn=Qn[3]-Qn[1]-kr}var Xn=function(ma,ri,Fo,mi){var zo=gu(ma.stretch-ir,yr,ee,e.left),Uo=O(ma.fixed-Dr,pn,ma.stretch,Pt),ts=gu(ri.stretch-_r,kr,he,e.top),bu=O(ri.fixed-fn,Rn,ri.stretch,St),rs=gu(Fo.stretch-ir,yr,ee,e.left),$u=O(Fo.fixed-Dr,pn,Fo.stretch,Pt),su=gu(mi.stretch-_r,kr,he,e.top),Ju=O(mi.fixed-fn,Rn,mi.stretch,St),uu=new te(zo,ts),Ws=new te(rs,ts),lu=new te(rs,su),hi=new te(zo,su),ni=new te(Uo/S,bu/S),Ji=new te($u/S,Ju/S),fo=t*Math.PI/180;if(fo){var xu=Math.sin(fo),bo=Math.cos(fo),Bo=[bo,-xu,xu,bo];uu._matMult(Bo),Ws._matMult(Bo),hi._matMult(Bo),lu._matMult(Bo)}var Nu=ma.stretch+ma.fixed,li=ri.stretch+ri.fixed;return{tl:uu,tr:Ws,bl:hi,br:lu,tex:{x:v.paddedRect.x+1+Nu,y:v.paddedRect.y+1+li,w:Fo.stretch+Fo.fixed-Nu,h:mi.stretch+mi.fixed-li},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ni,pixelOffsetBR:Ji,minFontScaleX:pn/S/ee,minFontScaleY:Rn/S/he,isSDF:r}};if(u&&(v.stretchX||v.stretchY))for(var Nn=Xo(_e,Yt,Pt),Ea=Xo(Ce,Wt,St),ca=0;ca<Nn.length-1;ca++)for(var ra=Nn[ca],$a=Nn[ca+1],Na=0;Na<Ea.length-1;Na++)f.push(Xn(ra,Ea[Na],$a,Ea[Na+1]));else f.push(Xn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:P+1},{fixed:0,stretch:V+1}));return f}function Ba(e,t,r){for(var u=0,f=0,v=e;f<v.length;f+=1){var S=v[f];u+=Math.max(t,Math.min(r,S[1]))-Math.max(t,Math.min(r,S[0]))}return u}function Xo(e,t,r){for(var u=[{fixed:-1,stretch:0}],f=0,v=e;f<v.length;f+=1){var S=v[f],P=S[0],V=S[1],ee=u[u.length-1];u.push({fixed:P-ee.stretch,stretch:ee.stretch}),u.push({fixed:P-ee.stretch,stretch:ee.stretch+(V-P)})}return u.push({fixed:t+1,stretch:r}),u}function gu(e,t,r,u){return e/t*r+u}function O(e,t,r,u){return e-t*r/u}var d=function(t,r,u,f,v,S,P,V,ee,he){if(this.boxStartIndex=t.length,ee){var _e=S.top,Ce=S.bottom,ut=S.collisionPadding;ut&&(_e-=ut[1],Ce+=ut[3]);var Pt=Ce-_e;Pt>0&&(Pt=Math.max(10,Pt),this.circleDiameter=Pt)}else{var St=S.top*P-V,Yt=S.bottom*P+V,Wt=S.left*P-V,ir=S.right*P+V,yr=S.collisionPadding;if(yr&&(Wt-=yr[0]*P,St-=yr[1]*P,ir+=yr[2]*P,Yt+=yr[3]*P),he){var _r=new te(Wt,St),kr=new te(ir,St),Dr=new te(Wt,Yt),pn=new te(ir,Yt),fn=he*Math.PI/180;_r._rotate(fn),kr._rotate(fn),Dr._rotate(fn),pn._rotate(fn),Wt=Math.min(_r.x,kr.x,Dr.x,pn.x),ir=Math.max(_r.x,kr.x,Dr.x,pn.x),St=Math.min(_r.y,kr.y,Dr.y,pn.y),Yt=Math.max(_r.y,kr.y,Dr.y,pn.y)}t.emplaceBack(r.x,r.y,Wt,St,ir,Yt,u,f,v)}this.boxEndIndex=t.length},c=function(t,r){if(t===void 0&&(t=[]),r===void 0&&(r=p),this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};function p(e,t){return e<t?-1:e>t?1:0}function T(e,t,r){t===void 0&&(t=1),r===void 0&&(r=!1);for(var u=1/0,f=1/0,v=-1/0,S=-1/0,P=e[0],V=0;V<P.length;V++){var ee=P[V];(!V||ee.x<u)&&(u=ee.x),(!V||ee.y<f)&&(f=ee.y),(!V||ee.x>v)&&(v=ee.x),(!V||ee.y>S)&&(S=ee.y)}var he=Math.min(v-u,S-f),_e=he/2,Ce=new c([],j);if(he===0)return new te(u,f);for(var ut=u;ut<v;ut+=he)for(var Pt=f;Pt<S;Pt+=he)Ce.push(new I(ut+_e,Pt+_e,_e,e));for(var St=function(ir){for(var yr=0,_r=0,kr=0,Dr=ir[0],pn=0,fn=Dr.length,Rn=fn-1;pn<fn;Rn=pn++){var Qn=Dr[pn],Xn=Dr[Rn],Nn=Qn.x*Xn.y-Xn.x*Qn.y;_r+=(Qn.x+Xn.x)*Nn,kr+=(Qn.y+Xn.y)*Nn,yr+=3*Nn}return new I(_r/yr,kr/yr,0,ir)}(e),Yt=Ce.length;Ce.length;){var Wt=Ce.pop();(Wt.d>St.d||!St.d)&&(St=Wt,r&&console.log("found best %d after %d probes",Math.round(1e4*Wt.d)/1e4,Yt)),Wt.max-St.d<=t||(Ce.push(new I(Wt.p.x-(_e=Wt.h/2),Wt.p.y-_e,_e,e)),Ce.push(new I(Wt.p.x+_e,Wt.p.y-_e,_e,e)),Ce.push(new I(Wt.p.x-_e,Wt.p.y+_e,_e,e)),Ce.push(new I(Wt.p.x+_e,Wt.p.y+_e,_e,e)),Yt+=4)}return r&&(console.log("num probes: "+Yt),console.log("best distance: "+St.d)),St.p}function j(e,t){return t.max-e.max}function I(e,t,r,u){this.p=new te(e,t),this.h=r,this.d=function(f,v){for(var S=!1,P=1/0,V=0;V<v.length;V++)for(var ee=v[V],he=0,_e=ee.length,Ce=_e-1;he<_e;Ce=he++){var ut=ee[he],Pt=ee[Ce];ut.y>f.y!=Pt.y>f.y&&f.x<(Pt.x-ut.x)*(f.y-ut.y)/(Pt.y-ut.y)+ut.x&&(S=!S),P=Math.min(P,Xu(f,ut,Pt))}return(S?1:-1)*Math.sqrt(P)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}c.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},c.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},c.prototype.peek=function(){return this.data[0]},c.prototype._up=function(e){for(var t=this.data,r=this.compare,u=t[e];e>0;){var f=e-1>>1,v=t[f];if(r(u,v)>=0)break;t[e]=v,e=f}t[e]=u},c.prototype._down=function(e){for(var t=this.data,r=this.compare,u=this.length>>1,f=t[e];e<u;){var v=1+(e<<1),S=t[v],P=v+1;if(P<this.length&&r(t[P],S)<0&&(v=P,S=t[P]),r(S,f)>=0)break;t[e]=S,e=v}t[e]=f};var k=Number.POSITIVE_INFINITY;function X(e,t){return t[1]!==k?function(r,u,f){var v=0,S=0;switch(u=Math.abs(u),f=Math.abs(f),r){case"top-right":case"top-left":case"top":S=f-7;break;case"bottom-right":case"bottom-left":case"bottom":S=7-f}switch(r){case"top-right":case"bottom-right":case"right":v=-u;break;case"top-left":case"bottom-left":case"left":v=u}return[v,S]}(e,t[0],t[1]):function(r,u){var f=0,v=0;u<0&&(u=0);var S=u/Math.sqrt(2);switch(r){case"top-right":case"top-left":v=S-7;break;case"bottom-right":case"bottom-left":v=7-S;break;case"bottom":v=7-u;break;case"top":v=u-7}switch(r){case"top-right":case"bottom-right":f=-S;break;case"top-left":case"bottom-left":f=S;break;case"left":f=u;break;case"right":f=-u}return[f,v]}(e,t[0])}function ae(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function $e(e,t,r,u,f,v,S,P,V,ee,he,_e,Ce,ut,Pt){var St=function(_r,kr,Dr,pn,fn,Rn,Qn,Xn){for(var Nn=pn.layout.get("text-rotate").evaluate(Rn,{})*Math.PI/180,Ea=[],ca=0,ra=kr.positionedLines;ca<ra.length;ca+=1)for(var $a=ra[ca],Na=0,ki=$a.positionedGlyphs;Na<ki.length;Na+=1){var ma=ki[Na];if(ma.rect){var ri=ma.rect||{},Fo=4,mi=!0,zo=1,Uo=0,ts=(fn||Xn)&&ma.vertical,bu=ma.metrics.advance*ma.scale/2;if(Xn&&kr.verticalizable&&(Uo=$a.lineOffset/2-(ma.imageName?-(24-ma.metrics.width*ma.scale)/2:24*(ma.scale-1))),ma.imageName){var rs=Qn[ma.imageName];mi=rs.sdf,Fo=1/(zo=rs.pixelRatio)}var $u=fn?[ma.x+bu,ma.y]:[0,0],su=fn?[0,0]:[ma.x+bu+Dr[0],ma.y+Dr[1]-Uo],Ju=[0,0];ts&&(Ju=su,su=[0,0]);var uu=(ma.metrics.left-Fo)*ma.scale-bu+su[0],Ws=(-ma.metrics.top-Fo)*ma.scale+su[1],lu=uu+ri.w*ma.scale/zo,hi=Ws+ri.h*ma.scale/zo,ni=new te(uu,Ws),Ji=new te(lu,Ws),fo=new te(uu,hi),xu=new te(lu,hi);if(ts){var bo=new te(-bu,bu- -17),Bo=-Math.PI/2,Nu=12-bu,li=new te(22-Nu,-(ma.imageName?Nu:0)),Xf=new(Function.prototype.bind.apply(te,[null].concat(Ju)));ni._rotateAround(Bo,bo)._add(li)._add(Xf),Ji._rotateAround(Bo,bo)._add(li)._add(Xf),fo._rotateAround(Bo,bo)._add(li)._add(Xf),xu._rotateAround(Bo,bo)._add(li)._add(Xf)}if(Nn){var Xc=Math.sin(Nn),hf=Math.cos(Nn),mc=[hf,-Xc,Xc,hf];ni._matMult(mc),Ji._matMult(mc),fo._matMult(mc),xu._matMult(mc)}var ku=new te(0,0),Lf=new te(0,0);Ea.push({tl:ni,tr:Ji,bl:fo,br:xu,tex:ri,writingMode:kr.writingMode,glyphOffset:$u,sectionIndex:ma.sectionIndex,isSDF:mi,pixelOffsetTL:ku,pixelOffsetBR:Lf,minFontScaleX:0,minFontScaleY:0})}}return Ea}(0,r,P,f,v,S,u,e.allowVerticalPlacement),Yt=e.textSizeData,Wt=null;Yt.kind==="source"?(Wt=[128*f.layout.get("text-size").evaluate(S,{})])[0]>32640&&Me(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Yt.kind==="composite"&&((Wt=[128*ut.compositeTextSizes[0].evaluate(S,{},Pt),128*ut.compositeTextSizes[1].evaluate(S,{},Pt)])[0]>32640||Wt[1]>32640)&&Me(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,St,Wt,P,v,S,ee,t,V.lineStartIndex,V.lineLength,Ce,Pt);for(var ir=0,yr=he;ir<yr.length;ir+=1)_e[yr[ir]]=e.text.placedSymbolArray.length-1;return 4*St.length}function Ie(e){for(var t in e)return e[t];return null}function Oe(e,t,r,u){var f=e.compareText;if(t in f){for(var v=f[t],S=v.length-1;S>=0;S--)if(u.dist(v[S])<r)return!0}else f[t]=[];return f[t].push(u),!1}var ft=So.VectorTileFeature.types,Ne=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function lt(e,t,r,u,f,v,S,P,V,ee,he,_e,Ce){var ut=P?Math.min(32640,Math.round(P[0])):0,Pt=P?Math.min(32640,Math.round(P[1])):0;e.emplaceBack(t,r,Math.round(32*u),Math.round(32*f),v,S,(ut<<1)+(V?1:0),Pt,16*ee,16*he,256*_e,256*Ce)}function Ue(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function It(e){for(var t=0,r=e.sections;t<r.length;t+=1)if(Fl(r[t].text))return!0;return!1}var $t=function(t){this.layoutVertexArray=new xf,this.indexArray=new Cl,this.programConfigurations=t,this.segments=new tt,this.dynamicLayoutVertexArray=new Bl,this.opacityVertexArray=new Vl,this.placedSymbolArray=new l};$t.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},$t.prototype.upload=function(e,t,r,u){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Sf.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Uf.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Ne,!0),this.opacityVertexBuffer.itemSize=1),(r||u)&&this.programConfigurations.upload(e))},$t.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},In("SymbolBuffers",$t);var ar=function(t,r,u){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new u,this.segments=new tt,this.collisionVertexArray=new Vc};ar.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Bf.members,!0)},ar.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},In("CollisionBuffers",ar);var tr=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(S){return S.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=No([]),this.placementViewportMatrix=No([]);var r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Mi(this.zoom,r["text-size"]),this.iconSizeData=Mi(this.zoom,r["icon-size"]);var u=this.layers[0].layout,f=u.get("symbol-sort-key"),v=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=v!=="viewport-y"&&f.constantOr(1)!==void 0,this.sortFeaturesByY=(v==="viewport-y"||v==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map(function(S){return aa[S]})),this.stateDependentLayerIds=this.layers.filter(function(S){return S.isStateDependent()}).map(function(S){return S.id}),this.sourceID=t.sourceID};tr.prototype.createArrays=function(){this.text=new $t(new La(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new $t(new La(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new L,this.lineVertexArray=new z,this.symbolInstances=new w},tr.prototype.calculateGlyphDependencies=function(e,t,r,u,f){for(var v=0;v<e.length;v++)if(t[e.charCodeAt(v)]=!0,(r||u)&&f){var S=Wl[e.charAt(v)];S&&(t[S.charCodeAt(0)]=!0)}},tr.prototype.populate=function(e,t,r){var u=this.layers[0],f=u.layout,v=f.get("text-font"),S=f.get("text-field"),P=f.get("icon-image"),V=(S.value.kind!=="constant"||S.value.value instanceof Xi&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),ee=P.value.kind!=="constant"||!!P.value.value||Object.keys(P.parameters).length>0,he=f.get("symbol-sort-key");if(this.features=[],V||ee){for(var _e=t.iconDependencies,Ce=t.glyphDependencies,ut=t.availableImages,Pt=new Pa(this.zoom),St=0,Yt=e;St<Yt.length;St+=1){var Wt=Yt[St],ir=Wt.feature,yr=Wt.id,_r=Wt.index,kr=Wt.sourceLayerIndex,Dr=u._featureFilter.needGeometry,pn=Ui(ir,Dr);if(u._featureFilter.filter(Pt,pn,r)){Dr||(pn.geometry=gi(ir));var fn=void 0;if(V){var Rn=u.getValueAndResolveTokens("text-field",pn,r,ut),Qn=Xi.factory(Rn);It(Qn)&&(this.hasRTLText=!0),(!this.hasRTLText||Uc()==="unavailable"||this.hasRTLText&&ss.isParsed())&&(fn=Pf(Qn,u,pn))}var Xn=void 0;if(ee){var Nn=u.getValueAndResolveTokens("icon-image",pn,r,ut);Xn=Nn instanceof Vo?Nn:Vo.fromString(Nn)}if(fn||Xn){var Ea=this.sortFeaturesByKey?he.evaluate(pn,{},r):void 0;if(this.features.push({id:yr,text:fn,icon:Xn,index:_r,sourceLayerIndex:kr,geometry:pn.geometry,properties:ir.properties,type:ft[ir.type],sortKey:Ea}),Xn&&(_e[Xn.name]=!0),fn){var ca=v.evaluate(pn,{},r).join(","),ra=f.get("text-rotation-alignment")==="map"&&f.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(aa.vertical)>=0;for(var $a=0,Na=fn.sections;$a<Na.length;$a+=1){var ki=Na[$a];if(ki.image)_e[ki.image.name]=!0;else{var ma=Ec(fn.toString()),ri=ki.fontStack||ca,Fo=Ce[ri]=Ce[ri]||{};this.calculateGlyphDependencies(ki.text,Fo,ra,this.allowVerticalPlacement,ma)}}}}}}f.get("symbol-placement")==="line"&&(this.features=function(mi){var zo={},Uo={},ts=[],bu=0;function rs(bo){ts.push(mi[bo]),bu++}function $u(bo,Bo,Nu){var li=Uo[bo];return delete Uo[bo],Uo[Bo]=li,ts[li].geometry[0].pop(),ts[li].geometry[0]=ts[li].geometry[0].concat(Nu[0]),li}function su(bo,Bo,Nu){var li=zo[Bo];return delete zo[Bo],zo[bo]=li,ts[li].geometry[0].shift(),ts[li].geometry[0]=Nu[0].concat(ts[li].geometry[0]),li}function Ju(bo,Bo,Nu){var li=Nu?Bo[0][Bo[0].length-1]:Bo[0][0];return bo+":"+li.x+":"+li.y}for(var uu=0;uu<mi.length;uu++){var Ws=mi[uu],lu=Ws.geometry,hi=Ws.text?Ws.text.toString():null;if(hi){var ni=Ju(hi,lu),Ji=Ju(hi,lu,!0);if(ni in Uo&&Ji in zo&&Uo[ni]!==zo[Ji]){var fo=su(ni,Ji,lu),xu=$u(ni,Ji,ts[fo].geometry);delete zo[ni],delete Uo[Ji],Uo[Ju(hi,ts[xu].geometry,!0)]=xu,ts[fo].geometry=null}else ni in Uo?$u(ni,Ji,lu):Ji in zo?su(ni,Ji,lu):(rs(uu),zo[ni]=bu-1,Uo[Ji]=bu-1)}else rs(uu)}return ts.filter(function(bo){return bo.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(mi,zo){return mi.sortKey-zo.sortKey})}},tr.prototype.update=function(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))},tr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},tr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},tr.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},tr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},tr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},tr.prototype.addToLineVertexArray=function(e,t){var r=this.lineVertexArray.length;if(e.segment!==void 0){for(var u=e.dist(t[e.segment+1]),f=e.dist(t[e.segment]),v={},S=e.segment+1;S<t.length;S++)v[S]={x:t[S].x,y:t[S].y,tileUnitDistanceFromAnchor:u},S<t.length-1&&(u+=t[S+1].dist(t[S]));for(var P=e.segment||0;P>=0;P--)v[P]={x:t[P].x,y:t[P].y,tileUnitDistanceFromAnchor:f},P>0&&(f+=t[P-1].dist(t[P]));for(var V=0;V<t.length;V++){var ee=v[V];this.lineVertexArray.emplaceBack(ee.x,ee.y,ee.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},tr.prototype.addSymbols=function(e,t,r,u,f,v,S,P,V,ee,he,_e){for(var Ce=e.indexArray,ut=e.layoutVertexArray,Pt=e.segments.prepareSegment(4*t.length,ut,Ce,this.canOverlap?v.sortKey:void 0),St=this.glyphOffsetArray.length,Yt=Pt.vertexLength,Wt=this.allowVerticalPlacement&&S===aa.vertical?Math.PI/2:0,ir=v.text&&v.text.sections,yr=0;yr<t.length;yr++){var _r=t[yr],kr=_r.tl,Dr=_r.tr,pn=_r.bl,fn=_r.br,Rn=_r.tex,Qn=_r.pixelOffsetTL,Xn=_r.pixelOffsetBR,Nn=_r.minFontScaleX,Ea=_r.minFontScaleY,ca=_r.glyphOffset,ra=_r.isSDF,$a=_r.sectionIndex,Na=Pt.vertexLength,ki=ca[1];lt(ut,P.x,P.y,kr.x,ki+kr.y,Rn.x,Rn.y,r,ra,Qn.x,Qn.y,Nn,Ea),lt(ut,P.x,P.y,Dr.x,ki+Dr.y,Rn.x+Rn.w,Rn.y,r,ra,Xn.x,Qn.y,Nn,Ea),lt(ut,P.x,P.y,pn.x,ki+pn.y,Rn.x,Rn.y+Rn.h,r,ra,Qn.x,Xn.y,Nn,Ea),lt(ut,P.x,P.y,fn.x,ki+fn.y,Rn.x+Rn.w,Rn.y+Rn.h,r,ra,Xn.x,Xn.y,Nn,Ea),Ue(e.dynamicLayoutVertexArray,P,Wt),Ce.emplaceBack(Na,Na+1,Na+2),Ce.emplaceBack(Na+1,Na+2,Na+3),Pt.vertexLength+=4,Pt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ca[0]),yr!==t.length-1&&$a===t[yr+1].sectionIndex||e.programConfigurations.populatePaintArrays(ut.length,v,v.index,{},_e,ir&&ir[$a])}e.placedSymbolArray.emplaceBack(P.x,P.y,St,this.glyphOffsetArray.length-St,Yt,V,ee,P.segment,r?r[0]:0,r?r[1]:0,u[0],u[1],S,0,!1,0,he)},tr.prototype._addCollisionDebugVertex=function(e,t,r,u,f,v){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,u,f,Math.round(v.x),Math.round(v.y))},tr.prototype.addCollisionDebugVertices=function(e,t,r,u,f,v,S){var P=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),V=P.vertexLength,ee=f.layoutVertexArray,he=f.collisionVertexArray,_e=S.anchorX,Ce=S.anchorY;this._addCollisionDebugVertex(ee,he,v,_e,Ce,new te(e,t)),this._addCollisionDebugVertex(ee,he,v,_e,Ce,new te(r,t)),this._addCollisionDebugVertex(ee,he,v,_e,Ce,new te(r,u)),this._addCollisionDebugVertex(ee,he,v,_e,Ce,new te(e,u)),P.vertexLength+=4;var ut=f.indexArray;ut.emplaceBack(V,V+1),ut.emplaceBack(V+1,V+2),ut.emplaceBack(V+2,V+3),ut.emplaceBack(V+3,V),P.primitiveLength+=4},tr.prototype.addDebugCollisionBoxes=function(e,t,r,u){for(var f=e;f<t;f++){var v=this.collisionBoxArray.get(f);this.addCollisionDebugVertices(v.x1,v.y1,v.x2,v.y2,u?this.textCollisionBox:this.iconCollisionBox,v.anchorPoint,r)}},tr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ar(ls,ch.members,ac),this.iconCollisionBox=new ar(ls,ch.members,ac);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},tr.prototype._deserializeCollisionBoxesForSymbol=function(e,t,r,u,f,v,S,P,V){for(var ee={},he=t;he<r;he++){var _e=e.get(he);ee.textBox={x1:_e.x1,y1:_e.y1,x2:_e.x2,y2:_e.y2,anchorPointX:_e.anchorPointX,anchorPointY:_e.anchorPointY},ee.textFeatureIndex=_e.featureIndex;break}for(var Ce=u;Ce<f;Ce++){var ut=e.get(Ce);ee.verticalTextBox={x1:ut.x1,y1:ut.y1,x2:ut.x2,y2:ut.y2,anchorPointX:ut.anchorPointX,anchorPointY:ut.anchorPointY},ee.verticalTextFeatureIndex=ut.featureIndex;break}for(var Pt=v;Pt<S;Pt++){var St=e.get(Pt);ee.iconBox={x1:St.x1,y1:St.y1,x2:St.x2,y2:St.y2,anchorPointX:St.anchorPointX,anchorPointY:St.anchorPointY},ee.iconFeatureIndex=St.featureIndex;break}for(var Yt=P;Yt<V;Yt++){var Wt=e.get(Yt);ee.verticalIconBox={x1:Wt.x1,y1:Wt.y1,x2:Wt.x2,y2:Wt.y2,anchorPointX:Wt.anchorPointX,anchorPointY:Wt.anchorPointY},ee.verticalIconFeatureIndex=Wt.featureIndex;break}return ee},tr.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},tr.prototype.hasTextData=function(){return this.text.segments.get().length>0},tr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},tr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},tr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},tr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},tr.prototype.addIndicesForPlacedSymbol=function(e,t){for(var r=e.placedSymbolArray.get(t),u=r.vertexStartIndex+4*r.numGlyphs,f=r.vertexStartIndex;f<u;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)},tr.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),r=Math.cos(e),u=[],f=[],v=[],S=0;S<this.symbolInstances.length;++S){v.push(S);var P=this.symbolInstances.get(S);u.push(0|Math.round(t*P.anchorX+r*P.anchorY)),f.push(P.featureIndex)}return v.sort(function(V,ee){return u[V]-u[ee]||f[ee]-f[V]}),v},tr.prototype.addToSortKeyRanges=function(e,t){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},tr.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,u=this.symbolInstanceIndexes;r<u.length;r+=1){var f=this.symbolInstances.get(u[r]);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach(function(v,S,P){v>=0&&P.indexOf(v)===S&&t.addIndicesForPlacedSymbol(t.text,v)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},In("SymbolBucket",tr,{omit:["layers","collisionBoxArray","features","compareText"]}),tr.MAX_GLYPHS=65535,tr.addDynamicAttributes=Ue;var pr=new vo({"symbol-placement":new Jn(Xe.layout_symbol["symbol-placement"]),"symbol-spacing":new Jn(Xe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Jn(Xe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new jn(Xe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Jn(Xe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Jn(Xe.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Jn(Xe.layout_symbol["icon-ignore-placement"]),"icon-optional":new Jn(Xe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Jn(Xe.layout_symbol["icon-rotation-alignment"]),"icon-size":new jn(Xe.layout_symbol["icon-size"]),"icon-text-fit":new Jn(Xe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Jn(Xe.layout_symbol["icon-text-fit-padding"]),"icon-image":new jn(Xe.layout_symbol["icon-image"]),"icon-rotate":new jn(Xe.layout_symbol["icon-rotate"]),"icon-padding":new Jn(Xe.layout_symbol["icon-padding"]),"icon-keep-upright":new Jn(Xe.layout_symbol["icon-keep-upright"]),"icon-offset":new jn(Xe.layout_symbol["icon-offset"]),"icon-anchor":new jn(Xe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Jn(Xe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Jn(Xe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Jn(Xe.layout_symbol["text-rotation-alignment"]),"text-field":new jn(Xe.layout_symbol["text-field"]),"text-font":new jn(Xe.layout_symbol["text-font"]),"text-size":new jn(Xe.layout_symbol["text-size"]),"text-max-width":new jn(Xe.layout_symbol["text-max-width"]),"text-line-height":new Jn(Xe.layout_symbol["text-line-height"]),"text-letter-spacing":new jn(Xe.layout_symbol["text-letter-spacing"]),"text-justify":new jn(Xe.layout_symbol["text-justify"]),"text-radial-offset":new jn(Xe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Jn(Xe.layout_symbol["text-variable-anchor"]),"text-anchor":new jn(Xe.layout_symbol["text-anchor"]),"text-max-angle":new Jn(Xe.layout_symbol["text-max-angle"]),"text-writing-mode":new Jn(Xe.layout_symbol["text-writing-mode"]),"text-rotate":new jn(Xe.layout_symbol["text-rotate"]),"text-padding":new Jn(Xe.layout_symbol["text-padding"]),"text-keep-upright":new Jn(Xe.layout_symbol["text-keep-upright"]),"text-transform":new jn(Xe.layout_symbol["text-transform"]),"text-offset":new jn(Xe.layout_symbol["text-offset"]),"text-allow-overlap":new Jn(Xe.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Jn(Xe.layout_symbol["text-ignore-placement"]),"text-optional":new Jn(Xe.layout_symbol["text-optional"])}),wr={paint:new vo({"icon-opacity":new jn(Xe.paint_symbol["icon-opacity"]),"icon-color":new jn(Xe.paint_symbol["icon-color"]),"icon-halo-color":new jn(Xe.paint_symbol["icon-halo-color"]),"icon-halo-width":new jn(Xe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new jn(Xe.paint_symbol["icon-halo-blur"]),"icon-translate":new Jn(Xe.paint_symbol["icon-translate"]),"icon-translate-anchor":new Jn(Xe.paint_symbol["icon-translate-anchor"]),"text-opacity":new jn(Xe.paint_symbol["text-opacity"]),"text-color":new jn(Xe.paint_symbol["text-color"],{runtimeType:xn,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new jn(Xe.paint_symbol["text-halo-color"]),"text-halo-width":new jn(Xe.paint_symbol["text-halo-width"]),"text-halo-blur":new jn(Xe.paint_symbol["text-halo-blur"]),"text-translate":new Jn(Xe.paint_symbol["text-translate"]),"text-translate-anchor":new Jn(Xe.paint_symbol["text-translate-anchor"])}),layout:pr},$r=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:ln,this.defaultValue=t};$r.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},$r.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},$r.prototype.outputDefined=function(){return!1},$r.prototype.serialize=function(){return null},In("FormatSectionOverride",$r,{omit:["defaultValue"]});var Cn=function(e){function t(r){e.call(this,r,wr)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,u){if(e.prototype.recalculate.call(this,r,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var f=this.layout.get("text-writing-mode");if(f){for(var v=[],S=0,P=f;S<P.length;S+=1){var V=P[S];v.indexOf(V)<0&&v.push(V)}this.layout._values["text-writing-mode"]=v}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(r,u,f,v){var S=this.layout.get(r).evaluate(u,{},f,v),P=this._unevaluatedLayout._values[r];return P.isDataDriven()||Po(P.value)||!S?S:function(V,ee){return ee.replace(/{([^{}]+)}/g,function(he,_e){return _e in V?String(V[_e]):""})}(u.properties,S)},t.prototype.createBucket=function(r){return new tr(r)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var r=0,u=wr.paint.overridableProperties;r<u.length;r+=1){var f=u[r];if(t.hasPaintOverride(this.layout,f)){var v,S=this.paint.get(f),P=new $r(S),V=new xl(P,S.property.specification);v=S.value.kind==="constant"||S.value.kind==="source"?new Rl("source",V):new Il("composite",V,S.value.zoomStops,S.value._interpolationType),this.paint._values[f]=new _s(S.property,v,S.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(r,u,f){return!(!this.layout||u.isDataDriven()||f.isDataDriven())&&t.hasPaintOverride(this.layout,r)},t.hasPaintOverride=function(r,u){var f=r.get("text-field"),v=wr.paint.properties[u],S=!1,P=function(_e){for(var Ce=0,ut=_e;Ce<ut.length;Ce+=1)if(v.overrides&&v.overrides.hasOverride(ut[Ce]))return void(S=!0)};if(f.value.kind==="constant"&&f.value.value instanceof Xi)P(f.value.value.sections);else if(f.value.kind==="source"){var V=function he(_e){S||(_e instanceof oi&&Ai(_e.value)===Va?P(_e.value.sections):_e instanceof oo?P(_e.sections):_e.eachChild(he))},ee=f.value;ee._styleExpression&&V(ee._styleExpression.expression)}return S},t}(Ss),un={paint:new vo({"background-color":new Jn(Xe.paint_background["background-color"]),"background-pattern":new us(Xe.paint_background["background-pattern"]),"background-opacity":new Jn(Xe.paint_background["background-opacity"])})},_n=function(e){function t(r){e.call(this,r,un)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ss),Kn={paint:new vo({"raster-opacity":new Jn(Xe.paint_raster["raster-opacity"]),"raster-hue-rotate":new Jn(Xe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Jn(Xe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Jn(Xe.paint_raster["raster-brightness-max"]),"raster-saturation":new Jn(Xe.paint_raster["raster-saturation"]),"raster-contrast":new Jn(Xe.paint_raster["raster-contrast"]),"raster-resampling":new Jn(Xe.paint_raster["raster-resampling"]),"raster-fade-duration":new Jn(Xe.paint_raster["raster-fade-duration"])})},ka=function(e){function t(r){e.call(this,r,Kn)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ss),Ei=function(e){function t(r){e.call(this,r,{}),this.implementation=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},t.prototype.onRemove=function(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},t}(Ss),Pi={circle:nu,heatmap:sf,hillshade:wf,fill:Ir,"fill-extrusion":bi,line:Th,symbol:Cn,background:_n,raster:ka},Du=K.HTMLImageElement,ou=K.HTMLCanvasElement,Xl=K.HTMLVideoElement,Ds=K.ImageData,Ns=K.ImageBitmap,Yl=function(t,r,u,f){this.context=t,this.format=u,this.texture=t.gl.createTexture(),this.update(r,f)};Yl.prototype.update=function(e,t,r){var u=e.width,f=e.height,v=!(this.size&&this.size[0]===u&&this.size[1]===f||r),S=this.context,P=S.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),P.bindTexture(P.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===P.RGBA&&(!t||t.premultiply!==!1)),v)this.size=[u,f],e instanceof Du||e instanceof ou||e instanceof Xl||e instanceof Ds||Ns&&e instanceof Ns?P.texImage2D(P.TEXTURE_2D,0,this.format,this.format,P.UNSIGNED_BYTE,e):P.texImage2D(P.TEXTURE_2D,0,this.format,u,f,0,this.format,P.UNSIGNED_BYTE,e.data);else{var V=r||{x:0,y:0},ee=V.x,he=V.y;e instanceof Du||e instanceof ou||e instanceof Xl||e instanceof Ds||Ns&&e instanceof Ns?P.texSubImage2D(P.TEXTURE_2D,0,ee,he,P.RGBA,P.UNSIGNED_BYTE,e):P.texSubImage2D(P.TEXTURE_2D,0,ee,he,u,f,P.RGBA,P.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&P.generateMipmap(P.TEXTURE_2D)},Yl.prototype.bind=function(e,t,r){var u=this.context.gl;u.bindTexture(u.TEXTURE_2D,this.texture),r!==u.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=u.LINEAR),e!==this.filter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,e),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,t),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,t),this.wrap=t)},Yl.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Yl.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var dc=function(t){var r=this;this._callback=t,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){r._triggered=!1,r._callback()})};dc.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},dc.prototype.remove=function(){delete this._channel,this._callback=function(){}};var yu=function(t,r,u){this.target=t,this.parent=r,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},_t(["receive","process"],this),this.invoker=new dc(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Qt()?t:K};function Mc(e,t,r){var u=2*Math.PI*6378137/256/Math.pow(2,r);return[e*u-2*Math.PI*6378137/2,t*u-2*Math.PI*6378137/2]}yu.prototype.send=function(e,t,r,u,f){var v=this;f===void 0&&(f=!1);var S=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[S]=r);var P=Q(this.globalScope)?void 0:[];return this.target.postMessage({id:S,type:e,hasCallback:!!r,targetMapId:u,mustQueue:f,sourceMapId:this.mapId,data:du(t,P)},P),{cancel:function(){r&&delete v.callbacks[S],v.target.postMessage({id:S,type:"<cancel>",targetMapId:u,sourceMapId:v.mapId})}}},yu.prototype.receive=function(e){var t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[r];var u=this.cancelCallbacks[r];delete this.cancelCallbacks[r],u&&u()}else Qt()||t.mustQueue?(this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,t)},yu.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},yu.prototype.processTask=function(e,t){var r=this;if(t.type==="<response>"){var u=this.callbacks[e];delete this.callbacks[e],u&&(t.error?u(Us(t.error)):u(null,Us(t.data)))}else{var f=!1,v=Q(this.globalScope)?void 0:[],S=t.hasCallback?function(he,_e){f=!0,delete r.cancelCallbacks[e],r.target.postMessage({id:e,type:"<response>",sourceMapId:r.mapId,error:he?du(he):null,data:du(_e,v)},v)}:function(he){f=!0},P=null,V=Us(t.data);if(this.parent[t.type])P=this.parent[t.type](t.sourceMapId,V,S);else if(this.parent.getWorkerSource){var ee=t.type.split(".");P=this.parent.getWorkerSource(t.sourceMapId,ee[0],V.source)[ee[1]](V,S)}else S(new Error("Could not find function "+t.type));!f&&P&&P.cancel&&(this.cancelCallbacks[e]=P.cancel)}},yu.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Co=function(t,r){t&&(r?this.setSouthWest(t).setNorthEast(r):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};Co.prototype.setNorthEast=function(e){return this._ne=e instanceof _a?new _a(e.lng,e.lat):_a.convert(e),this},Co.prototype.setSouthWest=function(e){return this._sw=e instanceof _a?new _a(e.lng,e.lat):_a.convert(e),this},Co.prototype.extend=function(e){var t,r,u=this._sw,f=this._ne;if(e instanceof _a)t=e,r=e;else{if(!(e instanceof Co))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Co.convert(e)):this.extend(_a.convert(e)):this;if(r=e._ne,!(t=e._sw)||!r)return this}return u||f?(u.lng=Math.min(t.lng,u.lng),u.lat=Math.min(t.lat,u.lat),f.lng=Math.max(r.lng,f.lng),f.lat=Math.max(r.lat,f.lat)):(this._sw=new _a(t.lng,t.lat),this._ne=new _a(r.lng,r.lat)),this},Co.prototype.getCenter=function(){return new _a((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Co.prototype.getSouthWest=function(){return this._sw},Co.prototype.getNorthEast=function(){return this._ne},Co.prototype.getNorthWest=function(){return new _a(this.getWest(),this.getNorth())},Co.prototype.getSouthEast=function(){return new _a(this.getEast(),this.getSouth())},Co.prototype.getWest=function(){return this._sw.lng},Co.prototype.getSouth=function(){return this._sw.lat},Co.prototype.getEast=function(){return this._ne.lng},Co.prototype.getNorth=function(){return this._ne.lat},Co.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Co.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Co.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Co.prototype.contains=function(e){var t=_a.convert(e),r=t.lng,u=t.lat,f=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&f},Co.convert=function(e){return!e||e instanceof Co?e:new Co(e)};var _a=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid LngLat object: ("+t+", "+r+")");if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};_a.prototype.wrap=function(){return new _a(mt(this.lng,-180,180),this.lat)},_a.prototype.toArray=function(){return[this.lng,this.lat]},_a.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},_a.prototype.distanceTo=function(e){var t=Math.PI/180,r=this.lat*t,u=e.lat*t,f=Math.sin(r)*Math.sin(u)+Math.cos(r)*Math.cos(u)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(f,1))},_a.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new Co(new _a(this.lng-r,this.lat-t),new _a(this.lng+r,this.lat+t))},_a.convert=function(e){if(e instanceof _a)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new _a(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new _a(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Ol=2*Math.PI*63710088e-1;function nh(e){return Ol*Math.cos(e*Math.PI/180)}function fh(e){return(180+e)/360}function Nh(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function pc(e,t){return e/nh(t)}function Gf(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var ah=function(t,r,u){u===void 0&&(u=0),this.x=+t,this.y=+r,this.z=+u};ah.fromLngLat=function(e,t){t===void 0&&(t=0);var r=_a.convert(e);return new ah(fh(r.lng),Nh(r.lat),pc(t,r.lat))},ah.prototype.toLngLat=function(){return new _a(360*this.x-180,Gf(this.y))},ah.prototype.toAltitude=function(){return this.z*nh(Gf(this.y))},ah.prototype.meterInMercatorCoordinateUnits=function(){return 1/Ol*(e=Gf(this.y),1/Math.cos(e*Math.PI/180));var e};var hh=function(t,r,u){this.z=t,this.x=r,this.y=u,this.key=kh(0,t,t,r,u)};hh.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},hh.prototype.url=function(e,t){var r,u,f,v,S,P=(u=this.y,f=this.z,v=Mc(256*(r=this.x),256*(u=Math.pow(2,f)-u-1),f),S=Mc(256*(r+1),256*(u+1),f),v[0]+","+v[1]+","+S[0]+","+S[1]),V=function(ee,he,_e){for(var Ce,ut="",Pt=ee;Pt>0;Pt--)ut+=(he&(Ce=1<<Pt-1)?1:0)+(_e&Ce?2:0);return ut}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",V).replace("{bbox-epsg-3857}",P)},hh.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new te(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},hh.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var qh=function(t,r){this.wrap=t,this.canonical=r,this.key=kh(t,r.z,r.z,r.x,r.y)},Zs=function(t,r,u,f,v){this.overscaledZ=t,this.wrap=r,this.canonical=new hh(u,+f,+v),this.key=kh(r,t,u,f,v)};function kh(e,t,r,u,f){(e*=2)<0&&(e=-1*e-1);var v=1<<r;return(v*v*e+v*f+u).toString(36)+r.toString(36)+t.toString(36)}Zs.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Zs.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Zs(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Zs(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Zs.prototype.calculateScaledKey=function(e,t){var r=this.canonical.z-e;return e>this.canonical.z?kh(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):kh(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)},Zs.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Zs.prototype.children=function(e){if(this.overscaledZ>=e)return[new Zs(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,r=2*this.canonical.x,u=2*this.canonical.y;return[new Zs(t,this.wrap,t,r,u),new Zs(t,this.wrap,t,r+1,u),new Zs(t,this.wrap,t,r,u+1),new Zs(t,this.wrap,t,r+1,u+1)]},Zs.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Zs.prototype.wrapped=function(){return new Zs(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Zs.prototype.unwrapTo=function(e){return new Zs(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Zs.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Zs.prototype.toUnwrapped=function(){return new qh(this.wrap,this.canonical)},Zs.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Zs.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new ah(e.x-this.wrap,e.y))},In("CanonicalTileID",hh),In("OverscaledTileID",Zs,{omit:["posMatrix"]});var Hf=function(t,r,u){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return Me('"'+u+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=r.height;var f=this.dim=r.height-2;this.data=new Uint32Array(r.data.buffer),this.encoding=u||"mapbox";for(var v=0;v<f;v++)this.data[this._idx(-1,v)]=this.data[this._idx(0,v)],this.data[this._idx(f,v)]=this.data[this._idx(f-1,v)],this.data[this._idx(v,-1)]=this.data[this._idx(v,0)],this.data[this._idx(v,f)]=this.data[this._idx(v,f-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(f,-1)]=this.data[this._idx(f-1,0)],this.data[this._idx(-1,f)]=this.data[this._idx(0,f-1)],this.data[this._idx(f,f)]=this.data[this._idx(f-1,f-1)]};Hf.prototype.get=function(e,t){var r=new Uint8Array(this.data.buffer),u=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(r[u],r[u+1],r[u+2])},Hf.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Hf.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},Hf.prototype._unpackMapbox=function(e,t,r){return(256*e*256+256*t+r)/10-1e4},Hf.prototype._unpackTerrarium=function(e,t,r){return 256*e+t+r/256-32768},Hf.prototype.getPixels=function(){return new go({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Hf.prototype.backfillBorder=function(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var u=t*this.dim,f=t*this.dim+this.dim,v=r*this.dim,S=r*this.dim+this.dim;switch(t){case-1:u=f-1;break;case 1:f=u+1}switch(r){case-1:v=S-1;break;case 1:S=v+1}for(var P=-t*this.dim,V=-r*this.dim,ee=v;ee<S;ee++)for(var he=u;he<f;he++)this.data[this._idx(he,ee)]=e.data[this._idx(he+P,ee+V)]},In("DEMData",Hf);var Gh=function(t){this._stringToNumber={},this._numberToString=[];for(var r=0;r<t.length;r++){var u=t[r];this._stringToNumber[u]=r,this._numberToString[r]=u}};Gh.prototype.encode=function(e){return this._stringToNumber[e]},Gh.prototype.decode=function(e){return this._numberToString[e]};var Hh=function(t,r,u,f,v){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=u,t._y=f,this.properties=t.properties,this.id=v},ed={geometry:{configurable:!0}};ed.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},ed.geometry.set=function(e){this._geometry=e},Hh.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(Hh.prototype,ed);var _h=function(){this.state={},this.stateChanges={},this.deletedStates={}};_h.prototype.updateState=function(e,t,r){var u=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},De(this.stateChanges[e][u],r),this.deletedStates[e]===null)for(var f in this.deletedStates[e]={},this.state[e])f!==u&&(this.deletedStates[e][f]=null);else if(this.deletedStates[e]&&this.deletedStates[e][u]===null)for(var v in this.deletedStates[e][u]={},this.state[e][u])r[v]||(this.deletedStates[e][u][v]=null);else for(var S in r)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][S]===null&&delete this.deletedStates[e][u][S]},_h.prototype.removeFeatureState=function(e,t,r){if(this.deletedStates[e]!==null){var u=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&t!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][r]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(r in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][r]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}},_h.prototype.getState=function(e,t){var r=String(t),u=De({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var f=this.deletedStates[e][t];if(f===null)return{};for(var v in f)delete u[v]}return u},_h.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},_h.prototype.coalesceChanges=function(e,t){var r={};for(var u in this.stateChanges){this.state[u]=this.state[u]||{};var f={};for(var v in this.stateChanges[u])this.state[u][v]||(this.state[u][v]={}),De(this.state[u][v],this.stateChanges[u][v]),f[v]=this.state[u][v];r[u]=f}for(var S in this.deletedStates){this.state[S]=this.state[S]||{};var P={};if(this.deletedStates[S]===null)for(var V in this.state[S])P[V]={},this.state[S][V]={};else for(var ee in this.deletedStates[S]){if(this.deletedStates[S][ee]===null)this.state[S][ee]={};else for(var he=0,_e=Object.keys(this.deletedStates[S][ee]);he<_e.length;he+=1)delete this.state[S][ee][_e[he]];P[ee]=this.state[S][ee]}r[S]=r[S]||{},De(r[S],P)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(var Ce in e)e[Ce].setFeatureState(r,t)};var Zf=function(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new ul(8192,16,0),this.grid3D=new ul(8192,16,0),this.featureIndexArray=new Ee,this.promoteId=r};function td(e,t,r,u,f){return ke(e,function(v,S){var P=t instanceof Tc?t.get(S):null;return P&&P.evaluate?P.evaluate(r,u,f):P})}function rd(e){for(var t=1/0,r=1/0,u=-1/0,f=-1/0,v=0,S=e;v<S.length;v+=1){var P=S[v];t=Math.min(t,P.x),r=Math.min(r,P.y),u=Math.max(u,P.x),f=Math.max(f,P.y)}return{minX:t,minY:r,maxX:u,maxY:f}}function ld(e,t){return t-e}Zf.prototype.insert=function(e,t,r,u,f,v){var S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,u,f);for(var P=v?this.grid3D:this.grid,V=0;V<t.length;V++){for(var ee=t[V],he=[1/0,1/0,-1/0,-1/0],_e=0;_e<ee.length;_e++){var Ce=ee[_e];he[0]=Math.min(he[0],Ce.x),he[1]=Math.min(he[1],Ce.y),he[2]=Math.max(he[2],Ce.x),he[3]=Math.max(he[3],Ce.y)}he[0]<8192&&he[1]<8192&&he[2]>=0&&he[3]>=0&&P.insert(S,he[0],he[1],he[2],he[3])}},Zf.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new So.VectorTile(new je(this.rawTileData)).layers,this.sourceLayerCoder=new Gh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Zf.prototype.query=function(e,t,r,u){var f=this;this.loadVTLayers();for(var v=e.params||{},S=8192/e.tileSize/e.scale,P=bc(v.filter),V=e.queryGeometry,ee=e.queryPadding*S,he=rd(V),_e=this.grid.query(he.minX-ee,he.minY-ee,he.maxX+ee,he.maxY+ee),Ce=rd(e.cameraQueryGeometry),ut=this.grid3D.query(Ce.minX-ee,Ce.minY-ee,Ce.maxX+ee,Ce.maxY+ee,function(_r,kr,Dr,pn){return function(fn,Rn,Qn,Xn,Nn){for(var Ea=0,ca=fn;Ea<ca.length;Ea+=1){var ra=ca[Ea];if(Rn<=ra.x&&Qn<=ra.y&&Xn>=ra.x&&Nn>=ra.y)return!0}var $a=[new te(Rn,Qn),new te(Rn,Nn),new te(Xn,Nn),new te(Xn,Qn)];if(fn.length>2){for(var Na=0,ki=$a;Na<ki.length;Na+=1)if(ru(fn,ki[Na]))return!0}for(var ma=0;ma<fn.length-1;ma++)if(Lu(fn[ma],fn[ma+1],$a))return!0;return!1}(e.cameraQueryGeometry,_r-ee,kr-ee,Dr+ee,pn+ee)}),Pt=0,St=ut;Pt<St.length;Pt+=1)_e.push(St[Pt]);_e.sort(ld);for(var Yt,Wt={},ir=function(kr){var Dr=_e[kr];if(Dr!==Yt){Yt=Dr;var pn=f.featureIndexArray.get(Dr),fn=null;f.loadMatchingFeature(Wt,pn.bucketIndex,pn.sourceLayerIndex,pn.featureIndex,P,v.layers,v.availableImages,t,r,u,function(Rn,Qn,Xn){return fn||(fn=gi(Rn)),Qn.queryIntersectsFeature(V,Rn,Xn,fn,f.z,e.transform,S,e.pixelPosMatrix)})}},yr=0;yr<_e.length;yr++)ir(yr);return Wt},Zf.prototype.loadMatchingFeature=function(e,t,r,u,f,v,S,P,V,ee,he){var _e=this.bucketLayerIDs[t];if(!v||function(fn,Rn){for(var Qn=0;Qn<fn.length;Qn++)if(Rn.indexOf(fn[Qn])>=0)return!0;return!1}(v,_e)){var Ce=this.sourceLayerCoder.decode(r),ut=this.vtLayers[Ce].feature(u);if(f.needGeometry){var Pt=Ui(ut,!0);if(!f.filter(new Pa(this.tileID.overscaledZ),Pt,this.tileID.canonical))return}else if(!f.filter(new Pa(this.tileID.overscaledZ),ut))return;for(var St=this.getId(ut,Ce),Yt=0;Yt<_e.length;Yt++){var Wt=_e[Yt];if(!(v&&v.indexOf(Wt)<0)){var ir=P[Wt];if(ir){var yr={};St!==void 0&&ee&&(yr=ee.getState(ir.sourceLayer||"_geojsonTileLayer",St));var _r=De({},V[Wt]);_r.paint=td(_r.paint,ir.paint,ut,yr,S),_r.layout=td(_r.layout,ir.layout,ut,yr,S);var kr=!he||he(ut,ir,yr);if(kr){var Dr=new Hh(ut,this.z,this.x,this.y,St);Dr.layer=_r;var pn=e[Wt];pn===void 0&&(pn=e[Wt]=[]),pn.push({featureIndex:u,feature:Dr,intersectionZ:kr})}}}}}},Zf.prototype.lookupSymbolFeatures=function(e,t,r,u,f,v,S,P){var V={};this.loadVTLayers();for(var ee=bc(f),he=0,_e=e;he<_e.length;he+=1)this.loadMatchingFeature(V,r,u,_e[he],ee,v,S,P,t);return V},Zf.prototype.hasLayer=function(e){for(var t=0,r=this.bucketLayerIDs;t<r.length;t+=1)for(var u=0,f=r[t];u<f.length;u+=1)if(e===f[u])return!0;return!1},Zf.prototype.getId=function(e,t){var r=e.id;return this.promoteId&&typeof(r=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(r=Number(r)),r},In("FeatureIndex",Zf,{omit:["rawTileData","sourceLayerCoder"]});var vs=function(t,r){this.tileID=t,this.uid=it(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};vs.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<ve.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},vs.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},vs.prototype.loadVectorData=function(e,t,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var u in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(ee,he){var _e={};if(!he)return _e;for(var Ce=function(){var Yt=Pt[ut],Wt=Yt.layerIds.map(function(_r){return he.getLayer(_r)}).filter(Boolean);if(Wt.length!==0){Yt.layers=Wt,Yt.stateDependentLayerIds&&(Yt.stateDependentLayers=Yt.stateDependentLayerIds.map(function(_r){return Wt.filter(function(kr){return kr.id===_r})[0]}));for(var ir=0,yr=Wt;ir<yr.length;ir+=1)_e[yr[ir].id]=Yt}},ut=0,Pt=ee;ut<Pt.length;ut+=1)Ce();return _e}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var f=this.buckets[u];if(f instanceof tr){if(this.hasSymbolBuckets=!0,!r)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var v in this.buckets){var S=this.buckets[v];if(S instanceof tr&&S.hasRTLText){this.hasRTLText=!0,ss.isLoading()||ss.isLoaded()||Uc()!=="deferred"||Lo();break}}for(var P in this.queryPadding=0,this.buckets){var V=this.buckets[P];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(P).queryRadius(V))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new a},vs.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},vs.prototype.getBucket=function(e){return this.buckets[e.id]},vs.prototype.upload=function(e){for(var t in this.buckets){var r=this.buckets[t];r.uploadPending()&&r.upload(e)}var u=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Yl(e,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Yl(e,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)},vs.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},vs.prototype.queryRenderedFeatures=function(e,t,r,u,f,v,S,P,V,ee){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:u,cameraQueryGeometry:f,scale:v,tileSize:this.tileSize,pixelPosMatrix:ee,transform:P,params:S,queryPadding:this.queryPadding*V},e,t,r):{}},vs.prototype.querySourceFeatures=function(e,t){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var u=r.loadVTLayers(),f=t?t.sourceLayer:"",v=u._geojsonTileLayer||u[f];if(v)for(var S=bc(t&&t.filter),P=this.tileID.canonical,V=P.z,ee=P.x,he=P.y,_e={z:V,x:ee,y:he},Ce=0;Ce<v.length;Ce++){var ut=v.feature(Ce);if(S.needGeometry){var Pt=Ui(ut,!0);if(!S.filter(new Pa(this.tileID.overscaledZ),Pt,this.tileID.canonical))continue}else if(!S.filter(new Pa(this.tileID.overscaledZ),ut))continue;var St=r.getId(ut,f),Yt=new Hh(ut,V,ee,he,St);Yt.tile=_e,e.push(Yt)}}},vs.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},vs.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},vs.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var r=ur(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var u=Date.now(),f=!1;if(this.expirationTime>u)f=!1;else if(t)if(this.expirationTime<t)f=!0;else{var v=this.expirationTime-t;v?this.expirationTime=u+Math.max(v,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},vs.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},vs.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var r=this.latestFeatureIndex.loadVTLayers();for(var u in this.buckets)if(t.style.hasLayer(u)){var f=this.buckets[u],v=f.layers[0].sourceLayer||"_geojsonTileLayer",S=r[v],P=e[v];if(S&&P&&Object.keys(P).length!==0){f.update(P,S,this.imageAtlas&&this.imageAtlas.patternPositions||{});var V=t&&t.style&&t.style.getLayer(u);V&&(this.queryPadding=Math.max(this.queryPadding,V.queryRadius(f)))}}}},vs.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},vs.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ve.now()},vs.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},vs.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=ve.now()+e},vs.prototype.setDependencies=function(e,t){for(var r={},u=0,f=t;u<f.length;u+=1)r[f[u]]=!0;this.dependencies[e]=r},vs.prototype.hasDependency=function(e,t){for(var r=0,u=e;r<u.length;r+=1){var f=this.dependencies[u[r]];if(f){for(var v=0,S=t;v<S.length;v+=1)if(f[S[v]])return!0}}return!1};var Wf=K.performance,cd=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},Wf.mark(this._marks.start)};cd.prototype.finish=function(){Wf.mark(this._marks.end);var e=Wf.getEntriesByName(this._marks.measure);return e.length===0&&(Wf.measure(this._marks.measure,this._marks.start,this._marks.end),e=Wf.getEntriesByName(this._marks.measure),Wf.clearMarks(this._marks.start),Wf.clearMarks(this._marks.end),Wf.clearMeasures(this._marks.measure)),e},i.Actor=yu,i.AlphaImage=Rs,i.CanonicalTileID=hh,i.CollisionBoxArray=a,i.Color=fa,i.DEMData=Hf,i.DataConstantProperty=Jn,i.DictionaryCoder=Gh,i.EXTENT=8192,i.ErrorEvent=Ct,i.EvaluationParameters=Pa,i.Event=st,i.Evented=Bt,i.FeatureIndex=Zf,i.FillBucket=Xt,i.FillExtrusionBucket=Qa,i.ImageAtlas=Hn,i.ImagePosition=Fr,i.LineBucket=Iu,i.LngLat=_a,i.LngLatBounds=Co,i.MercatorCoordinate=ah,i.ONE_EM=24,i.OverscaledTileID=Zs,i.Point=te,i.Point$1=te,i.Properties=vo,i.Protobuf=je,i.RGBAImage=go,i.RequestManager=R,i.RequestPerformance=cd,i.ResourceType=Hr,i.SegmentVector=tt,i.SourceFeatureState=_h,i.StructArrayLayout1ui2=ic,i.StructArrayLayout2f1f2i16=Hu,i.StructArrayLayout2i4=mu,i.StructArrayLayout3ui6=Cl,i.StructArrayLayout4i8=hl,i.SymbolBucket=tr,i.Texture=Yl,i.Tile=vs,i.Transitionable=To,i.Uniform1f=rn,i.Uniform1i=Ar,i.Uniform2f=Xr,i.Uniform3f=mn,i.Uniform4f=Ln,i.UniformColor=qn,i.UniformMatrix4f=Sa,i.UnwrappedTileID=qh,i.ValidationError=Lt,i.WritingMode=aa,i.ZoomHistory=ll,i.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},i.addDynamicAttributes=Ue,i.asyncAll=function(e,t,r){if(!e.length)return r(null,[]);var u=e.length,f=new Array(e.length),v=null;e.forEach(function(S,P){t(S,function(V,ee){V&&(v=V),f[P]=ee,--u==0&&r(v,f)})})},i.bezier=pe,i.bindAll=_t,i.browser=ve,i.cacheEntryPossiblyAdded=function(e){++Ht>Et&&(e.getActor().send("enforceCacheSizeLimit",bt),Ht=0)},i.clamp=Pe,i.clearTileCache=function(e){var t=K.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},i.clipLine=An,i.clone=function(e){var t=new Do(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},i.clone$1=Ve,i.clone$2=function(e){var t=new Do(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},i.collisionCircleLayout=Vf,i.config=ge,i.create=function(){var e=new Do(16);return Do!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},i.create$1=function(){var e=new Do(9);return Do!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},i.create$2=function(){var e=new Do(4);return Do!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},i.createCommonjsModule=Z,i.createExpression=ql,i.createLayout=no,i.createStyleLayer=function(e){return e.type==="custom"?new Ei(e):new Pi[e.type](e)},i.cross=function(e,t,r){var u=t[0],f=t[1],v=t[2],S=r[0],P=r[1],V=r[2];return e[0]=f*V-v*P,e[1]=v*S-u*V,e[2]=u*P-f*S,e},i.deepEqual=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(var u=0;u<t.length;u++)if(!e(t[u],r[u]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object")return!1;if(Object.keys(t).length!==Object.keys(r).length)return!1;for(var f in t)if(!e(t[f],r[f]))return!1;return!0}return t===r},i.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},i.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},i.ease=Ze,i.emitValidationErrors=sl,i.endsWith=wt,i.enforceCacheSizeLimit=function(e){Fe(),Qe&&Qe.then(function(t){t.keys().then(function(r){for(var u=0;u<r.length-e;u++)t.delete(r[u])})})},i.evaluateSizeForFeature=ms,i.evaluateSizeForZoom=Zo,i.evaluateVariableOffset=X,i.evented=af,i.extend=De,i.featureFilter=bc,i.filterObject=Re,i.fromRotation=function(e,t){var r=Math.sin(t),u=Math.cos(t);return e[0]=u,e[1]=r,e[2]=0,e[3]=-r,e[4]=u,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},i.getAnchorAlignment=jo,i.getAnchorJustification=ae,i.getArrayBuffer=Yn,i.getImage=W,i.getJSON=function(e,t){return $n(De(e,{type:"json"}),t)},i.getRTLTextPluginStatus=Uc,i.getReferrer=Bn,i.getVideo=function(e,t){var r,u,f=K.document.createElement("video");f.muted=!0,f.onloadstart=function(){t(null,f)};for(var v=0;v<e.length;v++){var S=K.document.createElement("source");r=e[v],u=void 0,(u=K.document.createElement("a")).href=r,(u.protocol!==K.document.location.protocol||u.host!==K.document.location.host)&&(f.crossOrigin="Anonymous"),S.src=e[v],f.appendChild(S)}return{cancel:function(){}}},i.identity=No,i.invert=function(e,t){var r=t[0],u=t[1],f=t[2],v=t[3],S=t[4],P=t[5],V=t[6],ee=t[7],he=t[8],_e=t[9],Ce=t[10],ut=t[11],Pt=t[12],St=t[13],Yt=t[14],Wt=t[15],ir=r*P-u*S,yr=r*V-f*S,_r=r*ee-v*S,kr=u*V-f*P,Dr=u*ee-v*P,pn=f*ee-v*V,fn=he*St-_e*Pt,Rn=he*Yt-Ce*Pt,Qn=he*Wt-ut*Pt,Xn=_e*Yt-Ce*St,Nn=_e*Wt-ut*St,Ea=Ce*Wt-ut*Yt,ca=ir*Ea-yr*Nn+_r*Xn+kr*Qn-Dr*Rn+pn*fn;return ca?(e[0]=(P*Ea-V*Nn+ee*Xn)*(ca=1/ca),e[1]=(f*Nn-u*Ea-v*Xn)*ca,e[2]=(St*pn-Yt*Dr+Wt*kr)*ca,e[3]=(Ce*Dr-_e*pn-ut*kr)*ca,e[4]=(V*Qn-S*Ea-ee*Rn)*ca,e[5]=(r*Ea-f*Qn+v*Rn)*ca,e[6]=(Yt*_r-Pt*pn-Wt*yr)*ca,e[7]=(he*pn-Ce*_r+ut*yr)*ca,e[8]=(S*Nn-P*Qn+ee*fn)*ca,e[9]=(u*Qn-r*Nn-v*fn)*ca,e[10]=(Pt*Dr-St*_r+Wt*ir)*ca,e[11]=(_e*_r-he*Dr-ut*ir)*ca,e[12]=(P*Rn-S*Xn-V*fn)*ca,e[13]=(r*Xn-u*Rn+f*fn)*ca,e[14]=(St*yr-Pt*kr-Yt*ir)*ca,e[15]=(he*kr-_e*yr+Ce*ir)*ca,e):null},i.isChar=qr,i.isMapboxURL=q,i.keysDifference=function(e,t){var r=[];for(var u in e)u in t||r.push(u);return r},i.makeRequest=$n,i.mapObject=ke,i.mercatorXfromLng=fh,i.mercatorYfromLat=Nh,i.mercatorZfromAltitude=pc,i.mul=uo,i.multiply=Ho,i.mvt=So,i.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},i.normalize=function(e,t){var r=t[0],u=t[1],f=t[2],v=r*r+u*u+f*f;return v>0&&(v=1/Math.sqrt(v)),e[0]=t[0]*v,e[1]=t[1]*v,e[2]=t[2]*v,e},i.number=Vi,i.offscreenCanvasSupported=hr,i.ortho=function(e,t,r,u,f,v,S){var P=1/(t-r),V=1/(u-f),ee=1/(v-S);return e[0]=-2*P,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*V,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*ee,e[11]=0,e[12]=(t+r)*P,e[13]=(f+u)*V,e[14]=(S+v)*ee,e[15]=1,e},i.parseGlyphPBF=function(e){return new je(e).readFields(Rr,[])},i.pbf=je,i.performSymbolLayout=function(e,t,r,u,f,v,S){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var P=e.layers[0].layout,V=e.layers[0]._unevaluatedLayout._values,ee={};if(e.textSizeData.kind==="composite"){var he=e.textSizeData,_e=he.maxZoom;ee.compositeTextSizes=[V["text-size"].possiblyEvaluate(new Pa(he.minZoom),S),V["text-size"].possiblyEvaluate(new Pa(_e),S)]}if(e.iconSizeData.kind==="composite"){var Ce=e.iconSizeData,ut=Ce.maxZoom;ee.compositeIconSizes=[V["icon-size"].possiblyEvaluate(new Pa(Ce.minZoom),S),V["icon-size"].possiblyEvaluate(new Pa(ut),S)]}ee.layoutTextSize=V["text-size"].possiblyEvaluate(new Pa(e.zoom+1),S),ee.layoutIconSize=V["icon-size"].possiblyEvaluate(new Pa(e.zoom+1),S),ee.textMaxSize=V["text-size"].possiblyEvaluate(new Pa(18));for(var Pt=24*P.get("text-line-height"),St=P.get("text-rotation-alignment")==="map"&&P.get("symbol-placement")!=="point",Yt=P.get("text-keep-upright"),Wt=P.get("text-size"),ir=function(){var Dr=_r[yr],pn=P.get("text-font").evaluate(Dr,{},S).join(","),fn=Wt.evaluate(Dr,{},S),Rn=ee.layoutTextSize.evaluate(Dr,{},S),Qn=ee.layoutIconSize.evaluate(Dr,{},S),Xn={horizontal:{},vertical:void 0},Nn=Dr.text,Ea=[0,0];if(Nn){var ca=Nn.toString(),ra=24*P.get("text-letter-spacing").evaluate(Dr,{},S),$a=function(hi){for(var ni=0,Ji=hi;ni<Ji.length;ni+=1)if(fo=Ji[ni].charCodeAt(0),qr.Arabic(fo)||qr["Arabic Supplement"](fo)||qr["Arabic Extended-A"](fo)||qr["Arabic Presentation Forms-A"](fo)||qr["Arabic Presentation Forms-B"](fo))return!1;var fo;return!0}(ca)?ra:0,Na=P.get("text-anchor").evaluate(Dr,{},S),ki=P.get("text-variable-anchor");if(!ki){var ma=P.get("text-radial-offset").evaluate(Dr,{},S);Ea=ma?X(Na,[24*ma,k]):P.get("text-offset").evaluate(Dr,{},S).map(function(hi){return 24*hi})}var ri=St?"center":P.get("text-justify").evaluate(Dr,{},S),Fo=P.get("symbol-placement"),mi=Fo==="point"?24*P.get("text-max-width").evaluate(Dr,{},S):0,zo=function(){e.allowVerticalPlacement&&Ec(ca)&&(Xn.vertical=jr(Nn,t,r,f,pn,mi,Pt,Na,"left",$a,Ea,aa.vertical,!0,Fo,Rn,fn))};if(!St&&ki){for(var Uo=ri==="auto"?ki.map(function(hi){return ae(hi)}):[ri],ts=!1,bu=0;bu<Uo.length;bu++){var rs=Uo[bu];if(!Xn.horizontal[rs])if(ts)Xn.horizontal[rs]=Xn.horizontal[0];else{var $u=jr(Nn,t,r,f,pn,mi,Pt,"center",rs,$a,Ea,aa.horizontal,!1,Fo,Rn,fn);$u&&(Xn.horizontal[rs]=$u,ts=$u.positionedLines.length===1)}}zo()}else{ri==="auto"&&(ri=ae(Na));var su=jr(Nn,t,r,f,pn,mi,Pt,Na,ri,$a,Ea,aa.horizontal,!1,Fo,Rn,fn);su&&(Xn.horizontal[ri]=su),zo(),Ec(ca)&&St&&Yt&&(Xn.vertical=jr(Nn,t,r,f,pn,mi,Pt,Na,ri,$a,Ea,aa.vertical,!1,Fo,Rn,fn))}}var Ju=void 0,uu=!1;if(Dr.icon&&Dr.icon.name){var Ws=u[Dr.icon.name];Ws&&(Ju=function(hi,ni,Ji){var fo=jo(Ji),xu=ni[0]-hi.displaySize[0]*fo.horizontalAlign,bo=ni[1]-hi.displaySize[1]*fo.verticalAlign;return{image:hi,top:bo,bottom:bo+hi.displaySize[1],left:xu,right:xu+hi.displaySize[0]}}(f[Dr.icon.name],P.get("icon-offset").evaluate(Dr,{},S),P.get("icon-anchor").evaluate(Dr,{},S)),uu=Ws.sdf,e.sdfIcons===void 0?e.sdfIcons=Ws.sdf:e.sdfIcons!==Ws.sdf&&Me("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ws.pixelRatio!==e.pixelRatio||P.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var lu=Ie(Xn.horizontal)||Xn.vertical;e.iconsInText=!!lu&&lu.iconsInText,(lu||Ju)&&function(hi,ni,Ji,fo,xu,bo,Bo,Nu,li,Xf,Xc){var hf=bo.textMaxSize.evaluate(ni,{});hf===void 0&&(hf=Bo);var mc,ku=hi.layers[0].layout,Lf=ku.get("icon-offset").evaluate(ni,{},Xc),Rf=Ie(Ji.horizontal),Yf=Bo/24,Sh=hi.tilePixelRatio*Yf,Af=hi.tilePixelRatio*hf/24,Ah=hi.tilePixelRatio*Nu,Kf=hi.tilePixelRatio*ku.get("symbol-spacing"),dh=ku.get("text-padding")*hi.tilePixelRatio,Zh=ku.get("icon-padding")*hi.tilePixelRatio,jh=ku.get("text-max-angle")/180*Math.PI,Wh=ku.get("text-rotation-alignment")==="map"&&ku.get("symbol-placement")!=="point",ph=ku.get("icon-rotation-alignment")==="map"&&ku.get("symbol-placement")!=="point",Ch=ku.get("symbol-placement"),Xh=Kf/2,mh=ku.get("icon-text-fit");fo&&mh!=="none"&&(hi.allowVerticalPlacement&&Ji.vertical&&(mc=ei(fo,Ji.vertical,mh,ku.get("icon-text-fit-padding"),Lf,Yf)),Rf&&(fo=ei(fo,Rf,mh,ku.get("icon-text-fit-padding"),Lf,Yf)));var $f=function(fd,Rh){Rh.x<0||Rh.x>=8192||Rh.y<0||Rh.y>=8192||function(gs,Yc,hd,Jf,od,h,_,x,y,A,M,B,ie,de,Be,zt,qt,Or,Nr,bn,gn,Fn,Ta,Ca,Li){var ai,ii,Qi,wa,qi,xo=gs.addToLineVertexArray(Yc,hd),Xs=0,Wa=0,As=0,Yo=0,df=-1,Ih=-1,Pc={},xh=jt(""),oh=0,Kc=0;if(x._unevaluatedLayout.getValue("text-radial-offset")===void 0?(oh=(ai=x.layout.get("text-offset").evaluate(gn,{},Ca).map(function(_d){return 24*_d}))[0],Kc=ai[1]):(oh=24*x.layout.get("text-radial-offset").evaluate(gn,{},Ca),Kc=k),gs.allowVerticalPlacement&&Jf.vertical){var dd=x.layout.get("text-rotate").evaluate(gn,{},Ca)+90;wa=new d(y,Yc,A,M,B,Jf.vertical,ie,de,Be,dd),_&&(qi=new d(y,Yc,A,M,B,_,qt,Or,Be,dd))}if(od){var sd=x.layout.get("icon-rotate").evaluate(gn,{}),pd=x.layout.get("icon-text-fit")!=="none",md=Ra(od,sd,Ta,pd),ud=_?Ra(_,sd,Ta,pd):void 0;Qi=new d(y,Yc,A,M,B,od,qt,Or,!1,sd),Xs=4*md.length;var vd=gs.iconSizeData,Vh=null;vd.kind==="source"?(Vh=[128*x.layout.get("icon-size").evaluate(gn,{})])[0]>32640&&Me(gs.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):vd.kind==="composite"&&((Vh=[128*Fn.compositeIconSizes[0].evaluate(gn,{},Ca),128*Fn.compositeIconSizes[1].evaluate(gn,{},Ca)])[0]>32640||Vh[1]>32640)&&Me(gs.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),gs.addSymbols(gs.icon,md,Vh,bn,Nr,gn,!1,Yc,xo.lineStartIndex,xo.lineLength,-1,Ca),df=gs.icon.placedSymbolArray.length-1,ud&&(Wa=4*ud.length,gs.addSymbols(gs.icon,ud,Vh,bn,Nr,gn,aa.vertical,Yc,xo.lineStartIndex,xo.lineLength,-1,Ca),Ih=gs.icon.placedSymbolArray.length-1)}for(var gd in Jf.horizontal){var Qh=Jf.horizontal[gd];if(!ii){xh=jt(Qh.text);var ja=x.layout.get("text-rotate").evaluate(gn,{},Ca);ii=new d(y,Yc,A,M,B,Qh,ie,de,Be,ja)}var ji=Qh.positionedLines.length===1;if(As+=$e(gs,Yc,Qh,h,x,Be,gn,zt,xo,Jf.vertical?aa.horizontal:aa.horizontalOnly,ji?Object.keys(Jf.horizontal):[gd],Pc,df,Fn,Ca),ji)break}Jf.vertical&&(Yo+=$e(gs,Yc,Jf.vertical,h,x,Be,gn,zt,xo,aa.vertical,["vertical"],Pc,Ih,Fn,Ca));var si=ii?ii.boxStartIndex:gs.collisionBoxArray.length,Dn=ii?ii.boxEndIndex:gs.collisionBoxArray.length,Lc=wa?wa.boxStartIndex:gs.collisionBoxArray.length,ys=wa?wa.boxEndIndex:gs.collisionBoxArray.length,$c=Qi?Qi.boxStartIndex:gs.collisionBoxArray.length,Jc=Qi?Qi.boxEndIndex:gs.collisionBoxArray.length,Eh=qi?qi.boxStartIndex:gs.collisionBoxArray.length,yd=qi?qi.boxEndIndex:gs.collisionBoxArray.length,sh=-1,bd=function(xd,Sd){return xd&&xd.circleDiameter?Math.max(xd.circleDiameter,Sd):Sd};sh=bd(ii,sh),sh=bd(wa,sh),sh=bd(Qi,sh);var Td=(sh=bd(qi,sh))>-1?1:0;Td&&(sh*=Li/24),gs.glyphOffsetArray.length>=tr.MAX_GLYPHS&&Me("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),gn.sortKey!==void 0&&gs.addToSortKeyRanges(gs.symbolInstances.length,gn.sortKey),gs.symbolInstances.emplaceBack(Yc.x,Yc.y,Pc.right>=0?Pc.right:-1,Pc.center>=0?Pc.center:-1,Pc.left>=0?Pc.left:-1,Pc.vertical||-1,df,Ih,xh,si,Dn,Lc,ys,$c,Jc,Eh,yd,A,As,Yo,Xs,Wa,Td,0,ie,oh,Kc,sh)}(hi,Rh,fd,Ji,fo,xu,mc,hi.layers[0],hi.collisionBoxArray,ni.index,ni.sourceLayerIndex,hi.index,Sh,dh,Wh,li,Ah,Zh,ph,Lf,ni,bo,Xf,Xc,Bo)};if(Ch==="line")for(var ih=0,Yh=An(ni.geometry,0,0,8192,8192);ih<Yh.length;ih+=1)for(var Fh=Yh[ih],vh=0,zh=xi(Fh,Kf,jh,Ji.vertical||Rf,fo,24,Af,hi.overscaling,8192);vh<zh.length;vh+=1){var wh=zh[vh];Rf&&Oe(hi,Rf.text,Xh,wh)||$f(Fh,wh)}else if(Ch==="line-center")for(var gh=0,Uh=ni.geometry;gh<Uh.length;gh+=1){var Bh=Uh[gh];if(Bh.length>1){var Oh=Hs(Bh,jh,Ji.vertical||Rf,fo,24,Af);Oh&&$f(Bh,Oh)}}else if(ni.type==="Polygon")for(var Mh=0,yh=N(ni.geometry,0);Mh<yh.length;Mh+=1){var Ph=yh[Mh],bh=T(Ph,16);$f(Ph[0],new co(bh.x,bh.y,0))}else if(ni.type==="LineString")for(var If=0,Lh=ni.geometry;If<Lh.length;If+=1){var Kh=Lh[If];$f(Kh,new co(Kh[0].x,Kh[0].y,0))}else if(ni.type==="Point")for(var $h=0,nd=ni.geometry;$h<nd.length;$h+=1)for(var ad=0,id=nd[$h];ad<id.length;ad+=1){var Jh=id[ad];$f([Jh],new co(Jh.x,Jh.y,0))}}(e,Dr,Xn,Ju,u,ee,Rn,Qn,Ea,uu,S)},yr=0,_r=e.features;yr<_r.length;yr+=1)ir();v&&e.generateCollisionDebugBuffers()},i.perspective=function(e,t,r,u,f){var v,S=1/Math.tan(t/2);return e[0]=S/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=S,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,f!=null&&f!==1/0?(e[10]=(f+u)*(v=1/(u-f)),e[14]=2*f*u*v):(e[10]=-1,e[14]=-2*u),e},i.pick=function(e,t){for(var r={},u=0;u<t.length;u++){var f=t[u];f in e&&(r[f]=e[f])}return r},i.plugin=ss,i.polygonIntersectsPolygon=vu,i.postMapLoadEvent=xt,i.postTurnstileEvent=dr,i.potpack=Br,i.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.register=In,i.registerForPluginStateChange=function(e){return e({pluginStatus:Bs,pluginURL:Cu}),af.on("pluginStateChange",e),e},i.renderColorRamp=ds,i.rotate=function(e,t,r){var u=t[0],f=t[1],v=t[2],S=t[3],P=Math.sin(r),V=Math.cos(r);return e[0]=u*V+v*P,e[1]=f*V+S*P,e[2]=u*-P+v*V,e[3]=f*-P+S*V,e},i.rotateX=function(e,t,r){var u=Math.sin(r),f=Math.cos(r),v=t[4],S=t[5],P=t[6],V=t[7],ee=t[8],he=t[9],_e=t[10],Ce=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=v*f+ee*u,e[5]=S*f+he*u,e[6]=P*f+_e*u,e[7]=V*f+Ce*u,e[8]=ee*f-v*u,e[9]=he*f-S*u,e[10]=_e*f-P*u,e[11]=Ce*f-V*u,e},i.rotateZ=function(e,t,r){var u=Math.sin(r),f=Math.cos(r),v=t[0],S=t[1],P=t[2],V=t[3],ee=t[4],he=t[5],_e=t[6],Ce=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=v*f+ee*u,e[1]=S*f+he*u,e[2]=P*f+_e*u,e[3]=V*f+Ce*u,e[4]=ee*f-v*u,e[5]=he*f-S*u,e[6]=_e*f-P*u,e[7]=Ce*f-V*u,e},i.scale=function(e,t,r){var u=r[0],f=r[1],v=r[2];return e[0]=t[0]*u,e[1]=t[1]*u,e[2]=t[2]*u,e[3]=t[3]*u,e[4]=t[4]*f,e[5]=t[5]*f,e[6]=t[6]*f,e[7]=t[7]*f,e[8]=t[8]*v,e[9]=t[9]*v,e[10]=t[10]*v,e[11]=t[11]*v,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},i.scale$1=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},i.scale$2=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},i.setCacheLimits=function(e,t){bt=e,Et=t},i.setRTLTextPlugin=function(e,t,r){if(r===void 0&&(r=!1),Bs==="deferred"||Bs==="loading"||Bs==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Cu=ve.resolveURL(e),Bs="deferred",zc=t,Ul(),r||Lo()},i.sphericalToCartesian=function(e){var t=e[0],r=e[1],u=e[2];return r+=90,r*=Math.PI/180,u*=Math.PI/180,{x:t*Math.cos(r)*Math.sin(u),y:t*Math.sin(r)*Math.sin(u),z:t*Math.cos(u)}},i.sqrLen=function(e){var t=e[0],r=e[1];return t*t+r*r},i.styleSpec=Xe,i.sub=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},i.symbolSize=Wo,i.transformMat3=function(e,t,r){var u=t[0],f=t[1],v=t[2];return e[0]=u*r[0]+f*r[3]+v*r[6],e[1]=u*r[1]+f*r[4]+v*r[7],e[2]=u*r[2]+f*r[5]+v*r[8],e},i.transformMat4=Ls,i.translate=function(e,t,r){var u,f,v,S,P,V,ee,he,_e,Ce,ut,Pt,St=r[0],Yt=r[1],Wt=r[2];return t===e?(e[12]=t[0]*St+t[4]*Yt+t[8]*Wt+t[12],e[13]=t[1]*St+t[5]*Yt+t[9]*Wt+t[13],e[14]=t[2]*St+t[6]*Yt+t[10]*Wt+t[14],e[15]=t[3]*St+t[7]*Yt+t[11]*Wt+t[15]):(f=t[1],v=t[2],S=t[3],P=t[4],V=t[5],ee=t[6],he=t[7],_e=t[8],Ce=t[9],ut=t[10],Pt=t[11],e[0]=u=t[0],e[1]=f,e[2]=v,e[3]=S,e[4]=P,e[5]=V,e[6]=ee,e[7]=he,e[8]=_e,e[9]=Ce,e[10]=ut,e[11]=Pt,e[12]=u*St+P*Yt+_e*Wt+t[12],e[13]=f*St+V*Yt+Ce*Wt+t[13],e[14]=v*St+ee*Yt+ut*Wt+t[14],e[15]=S*St+he*Yt+Pt*Wt+t[15]),e},i.triggerPluginCompletionEvent=zl,i.uniqueId=it,i.validateCustomStyleLayer=function(e){var t=[],r=e.id;return r===void 0&&t.push({message:"layers."+r+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+r+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),t},i.validateLight=bf,i.validateStyle=ol,i.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},i.vectorTile=So,i.version="1.13.0",i.warnOnce=Me,i.webpSupported=He,i.window=K,i.wrap=mt}),F(["./shared"],function(i){"use strict";function Z(U){var W=typeof U;if(W==="number"||W==="boolean"||W==="string"||U==null)return JSON.stringify(U);if(Array.isArray(U)){for(var le="[",xe=0,st=U;xe<st.length;xe+=1)le+=Z(st[xe])+",";return le+"]"}for(var Ct=Object.keys(U).sort(),Bt="{",Xe=0;Xe<Ct.length;Xe++)Bt+=JSON.stringify(Ct[Xe])+":"+Z(U[Ct[Xe]])+",";return Bt+"}"}function D(U){for(var W="",le=0,xe=i.refProperties;le<xe.length;le+=1)W+="/"+Z(U[xe[le]]);return W}var $=function(W){this.keyCache={},W&&this.replace(W)};$.prototype.replace=function(U){this._layerConfigs={},this._layers={},this.update(U,[])},$.prototype.update=function(U,W){for(var le=this,xe=0,st=U;xe<st.length;xe+=1){var Ct=st[xe];this._layerConfigs[Ct.id]=Ct;var Bt=this._layers[Ct.id]=i.createStyleLayer(Ct);Bt._featureFilter=i.featureFilter(Bt.filter),this.keyCache[Ct.id]&&delete this.keyCache[Ct.id]}for(var Xe=0,Lt=W;Xe<Lt.length;Xe+=1){var lr=Lt[Xe];delete this.keyCache[lr],delete this._layerConfigs[lr],delete this._layers[lr]}this.familiesBySource={};for(var zr=0,Vr=function(hn,xn){for(var yn={},vn=0;vn<hn.length;vn++){var Pn=xn&&xn[hn[vn].id]||D(hn[vn]);xn&&(xn[hn[vn].id]=Pn);var Va=yn[Pn];Va||(Va=yn[Pn]=[]),Va.push(hn[vn])}var va=[];for(var Ma in yn)va.push(yn[Ma]);return va}(i.values(this._layerConfigs),this.keyCache);zr<Vr.length;zr+=1){var cr=Vr[zr].map(function(hn){return le._layers[hn.id]}),Ur=cr[0];if(Ur.visibility!=="none"){var Mn=Ur.source||"",ln=this.familiesBySource[Mn];ln||(ln=this.familiesBySource[Mn]={});var er=Ur.sourceLayer||"_geojsonTileLayer",tn=ln[er];tn||(tn=ln[er]=[]),tn.push(cr)}}};var te=function(W){var le={},xe=[];for(var st in W){var Ct=W[st],Bt=le[st]={};for(var Xe in Ct){var Lt=Ct[+Xe];if(Lt&&Lt.bitmap.width!==0&&Lt.bitmap.height!==0){var lr={x:0,y:0,w:Lt.bitmap.width+2,h:Lt.bitmap.height+2};xe.push(lr),Bt[Xe]={rect:lr,metrics:Lt.metrics}}}}var zr=i.potpack(xe),Vr=new i.AlphaImage({width:zr.w||1,height:zr.h||1});for(var cr in W){var Ur=W[cr];for(var Mn in Ur){var ln=Ur[+Mn];if(ln&&ln.bitmap.width!==0&&ln.bitmap.height!==0){var er=le[cr][Mn].rect;i.AlphaImage.copy(ln.bitmap,Vr,{x:0,y:0},{x:er.x+1,y:er.y+1},ln.bitmap)}}}this.image=Vr,this.positions=le};i.register("GlyphAtlas",te);var fe=function(W){this.tileID=new i.OverscaledTileID(W.tileID.overscaledZ,W.tileID.wrap,W.tileID.canonical.z,W.tileID.canonical.x,W.tileID.canonical.y),this.uid=W.uid,this.zoom=W.zoom,this.pixelRatio=W.pixelRatio,this.tileSize=W.tileSize,this.source=W.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=W.showCollisionBoxes,this.collectResourceTiming=!!W.collectResourceTiming,this.returnDependencies=!!W.returnDependencies,this.promoteId=W.promoteId};function K(U,W,le){for(var xe=new i.EvaluationParameters(W),st=0,Ct=U;st<Ct.length;st+=1)Ct[st].recalculate(xe,le)}function Ge(U,W){var le=i.getArrayBuffer(U.request,function(xe,st,Ct,Bt){xe?W(xe):st&&W(null,{vectorTile:new i.vectorTile.VectorTile(new i.pbf(st)),rawData:st,cacheControl:Ct,expires:Bt})});return function(){le.cancel(),W()}}fe.prototype.parse=function(U,W,le,xe,st){var Ct=this;this.status="parsing",this.data=U,this.collisionBoxArray=new i.CollisionBoxArray;var Bt=new i.DictionaryCoder(Object.keys(U.layers).sort()),Xe=new i.FeatureIndex(this.tileID,this.promoteId);Xe.bucketLayerIDs=[];var Lt,lr,zr,Vr,cr={},Ur={featureIndex:Xe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:le},Mn=W.familiesBySource[this.source];for(var ln in Mn){var er=U.layers[ln];if(er){er.version===1&&i.warnOnce('Vector tile source "'+this.source+'" layer "'+ln+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var tn=Bt.encode(ln),hn=[],xn=0;xn<er.length;xn++){var yn=er.feature(xn),vn=Xe.getId(yn,ln);hn.push({feature:yn,id:vn,index:xn,sourceLayerIndex:tn})}for(var Pn=0,Va=Mn[ln];Pn<Va.length;Pn+=1){var va=Va[Pn],Ma=va[0];Ma.minzoom&&this.zoom<Math.floor(Ma.minzoom)||Ma.maxzoom&&this.zoom>=Ma.maxzoom||Ma.visibility!=="none"&&(K(va,this.zoom,le),(cr[Ma.id]=Ma.createBucket({index:Xe.bucketLayerIDs.length,layers:va,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:tn,sourceID:this.source})).populate(hn,Ur,this.tileID.canonical),Xe.bucketLayerIDs.push(va.map(function(ga){return ga.id})))}}}var Ia=i.mapObject(Ur.glyphDependencies,function(ga){return Object.keys(ga).map(Number)});Object.keys(Ia).length?xe.send("getGlyphs",{uid:this.uid,stacks:Ia},function(ga,ya){Lt||(Lt=ga,lr=ya,di.call(Ct))}):lr={};var Wi=Object.keys(Ur.iconDependencies);Wi.length?xe.send("getImages",{icons:Wi,source:this.source,tileID:this.tileID,type:"icons"},function(ga,ya){Lt||(Lt=ga,zr=ya,di.call(Ct))}):zr={};var da=Object.keys(Ur.patternDependencies);function di(){if(Lt)return st(Lt);if(lr&&zr&&Vr){var ga=new te(lr),ya=new i.ImageAtlas(zr,Vr);for(var fa in cr){var Si=cr[fa];Si instanceof i.SymbolBucket?(K(Si.layers,this.zoom,le),i.performSymbolLayout(Si,lr,ga.positions,zr,ya.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Si.hasPattern&&(Si instanceof i.LineBucket||Si instanceof i.FillBucket||Si instanceof i.FillExtrusionBucket)&&(K(Si.layers,this.zoom,le),Si.addFeatures(Ur,this.tileID.canonical,ya.patternPositions))}this.status="done",st(null,{buckets:i.values(cr).filter(function(ns){return!ns.isEmpty()}),featureIndex:Xe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ga.image,imageAtlas:ya,glyphMap:this.returnDependencies?lr:null,iconMap:this.returnDependencies?zr:null,glyphPositions:this.returnDependencies?ga.positions:null})}}da.length?xe.send("getImages",{icons:da,source:this.source,tileID:this.tileID,type:"patterns"},function(ga,ya){Lt||(Lt=ga,Vr=ya,di.call(Ct))}):Vr={},di.call(this)};var pe=function(W,le,xe,st){this.actor=W,this.layerIndex=le,this.availableImages=xe,this.loadVectorData=st||Ge,this.loading={},this.loaded={}};pe.prototype.loadTile=function(U,W){var le=this,xe=U.uid;this.loading||(this.loading={});var st=!!(U&&U.request&&U.request.collectResourceTiming)&&new i.RequestPerformance(U.request),Ct=this.loading[xe]=new fe(U);Ct.abort=this.loadVectorData(U,function(Bt,Xe){if(delete le.loading[xe],Bt||!Xe)return Ct.status="done",le.loaded[xe]=Ct,W(Bt);var Lt=Xe.rawData,lr={};Xe.expires&&(lr.expires=Xe.expires),Xe.cacheControl&&(lr.cacheControl=Xe.cacheControl);var zr={};if(st){var Vr=st.finish();Vr&&(zr.resourceTiming=JSON.parse(JSON.stringify(Vr)))}Ct.vectorTile=Xe.vectorTile,Ct.parse(Xe.vectorTile,le.layerIndex,le.availableImages,le.actor,function(cr,Ur){if(cr||!Ur)return W(cr);W(null,i.extend({rawTileData:Lt.slice(0)},Ur,lr,zr))}),le.loaded=le.loaded||{},le.loaded[xe]=Ct})},pe.prototype.reloadTile=function(U,W){var le=this,xe=this.loaded,st=U.uid,Ct=this;if(xe&&xe[st]){var Bt=xe[st];Bt.showCollisionBoxes=U.showCollisionBoxes;var Xe=function(lr,zr){var Vr=Bt.reloadCallback;Vr&&(delete Bt.reloadCallback,Bt.parse(Bt.vectorTile,Ct.layerIndex,le.availableImages,Ct.actor,Vr)),W(lr,zr)};Bt.status==="parsing"?Bt.reloadCallback=Xe:Bt.status==="done"&&(Bt.vectorTile?Bt.parse(Bt.vectorTile,this.layerIndex,this.availableImages,this.actor,Xe):Xe())}},pe.prototype.abortTile=function(U,W){var le=this.loading,xe=U.uid;le&&le[xe]&&le[xe].abort&&(le[xe].abort(),delete le[xe]),W()},pe.prototype.removeTile=function(U,W){var le=this.loaded,xe=U.uid;le&&le[xe]&&delete le[xe],W()};var Ze=i.window.ImageBitmap,Pe=function(){this.loaded={}};function mt(U,W){if(U.length!==0){De(U[0],W);for(var le=1;le<U.length;le++)De(U[le],!W)}}function De(U,W){for(var le=0,xe=0,st=U.length,Ct=st-1;xe<st;Ct=xe++)le+=(U[xe][0]-U[Ct][0])*(U[Ct][1]+U[xe][1]);le>=0!=!!W&&U.reverse()}Pe.prototype.loadTile=function(U,W){var le=U.uid,xe=U.encoding,st=U.rawImageData,Ct=Ze&&st instanceof Ze?this.getImageData(st):st,Bt=new i.DEMData(le,Ct,xe);this.loaded=this.loaded||{},this.loaded[le]=Bt,W(null,Bt)},Pe.prototype.getImageData=function(U){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(U.width,U.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=U.width,this.offscreenCanvas.height=U.height,this.offscreenCanvasContext.drawImage(U,0,0,U.width,U.height);var W=this.offscreenCanvasContext.getImageData(-1,-1,U.width+2,U.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new i.RGBAImage({width:W.width,height:W.height},W.data)},Pe.prototype.removeTile=function(U){var W=this.loaded,le=U.uid;W&&W[le]&&delete W[le]};var At=i.vectorTile.VectorTileFeature.prototype.toGeoJSON,it=function(W){this._feature=W,this.extent=i.EXTENT,this.type=W.type,this.properties=W.tags,"id"in W&&!isNaN(W.id)&&(this.id=parseInt(W.id,10))};it.prototype.loadGeometry=function(){if(this._feature.type===1){for(var U=[],W=0,le=this._feature.geometry;W<le.length;W+=1){var xe=le[W];U.push([new i.Point$1(xe[0],xe[1])])}return U}for(var st=[],Ct=0,Bt=this._feature.geometry;Ct<Bt.length;Ct+=1){for(var Xe=[],Lt=0,lr=Bt[Ct];Lt<lr.length;Lt+=1){var zr=lr[Lt];Xe.push(new i.Point$1(zr[0],zr[1]))}st.push(Xe)}return st},it.prototype.toGeoJSON=function(U,W,le){return At.call(this,U,W,le)};var vt=function(W){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.EXTENT,this.length=W.length,this._features=W};vt.prototype.feature=function(U){return new it(this._features[U])};var Je=i.vectorTile.VectorTileFeature,_t=wt;function wt(U,W){this.options=W||{},this.features=U,this.length=U.length}function ke(U,W){this.id=typeof U.id=="number"?U.id:void 0,this.type=U.type,this.rawGeometry=U.type===1?[U.geometry]:U.geometry,this.properties=U.tags,this.extent=W||4096}wt.prototype.feature=function(U){return new ke(this.features[U],this.options.extent)},ke.prototype.loadGeometry=function(){var U=this.rawGeometry;this.geometry=[];for(var W=0;W<U.length;W++){for(var le=U[W],xe=[],st=0;st<le.length;st++)xe.push(new i.Point$1(le[st][0],le[st][1]));this.geometry.push(xe)}return this.geometry},ke.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var U=this.geometry,W=1/0,le=-1/0,xe=1/0,st=-1/0,Ct=0;Ct<U.length;Ct++)for(var Bt=U[Ct],Xe=0;Xe<Bt.length;Xe++){var Lt=Bt[Xe];W=Math.min(W,Lt.x),le=Math.max(le,Lt.x),xe=Math.min(xe,Lt.y),st=Math.max(st,Lt.y)}return[W,xe,le,st]},ke.prototype.toGeoJSON=Je.prototype.toGeoJSON;var Re=dt,Ve=_t;function dt(U){var W=new i.pbf;return function(le,xe){for(var st in le.layers)xe.writeMessage(3,Me,le.layers[st])}(U,W),W.finish()}function Me(U,W){var le;W.writeVarintField(15,U.version||1),W.writeStringField(1,U.name||""),W.writeVarintField(5,U.extent||4096);var xe={keys:[],values:[],keycache:{},valuecache:{}};for(le=0;le<U.length;le++)xe.feature=U.feature(le),W.writeMessage(2,ht,xe);var st=xe.keys;for(le=0;le<st.length;le++)W.writeStringField(3,st[le]);var Ct=xe.values;for(le=0;le<Ct.length;le++)W.writeMessage(4,Q,Ct[le])}function ht(U,W){var le=U.feature;le.id!==void 0&&W.writeVarintField(1,le.id),W.writeMessage(2,Zt,U),W.writeVarintField(3,le.type),W.writeMessage(4,oe,le)}function Zt(U,W){var le=U.feature,xe=U.keys,st=U.values,Ct=U.keycache,Bt=U.valuecache;for(var Xe in le.properties){var Lt=Ct[Xe];Lt===void 0&&(xe.push(Xe),Ct[Xe]=Lt=xe.length-1),W.writeVarint(Lt);var lr=le.properties[Xe],zr=typeof lr;zr!=="string"&&zr!=="boolean"&&zr!=="number"&&(lr=JSON.stringify(lr));var Vr=zr+":"+lr,cr=Bt[Vr];cr===void 0&&(st.push(lr),Bt[Vr]=cr=st.length-1),W.writeVarint(cr)}}function Qt(U,W){return(W<<3)+(7&U)}function ur(U){return U<<1^U>>31}function oe(U,W){for(var le=U.loadGeometry(),xe=U.type,st=0,Ct=0,Bt=le.length,Xe=0;Xe<Bt;Xe++){var Lt=le[Xe],lr=1;xe===1&&(lr=Lt.length),W.writeVarint(Qt(1,lr));for(var zr=xe===3?Lt.length-1:Lt.length,Vr=0;Vr<zr;Vr++){Vr===1&&xe!==1&&W.writeVarint(Qt(2,zr-1));var cr=Lt[Vr].x-st,Ur=Lt[Vr].y-Ct;W.writeVarint(ur(cr)),W.writeVarint(ur(Ur)),st+=cr,Ct+=Ur}xe===3&&W.writeVarint(Qt(7,1))}}function Q(U,W){var le=typeof U;le==="string"?W.writeStringField(1,U):le==="boolean"?W.writeBooleanField(7,U):le==="number"&&(U%1!=0?W.writeDoubleField(3,U):U<0?W.writeSVarintField(6,U):W.writeVarintField(5,U))}function H(U,W,le,xe){Se(U,le,xe),Se(W,2*le,2*xe),Se(W,2*le+1,2*xe+1)}function Se(U,W,le){var xe=U[W];U[W]=U[le],U[le]=xe}function be(U,W,le,xe){var st=U-le,Ct=W-xe;return st*st+Ct*Ct}Re.fromVectorTileJs=dt,Re.fromGeojsonVt=function(U,W){W=W||{};var le={};for(var xe in U)le[xe]=new _t(U[xe].features,W),le[xe].name=xe,le[xe].version=W.version,le[xe].extent=W.extent;return dt({layers:le})},Re.GeoJSONWrapper=Ve;var Te=function(W){return W[0]},me=function(W){return W[1]},nt=function(W,le,xe,st,Ct){le===void 0&&(le=Te),xe===void 0&&(xe=me),st===void 0&&(st=64),Ct===void 0&&(Ct=Float64Array),this.nodeSize=st,this.points=W;for(var Bt=W.length<65536?Uint16Array:Uint32Array,Xe=this.ids=new Bt(W.length),Lt=this.coords=new Ct(2*W.length),lr=0;lr<W.length;lr++)Xe[lr]=lr,Lt[2*lr]=le(W[lr]),Lt[2*lr+1]=xe(W[lr]);!function zr(Vr,cr,Ur,Mn,ln,er){if(!(ln-Mn<=Ur)){var tn=Mn+ln>>1;!function hn(xn,yn,vn,Pn,Va,va){for(;Va>Pn;){if(Va-Pn>600){var Ma=Va-Pn+1,Ia=vn-Pn+1,Wi=Math.log(Ma),da=.5*Math.exp(2*Wi/3),di=.5*Math.sqrt(Wi*da*(Ma-da)/Ma)*(Ia-Ma/2<0?-1:1);hn(xn,yn,vn,Math.max(Pn,Math.floor(vn-Ia*da/Ma+di)),Math.min(Va,Math.floor(vn+(Ma-Ia)*da/Ma+di)),va)}var ga=yn[2*vn+va],ya=Pn,fa=Va;for(H(xn,yn,Pn,vn),yn[2*Va+va]>ga&&H(xn,yn,Pn,Va);ya<fa;){for(H(xn,yn,ya,fa),ya++,fa--;yn[2*ya+va]<ga;)ya++;for(;yn[2*fa+va]>ga;)fa--}yn[2*Pn+va]===ga?H(xn,yn,Pn,fa):H(xn,yn,++fa,Va),fa<=vn&&(Pn=fa+1),vn<=fa&&(Va=fa-1)}}(Vr,cr,tn,Mn,ln,er%2),zr(Vr,cr,Ur,Mn,tn-1,er+1),zr(Vr,cr,Ur,tn+1,ln,er+1)}}(Xe,Lt,st,0,Xe.length-1,0)};nt.prototype.range=function(U,W,le,xe){return function(st,Ct,Bt,Xe,Lt,lr,zr){for(var Vr,cr,Ur=[0,st.length-1,0],Mn=[];Ur.length;){var ln=Ur.pop(),er=Ur.pop(),tn=Ur.pop();if(er-tn<=zr)for(var hn=tn;hn<=er;hn++)cr=Ct[2*hn+1],(Vr=Ct[2*hn])>=Bt&&Vr<=Lt&&cr>=Xe&&cr<=lr&&Mn.push(st[hn]);else{var xn=Math.floor((tn+er)/2);cr=Ct[2*xn+1],(Vr=Ct[2*xn])>=Bt&&Vr<=Lt&&cr>=Xe&&cr<=lr&&Mn.push(st[xn]);var yn=(ln+1)%2;(ln===0?Bt<=Vr:Xe<=cr)&&(Ur.push(tn),Ur.push(xn-1),Ur.push(yn)),(ln===0?Lt>=Vr:lr>=cr)&&(Ur.push(xn+1),Ur.push(er),Ur.push(yn))}}return Mn}(this.ids,this.coords,U,W,le,xe,this.nodeSize)},nt.prototype.within=function(U,W,le){return function(xe,st,Ct,Bt,Xe,Lt){for(var lr=[0,xe.length-1,0],zr=[],Vr=Xe*Xe;lr.length;){var cr=lr.pop(),Ur=lr.pop(),Mn=lr.pop();if(Ur-Mn<=Lt)for(var ln=Mn;ln<=Ur;ln++)be(st[2*ln],st[2*ln+1],Ct,Bt)<=Vr&&zr.push(xe[ln]);else{var er=Math.floor((Mn+Ur)/2),tn=st[2*er],hn=st[2*er+1];be(tn,hn,Ct,Bt)<=Vr&&zr.push(xe[er]);var xn=(cr+1)%2;(cr===0?Ct-Xe<=tn:Bt-Xe<=hn)&&(lr.push(Mn),lr.push(er-1),lr.push(xn)),(cr===0?Ct+Xe>=tn:Bt+Xe>=hn)&&(lr.push(er+1),lr.push(Ur),lr.push(xn))}}return zr}(this.ids,this.coords,U,W,le,this.nodeSize)};var Jt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(W){return W}},Mt=function(W){this.options=C(Object.create(Jt),W),this.trees=new Array(this.options.maxZoom+1)};function ve(U,W,le,xe,st){return{x:U,y:W,zoom:1/0,id:le,parentId:-1,numPoints:xe,properties:st}}function ge(U,W){var le=U.geometry.coordinates,xe=le[1];return{x:we(le[0]),y:gt(xe),zoom:1/0,index:W,parentId:-1}}function He(U){return{type:"Feature",id:U.id,properties:ot(U),geometry:{type:"Point",coordinates:[(xe=U.x,360*(xe-.5)),(W=U.y,le=(180-360*W)*Math.PI/180,360*Math.atan(Math.exp(le))/Math.PI-90)]}};var W,le,xe}function ot(U){var W=U.numPoints,le=W>=1e4?Math.round(W/1e3)+"k":W>=1e3?Math.round(W/100)/10+"k":W;return C(C({},U.properties),{cluster:!0,cluster_id:U.id,point_count:W,point_count_abbreviated:le})}function we(U){return U/360+.5}function gt(U){var W=Math.sin(U*Math.PI/180),le=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return le<0?0:le>1?1:le}function C(U,W){for(var le in W)U[le]=W[le];return U}function R(U){return U.x}function q(U){return U.y}function ce(U,W,le,xe,st,Ct){var Bt=st-le,Xe=Ct-xe;if(Bt!==0||Xe!==0){var Lt=((U-le)*Bt+(W-xe)*Xe)/(Bt*Bt+Xe*Xe);Lt>1?(le=st,xe=Ct):Lt>0&&(le+=Bt*Lt,xe+=Xe*Lt)}return(Bt=U-le)*Bt+(Xe=W-xe)*Xe}function We(U,W,le,xe){var st={id:U===void 0?null:U,type:W,geometry:le,tags:xe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ct){var Bt=Ct.geometry,Xe=Ct.type;if(Xe==="Point"||Xe==="MultiPoint"||Xe==="LineString")qe(Ct,Bt);else if(Xe==="Polygon"||Xe==="MultiLineString")for(var Lt=0;Lt<Bt.length;Lt++)qe(Ct,Bt[Lt]);else if(Xe==="MultiPolygon")for(Lt=0;Lt<Bt.length;Lt++)for(var lr=0;lr<Bt[Lt].length;lr++)qe(Ct,Bt[Lt][lr])}(st),st}function qe(U,W){for(var le=0;le<W.length;le+=3)U.minX=Math.min(U.minX,W[le]),U.minY=Math.min(U.minY,W[le+1]),U.maxX=Math.max(U.maxX,W[le]),U.maxY=Math.max(U.maxY,W[le+1])}function Tt(U,W,le,xe){if(W.geometry){var st=W.geometry.coordinates,Ct=W.geometry.type,Bt=Math.pow(le.tolerance/((1<<le.maxZoom)*le.extent),2),Xe=[],Lt=W.id;if(le.promoteId?Lt=W.properties[le.promoteId]:le.generateId&&(Lt=xe||0),Ct==="Point")at(st,Xe);else if(Ct==="MultiPoint")for(var lr=0;lr<st.length;lr++)at(st[lr],Xe);else if(Ct==="LineString")Ut(st,Xe,Bt,!1);else if(Ct==="MultiLineString"){if(le.lineMetrics){for(lr=0;lr<st.length;lr++)Ut(st[lr],Xe=[],Bt,!1),U.push(We(Lt,"LineString",Xe,W.properties));return}J(st,Xe,Bt,!1)}else if(Ct==="Polygon")J(st,Xe,Bt,!0);else{if(Ct!=="MultiPolygon"){if(Ct==="GeometryCollection"){for(lr=0;lr<W.geometry.geometries.length;lr++)Tt(U,{id:Lt,geometry:W.geometry.geometries[lr],properties:W.properties},le,xe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(lr=0;lr<st.length;lr++){var zr=[];J(st[lr],zr,Bt,!0),Xe.push(zr)}}U.push(We(Lt,Ct,Xe,W.properties))}}function at(U,W){W.push(Qe(U[0])),W.push(ne(U[1])),W.push(0)}function Ut(U,W,le,xe){for(var st,Ct,Bt=0,Xe=0;Xe<U.length;Xe++){var Lt=Qe(U[Xe][0]),lr=ne(U[Xe][1]);W.push(Lt),W.push(lr),W.push(0),Xe>0&&(Bt+=xe?(st*lr-Lt*Ct)/2:Math.sqrt(Math.pow(Lt-st,2)+Math.pow(lr-Ct,2))),st=Lt,Ct=lr}var zr=W.length-3;W[2]=1,function Vr(cr,Ur,Mn,ln){for(var er,tn=ln,hn=Mn-Ur>>1,xn=Mn-Ur,yn=cr[Ur],vn=cr[Ur+1],Pn=cr[Mn],Va=cr[Mn+1],va=Ur+3;va<Mn;va+=3){var Ma=ce(cr[va],cr[va+1],yn,vn,Pn,Va);if(Ma>tn)er=va,tn=Ma;else if(Ma===tn){var Ia=Math.abs(va-hn);Ia<xn&&(er=va,xn=Ia)}}tn>ln&&(er-Ur>3&&Vr(cr,Ur,er,ln),cr[er+2]=tn,Mn-er>3&&Vr(cr,er,Mn,ln))}(W,0,zr,le),W[zr+2]=1,W.size=Math.abs(Bt),W.start=0,W.end=W.size}function J(U,W,le,xe){for(var st=0;st<U.length;st++){var Ct=[];Ut(U[st],Ct,le,xe),W.push(Ct)}}function Qe(U){return U/360+.5}function ne(U){var W=Math.sin(U*Math.PI/180),le=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return le<0?0:le>1?1:le}function et(U,W,le,xe,st,Ct,Bt,Xe){if(xe/=W,Ct>=(le/=W)&&Bt<xe)return U;if(Bt<le||Ct>=xe)return null;for(var Lt=[],lr=0;lr<U.length;lr++){var zr=U[lr],Vr=zr.geometry,cr=zr.type,Ur=st===0?zr.minX:zr.minY,Mn=st===0?zr.maxX:zr.maxY;if(Ur>=le&&Mn<xe)Lt.push(zr);else if(!(Mn<le||Ur>=xe)){var ln=[];if(cr==="Point"||cr==="MultiPoint")kt(Vr,ln,le,xe,st);else if(cr==="LineString")dr(Vr,ln,le,xe,st,!1,Xe.lineMetrics);else if(cr==="MultiLineString")xt(Vr,ln,le,xe,st,!1);else if(cr==="Polygon")xt(Vr,ln,le,xe,st,!0);else if(cr==="MultiPolygon")for(var er=0;er<Vr.length;er++){var tn=[];xt(Vr[er],tn,le,xe,st,!0),tn.length&&ln.push(tn)}if(ln.length){if(Xe.lineMetrics&&cr==="LineString"){for(er=0;er<ln.length;er++)Lt.push(We(zr.id,cr,ln[er],zr.tags));continue}cr!=="LineString"&&cr!=="MultiLineString"||(ln.length===1?(cr="LineString",ln=ln[0]):cr="MultiLineString"),cr!=="Point"&&cr!=="MultiPoint"||(cr=ln.length===3?"Point":"MultiPoint"),Lt.push(We(zr.id,cr,ln,zr.tags))}}}return Lt.length?Lt:null}function kt(U,W,le,xe,st){for(var Ct=0;Ct<U.length;Ct+=3){var Bt=U[Ct+st];Bt>=le&&Bt<=xe&&(W.push(U[Ct]),W.push(U[Ct+1]),W.push(U[Ct+2]))}}function dr(U,W,le,xe,st,Ct,Bt){for(var Xe,Lt,lr=Ye(U),zr=st===0?Et:Fe,Vr=U.start,cr=0;cr<U.length-3;cr+=3){var Ur=U[cr],Mn=U[cr+1],ln=U[cr+2],er=U[cr+3],tn=U[cr+4],hn=st===0?Ur:Mn,xn=st===0?er:tn,yn=!1;Bt&&(Xe=Math.sqrt(Math.pow(Ur-er,2)+Math.pow(Mn-tn,2))),hn<le?xn>le&&(Lt=zr(lr,Ur,Mn,er,tn,le),Bt&&(lr.start=Vr+Xe*Lt)):hn>xe?xn<xe&&(Lt=zr(lr,Ur,Mn,er,tn,xe),Bt&&(lr.start=Vr+Xe*Lt)):bt(lr,Ur,Mn,ln),xn<le&&hn>=le&&(Lt=zr(lr,Ur,Mn,er,tn,le),yn=!0),xn>xe&&hn<=xe&&(Lt=zr(lr,Ur,Mn,er,tn,xe),yn=!0),!Ct&&yn&&(Bt&&(lr.end=Vr+Xe*Lt),W.push(lr),lr=Ye(U)),Bt&&(Vr+=Xe)}var vn=U.length-3;Ur=U[vn],Mn=U[vn+1],ln=U[vn+2],(hn=st===0?Ur:Mn)>=le&&hn<=xe&&bt(lr,Ur,Mn,ln),vn=lr.length-3,Ct&&vn>=3&&(lr[vn]!==lr[0]||lr[vn+1]!==lr[1])&&bt(lr,lr[0],lr[1],lr[2]),lr.length&&W.push(lr)}function Ye(U){var W=[];return W.size=U.size,W.start=U.start,W.end=U.end,W}function xt(U,W,le,xe,st,Ct){for(var Bt=0;Bt<U.length;Bt++)dr(U[Bt],W,le,xe,st,Ct,!1)}function bt(U,W,le,xe){U.push(W),U.push(le),U.push(xe)}function Et(U,W,le,xe,st,Ct){var Bt=(Ct-W)/(xe-W);return U.push(Ct),U.push(le+(st-le)*Bt),U.push(1),Bt}function Fe(U,W,le,xe,st,Ct){var Bt=(Ct-le)/(st-le);return U.push(W+(xe-W)*Bt),U.push(Ct),U.push(1),Bt}function pt(U,W){for(var le=[],xe=0;xe<U.length;xe++){var st,Ct=U[xe],Bt=Ct.type;if(Bt==="Point"||Bt==="MultiPoint"||Bt==="LineString")st=yt(Ct.geometry,W);else if(Bt==="MultiLineString"||Bt==="Polygon"){st=[];for(var Xe=0;Xe<Ct.geometry.length;Xe++)st.push(yt(Ct.geometry[Xe],W))}else if(Bt==="MultiPolygon")for(st=[],Xe=0;Xe<Ct.geometry.length;Xe++){for(var Lt=[],lr=0;lr<Ct.geometry[Xe].length;lr++)Lt.push(yt(Ct.geometry[Xe][lr],W));st.push(Lt)}le.push(We(Ct.id,Bt,st,Ct.tags))}return le}function yt(U,W){var le=[];le.size=U.size,U.start!==void 0&&(le.start=U.start,le.end=U.end);for(var xe=0;xe<U.length;xe+=3)le.push(U[xe]+W,U[xe+1],U[xe+2]);return le}function Ht(U,W){if(U.transformed)return U;var le,xe,st,Ct=1<<U.z,Bt=U.x,Xe=U.y;for(le=0;le<U.features.length;le++){var Lt=U.features[le],lr=Lt.geometry,zr=Lt.type;if(Lt.geometry=[],zr===1)for(xe=0;xe<lr.length;xe+=2)Lt.geometry.push(hr(lr[xe],lr[xe+1],W,Ct,Bt,Xe));else for(xe=0;xe<lr.length;xe++){var Vr=[];for(st=0;st<lr[xe].length;st+=2)Vr.push(hr(lr[xe][st],lr[xe][st+1],W,Ct,Bt,Xe));Lt.geometry.push(Vr)}}return U.transformed=!0,U}function hr(U,W,le,xe,st,Ct){return[Math.round(le*(U*xe-st)),Math.round(le*(W*xe-Ct))]}function Hr(U,W,le,xe,st){for(var Ct=W===st.maxZoom?0:st.tolerance/((1<<W)*st.extent),Bt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:le,y:xe,z:W,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Xe=0;Xe<U.length;Xe++){Bt.numFeatures++,gr(Bt,U[Xe],Ct,st);var Lt=U[Xe].minX,lr=U[Xe].minY,zr=U[Xe].maxX,Vr=U[Xe].maxY;Lt<Bt.minX&&(Bt.minX=Lt),lr<Bt.minY&&(Bt.minY=lr),zr>Bt.maxX&&(Bt.maxX=zr),Vr>Bt.maxY&&(Bt.maxY=Vr)}return Bt}function gr(U,W,le,xe){var st=W.geometry,Ct=W.type,Bt=[];if(Ct==="Point"||Ct==="MultiPoint")for(var Xe=0;Xe<st.length;Xe+=3)Bt.push(st[Xe]),Bt.push(st[Xe+1]),U.numPoints++,U.numSimplified++;else if(Ct==="LineString")Bn(Bt,st,U,le,!1,!1);else if(Ct==="MultiLineString"||Ct==="Polygon")for(Xe=0;Xe<st.length;Xe++)Bn(Bt,st[Xe],U,le,Ct==="Polygon",Xe===0);else if(Ct==="MultiPolygon")for(var Lt=0;Lt<st.length;Lt++){var lr=st[Lt];for(Xe=0;Xe<lr.length;Xe++)Bn(Bt,lr[Xe],U,le,!0,Xe===0)}if(Bt.length){var zr=W.tags||null;if(Ct==="LineString"&&xe.lineMetrics){for(var Vr in zr={},W.tags)zr[Vr]=W.tags[Vr];zr.mapbox_clip_start=st.start/st.size,zr.mapbox_clip_end=st.end/st.size}var cr={geometry:Bt,type:Ct==="Polygon"||Ct==="MultiPolygon"?3:Ct==="LineString"||Ct==="MultiLineString"?2:1,tags:zr};W.id!==null&&(cr.id=W.id),U.features.push(cr)}}function Bn(U,W,le,xe,st,Ct){var Bt=xe*xe;if(xe>0&&W.size<(st?Bt:xe))le.numPoints+=W.length/3;else{for(var Xe=[],Lt=0;Lt<W.length;Lt+=3)(xe===0||W[Lt+2]>Bt)&&(le.numSimplified++,Xe.push(W[Lt]),Xe.push(W[Lt+1])),le.numPoints++;st&&function(lr,zr){for(var Vr=0,cr=0,Ur=lr.length,Mn=Ur-2;cr<Ur;Mn=cr,cr+=2)Vr+=(lr[cr]-lr[Mn])*(lr[cr+1]+lr[Mn+1]);if(Vr>0===zr)for(cr=0,Ur=lr.length;cr<Ur/2;cr+=2){var ln=lr[cr],er=lr[cr+1];lr[cr]=lr[Ur-2-cr],lr[cr+1]=lr[Ur-1-cr],lr[Ur-2-cr]=ln,lr[Ur-1-cr]=er}}(Xe,Ct),U.push(Xe)}}function zn(U,W){var le=(W=this.options=function(st,Ct){for(var Bt in Ct)st[Bt]=Ct[Bt];return st}(Object.create(this.options),W)).debug;if(le&&console.time("preprocess data"),W.maxZoom<0||W.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(W.promoteId&&W.generateId)throw new Error("promoteId and generateId cannot be used together.");var xe=function(st,Ct){var Bt=[];if(st.type==="FeatureCollection")for(var Xe=0;Xe<st.features.length;Xe++)Tt(Bt,st.features[Xe],Ct,Xe);else Tt(Bt,st.type==="Feature"?st:{geometry:st},Ct);return Bt}(U,W);this.tiles={},this.tileCoords=[],le&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",W.indexMaxZoom,W.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(xe=function(st,Ct){var Bt=Ct.buffer/Ct.extent,Xe=st,Lt=et(st,1,-1-Bt,Bt,0,-1,2,Ct),lr=et(st,1,1-Bt,2+Bt,0,-1,2,Ct);return(Lt||lr)&&(Xe=et(st,1,-Bt,1+Bt,0,-1,2,Ct)||[],Lt&&(Xe=pt(Lt,1).concat(Xe)),lr&&(Xe=Xe.concat(pt(lr,-1)))),Xe}(xe,W)).length&&this.splitTile(xe,0,0,0),le&&(xe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function oa(U,W,le){return 32*((1<<U)*le+W)+U}function $n(U,W){var le=U.tileID.canonical;if(!this._geoJSONIndex)return W(null,null);var xe=this._geoJSONIndex.getTile(le.z,le.x,le.y);if(!xe)return W(null,null);var st=new vt(xe.features),Ct=Re(st);Ct.byteOffset===0&&Ct.byteLength===Ct.buffer.byteLength||(Ct=new Uint8Array(Ct)),W(null,{vectorTile:st,rawData:Ct.buffer})}Mt.prototype.load=function(U){var W=this.options,le=W.log,xe=W.minZoom,st=W.maxZoom,Ct=W.nodeSize;le&&console.time("total time");var Bt="prepare "+U.length+" points";le&&console.time(Bt),this.points=U;for(var Xe=[],Lt=0;Lt<U.length;Lt++)U[Lt].geometry&&Xe.push(ge(U[Lt],Lt));this.trees[st+1]=new nt(Xe,R,q,Ct,Float32Array),le&&console.timeEnd(Bt);for(var lr=st;lr>=xe;lr--){var zr=+Date.now();Xe=this._cluster(Xe,lr),this.trees[lr]=new nt(Xe,R,q,Ct,Float32Array),le&&console.log("z%d: %d clusters in %dms",lr,Xe.length,+Date.now()-zr)}return le&&console.timeEnd("total time"),this},Mt.prototype.getClusters=function(U,W){var le=((U[0]+180)%360+360)%360-180,xe=Math.max(-90,Math.min(90,U[1])),st=U[2]===180?180:((U[2]+180)%360+360)%360-180,Ct=Math.max(-90,Math.min(90,U[3]));if(U[2]-U[0]>=360)le=-180,st=180;else if(le>st){var Bt=this.getClusters([le,xe,180,Ct],W),Xe=this.getClusters([-180,xe,st,Ct],W);return Bt.concat(Xe)}for(var Lt=this.trees[this._limitZoom(W)],lr=[],zr=0,Vr=Lt.range(we(le),gt(Ct),we(st),gt(xe));zr<Vr.length;zr+=1){var cr=Lt.points[Vr[zr]];lr.push(cr.numPoints?He(cr):this.points[cr.index])}return lr},Mt.prototype.getChildren=function(U){var W=this._getOriginId(U),le=this._getOriginZoom(U),xe="No cluster with the specified id.",st=this.trees[le];if(!st)throw new Error(xe);var Ct=st.points[W];if(!Ct)throw new Error(xe);for(var Bt=this.options.radius/(this.options.extent*Math.pow(2,le-1)),Xe=[],Lt=0,lr=st.within(Ct.x,Ct.y,Bt);Lt<lr.length;Lt+=1){var zr=st.points[lr[Lt]];zr.parentId===U&&Xe.push(zr.numPoints?He(zr):this.points[zr.index])}if(Xe.length===0)throw new Error(xe);return Xe},Mt.prototype.getLeaves=function(U,W,le){var xe=[];return this._appendLeaves(xe,U,W=W||10,le=le||0,0),xe},Mt.prototype.getTile=function(U,W,le){var xe=this.trees[this._limitZoom(U)],st=Math.pow(2,U),Ct=this.options,Bt=Ct.radius/Ct.extent,Xe=(le-Bt)/st,Lt=(le+1+Bt)/st,lr={features:[]};return this._addTileFeatures(xe.range((W-Bt)/st,Xe,(W+1+Bt)/st,Lt),xe.points,W,le,st,lr),W===0&&this._addTileFeatures(xe.range(1-Bt/st,Xe,1,Lt),xe.points,st,le,st,lr),W===st-1&&this._addTileFeatures(xe.range(0,Xe,Bt/st,Lt),xe.points,-1,le,st,lr),lr.features.length?lr:null},Mt.prototype.getClusterExpansionZoom=function(U){for(var W=this._getOriginZoom(U)-1;W<=this.options.maxZoom;){var le=this.getChildren(U);if(W++,le.length!==1)break;U=le[0].properties.cluster_id}return W},Mt.prototype._appendLeaves=function(U,W,le,xe,st){for(var Ct=0,Bt=this.getChildren(W);Ct<Bt.length;Ct+=1){var Xe=Bt[Ct],Lt=Xe.properties;if(Lt&&Lt.cluster?st+Lt.point_count<=xe?st+=Lt.point_count:st=this._appendLeaves(U,Lt.cluster_id,le,xe,st):st<xe?st++:U.push(Xe),U.length===le)break}return st},Mt.prototype._addTileFeatures=function(U,W,le,xe,st,Ct){for(var Bt=0,Xe=U;Bt<Xe.length;Bt+=1){var Lt=W[Xe[Bt]],lr=Lt.numPoints,zr={type:1,geometry:[[Math.round(this.options.extent*(Lt.x*st-le)),Math.round(this.options.extent*(Lt.y*st-xe))]],tags:lr?ot(Lt):this.points[Lt.index].properties},Vr=void 0;lr?Vr=Lt.id:this.options.generateId?Vr=Lt.index:this.points[Lt.index].id&&(Vr=this.points[Lt.index].id),Vr!==void 0&&(zr.id=Vr),Ct.features.push(zr)}},Mt.prototype._limitZoom=function(U){return Math.max(this.options.minZoom,Math.min(+U,this.options.maxZoom+1))},Mt.prototype._cluster=function(U,W){for(var le=[],xe=this.options,st=xe.reduce,Ct=xe.minPoints,Bt=xe.radius/(xe.extent*Math.pow(2,W)),Xe=0;Xe<U.length;Xe++){var Lt=U[Xe];if(!(Lt.zoom<=W)){Lt.zoom=W;for(var lr=this.trees[W+1],zr=lr.within(Lt.x,Lt.y,Bt),Vr=Lt.numPoints||1,cr=Vr,Ur=0,Mn=zr;Ur<Mn.length;Ur+=1){var ln=lr.points[Mn[Ur]];ln.zoom>W&&(cr+=ln.numPoints||1)}if(cr>=Ct){for(var er=Lt.x*Vr,tn=Lt.y*Vr,hn=st&&Vr>1?this._map(Lt,!0):null,xn=(Xe<<5)+(W+1)+this.points.length,yn=0,vn=zr;yn<vn.length;yn+=1){var Pn=lr.points[vn[yn]];if(!(Pn.zoom<=W)){Pn.zoom=W;var Va=Pn.numPoints||1;er+=Pn.x*Va,tn+=Pn.y*Va,Pn.parentId=xn,st&&(hn||(hn=this._map(Lt,!0)),st(hn,this._map(Pn)))}}Lt.parentId=xn,le.push(ve(er/cr,tn/cr,xn,cr,hn))}else if(le.push(Lt),cr>1)for(var va=0,Ma=zr;va<Ma.length;va+=1){var Ia=lr.points[Ma[va]];Ia.zoom<=W||(Ia.zoom=W,le.push(Ia))}}}return le},Mt.prototype._getOriginId=function(U){return U-this.points.length>>5},Mt.prototype._getOriginZoom=function(U){return(U-this.points.length)%32},Mt.prototype._map=function(U,W){if(U.numPoints)return W?C({},U.properties):U.properties;var le=this.points[U.index].properties,xe=this.options.map(le);return W&&xe===le?C({},xe):xe},zn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},zn.prototype.splitTile=function(U,W,le,xe,st,Ct,Bt){for(var Xe=[U,W,le,xe],Lt=this.options,lr=Lt.debug;Xe.length;){xe=Xe.pop(),le=Xe.pop(),W=Xe.pop(),U=Xe.pop();var zr=1<<W,Vr=oa(W,le,xe),cr=this.tiles[Vr];if(!cr&&(lr>1&&console.time("creation"),cr=this.tiles[Vr]=Hr(U,W,le,xe,Lt),this.tileCoords.push({z:W,x:le,y:xe}),lr)){lr>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",W,le,xe,cr.numFeatures,cr.numPoints,cr.numSimplified),console.timeEnd("creation"));var Ur="z"+W;this.stats[Ur]=(this.stats[Ur]||0)+1,this.total++}if(cr.source=U,st){if(W===Lt.maxZoom||W===st)continue;var Mn=1<<st-W;if(le!==Math.floor(Ct/Mn)||xe!==Math.floor(Bt/Mn))continue}else if(W===Lt.indexMaxZoom||cr.numPoints<=Lt.indexMaxPoints)continue;if(cr.source=null,U.length!==0){lr>1&&console.time("clipping");var ln,er,tn,hn,xn,yn,vn=.5*Lt.buffer/Lt.extent,Pn=.5-vn,Va=.5+vn,va=1+vn;ln=er=tn=hn=null,xn=et(U,zr,le-vn,le+Va,0,cr.minX,cr.maxX,Lt),yn=et(U,zr,le+Pn,le+va,0,cr.minX,cr.maxX,Lt),U=null,xn&&(ln=et(xn,zr,xe-vn,xe+Va,1,cr.minY,cr.maxY,Lt),er=et(xn,zr,xe+Pn,xe+va,1,cr.minY,cr.maxY,Lt),xn=null),yn&&(tn=et(yn,zr,xe-vn,xe+Va,1,cr.minY,cr.maxY,Lt),hn=et(yn,zr,xe+Pn,xe+va,1,cr.minY,cr.maxY,Lt),yn=null),lr>1&&console.timeEnd("clipping"),Xe.push(ln||[],W+1,2*le,2*xe),Xe.push(er||[],W+1,2*le,2*xe+1),Xe.push(tn||[],W+1,2*le+1,2*xe),Xe.push(hn||[],W+1,2*le+1,2*xe+1)}}},zn.prototype.getTile=function(U,W,le){var xe=this.options,st=xe.extent,Ct=xe.debug;if(U<0||U>24)return null;var Bt=1<<U,Xe=oa(U,W=(W%Bt+Bt)%Bt,le);if(this.tiles[Xe])return Ht(this.tiles[Xe],st);Ct>1&&console.log("drilling down to z%d-%d-%d",U,W,le);for(var Lt,lr=U,zr=W,Vr=le;!Lt&&lr>0;)lr--,zr=Math.floor(zr/2),Vr=Math.floor(Vr/2),Lt=this.tiles[oa(lr,zr,Vr)];return Lt&&Lt.source?(Ct>1&&console.log("found parent tile z%d-%d-%d",lr,zr,Vr),Ct>1&&console.time("drilling down"),this.splitTile(Lt.source,lr,zr,Vr,U,W,le),Ct>1&&console.timeEnd("drilling down"),this.tiles[Xe]?Ht(this.tiles[Xe],st):null):null};var Yn=function(U){function W(le,xe,st,Ct){U.call(this,le,xe,st,$n),Ct&&(this.loadGeoJSON=Ct)}return U&&(W.__proto__=U),(W.prototype=Object.create(U&&U.prototype)).constructor=W,W.prototype.loadData=function(le,xe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=xe,this._pendingLoadDataParams=le,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},W.prototype._loadData=function(){var le=this;if(this._pendingCallback&&this._pendingLoadDataParams){var xe=this._pendingCallback,st=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var Ct=!!(st&&st.request&&st.request.collectResourceTiming)&&new i.RequestPerformance(st.request);this.loadGeoJSON(st,function(Bt,Xe){if(Bt||!Xe)return xe(Bt);if(typeof Xe!="object")return xe(new Error("Input data given to '"+st.source+"' is not a valid GeoJSON object."));!function cr(Ur,Mn){var ln,er=Ur&&Ur.type;if(er==="FeatureCollection")for(ln=0;ln<Ur.features.length;ln++)cr(Ur.features[ln],Mn);else if(er==="GeometryCollection")for(ln=0;ln<Ur.geometries.length;ln++)cr(Ur.geometries[ln],Mn);else if(er==="Feature")cr(Ur.geometry,Mn);else if(er==="Polygon")mt(Ur.coordinates,Mn);else if(er==="MultiPolygon")for(ln=0;ln<Ur.coordinates.length;ln++)mt(Ur.coordinates[ln],Mn);return Ur}(Xe,!0);try{if(st.filter){var Lt=i.createExpression(st.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Lt.result==="error")throw new Error(Lt.value.map(function(cr){return cr.key+": "+cr.message}).join(", "));var lr=Xe.features.filter(function(cr){return Lt.value.evaluate({zoom:0},cr)});Xe={type:"FeatureCollection",features:lr}}le._geoJSONIndex=st.cluster?new Mt(function(cr){var Ur=cr.superclusterOptions,Mn=cr.clusterProperties;if(!Mn||!Ur)return Ur;for(var ln={},er={},tn={accumulated:null,zoom:0},hn={properties:null},xn=Object.keys(Mn),yn=0,vn=xn;yn<vn.length;yn+=1){var Pn=vn[yn],Va=Mn[Pn],va=Va[0],Ma=i.createExpression(Va[1]),Ia=i.createExpression(typeof va=="string"?[va,["accumulated"],["get",Pn]]:va);ln[Pn]=Ma.value,er[Pn]=Ia.value}return Ur.map=function(Wi){hn.properties=Wi;for(var da={},di=0,ga=xn;di<ga.length;di+=1){var ya=ga[di];da[ya]=ln[ya].evaluate(tn,hn)}return da},Ur.reduce=function(Wi,da){hn.properties=da;for(var di=0,ga=xn;di<ga.length;di+=1){var ya=ga[di];tn.accumulated=Wi[ya],Wi[ya]=er[ya].evaluate(tn,hn)}},Ur}(st)).load(Xe.features):function(cr,Ur){return new zn(cr,Ur)}(Xe,st.geojsonVtOptions)}catch(cr){return xe(cr)}le.loaded={};var zr={};if(Ct){var Vr=Ct.finish();Vr&&(zr.resourceTiming={},zr.resourceTiming[st.source]=JSON.parse(JSON.stringify(Vr)))}xe(null,zr)})}},W.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},W.prototype.reloadTile=function(le,xe){var st=this.loaded;return st&&st[le.uid]?U.prototype.reloadTile.call(this,le,xe):this.loadTile(le,xe)},W.prototype.loadGeoJSON=function(le,xe){if(le.request)i.getJSON(le.request,xe);else{if(typeof le.data!="string")return xe(new Error("Input data given to '"+le.source+"' is not a valid GeoJSON object."));try{return xe(null,JSON.parse(le.data))}catch(st){return xe(new Error("Input data given to '"+le.source+"' is not a valid GeoJSON object."))}}},W.prototype.removeSource=function(le,xe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),xe()},W.prototype.getClusterExpansionZoom=function(le,xe){try{xe(null,this._geoJSONIndex.getClusterExpansionZoom(le.clusterId))}catch(st){xe(st)}},W.prototype.getClusterChildren=function(le,xe){try{xe(null,this._geoJSONIndex.getChildren(le.clusterId))}catch(st){xe(st)}},W.prototype.getClusterLeaves=function(le,xe){try{xe(null,this._geoJSONIndex.getLeaves(le.clusterId,le.limit,le.offset))}catch(st){xe(st)}},W}(pe),On=function(W){var le=this;this.self=W,this.actor=new i.Actor(W,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:pe,geojson:Yn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(xe,st){if(le.workerSourceTypes[xe])throw new Error('Worker source with name "'+xe+'" already registered.');le.workerSourceTypes[xe]=st},this.self.registerRTLTextPlugin=function(xe){if(i.plugin.isParsed())throw new Error("RTL text plugin already registered.");i.plugin.applyArabicShaping=xe.applyArabicShaping,i.plugin.processBidirectionalText=xe.processBidirectionalText,i.plugin.processStyledBidirectionalText=xe.processStyledBidirectionalText}};return On.prototype.setReferrer=function(U,W){this.referrer=W},On.prototype.setImages=function(U,W,le){for(var xe in this.availableImages[U]=W,this.workerSources[U]){var st=this.workerSources[U][xe];for(var Ct in st)st[Ct].availableImages=W}le()},On.prototype.setLayers=function(U,W,le){this.getLayerIndex(U).replace(W),le()},On.prototype.updateLayers=function(U,W,le){this.getLayerIndex(U).update(W.layers,W.removedIds),le()},On.prototype.loadTile=function(U,W,le){this.getWorkerSource(U,W.type,W.source).loadTile(W,le)},On.prototype.loadDEMTile=function(U,W,le){this.getDEMWorkerSource(U,W.source).loadTile(W,le)},On.prototype.reloadTile=function(U,W,le){this.getWorkerSource(U,W.type,W.source).reloadTile(W,le)},On.prototype.abortTile=function(U,W,le){this.getWorkerSource(U,W.type,W.source).abortTile(W,le)},On.prototype.removeTile=function(U,W,le){this.getWorkerSource(U,W.type,W.source).removeTile(W,le)},On.prototype.removeDEMTile=function(U,W){this.getDEMWorkerSource(U,W.source).removeTile(W)},On.prototype.removeSource=function(U,W,le){if(this.workerSources[U]&&this.workerSources[U][W.type]&&this.workerSources[U][W.type][W.source]){var xe=this.workerSources[U][W.type][W.source];delete this.workerSources[U][W.type][W.source],xe.removeSource!==void 0?xe.removeSource(W,le):le()}},On.prototype.loadWorkerSource=function(U,W,le){try{this.self.importScripts(W.url),le()}catch(xe){le(xe.toString())}},On.prototype.syncRTLPluginState=function(U,W,le){try{i.plugin.setState(W);var xe=i.plugin.getPluginURL();if(i.plugin.isLoaded()&&!i.plugin.isParsed()&&xe!=null){this.self.importScripts(xe);var st=i.plugin.isParsed();le(st?void 0:new Error("RTL Text Plugin failed to import scripts from "+xe),st)}}catch(Ct){le(Ct.toString())}},On.prototype.getAvailableImages=function(U){var W=this.availableImages[U];return W||(W=[]),W},On.prototype.getLayerIndex=function(U){var W=this.layerIndexes[U];return W||(W=this.layerIndexes[U]=new $),W},On.prototype.getWorkerSource=function(U,W,le){var xe=this;return this.workerSources[U]||(this.workerSources[U]={}),this.workerSources[U][W]||(this.workerSources[U][W]={}),this.workerSources[U][W][le]||(this.workerSources[U][W][le]=new this.workerSourceTypes[W]({send:function(Ct,Bt,Xe){xe.actor.send(Ct,Bt,Xe,U)}},this.getLayerIndex(U),this.getAvailableImages(U))),this.workerSources[U][W][le]},On.prototype.getDEMWorkerSource=function(U,W){return this.demWorkerSources[U]||(this.demWorkerSources[U]={}),this.demWorkerSources[U][W]||(this.demWorkerSources[U][W]=new Pe),this.demWorkerSources[U][W]},On.prototype.enforceCacheSizeLimit=function(U,W){i.enforceCacheSizeLimit(W)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new On(self)),On}),F(["./shared"],function(i){"use strict";var Z=i.createCommonjsModule(function(s){function a(g){return!n(g)}function n(g){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var L,z,ue=new Blob([""],{type:"text/javascript"}),Ee=URL.createObjectURL(ue);try{z=new Worker(Ee),L=!0}catch(Ke){L=!1}return z&&z.terminate(),URL.revokeObjectURL(Ee),L}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var L=document.createElement("canvas");L.width=L.height=1;var z=L.getContext("2d");if(!z)return!1;var ue=z.getImageData(0,0,1,1);return ue&&ue.width===L.width}()?(l[w=g&&g.failIfMajorPerformanceCaveat]===void 0&&(l[w]=function(L){var z=function(Ee){var Ke=document.createElement("canvas"),tt=Object.create(a.webGLContextAttributes);return tt.failIfMajorPerformanceCaveat=Ee,Ke.probablySupportsContext?Ke.probablySupportsContext("webgl",tt)||Ke.probablySupportsContext("experimental-webgl",tt):Ke.supportsContext?Ke.supportsContext("webgl",tt)||Ke.supportsContext("experimental-webgl",tt):Ke.getContext("webgl",tt)||Ke.getContext("experimental-webgl",tt)}(L);if(!z)return!1;var ue=z.createShader(z.VERTEX_SHADER);return!(!ue||z.isContextLost())&&(z.shaderSource(ue,"void main() {}"),z.compileShader(ue),z.getShaderParameter(ue,z.COMPILE_STATUS)===!0)}(w)),l[w]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var w}s.exports?s.exports=a:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=a,window.mapboxgl.notSupportedReason=n);var l={};a.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),D={create:function(a,n,l){var g=i.window.document.createElement(a);return n!==void 0&&(g.className=n),l&&l.appendChild(g),g},createNS:function(a,n){return i.window.document.createElementNS(a,n)}},$=i.window.document&&i.window.document.documentElement.style;function te(s){if(!$)return s[0];for(var a=0;a<s.length;a++)if(s[a]in $)return s[a];return s[0]}var fe,K=te(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);D.disableDrag=function(){$&&K&&(fe=$[K],$[K]="none")},D.enableDrag=function(){$&&K&&($[K]=fe)};var Ge=te(["transform","WebkitTransform"]);D.setTransform=function(s,a){s.style[Ge]=a};var pe=!1;try{var Ze=Object.defineProperty({},"passive",{get:function(){pe=!0}});i.window.addEventListener("test",Ze,Ze),i.window.removeEventListener("test",Ze,Ze)}catch(s){pe=!1}D.addEventListener=function(s,a,n,l){l===void 0&&(l={}),s.addEventListener(a,n,"passive"in l&&pe?l:l.capture)},D.removeEventListener=function(s,a,n,l){l===void 0&&(l={}),s.removeEventListener(a,n,"passive"in l&&pe?l:l.capture)};var Pe=function s(a){a.preventDefault(),a.stopPropagation(),i.window.removeEventListener("click",s,!0)};function mt(s){var a=s.userImage;return!!(a&&a.render&&a.render())&&(s.data.replace(new Uint8Array(a.data.buffer)),!0)}D.suppressClick=function(){i.window.addEventListener("click",Pe,!0),i.window.setTimeout(function(){i.window.removeEventListener("click",Pe,!0)},0)},D.mousePos=function(s,a){var n=s.getBoundingClientRect();return new i.Point(a.clientX-n.left-s.clientLeft,a.clientY-n.top-s.clientTop)},D.touchPos=function(s,a){for(var n=s.getBoundingClientRect(),l=[],g=0;g<a.length;g++)l.push(new i.Point(a[g].clientX-n.left-s.clientLeft,a[g].clientY-n.top-s.clientTop));return l},D.mouseButton=function(s){return i.window.InstallTrigger!==void 0&&s.button===2&&s.ctrlKey&&i.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:s.button},D.remove=function(s){s.parentNode&&s.parentNode.removeChild(s)};var De=function(s){function a(){s.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new i.RGBAImage({width:1,height:1}),this.dirty=!0}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.isLoaded=function(){return this.loaded},a.prototype.setLoaded=function(n){if(this.loaded!==n&&(this.loaded=n,n)){for(var l=0,g=this.requestors;l<g.length;l+=1){var w=g[l];this._notify(w.ids,w.callback)}this.requestors=[]}},a.prototype.getImage=function(n){return this.images[n]},a.prototype.addImage=function(n,l){this._validate(n,l)&&(this.images[n]=l)},a.prototype._validate=function(n,l){var g=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new i.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchX" value'))),g=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new i.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchY" value'))),g=!1),this._validateContent(l.content,l)||(this.fire(new i.ErrorEvent(new Error('Image "'+n+'" has invalid "content" value'))),g=!1),g},a.prototype._validateStretch=function(n,l){if(!n)return!0;for(var g=0,w=0,L=n;w<L.length;w+=1){var z=L[w];if(z[0]<g||z[1]<z[0]||l<z[1])return!1;g=z[1]}return!0},a.prototype._validateContent=function(n,l){return!(n&&(n.length!==4||n[0]<0||l.data.width<n[0]||n[1]<0||l.data.height<n[1]||n[2]<0||l.data.width<n[2]||n[3]<0||l.data.height<n[3]||n[2]<n[0]||n[3]<n[1]))},a.prototype.updateImage=function(n,l){l.version=this.images[n].version+1,this.images[n]=l,this.updatedImages[n]=!0},a.prototype.removeImage=function(n){var l=this.images[n];delete this.images[n],delete this.patterns[n],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()},a.prototype.listImages=function(){return Object.keys(this.images)},a.prototype.getImages=function(n,l){var g=!0;if(!this.isLoaded())for(var w=0,L=n;w<L.length;w+=1)this.images[L[w]]||(g=!1);this.isLoaded()||g?this._notify(n,l):this.requestors.push({ids:n,callback:l})},a.prototype._notify=function(n,l){for(var g={},w=0,L=n;w<L.length;w+=1){var z=L[w];this.images[z]||this.fire(new i.Event("styleimagemissing",{id:z}));var ue=this.images[z];ue?g[z]={data:ue.data.clone(),pixelRatio:ue.pixelRatio,sdf:ue.sdf,version:ue.version,stretchX:ue.stretchX,stretchY:ue.stretchY,content:ue.content,hasRenderCallback:Boolean(ue.userImage&&ue.userImage.render)}:i.warnOnce('Image "'+z+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}l(null,g)},a.prototype.getPixelSize=function(){var n=this.atlasImage;return{width:n.width,height:n.height}},a.prototype.getPattern=function(n){var l=this.patterns[n],g=this.getImage(n);if(!g)return null;if(l&&l.position.version===g.version)return l.position;if(l)l.position.version=g.version;else{var w={w:g.data.width+2,h:g.data.height+2,x:0,y:0},L=new i.ImagePosition(w,g);this.patterns[n]={bin:w,position:L}}return this._updatePatternAtlas(),this.patterns[n].position},a.prototype.bind=function(n){var l=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new i.Texture(n,this.atlasImage,l.RGBA),this.atlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE)},a.prototype._updatePatternAtlas=function(){var n=[];for(var l in this.patterns)n.push(this.patterns[l].bin);var g=i.potpack(n),w=g.w,L=g.h,z=this.atlasImage;for(var ue in z.resize({width:w||1,height:L||1}),this.patterns){var Ee=this.patterns[ue].bin,Ke=Ee.x+1,tt=Ee.y+1,rt=this.images[ue].data,Ft=rt.width,Nt=rt.height;i.RGBAImage.copy(rt,z,{x:0,y:0},{x:Ke,y:tt},{width:Ft,height:Nt}),i.RGBAImage.copy(rt,z,{x:0,y:Nt-1},{x:Ke,y:tt-1},{width:Ft,height:1}),i.RGBAImage.copy(rt,z,{x:0,y:0},{x:Ke,y:tt+Nt},{width:Ft,height:1}),i.RGBAImage.copy(rt,z,{x:Ft-1,y:0},{x:Ke-1,y:tt},{width:1,height:Nt}),i.RGBAImage.copy(rt,z,{x:0,y:0},{x:Ke+Ft,y:tt},{width:1,height:Nt})}this.dirty=!0},a.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},a.prototype.dispatchRenderCallbacks=function(n){for(var l=0,g=n;l<g.length;l+=1){var w=g[l];if(!this.callbackDispatchedThisFrame[w]){this.callbackDispatchedThisFrame[w]=!0;var L=this.images[w];mt(L)&&this.updateImage(w,L)}}},a}(i.Evented),At=Je,it=Je,vt=1e20;function Je(s,a,n,l,g,w){this.fontSize=s||24,this.buffer=a===void 0?3:a,this.cutoff=l||.25,this.fontFamily=g||"sans-serif",this.fontWeight=w||"normal",this.radius=n||8;var L=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=L,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(L*L),this.gridInner=new Float64Array(L*L),this.f=new Float64Array(L),this.d=new Float64Array(L),this.z=new Float64Array(L+1),this.v=new Int16Array(L),this.middle=Math.round(L/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function _t(s,a,n,l,g,w,L){for(var z=0;z<a;z++){for(var ue=0;ue<n;ue++)l[ue]=s[ue*a+z];for(wt(l,g,w,L,n),ue=0;ue<n;ue++)s[ue*a+z]=g[ue]}for(ue=0;ue<n;ue++){for(z=0;z<a;z++)l[z]=s[ue*a+z];for(wt(l,g,w,L,a),z=0;z<a;z++)s[ue*a+z]=Math.sqrt(g[z])}}function wt(s,a,n,l,g){n[0]=0,l[0]=-vt,l[1]=+vt;for(var w=1,L=0;w<g;w++){for(var z=(s[w]+w*w-(s[n[L]]+n[L]*n[L]))/(2*w-2*n[L]);z<=l[L];)L--,z=(s[w]+w*w-(s[n[L]]+n[L]*n[L]))/(2*w-2*n[L]);n[++L]=w,l[L]=z,l[L+1]=+vt}for(w=0,L=0;w<g;w++){for(;l[L+1]<w;)L++;a[w]=(w-n[L])*(w-n[L])+s[n[L]]}}Je.prototype.draw=function(s){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(s,this.buffer,this.middle);for(var a=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),l=0;l<this.size*this.size;l++){var g=a.data[4*l+3]/255;this.gridOuter[l]=g===1?0:g===0?vt:Math.pow(Math.max(0,.5-g),2),this.gridInner[l]=g===1?vt:g===0?0:Math.pow(Math.max(0,g-.5),2)}for(_t(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),_t(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),l=0;l<this.size*this.size;l++)n[l]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[l]-this.gridInner[l])/this.radius+this.cutoff))));return n},At.default=it;var ke=function(a,n){this.requestManager=a,this.localIdeographFontFamily=n,this.entries={}};ke.prototype.setURL=function(s){this.url=s},ke.prototype.getGlyphs=function(s,a){var n=this,l=[];for(var g in s)for(var w=0,L=s[g];w<L.length;w+=1)l.push({stack:g,id:L[w]});i.asyncAll(l,function(z,ue){var Ee=z.stack,Ke=z.id,tt=n.entries[Ee];tt||(tt=n.entries[Ee]={glyphs:{},requests:{},ranges:{}});var rt=tt.glyphs[Ke];if(rt===void 0){if(rt=n._tinySDF(tt,Ee,Ke))return tt.glyphs[Ke]=rt,void ue(null,{stack:Ee,id:Ke,glyph:rt});var Ft=Math.floor(Ke/256);if(256*Ft>65535)ue(new Error("glyphs > 65535 not supported"));else if(tt.ranges[Ft])ue(null,{stack:Ee,id:Ke,glyph:rt});else{var Nt=tt.requests[Ft];Nt||(Nt=tt.requests[Ft]=[],ke.loadGlyphRange(Ee,Ft,n.url,n.requestManager,function(Kt,jt){if(jt){for(var Gt in jt)n._doesCharSupportLocalGlyph(+Gt)||(tt.glyphs[+Gt]=jt[+Gt]);tt.ranges[Ft]=!0}for(var nr=0,rr=Nt;nr<rr.length;nr+=1)(0,rr[nr])(Kt,jt);delete tt.requests[Ft]})),Nt.push(function(Kt,jt){Kt?ue(Kt):jt&&ue(null,{stack:Ee,id:Ke,glyph:jt[Ke]||null})})}}else ue(null,{stack:Ee,id:Ke,glyph:rt})},function(z,ue){if(z)a(z);else if(ue){for(var Ee={},Ke=0,tt=ue;Ke<tt.length;Ke+=1){var rt=tt[Ke],Ft=rt.stack,Nt=rt.id,Kt=rt.glyph;(Ee[Ft]||(Ee[Ft]={}))[Nt]=Kt&&{id:Kt.id,bitmap:Kt.bitmap.clone(),metrics:Kt.metrics}}a(null,Ee)}})},ke.prototype._doesCharSupportLocalGlyph=function(s){return!!this.localIdeographFontFamily&&(i.isChar["CJK Unified Ideographs"](s)||i.isChar["Hangul Syllables"](s)||i.isChar.Hiragana(s)||i.isChar.Katakana(s))},ke.prototype._tinySDF=function(s,a,n){var l=this.localIdeographFontFamily;if(l&&this._doesCharSupportLocalGlyph(n)){var g=s.tinySDF;if(!g){var w="400";/bold/i.test(a)?w="900":/medium/i.test(a)?w="500":/light/i.test(a)&&(w="200"),g=s.tinySDF=new ke.TinySDF(24,3,8,.25,l,w)}return{id:n,bitmap:new i.AlphaImage({width:30,height:30},g.draw(String.fromCharCode(n))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},ke.loadGlyphRange=function(s,a,n,l,g){var w=256*a,L=w+255,z=l.transformRequest(l.normalizeGlyphsURL(n).replace("{fontstack}",s).replace("{range}",w+"-"+L),i.ResourceType.Glyphs);i.getArrayBuffer(z,function(ue,Ee){if(ue)g(ue);else if(Ee){for(var Ke={},tt=0,rt=i.parseGlyphPBF(Ee);tt<rt.length;tt+=1){var Ft=rt[tt];Ke[Ft.id]=Ft}g(null,Ke)}})},ke.TinySDF=At;var Re=function(){this.specification=i.styleSpec.light.position};Re.prototype.possiblyEvaluate=function(s,a){return i.sphericalToCartesian(s.expression.evaluate(a))},Re.prototype.interpolate=function(s,a,n){return{x:i.number(s.x,a.x,n),y:i.number(s.y,a.y,n),z:i.number(s.z,a.z,n)}};var Ve=new i.Properties({anchor:new i.DataConstantProperty(i.styleSpec.light.anchor),position:new Re,color:new i.DataConstantProperty(i.styleSpec.light.color),intensity:new i.DataConstantProperty(i.styleSpec.light.intensity)}),dt=function(s){function a(n){s.call(this),this._transitionable=new i.Transitionable(Ve),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getLight=function(){return this._transitionable.serialize()},a.prototype.setLight=function(n,l){if(l===void 0&&(l={}),!this._validate(i.validateLight,n,l))for(var g in n){var w=n[g];i.endsWith(g,"-transition")?this._transitionable.setTransition(g.slice(0,-"-transition".length),w):this._transitionable.setValue(g,w)}},a.prototype.updateTransitions=function(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)},a.prototype.hasTransition=function(){return this._transitioning.hasTransition()},a.prototype.recalculate=function(n){this.properties=this._transitioning.possiblyEvaluate(n)},a.prototype._validate=function(n,l,g){return(!g||g.validate!==!1)&&i.emitValidationErrors(this,n.call(i.validateStyle,i.extend({value:l,style:{glyphs:!0,sprite:!0},styleSpec:i.styleSpec})))},a}(i.Evented),Me=function(a,n){this.width=a,this.height=n,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Me.prototype.getDash=function(s,a){var n=s.join(",")+String(a);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(s,a)),this.dashEntry[n]},Me.prototype.getDashRanges=function(s,a,n){var l=[],g=s.length%2==1?-s[s.length-1]*n:0,w=s[0]*n,L=!0;l.push({left:g,right:w,isDash:L,zeroLength:s[0]===0});for(var z=s[0],ue=1;ue<s.length;ue++){var Ee=s[ue];l.push({left:g=z*n,right:w=(z+=Ee)*n,isDash:L=!L,zeroLength:Ee===0})}return l},Me.prototype.addRoundDash=function(s,a,n){for(var l=a/2,g=-n;g<=n;g++)for(var w=this.width*(this.nextRow+n+g),L=0,z=s[L],ue=0;ue<this.width;ue++){ue/z.right>1&&(z=s[++L]);var Ee=Math.abs(ue-z.left),Ke=Math.abs(ue-z.right),tt=Math.min(Ee,Ke),rt=void 0,Ft=g/n*(l+1);if(z.isDash){var Nt=l-Math.abs(Ft);rt=Math.sqrt(tt*tt+Nt*Nt)}else rt=l-Math.sqrt(tt*tt+Ft*Ft);this.data[w+ue]=Math.max(0,Math.min(255,rt+128))}},Me.prototype.addRegularDash=function(s){for(var a=s.length-1;a>=0;--a){var n=s[a],l=s[a+1];n.zeroLength?s.splice(a,1):l&&l.isDash===n.isDash&&(l.left=n.left,s.splice(a,1))}var g=s[0],w=s[s.length-1];g.isDash===w.isDash&&(g.left=w.left-this.width,w.right=g.right+this.width);for(var L=this.width*this.nextRow,z=0,ue=s[z],Ee=0;Ee<this.width;Ee++){Ee/ue.right>1&&(ue=s[++z]);var Ke=Math.abs(Ee-ue.left),tt=Math.abs(Ee-ue.right),rt=Math.min(Ke,tt);this.data[L+Ee]=Math.max(0,Math.min(255,(ue.isDash?rt:-rt)+128))}},Me.prototype.addDash=function(s,a){var n=a?7:0,l=2*n+1;if(this.nextRow+l>this.height)return i.warnOnce("LineAtlas out of space"),null;for(var g=0,w=0;w<s.length;w++)g+=s[w];if(g!==0){var L=this.width/g,z=this.getDashRanges(s,this.width,L);a?this.addRoundDash(z,L,n):this.addRegularDash(z)}var ue={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:g};return this.nextRow+=l,this.dirty=!0,ue},Me.prototype.bind=function(s){var a=s.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))};var ht=function s(a,n){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=i.uniqueId();for(var l=this.workerPool.acquire(this.id),g=0;g<l.length;g++){var w=new s.Actor(l[g],n,this.id);w.name="Worker "+g,this.actors.push(w)}};function Zt(s,a,n){var l=function(w,L){if(w)return n(w);if(L){var z=i.pick(i.extend(L,s),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);L.vector_layers&&(z.vectorLayers=L.vector_layers,z.vectorLayerIds=z.vectorLayers.map(function(ue){return ue.id})),z.tiles=a.canonicalizeTileset(z,s.url),n(null,z)}};return s.url?i.getJSON(a.transformRequest(a.normalizeSourceURL(s.url),i.ResourceType.Source),l):i.browser.frame(function(){return l(null,s)})}ht.prototype.broadcast=function(s,a,n){i.asyncAll(this.actors,function(l,g){l.send(s,a,g)},n=n||function(){})},ht.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},ht.prototype.remove=function(){this.actors.forEach(function(s){s.remove()}),this.actors=[],this.workerPool.release(this.id)},ht.Actor=i.Actor;var Qt=function(a,n,l){this.bounds=i.LngLatBounds.convert(this.validateBounds(a)),this.minzoom=n||0,this.maxzoom=l||24};Qt.prototype.validateBounds=function(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]},Qt.prototype.contains=function(s){var a=Math.pow(2,s.z),n=Math.floor(i.mercatorXfromLng(this.bounds.getWest())*a),l=Math.floor(i.mercatorYfromLat(this.bounds.getNorth())*a),g=Math.ceil(i.mercatorXfromLng(this.bounds.getEast())*a),w=Math.ceil(i.mercatorYfromLat(this.bounds.getSouth())*a);return s.x>=n&&s.x<g&&s.y>=l&&s.y<w};var ur=function(s){function a(n,l,g,w){if(s.call(this),this.id=n,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.extend(this,i.pick(l,["url","scheme","tileSize","promoteId"])),this._options=i.extend({type:"vector"},l),this._collectResourceTiming=l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new i.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Zt(this._options,this.map._requestManager,function(l,g){n._tileJSONRequest=null,n._loaded=!0,l?n.fire(new i.ErrorEvent(l)):g&&(i.extend(n,g),g.bounds&&(n.tileBounds=new Qt(g.bounds,n.minzoom,n.maxzoom)),i.postTurnstileEvent(g.tiles,n.map._requestManager._customAccessToken),i.postMapLoadEvent(g.tiles,n.map._getMapId(),n.map._requestManager._skuToken,n.map._requestManager._customAccessToken),n.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.setSourceProperty=function(n){this._tileJSONRequest&&this._tileJSONRequest.cancel(),n(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},a.prototype.setTiles=function(n){var l=this;return this.setSourceProperty(function(){l._options.tiles=n}),this},a.prototype.setUrl=function(n){var l=this;return this.setSourceProperty(function(){l.url=n,l._options.url=n}),this},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return i.extend({},this._options)},a.prototype.loadTile=function(n,l){var g=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(g,i.ResourceType.Tile),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:i.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function L(z,ue){return delete n.request,n.aborted?l(null):z&&z.status!==404?l(z):(ue&&ue.resourceTiming&&(n.resourceTiming=ue.resourceTiming),this.map._refreshExpiredTiles&&ue&&n.setExpiryData(ue),n.loadVectorData(ue,this.map.painter),i.cacheEntryPossiblyAdded(this.dispatcher),l(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}w.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired"?n.state==="loading"?n.reloadCallback=l:n.request=n.actor.send("reloadTile",w,L.bind(this)):(n.actor=this.dispatcher.getActor(),n.request=n.actor.send("loadTile",w,L.bind(this)))},a.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id},void 0)},a.prototype.unloadTile=function(n){n.unloadVectorData(),n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id},void 0)},a.prototype.hasTransition=function(){return!1},a}(i.Evented),oe=function(s){function a(n,l,g,w){s.call(this),this.id=n,this.dispatcher=g,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.extend({type:"raster"},l),i.extend(this,i.pick(l,["url","scheme","tileSize"]))}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new i.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Zt(this._options,this.map._requestManager,function(l,g){n._tileJSONRequest=null,n._loaded=!0,l?n.fire(new i.ErrorEvent(l)):g&&(i.extend(n,g),g.bounds&&(n.tileBounds=new Qt(g.bounds,n.minzoom,n.maxzoom)),i.postTurnstileEvent(g.tiles),i.postMapLoadEvent(g.tiles,n.map._getMapId(),n.map._requestManager._skuToken),n.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return i.extend({},this._options)},a.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},a.prototype.loadTile=function(n,l){var g=this,w=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);n.request=i.getImage(this.map._requestManager.transformRequest(w,i.ResourceType.Tile),function(L,z){if(delete n.request,n.aborted)n.state="unloaded",l(null);else if(L)n.state="errored",l(L);else if(z){g.map._refreshExpiredTiles&&n.setExpiryData(z),delete z.cacheControl,delete z.expires;var ue=g.map.painter.context,Ee=ue.gl;n.texture=g.map.painter.getTileTexture(z.width),n.texture?n.texture.update(z,{useMipmap:!0}):(n.texture=new i.Texture(ue,z,Ee.RGBA,{useMipmap:!0}),n.texture.bind(Ee.LINEAR,Ee.CLAMP_TO_EDGE,Ee.LINEAR_MIPMAP_NEAREST),ue.extTextureFilterAnisotropic&&Ee.texParameterf(Ee.TEXTURE_2D,ue.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ue.extTextureFilterAnisotropicMax)),n.state="loaded",i.cacheEntryPossiblyAdded(g.dispatcher),l(null)}})},a.prototype.abortTile=function(n,l){n.request&&(n.request.cancel(),delete n.request),l()},a.prototype.unloadTile=function(n,l){n.texture&&this.map.painter.saveTileTexture(n.texture),l()},a.prototype.hasTransition=function(){return!1},a}(i.Evented),Q=function(s){function a(n,l,g,w){s.call(this,n,l,g,w),this.type="raster-dem",this.maxzoom=22,this._options=i.extend({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox"}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},a.prototype.loadTile=function(n,l){var g=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function w(L,z){L&&(n.state="errored",l(L)),z&&(n.dem=z,n.needsHillshadePrepare=!0,n.state="loaded",l(null))}n.request=i.getImage(this.map._requestManager.transformRequest(g,i.ResourceType.Tile),function(L,z){if(delete n.request,n.aborted)n.state="unloaded",l(null);else if(L)n.state="errored",l(L);else if(z){this.map._refreshExpiredTiles&&n.setExpiryData(z),delete z.cacheControl,delete z.expires;var ue=i.window.ImageBitmap&&z instanceof i.window.ImageBitmap&&i.offscreenCanvasSupported()?z:i.browser.getImageData(z,1),Ee={uid:n.uid,coord:n.tileID,source:this.id,rawImageData:ue,encoding:this.encoding};n.actor&&n.state!=="expired"||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",Ee,w.bind(this)))}}.bind(this)),n.neighboringTiles=this._getNeighboringTiles(n.tileID)},a.prototype._getNeighboringTiles=function(n){var l=n.canonical,g=Math.pow(2,l.z),w=(l.x-1+g)%g,L=l.x===0?n.wrap-1:n.wrap,z=(l.x+1+g)%g,ue=l.x+1===g?n.wrap+1:n.wrap,Ee={};return Ee[new i.OverscaledTileID(n.overscaledZ,L,l.z,w,l.y).key]={backfilled:!1},Ee[new i.OverscaledTileID(n.overscaledZ,ue,l.z,z,l.y).key]={backfilled:!1},l.y>0&&(Ee[new i.OverscaledTileID(n.overscaledZ,L,l.z,w,l.y-1).key]={backfilled:!1},Ee[new i.OverscaledTileID(n.overscaledZ,n.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},Ee[new i.OverscaledTileID(n.overscaledZ,ue,l.z,z,l.y-1).key]={backfilled:!1}),l.y+1<g&&(Ee[new i.OverscaledTileID(n.overscaledZ,L,l.z,w,l.y+1).key]={backfilled:!1},Ee[new i.OverscaledTileID(n.overscaledZ,n.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},Ee[new i.OverscaledTileID(n.overscaledZ,ue,l.z,z,l.y+1).key]={backfilled:!1}),Ee},a.prototype.unloadTile=function(n){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&n.actor.send("removeDEMTile",{uid:n.uid,source:this.id})},a}(oe),H=function(s){function a(n,l,g,w){s.call(this),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=g.getActor(),this.setEventedParent(w),this._data=l.data,this._options=i.extend({},l),this._collectResourceTiming=l.collectResourceTiming,this._resourceTiming=[],l.maxzoom!==void 0&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;var L=i.EXTENT/this.tileSize;this.workerOptions=i.extend({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(l.buffer!==void 0?l.buffer:128)*L,tolerance:(l.tolerance!==void 0?l.tolerance:.375)*L,extent:i.EXTENT,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:l.clusterMaxZoom!==void 0?Math.min(l.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:i.EXTENT,radius:(l.clusterRadius||50)*L,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this.fire(new i.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(l){if(l)n.fire(new i.ErrorEvent(l));else{var g={dataType:"source",sourceDataType:"metadata"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(g.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new i.Event("data",g))}})},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.setData=function(n){var l=this;return this._data=n,this.fire(new i.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(g){if(g)l.fire(new i.ErrorEvent(g));else{var w={dataType:"source",sourceDataType:"content"};l._collectResourceTiming&&l._resourceTiming&&l._resourceTiming.length>0&&(w.resourceTiming=l._resourceTiming,l._resourceTiming=[]),l.fire(new i.Event("data",w))}}),this},a.prototype.getClusterExpansionZoom=function(n,l){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:n,source:this.id},l),this},a.prototype.getClusterChildren=function(n,l){return this.actor.send("geojson.getClusterChildren",{clusterId:n,source:this.id},l),this},a.prototype.getClusterLeaves=function(n,l,g,w){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:n,limit:l,offset:g},w),this},a.prototype._updateWorkerData=function(n){var l=this;this._loaded=!1;var g=i.extend({},this.workerOptions),w=this._data;typeof w=="string"?(g.request=this.map._requestManager.transformRequest(i.browser.resolveURL(w),i.ResourceType.Source),g.request.collectResourceTiming=this._collectResourceTiming):g.data=JSON.stringify(w),this.actor.send(this.type+".loadData",g,function(L,z){l._removed||z&&z.abandoned||(l._loaded=!0,z&&z.resourceTiming&&z.resourceTiming[l.id]&&(l._resourceTiming=z.resourceTiming[l.id].slice(0)),l.actor.send(l.type+".coalesce",{source:g.source},null),n(L))})},a.prototype.loaded=function(){return this._loaded},a.prototype.loadTile=function(n,l){var g=this,w=n.actor?"reloadTile":"loadTile";n.actor=this.actor,n.request=this.actor.send(w,{type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:i.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(L,z){return delete n.request,n.unloadVectorData(),n.aborted?l(null):L?l(L):(n.loadVectorData(z,g.map.painter,w==="reloadTile"),l(null))})},a.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.aborted=!0},a.prototype.unloadTile=function(n){n.unloadVectorData(),this.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id})},a.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},a.prototype.serialize=function(){return i.extend({},this._options,{type:this.type,data:this._data})},a.prototype.hasTransition=function(){return!1},a}(i.Evented),Se=i.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),be=function(s){function a(n,l,g,w){s.call(this),this.id=n,this.dispatcher=g,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=l}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(n,l){var g=this;this._loaded=!1,this.fire(new i.Event("dataloading",{dataType:"source"})),this.url=this.options.url,i.getImage(this.map._requestManager.transformRequest(this.url,i.ResourceType.Image),function(w,L){g._loaded=!0,w?g.fire(new i.ErrorEvent(w)):L&&(g.image=L,n&&(g.coordinates=n),l&&l(),g._finishLoading())})},a.prototype.loaded=function(){return this._loaded},a.prototype.updateImage=function(n){var l=this;return this.image&&n.url?(this.options.url=n.url,this.load(n.coordinates,function(){l.texture=null}),this):this},a.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})))},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.setCoordinates=function(n){var l=this;this.coordinates=n;var g=n.map(i.MercatorCoordinate.fromLngLat);this.tileID=function(L){for(var z=1/0,ue=1/0,Ee=-1/0,Ke=-1/0,tt=0,rt=L;tt<rt.length;tt+=1){var Ft=rt[tt];z=Math.min(z,Ft.x),ue=Math.min(ue,Ft.y),Ee=Math.max(Ee,Ft.x),Ke=Math.max(Ke,Ft.y)}var Nt=Math.max(Ee-z,Ke-ue),Kt=Math.max(0,Math.floor(-Math.log(Nt)/Math.LN2)),jt=Math.pow(2,Kt);return new i.CanonicalTileID(Kt,Math.floor((z+Ee)/2*jt),Math.floor((ue+Ke)/2*jt))}(g),this.minzoom=this.maxzoom=this.tileID.z;var w=g.map(function(L){return l.tileID.getTilePoint(L)._round()});return this._boundsArray=new i.StructArrayLayout4i8,this._boundsArray.emplaceBack(w[0].x,w[0].y,0,0),this._boundsArray.emplaceBack(w[1].x,w[1].y,i.EXTENT,0),this._boundsArray.emplaceBack(w[3].x,w[3].y,0,i.EXTENT),this._boundsArray.emplaceBack(w[2].x,w[2].y,i.EXTENT,i.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"})),this},a.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var n=this.map.painter.context,l=n.gl;for(var g in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Se.members)),this.boundsSegments||(this.boundsSegments=i.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new i.Texture(n,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[g];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},a.prototype.loadTile=function(n,l){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},l(null)):(n.state="errored",l(null))},a.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return!1},a}(i.Evented),Te=function(s){function a(n,l,g,w){s.call(this,n,l,g,w),this.roundZoom=!0,this.type="video",this.options=l}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this._loaded=!1;var l=this.options;this.urls=[];for(var g=0,w=l.urls;g<w.length;g+=1)this.urls.push(this.map._requestManager.transformRequest(w[g],i.ResourceType.Source).url);i.getVideo(this.urls,function(L,z){n._loaded=!0,L?n.fire(new i.ErrorEvent(L)):z&&(n.video=z,n.video.loop=!0,n.video.addEventListener("playing",function(){n.map.triggerRepaint()}),n.map&&n.video.play(),n._finishLoading())})},a.prototype.pause=function(){this.video&&this.video.pause()},a.prototype.play=function(){this.video&&this.video.play()},a.prototype.seek=function(n){if(this.video){var l=this.video.seekable;n<l.start(0)||n>l.end(0)?this.fire(new i.ErrorEvent(new i.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+l.start(0)+" and "+l.end(0)+"-second mark."))):this.video.currentTime=n}},a.prototype.getVideo=function(){return this.video},a.prototype.onAdd=function(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},a.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var n=this.map.painter.context,l=n.gl;for(var g in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Se.members)),this.boundsSegments||(this.boundsSegments=i.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new i.Texture(n,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[g];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this.video&&!this.video.paused},a}(be),me=function(s){function a(n,l,g,w){s.call(this,n,l,g,w),l.coordinates?Array.isArray(l.coordinates)&&l.coordinates.length===4&&!l.coordinates.some(function(L){return!Array.isArray(L)||L.length!==2||L.some(function(z){return typeof z!="number"})})||this.fire(new i.ErrorEvent(new i.ValidationError("sources."+n,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.ErrorEvent(new i.ValidationError("sources."+n,null,'missing required property "coordinates"'))),l.animate&&typeof l.animate!="boolean"&&this.fire(new i.ErrorEvent(new i.ValidationError("sources."+n,null,'optional "animate" property must be a boolean value'))),l.canvas?typeof l.canvas=="string"||l.canvas instanceof i.window.HTMLCanvasElement||this.fire(new i.ErrorEvent(new i.ValidationError("sources."+n,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.ErrorEvent(new i.ValidationError("sources."+n,null,'missing required property "canvas"'))),this.options=l,this.animate=l.animate===void 0||l.animate}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof i.window.HTMLCanvasElement?this.options.canvas:i.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},a.prototype.getCanvas=function(){return this.canvas},a.prototype.onAdd=function(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()},a.prototype.onRemove=function(){this.pause()},a.prototype.prepare=function(){var n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var l=this.map.painter.context,g=l.gl;for(var w in this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,Se.members)),this.boundsSegments||(this.boundsSegments=i.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.Texture(l,this.canvas,g.RGBA,{premultiply:!0}),this.tiles){var L=this.tiles[w];L.state!=="loaded"&&(L.state="loaded",L.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this._playing},a.prototype._hasInvalidDimensions=function(){for(var n=0,l=[this.canvas.width,this.canvas.height];n<l.length;n+=1){var g=l[n];if(isNaN(g)||g<=0)return!0}return!1},a}(be),nt={vector:ur,raster:oe,"raster-dem":Q,geojson:H,video:Te,image:be,canvas:me};function Jt(s,a){var n=i.identity([]);return i.translate(n,n,[1,1,0]),i.scale(n,n,[.5*s.width,.5*s.height,1]),i.multiply(n,n,s.calculatePosMatrix(a.toUnwrapped()))}function Mt(s,a,n,l,g,w){var L=function(Kt,jt,Gt){if(Kt)for(var nr=0,rr=Kt;nr<rr.length;nr+=1){var Lr=jt[rr[nr]];if(Lr&&Lr.source===Gt&&Lr.type==="fill-extrusion")return!0}else for(var vr in jt){var Sr=jt[vr];if(Sr.source===Gt&&Sr.type==="fill-extrusion")return!0}return!1}(g&&g.layers,a,s.id),z=w.maxPitchScaleFactor(),ue=s.tilesIn(l,z,L);ue.sort(ve);for(var Ee=[],Ke=0,tt=ue;Ke<tt.length;Ke+=1){var rt=tt[Ke];Ee.push({wrappedTileID:rt.tileID.wrapped().key,queryResults:rt.tile.queryRenderedFeatures(a,n,s._state,rt.queryGeometry,rt.cameraQueryGeometry,rt.scale,g,w,z,Jt(s.transform,rt.tileID))})}var Ft=function(Kt){for(var jt={},Gt={},nr=0,rr=Kt;nr<rr.length;nr+=1){var Lr=rr[nr],vr=Lr.queryResults,Sr=Lr.wrappedTileID,Ar=Gt[Sr]=Gt[Sr]||{};for(var rn in vr)for(var Xr=vr[rn],mn=Ar[rn]=Ar[rn]||{},Ln=jt[rn]=jt[rn]||[],qn=0,sa=Xr;qn<sa.length;qn+=1){var Sa=sa[qn];mn[Sa.featureIndex]||(mn[Sa.featureIndex]=!0,Ln.push(Sa))}}return jt}(Ee);for(var Nt in Ft)Ft[Nt].forEach(function(Kt){var jt=Kt.feature,Gt=s.getFeatureState(jt.layer["source-layer"],jt.id);jt.source=jt.layer.source,jt.layer["source-layer"]&&(jt.sourceLayer=jt.layer["source-layer"]),jt.state=Gt});return Ft}function ve(s,a){var n=s.tileID,l=a.tileID;return n.overscaledZ-l.overscaledZ||n.canonical.y-l.canonical.y||n.wrap-l.wrap||n.canonical.x-l.canonical.x}var ge=function(a,n){this.max=a,this.onRemove=n,this.reset()};ge.prototype.reset=function(){for(var s in this.data)for(var a=0,n=this.data[s];a<n.length;a+=1){var l=n[a];l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value)}return this.data={},this.order=[],this},ge.prototype.add=function(s,a,n){var l=this,g=s.wrapped().key;this.data[g]===void 0&&(this.data[g]=[]);var w={value:a,timeout:void 0};if(n!==void 0&&(w.timeout=setTimeout(function(){l.remove(s,w)},n)),this.data[g].push(w),this.order.push(g),this.order.length>this.max){var L=this._getAndRemoveByKey(this.order[0]);L&&this.onRemove(L)}return this},ge.prototype.has=function(s){return s.wrapped().key in this.data},ge.prototype.getAndRemove=function(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null},ge.prototype._getAndRemoveByKey=function(s){var a=this.data[s].shift();return a.timeout&&clearTimeout(a.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),a.value},ge.prototype.getByKey=function(s){var a=this.data[s];return a?a[0].value:null},ge.prototype.get=function(s){return this.has(s)?this.data[s.wrapped().key][0].value:null},ge.prototype.remove=function(s,a){if(!this.has(s))return this;var n=s.wrapped().key,l=a===void 0?0:this.data[n].indexOf(a),g=this.data[n][l];return this.data[n].splice(l,1),g.timeout&&clearTimeout(g.timeout),this.data[n].length===0&&delete this.data[n],this.onRemove(g.value),this.order.splice(this.order.indexOf(n),1),this},ge.prototype.setMaxSize=function(s){for(this.max=s;this.order.length>this.max;){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},ge.prototype.filter=function(s){var a=[];for(var n in this.data)for(var l=0,g=this.data[n];l<g.length;l+=1){var w=g[l];s(w.value)||a.push(w)}for(var L=0,z=a;L<z.length;L+=1){var ue=z[L];this.remove(ue.value.tileID,ue)}};var He=function(a,n,l){this.context=a;var g=a.gl;this.buffer=g.createBuffer(),this.dynamicDraw=Boolean(l),this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer};He.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},He.prototype.updateData=function(s){var a=this.context.gl;this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)},He.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var ot={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},we=function(a,n,l,g){this.length=n.length,this.attributes=l,this.itemSize=n.bytesPerElement,this.dynamicDraw=g,this.context=a;var w=a.gl;this.buffer=w.createBuffer(),a.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer};we.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},we.prototype.updateData=function(s){var a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,s.arrayBuffer)},we.prototype.enableAttributes=function(s,a){for(var n=0;n<this.attributes.length;n++){var l=a.attributes[this.attributes[n].name];l!==void 0&&s.enableVertexAttribArray(l)}},we.prototype.setVertexAttribPointers=function(s,a,n){for(var l=0;l<this.attributes.length;l++){var g=this.attributes[l],w=a.attributes[g.name];w!==void 0&&s.vertexAttribPointer(w,g.components,s[ot[g.type]],!1,this.itemSize,g.offset+this.itemSize*(n||0))}},we.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var gt=function(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};gt.prototype.get=function(){return this.current},gt.prototype.set=function(s){},gt.prototype.getDefault=function(){return this.default},gt.prototype.setDefault=function(){this.set(this.default)};var C=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return i.Color.transparent},a.prototype.set=function(n){var l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},a}(gt),R=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 1},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)},a}(gt),q=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 0},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)},a}(gt),ce=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return[!0,!0,!0,!0]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},a}(gt),We=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!0},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)},a}(gt),qe=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 255},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)},a}(gt),Tt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},a.prototype.set=function(n){var l=this.current;(n.func!==l.func||n.ref!==l.ref||n.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)},a}(gt),at=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){var n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)},a}(gt),Ut=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=n,this.dirty=!1}},a}(gt),J=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return[0,1]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)},a}(gt),Qe=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=n,this.dirty=!1}},a}(gt),ne=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.LESS},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)},a}(gt),et=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.BLEND):l.disable(l.BLEND),this.current=n,this.dirty=!1}},a}(gt),kt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){var n=this.gl;return[n.ONE,n.ZERO]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)},a}(gt),dr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return i.Color.transparent},a.prototype.set=function(n){var l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},a}(gt),Ye=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.FUNC_ADD},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)},a}(gt),xt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=n,this.dirty=!1}},a}(gt),bt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.BACK},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)},a}(gt),Et=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.CCW},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)},a}(gt),Fe=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)},a}(gt),pt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.TEXTURE0},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)},a}(gt),yt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){var n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},a}(gt),Ht=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,n),this.current=n,this.dirty=!1}},a}(gt),hr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,n),this.current=n,this.dirty=!1}},a}(gt),Hr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindTexture(l.TEXTURE_2D,n),this.current=n,this.dirty=!1}},a}(gt),gr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}},a}(gt),Bn=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){var l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1},a}(gt),zn=function(s){function a(n){s.call(this,n),this.vao=n.extVertexArrayObject}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){this.vao&&(n!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(n),this.current=n,this.dirty=!1)},a}(gt),oa=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 4},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}},a}(gt),$n=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}},a}(gt),Yn=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}},a}(gt),On=function(s){function a(n,l){s.call(this,n),this.context=n,this.parent=l}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a}(gt),U=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.setDirty=function(){this.dirty=!0},a.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}},a}(On),W=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,n),this.current=n,this.dirty=!1}},a}(On),le=function(a,n,l,g){this.context=a,this.width=n,this.height=l;var w=this.framebuffer=a.gl.createFramebuffer();this.colorAttachment=new U(a,w),g&&(this.depthAttachment=new W(a,w))};le.prototype.destroy=function(){var s=this.context.gl,a=this.colorAttachment.get();if(a&&s.deleteTexture(a),this.depthAttachment){var n=this.depthAttachment.get();n&&s.deleteRenderbuffer(n)}s.deleteFramebuffer(this.framebuffer)};var xe=function(a,n,l){this.func=a,this.mask=n,this.range=l};xe.ReadOnly=!1,xe.ReadWrite=!0,xe.disabled=new xe(519,xe.ReadOnly,[0,1]);var st=function(a,n,l,g,w,L){this.test=a,this.ref=n,this.mask=l,this.fail=g,this.depthFail=w,this.pass=L};st.disabled=new st({func:519,mask:0},0,0,7680,7680,7680);var Ct=function(a,n,l){this.blendFunction=a,this.blendColor=n,this.mask=l};Ct.disabled=new Ct(Ct.Replace=[1,0],i.Color.transparent,[!1,!1,!1,!1]),Ct.unblended=new Ct(Ct.Replace,i.Color.transparent,[!0,!0,!0,!0]),Ct.alphaBlended=new Ct([1,771],i.Color.transparent,[!0,!0,!0,!0]);var Bt=function(a,n,l){this.enable=a,this.mode=n,this.frontFace=l};Bt.disabled=new Bt(!1,1029,2305),Bt.backCCW=new Bt(!0,1029,2305);var Xe=function(a){this.gl=a,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new C(this),this.clearDepth=new R(this),this.clearStencil=new q(this),this.colorMask=new ce(this),this.depthMask=new We(this),this.stencilMask=new qe(this),this.stencilFunc=new Tt(this),this.stencilOp=new at(this),this.stencilTest=new Ut(this),this.depthRange=new J(this),this.depthTest=new Qe(this),this.depthFunc=new ne(this),this.blend=new et(this),this.blendFunc=new kt(this),this.blendColor=new dr(this),this.blendEquation=new Ye(this),this.cullFace=new xt(this),this.cullFaceSide=new bt(this),this.frontFace=new Et(this),this.program=new Fe(this),this.activeTexture=new pt(this),this.viewport=new yt(this),this.bindFramebuffer=new Ht(this),this.bindRenderbuffer=new hr(this),this.bindTexture=new Hr(this),this.bindVertexBuffer=new gr(this),this.bindElementBuffer=new Bn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new zn(this),this.pixelStoreUnpack=new oa(this),this.pixelStoreUnpackPremultiplyAlpha=new $n(this),this.pixelStoreUnpackFlipY=new Yn(this),this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=a.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(a.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=a.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=a.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE)};Xe.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Xe.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Xe.prototype.createIndexBuffer=function(s,a){return new He(this,s,a)},Xe.prototype.createVertexBuffer=function(s,a,n){return new we(this,s,a,n)},Xe.prototype.createRenderbuffer=function(s,a,n){var l=this.gl,g=l.createRenderbuffer();return this.bindRenderbuffer.set(g),l.renderbufferStorage(l.RENDERBUFFER,s,a,n),this.bindRenderbuffer.set(null),g},Xe.prototype.createFramebuffer=function(s,a,n){return new le(this,s,a,n)},Xe.prototype.clear=function(s){var a=s.color,n=s.depth,l=this.gl,g=0;a&&(g|=l.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set([!0,!0,!0,!0])),n!==void 0&&(g|=l.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),l.clear(g)},Xe.prototype.setCullFace=function(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))},Xe.prototype.setDepthMode=function(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)},Xe.prototype.setStencilMode=function(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)},Xe.prototype.setColorMode=function(s){i.deepEqual(s.blendFunction,Ct.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor)),this.colorMask.set(s.mask)},Xe.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Lt=function(s){function a(n,l,g){var w=this;s.call(this),this.id=n,this.dispatcher=g,this.on("data",function(L){L.dataType==="source"&&L.sourceDataType==="metadata"&&(w._sourceLoaded=!0),w._sourceLoaded&&!w._paused&&L.dataType==="source"&&L.sourceDataType==="content"&&(w.reload(),w.transform&&w.update(w.transform))}),this.on("error",function(){w._sourceErrored=!0}),this._source=function(L,z,ue,Ee){var Ke=new nt[z.type](L,z,ue,Ee);if(Ke.id!==L)throw new Error("Expected Source id to be "+L+" instead of "+Ke.id);return i.bindAll(["load","abort","unload","serialize","prepare"],Ke),Ke}(n,l,g,this),this._tiles={},this._cache=new ge(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new i.SourceFeatureState}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.onAdd=function(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(n)},a.prototype.onRemove=function(n){this._source&&this._source.onRemove&&this._source.onRemove(n)},a.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var n in this._tiles){var l=this._tiles[n];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0},a.prototype.getSource=function(){return this._source},a.prototype.pause=function(){this._paused=!0},a.prototype.resume=function(){if(this._paused){var n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}},a.prototype._loadTile=function(n,l){return this._source.loadTile(n,l)},a.prototype._unloadTile=function(n){if(this._source.unloadTile)return this._source.unloadTile(n,function(){})},a.prototype._abortTile=function(n){if(this._source.abortTile)return this._source.abortTile(n,function(){})},a.prototype.serialize=function(){return this._source.serialize()},a.prototype.prepare=function(n){for(var l in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var g=this._tiles[l];g.upload(n),g.prepare(this.map.style.imageManager)}},a.prototype.getIds=function(){return i.values(this._tiles).map(function(n){return n.tileID}).sort(lr).map(function(n){return n.key})},a.prototype.getRenderableIds=function(n){var l=this,g=[];for(var w in this._tiles)this._isIdRenderable(w,n)&&g.push(this._tiles[w]);return n?g.sort(function(L,z){var ue=L.tileID,Ee=z.tileID,Ke=new i.Point(ue.canonical.x,ue.canonical.y)._rotate(l.transform.angle),tt=new i.Point(Ee.canonical.x,Ee.canonical.y)._rotate(l.transform.angle);return ue.overscaledZ-Ee.overscaledZ||tt.y-Ke.y||tt.x-Ke.x}).map(function(L){return L.tileID.key}):g.map(function(L){return L.tileID}).sort(lr).map(function(L){return L.key})},a.prototype.hasRenderableParent=function(n){var l=this.findLoadedParent(n,0);return!!l&&this._isIdRenderable(l.tileID.key)},a.prototype._isIdRenderable=function(n,l){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(l||!this._tiles[n].holdingForFade())},a.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var n in this._cache.reset(),this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(n,"reloading")},a.prototype._reloadTile=function(n,l){var g=this._tiles[n];g&&(g.state!=="loading"&&(g.state=l),this._loadTile(g,this._tileLoaded.bind(this,g,n,l)))},a.prototype._tileLoaded=function(n,l,g,w){if(w)return n.state="errored",void(w.status!==404?this._source.fire(new i.ErrorEvent(w,{tile:n})):this.update(this.transform));n.timeAdded=i.browser.now(),g==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(l,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new i.Event("data",{dataType:"source",tile:n,coord:n.tileID}))},a.prototype._backfillDEM=function(n){for(var l=this.getRenderableIds(),g=0;g<l.length;g++){var w=l[g];if(n.neighboringTiles&&n.neighboringTiles[w]){var L=this.getTileByID(w);z(n,L),z(L,n)}}function z(ue,Ee){ue.needsHillshadePrepare=!0;var Ke=Ee.tileID.canonical.x-ue.tileID.canonical.x,tt=Ee.tileID.canonical.y-ue.tileID.canonical.y,rt=Math.pow(2,ue.tileID.canonical.z),Ft=Ee.tileID.key;Ke===0&&tt===0||Math.abs(tt)>1||(Math.abs(Ke)>1&&(Math.abs(Ke+rt)===1?Ke+=rt:Math.abs(Ke-rt)===1&&(Ke-=rt)),Ee.dem&&ue.dem&&(ue.dem.backfillBorder(Ee.dem,Ke,tt),ue.neighboringTiles&&ue.neighboringTiles[Ft]&&(ue.neighboringTiles[Ft].backfilled=!0)))}},a.prototype.getTile=function(n){return this.getTileByID(n.key)},a.prototype.getTileByID=function(n){return this._tiles[n]},a.prototype._retainLoadedChildren=function(n,l,g,w){for(var L in this._tiles){var z=this._tiles[L];if(!(w[L]||!z.hasData()||z.tileID.overscaledZ<=l||z.tileID.overscaledZ>g)){for(var ue=z.tileID;z&&z.tileID.overscaledZ>l+1;){var Ee=z.tileID.scaledTo(z.tileID.overscaledZ-1);(z=this._tiles[Ee.key])&&z.hasData()&&(ue=Ee)}for(var Ke=ue;Ke.overscaledZ>l;)if(n[(Ke=Ke.scaledTo(Ke.overscaledZ-1)).key]){w[ue.key]=ue;break}}}},a.prototype.findLoadedParent=function(n,l){if(n.key in this._loadedParentTiles){var g=this._loadedParentTiles[n.key];return g&&g.tileID.overscaledZ>=l?g:null}for(var w=n.overscaledZ-1;w>=l;w--){var L=n.scaledTo(w),z=this._getLoadedTile(L);if(z)return z}},a.prototype._getLoadedTile=function(n){var l=this._tiles[n.key];return l&&l.hasData()?l:this._cache.getByKey(n.wrapped().key)},a.prototype.updateCacheSize=function(n){var l=Math.ceil(n.width/this._source.tileSize)+1,g=Math.ceil(n.height/this._source.tileSize)+1,w=Math.floor(l*g*5),L=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(L)},a.prototype.handleWrapJump=function(n){var l=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,l){var g={};for(var w in this._tiles){var L=this._tiles[w];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+l),g[L.tileID.key]=L}for(var z in this._tiles=g,this._timers)clearTimeout(this._timers[z]),delete this._timers[z];for(var ue in this._tiles)this._setTileReloadTimer(ue,this._tiles[ue])}},a.prototype.update=function(n){var l=this;if(this.transform=n,this._sourceLoaded&&!this._paused){var g;this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?g=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Ar){return new i.OverscaledTileID(Ar.canonical.z,Ar.wrap,Ar.canonical.z,Ar.canonical.x,Ar.canonical.y)}):(g=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(g=g.filter(function(Ar){return l._source.hasTile(Ar)}))):g=[];var w=n.coveringZoomLevel(this._source),L=Math.max(w-a.maxOverzooming,this._source.minzoom),z=Math.max(w+a.maxUnderzooming,this._source.minzoom),ue=this._updateRetainedTiles(g,w);if(zr(this._source.type)){for(var Ee={},Ke={},tt=0,rt=Object.keys(ue);tt<rt.length;tt+=1){var Ft=rt[tt],Nt=ue[Ft],Kt=this._tiles[Ft];if(Kt&&!(Kt.fadeEndTime&&Kt.fadeEndTime<=i.browser.now())){var jt=this.findLoadedParent(Nt,L);jt&&(this._addTile(jt.tileID),Ee[jt.tileID.key]=jt.tileID),Ke[Ft]=Nt}}for(var Gt in this._retainLoadedChildren(Ke,w,z,ue),Ee)ue[Gt]||(this._coveredTiles[Gt]=!0,ue[Gt]=Ee[Gt])}for(var nr in ue)this._tiles[nr].clearFadeHold();for(var rr=0,Lr=i.keysDifference(this._tiles,ue);rr<Lr.length;rr+=1){var vr=Lr[rr],Sr=this._tiles[vr];Sr.hasSymbolBuckets&&!Sr.holdingForFade()?Sr.setHoldDuration(this.map._fadeDuration):Sr.hasSymbolBuckets&&!Sr.symbolFadeFinished()||this._removeTile(vr)}this._updateLoadedParentTileCache()}},a.prototype.releaseSymbolFadeTiles=function(){for(var n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)},a.prototype._updateRetainedTiles=function(n,l){for(var g={},w={},L=Math.max(l-a.maxOverzooming,this._source.minzoom),z=Math.max(l+a.maxUnderzooming,this._source.minzoom),ue={},Ee=0,Ke=n;Ee<Ke.length;Ee+=1){var tt=Ke[Ee],rt=this._addTile(tt);g[tt.key]=tt,rt.hasData()||l<this._source.maxzoom&&(ue[tt.key]=tt)}this._retainLoadedChildren(ue,l,z,g);for(var Ft=0,Nt=n;Ft<Nt.length;Ft+=1){var Kt=Nt[Ft],jt=this._tiles[Kt.key];if(!jt.hasData()){if(l+1>this._source.maxzoom){var Gt=Kt.children(this._source.maxzoom)[0],nr=this.getTile(Gt);if(nr&&nr.hasData()){g[Gt.key]=Gt;continue}}else{var rr=Kt.children(this._source.maxzoom);if(g[rr[0].key]&&g[rr[1].key]&&g[rr[2].key]&&g[rr[3].key])continue}for(var Lr=jt.wasRequested(),vr=Kt.overscaledZ-1;vr>=L;--vr){var Sr=Kt.scaledTo(vr);if(w[Sr.key])break;if(w[Sr.key]=!0,!(jt=this.getTile(Sr))&&Lr&&(jt=this._addTile(Sr)),jt&&(g[Sr.key]=Sr,Lr=jt.wasRequested(),jt.hasData()))break}}}return g},a.prototype._updateLoadedParentTileCache=function(){for(var n in this._loadedParentTiles={},this._tiles){for(var l=[],g=void 0,w=this._tiles[n].tileID;w.overscaledZ>0;){if(w.key in this._loadedParentTiles){g=this._loadedParentTiles[w.key];break}l.push(w.key);var L=w.scaledTo(w.overscaledZ-1);if(g=this._getLoadedTile(L))break;w=L}for(var z=0,ue=l;z<ue.length;z+=1)this._loadedParentTiles[ue[z]]=g}},a.prototype._addTile=function(n){var l=this._tiles[n.key];if(l)return l;(l=this._cache.getAndRemove(n))&&(this._setTileReloadTimer(n.key,l),l.tileID=n,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,l)));var g=Boolean(l);return g||(l=new i.Tile(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(l,this._tileLoaded.bind(this,l,n.key,l.state))),l?(l.uses++,this._tiles[n.key]=l,g||this._source.fire(new i.Event("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null},a.prototype._setTileReloadTimer=function(n,l){var g=this;n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);var w=l.getExpiryTimeout();w&&(this._timers[n]=setTimeout(function(){g._reloadTile(n,"expired"),delete g._timers[n]},w))},a.prototype._removeTile=function(n){var l=this._tiles[n];l&&(l.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),l.uses>0||(l.hasData()&&l.state!=="reloading"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))},a.prototype.clearTiles=function(){for(var n in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(n);this._cache.reset()},a.prototype.tilesIn=function(n,l,g){var w=this,L=[],z=this.transform;if(!z)return L;for(var ue=g?z.getCameraQueryGeometry(n):n,Ee=n.map(function(vr){return z.pointCoordinate(vr)}),Ke=ue.map(function(vr){return z.pointCoordinate(vr)}),tt=this.getIds(),rt=1/0,Ft=1/0,Nt=-1/0,Kt=-1/0,jt=0,Gt=Ke;jt<Gt.length;jt+=1){var nr=Gt[jt];rt=Math.min(rt,nr.x),Ft=Math.min(Ft,nr.y),Nt=Math.max(Nt,nr.x),Kt=Math.max(Kt,nr.y)}for(var rr=function(Sr){var Ar=w._tiles[tt[Sr]];if(!Ar.holdingForFade()){var rn=Ar.tileID,Xr=Math.pow(2,z.zoom-Ar.tileID.overscaledZ),mn=l*Ar.queryPadding*i.EXTENT/Ar.tileSize/Xr,Ln=[rn.getTilePoint(new i.MercatorCoordinate(rt,Ft)),rn.getTilePoint(new i.MercatorCoordinate(Nt,Kt))];if(Ln[0].x-mn<i.EXTENT&&Ln[0].y-mn<i.EXTENT&&Ln[1].x+mn>=0&&Ln[1].y+mn>=0){var qn=Ee.map(function(Sa){return rn.getTilePoint(Sa)}),sa=Ke.map(function(Sa){return rn.getTilePoint(Sa)});L.push({tile:Ar,tileID:rn,queryGeometry:qn,cameraQueryGeometry:sa,scale:Xr})}}},Lr=0;Lr<tt.length;Lr++)rr(Lr);return L},a.prototype.getVisibleCoordinates=function(n){for(var l=this,g=this.getRenderableIds(n).map(function(ue){return l._tiles[ue].tileID}),w=0,L=g;w<L.length;w+=1){var z=L[w];z.posMatrix=this.transform.calculatePosMatrix(z.toUnwrapped())}return g},a.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(zr(this._source.type))for(var n in this._tiles){var l=this._tiles[n];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=i.browser.now())return!0}return!1},a.prototype.setFeatureState=function(n,l,g){this._state.updateState(n=n||"_geojsonTileLayer",l,g)},a.prototype.removeFeatureState=function(n,l,g){this._state.removeFeatureState(n=n||"_geojsonTileLayer",l,g)},a.prototype.getFeatureState=function(n,l){return this._state.getState(n=n||"_geojsonTileLayer",l)},a.prototype.setDependencies=function(n,l,g){var w=this._tiles[n];w&&w.setDependencies(l,g)},a.prototype.reloadTilesForDependencies=function(n,l){for(var g in this._tiles)this._tiles[g].hasDependency(n,l)&&this._reloadTile(g,"reloading");this._cache.filter(function(w){return!w.hasDependency(n,l)})},a}(i.Evented);function lr(s,a){var n=Math.abs(2*s.wrap)-+(s.wrap<0),l=Math.abs(2*a.wrap)-+(a.wrap<0);return s.overscaledZ-a.overscaledZ||l-n||a.canonical.y-s.canonical.y||a.canonical.x-s.canonical.x}function zr(s){return s==="raster"||s==="image"||s==="video"}function Vr(){return new i.window.Worker(oc.workerUrl)}Lt.maxOverzooming=10,Lt.maxUnderzooming=3;var cr="mapboxgl_preloaded_worker_pool",Ur=function(){this.active={}};Ur.prototype.acquire=function(s){if(!this.workers)for(this.workers=[];this.workers.length<Ur.workerCount;)this.workers.push(new Vr);return this.active[s]=!0,this.workers.slice()},Ur.prototype.release=function(s){delete this.active[s],this.numActive()===0&&(this.workers.forEach(function(a){a.terminate()}),this.workers=null)},Ur.prototype.isPreloaded=function(){return!!this.active[cr]},Ur.prototype.numActive=function(){return Object.keys(this.active).length};var Mn,ln=Math.floor(i.browser.hardwareConcurrency/2);function er(){return Mn||(Mn=new Ur),Mn}function tn(s,a){var n={};for(var l in s)l!=="ref"&&(n[l]=s[l]);return i.refProperties.forEach(function(g){g in a&&(n[g]=a[g])}),n}function hn(s){s=s.slice();for(var a=Object.create(null),n=0;n<s.length;n++)a[s[n].id]=s[n];for(var l=0;l<s.length;l++)"ref"in s[l]&&(s[l]=tn(s[l],a[s[l].ref]));return s}Ur.workerCount=Math.max(Math.min(ln,6),1);var xn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function yn(s,a,n){n.push({command:xn.addSource,args:[s,a[s]]})}function vn(s,a,n){a.push({command:xn.removeSource,args:[s]}),n[s]=!0}function Pn(s,a,n,l){vn(s,n,l),yn(s,a,n)}function Va(s,a,n){var l;for(l in s[n])if(s[n].hasOwnProperty(l)&&l!=="data"&&!i.deepEqual(s[n][l],a[n][l]))return!1;for(l in a[n])if(a[n].hasOwnProperty(l)&&l!=="data"&&!i.deepEqual(s[n][l],a[n][l]))return!1;return!0}function va(s,a,n,l,g,w){var L;for(L in a=a||{},s=s||{})s.hasOwnProperty(L)&&(i.deepEqual(s[L],a[L])||n.push({command:w,args:[l,L,a[L],g]}));for(L in a)a.hasOwnProperty(L)&&!s.hasOwnProperty(L)&&(i.deepEqual(s[L],a[L])||n.push({command:w,args:[l,L,a[L],g]}))}function Ma(s){return s.id}function Ia(s,a){return s[a.id]=a,s}var Wi=function(a,n){this.reset(a,n)};Wi.prototype.reset=function(s,a){this.points=s||[],this._distances=[0];for(var n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Wi.prototype.lerp=function(s){if(this.points.length===1)return this.points[0];s=i.clamp(s,0,1);for(var a=1,n=this._distances[a],l=s*this.paddedLength+this.padding;n<l&&a<this._distances.length;)n=this._distances[++a];var g=a-1,w=this._distances[g],L=n-w,z=L>0?(l-w)/L:0;return this.points[g].mult(1-z).add(this.points[a].mult(z))};var da=function(a,n,l){var g=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(a/l),this.yCellCount=Math.ceil(n/l);for(var L=0;L<this.xCellCount*this.yCellCount;L++)g.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=n,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0};function di(s,a,n,l,g){var w=i.create();return a?(i.scale(w,w,[1/g,1/g,1]),n||i.rotateZ(w,w,l.angle)):i.multiply(w,l.labelPlaneMatrix,s),w}function ga(s,a,n,l,g){if(a){var w=i.clone(s);return i.scale(w,w,[g,g,1]),n||i.rotateZ(w,w,-l.angle),w}return l.glCoordMatrix}function ya(s,a){var n=[s.x,s.y,0,1];Yi(n,n,a);var l=n[3];return{point:new i.Point(n[0]/l,n[1]/l),signedDistanceFromCamera:l}}function fa(s,a){return .5+s/a*.5}function Si(s,a){var n=s[0]/s[3],l=s[1]/s[3];return n>=-a[0]&&n<=a[0]&&l>=-a[1]&&l<=a[1]}function ns(s,a,n,l,g,w,L,z){var ue=l?s.textSizeData:s.iconSizeData,Ee=i.evaluateSizeForZoom(ue,n.transform.zoom),Ke=[256/n.width*2+1,256/n.height*2+1],tt=l?s.text.dynamicLayoutVertexArray:s.icon.dynamicLayoutVertexArray;tt.clear();for(var rt=s.lineVertexArray,Ft=l?s.text.placedSymbolArray:s.icon.placedSymbolArray,Nt=n.transform.width/n.transform.height,Kt=!1,jt=0;jt<Ft.length;jt++){var Gt=Ft.get(jt);if(Gt.hidden||Gt.writingMode===i.WritingMode.vertical&&!Kt)oi(Gt.numGlyphs,tt);else{Kt=!1;var nr=[Gt.anchorX,Gt.anchorY,0,1];if(i.transformMat4(nr,nr,a),Si(nr,Ke)){var rr=fa(n.transform.cameraToCenterDistance,nr[3]),Lr=i.evaluateSizeForFeature(ue,Ee,Gt),vr=L?Lr/rr:Lr*rr,Sr=new i.Point(Gt.anchorX,Gt.anchorY),Ar=ya(Sr,g).point,rn={},Xr=ju(Gt,vr,!1,z,a,g,w,s.glyphOffsetArray,rt,tt,Ar,Sr,rn,Nt);Kt=Xr.useVertical,(Xr.notEnoughRoom||Kt||Xr.needsFlipping&&ju(Gt,vr,!0,z,a,g,w,s.glyphOffsetArray,rt,tt,Ar,Sr,rn,Nt).notEnoughRoom)&&oi(Gt.numGlyphs,tt)}else oi(Gt.numGlyphs,tt)}}l?s.text.dynamicLayoutVertexBuffer.updateData(tt):s.icon.dynamicLayoutVertexBuffer.updateData(tt)}function Xi(s,a,n,l,g,w,L,z,ue,Ee,Ke){var tt=z.glyphStartIndex+z.numGlyphs,rt=z.lineStartIndex,Ft=z.lineStartIndex+z.lineLength,Nt=a.getoffsetX(z.glyphStartIndex),Kt=a.getoffsetX(tt-1),jt=Ai(s*Nt,n,l,g,w,L,z.segment,rt,Ft,ue,Ee,Ke);if(!jt)return null;var Gt=Ai(s*Kt,n,l,g,w,L,z.segment,rt,Ft,ue,Ee,Ke);return Gt?{first:jt,last:Gt}:null}function Vo(s,a,n,l){return s===i.WritingMode.horizontal&&Math.abs(n.y-a.y)>Math.abs(n.x-a.x)*l?{useVertical:!0}:(s===i.WritingMode.vertical?a.y<n.y:a.x>n.x)?{needsFlipping:!0}:null}function ju(s,a,n,l,g,w,L,z,ue,Ee,Ke,tt,rt,Ft){var Nt,Kt=a/24,jt=s.lineOffsetX*Kt,Gt=s.lineOffsetY*Kt;if(s.numGlyphs>1){var nr=s.glyphStartIndex+s.numGlyphs,rr=s.lineStartIndex,Lr=s.lineStartIndex+s.lineLength,vr=Xi(Kt,z,jt,Gt,n,Ke,tt,s,ue,w,rt);if(!vr)return{notEnoughRoom:!0};var Sr=ya(vr.first.point,L).point,Ar=ya(vr.last.point,L).point;if(l&&!n){var rn=Vo(s.writingMode,Sr,Ar,Ft);if(rn)return rn}Nt=[vr.first];for(var Xr=s.glyphStartIndex+1;Xr<nr-1;Xr++)Nt.push(Ai(Kt*z.getoffsetX(Xr),jt,Gt,n,Ke,tt,s.segment,rr,Lr,ue,w,rt));Nt.push(vr.last)}else{if(l&&!n){var mn=ya(tt,g).point,Ln=s.lineStartIndex+s.segment+1,qn=new i.Point(ue.getx(Ln),ue.gety(Ln)),sa=ya(qn,g),Sa=sa.signedDistanceFromCamera>0?sa.point:Ga(tt,qn,mn,1,g),Za=Vo(s.writingMode,mn,Sa,Ft);if(Za)return Za}var Sn=Ai(Kt*z.getoffsetX(s.glyphStartIndex),jt,Gt,n,Ke,tt,s.segment,s.lineStartIndex,s.lineStartIndex+s.lineLength,ue,w,rt);if(!Sn)return{notEnoughRoom:!0};Nt=[Sn]}for(var ua=0,ba=Nt;ua<ba.length;ua+=1){var Zn=ba[ua];i.addDynamicAttributes(Ee,Zn.point,Zn.angle)}return{}}function Ga(s,a,n,l,g){var w=ya(s.add(s.sub(a)._unit()),g).point,L=n.sub(w);return n.add(L._mult(l/L.mag()))}function Ai(s,a,n,l,g,w,L,z,ue,Ee,Ke,tt){var rt=l?s-a:s+a,Ft=rt>0?1:-1,Nt=0;l&&(Ft*=-1,Nt=Math.PI),Ft<0&&(Nt+=Math.PI);for(var Kt=Ft>0?z+L:z+L+1,jt=g,Gt=g,nr=0,rr=0,Lr=Math.abs(rt),vr=[];nr+rr<=Lr;){if((Kt+=Ft)<z||Kt>=ue)return null;if(Gt=jt,vr.push(jt),(jt=tt[Kt])===void 0){var Sr=new i.Point(Ee.getx(Kt),Ee.gety(Kt)),Ar=ya(Sr,Ke);if(Ar.signedDistanceFromCamera>0)jt=tt[Kt]=Ar.point;else{var rn=Kt-Ft;jt=Ga(nr===0?w:new i.Point(Ee.getx(rn),Ee.gety(rn)),Sr,Gt,Lr-nr+1,Ke)}}nr+=rr,rr=Gt.dist(jt)}var Xr=(Lr-nr)/rr,mn=jt.sub(Gt),Ln=mn.mult(Xr)._add(Gt);Ln._add(mn._unit()._perp()._mult(n*Ft));var qn=Nt+Math.atan2(jt.y-Gt.y,jt.x-Gt.x);return vr.push(Ln),{point:Ln,angle:qn,path:vr}}da.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},da.prototype.insert=function(s,a,n,l,g){this._forEachCell(a,n,l,g,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(a),this.bboxes.push(n),this.bboxes.push(l),this.bboxes.push(g)},da.prototype.insertCircle=function(s,a,n,l){this._forEachCell(a-l,n-l,a+l,n+l,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(a),this.circles.push(n),this.circles.push(l)},da.prototype._insertBoxCell=function(s,a,n,l,g,w){this.boxCells[g].push(w)},da.prototype._insertCircleCell=function(s,a,n,l,g,w){this.circleCells[g].push(w)},da.prototype._query=function(s,a,n,l,g,w){if(n<0||s>this.width||l<0||a>this.height)return!g&&[];var L=[];if(s<=0&&a<=0&&this.width<=n&&this.height<=l){if(g)return!0;for(var z=0;z<this.boxKeys.length;z++)L.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(var ue=0;ue<this.circleKeys.length;ue++){var Ee=this.circles[3*ue],Ke=this.circles[3*ue+1],tt=this.circles[3*ue+2];L.push({key:this.circleKeys[ue],x1:Ee-tt,y1:Ke-tt,x2:Ee+tt,y2:Ke+tt})}return w?L.filter(w):L}return this._forEachCell(s,a,n,l,this._queryCell,L,{hitTest:g,seenUids:{box:{},circle:{}}},w),g?L.length>0:L},da.prototype._queryCircle=function(s,a,n,l,g){var w=s-n,L=s+n,z=a-n,ue=a+n;if(L<0||w>this.width||ue<0||z>this.height)return!l&&[];var Ee=[];return this._forEachCell(w,z,L,ue,this._queryCellCircle,Ee,{hitTest:l,circle:{x:s,y:a,radius:n},seenUids:{box:{},circle:{}}},g),l?Ee.length>0:Ee},da.prototype.query=function(s,a,n,l,g){return this._query(s,a,n,l,!1,g)},da.prototype.hitTest=function(s,a,n,l,g){return this._query(s,a,n,l,!0,g)},da.prototype.hitTestCircle=function(s,a,n,l){return this._queryCircle(s,a,n,!0,l)},da.prototype._queryCell=function(s,a,n,l,g,w,L,z){var ue=L.seenUids,Ee=this.boxCells[g];if(Ee!==null)for(var Ke=this.bboxes,tt=0,rt=Ee;tt<rt.length;tt+=1){var Ft=rt[tt];if(!ue.box[Ft]){ue.box[Ft]=!0;var Nt=4*Ft;if(s<=Ke[Nt+2]&&a<=Ke[Nt+3]&&n>=Ke[Nt+0]&&l>=Ke[Nt+1]&&(!z||z(this.boxKeys[Ft]))){if(L.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[Ft],x1:Ke[Nt],y1:Ke[Nt+1],x2:Ke[Nt+2],y2:Ke[Nt+3]})}}}var Kt=this.circleCells[g];if(Kt!==null)for(var jt=this.circles,Gt=0,nr=Kt;Gt<nr.length;Gt+=1){var rr=nr[Gt];if(!ue.circle[rr]){ue.circle[rr]=!0;var Lr=3*rr;if(this._circleAndRectCollide(jt[Lr],jt[Lr+1],jt[Lr+2],s,a,n,l)&&(!z||z(this.circleKeys[rr]))){if(L.hitTest)return w.push(!0),!0;var vr=jt[Lr],Sr=jt[Lr+1],Ar=jt[Lr+2];w.push({key:this.circleKeys[rr],x1:vr-Ar,y1:Sr-Ar,x2:vr+Ar,y2:Sr+Ar})}}}},da.prototype._queryCellCircle=function(s,a,n,l,g,w,L,z){var ue=L.circle,Ee=L.seenUids,Ke=this.boxCells[g];if(Ke!==null)for(var tt=this.bboxes,rt=0,Ft=Ke;rt<Ft.length;rt+=1){var Nt=Ft[rt];if(!Ee.box[Nt]){Ee.box[Nt]=!0;var Kt=4*Nt;if(this._circleAndRectCollide(ue.x,ue.y,ue.radius,tt[Kt+0],tt[Kt+1],tt[Kt+2],tt[Kt+3])&&(!z||z(this.boxKeys[Nt])))return w.push(!0),!0}}var jt=this.circleCells[g];if(jt!==null)for(var Gt=this.circles,nr=0,rr=jt;nr<rr.length;nr+=1){var Lr=rr[nr];if(!Ee.circle[Lr]){Ee.circle[Lr]=!0;var vr=3*Lr;if(this._circlesCollide(Gt[vr],Gt[vr+1],Gt[vr+2],ue.x,ue.y,ue.radius)&&(!z||z(this.circleKeys[Lr])))return w.push(!0),!0}}},da.prototype._forEachCell=function(s,a,n,l,g,w,L,z){for(var ue=this._convertToXCellCoord(s),Ee=this._convertToYCellCoord(a),Ke=this._convertToXCellCoord(n),tt=this._convertToYCellCoord(l),rt=ue;rt<=Ke;rt++)for(var Ft=Ee;Ft<=tt;Ft++)if(g.call(this,s,a,n,l,this.xCellCount*Ft+rt,w,L,z))return},da.prototype._convertToXCellCoord=function(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))},da.prototype._convertToYCellCoord=function(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))},da.prototype._circlesCollide=function(s,a,n,l,g,w){var L=l-s,z=g-a,ue=n+w;return ue*ue>L*L+z*z},da.prototype._circleAndRectCollide=function(s,a,n,l,g,w,L){var z=(w-l)/2,ue=Math.abs(s-(l+z));if(ue>z+n)return!1;var Ee=(L-g)/2,Ke=Math.abs(a-(g+Ee));if(Ke>Ee+n)return!1;if(ue<=z||Ke<=Ee)return!0;var tt=ue-z,rt=Ke-Ee;return tt*tt+rt*rt<=n*n};var Ko=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function oi(s,a){for(var n=0;n<s;n++){var l=a.length;a.resize(l+4),a.float32.set(Ko,3*l)}}function Yi(s,a,n){var l=a[0],g=a[1];return s[0]=n[0]*l+n[4]*g+n[12],s[1]=n[1]*l+n[5]*g+n[13],s[3]=n[3]*l+n[7]*g+n[15],s}var wo=function(a,n,l){n===void 0&&(n=new da(a.width+200,a.height+200,25)),l===void 0&&(l=new da(a.width+200,a.height+200,25)),this.transform=a,this.grid=n,this.ignoredGrid=l,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+100,this.screenBottomBoundary=a.height+100,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200};function Ha(s,a,n){return a*(i.EXTENT/(s.tileSize*Math.pow(2,n-s.tileID.overscaledZ)))}wo.prototype.placeCollisionBox=function(s,a,n,l,g){var w=this.projectAndGetPerspectiveRatio(l,s.anchorPointX,s.anchorPointY),L=n*w.perspectiveRatio,z=s.x1*L+w.point.x,ue=s.y1*L+w.point.y,Ee=s.x2*L+w.point.x,Ke=s.y2*L+w.point.y;return!this.isInsideGrid(z,ue,Ee,Ke)||!a&&this.grid.hitTest(z,ue,Ee,Ke,g)?{box:[],offscreen:!1}:{box:[z,ue,Ee,Ke],offscreen:this.isOffscreen(z,ue,Ee,Ke)}},wo.prototype.placeCollisionCircles=function(s,a,n,l,g,w,L,z,ue,Ee,Ke,tt,rt){var Ft=[],Nt=new i.Point(a.anchorX,a.anchorY),Kt=ya(Nt,w),jt=fa(this.transform.cameraToCenterDistance,Kt.signedDistanceFromCamera),Gt=(Ee?g/jt:g*jt)/i.ONE_EM,nr=ya(Nt,L).point,rr=Xi(Gt,l,a.lineOffsetX*Gt,a.lineOffsetY*Gt,!1,nr,Nt,a,n,L,{}),Lr=!1,vr=!1,Sr=!0;if(rr){for(var Ar=.5*tt*jt+rt,rn=new i.Point(-100,-100),Xr=new i.Point(this.screenRightBoundary,this.screenBottomBoundary),mn=new Wi,Ln=rr.first,qn=rr.last,sa=[],Sa=Ln.path.length-1;Sa>=1;Sa--)sa.push(Ln.path[Sa]);for(var Za=1;Za<qn.path.length;Za++)sa.push(qn.path[Za]);var Sn=2.5*Ar;if(z){var ua=sa.map(function(Gs){return ya(Gs,z)});sa=ua.some(function(Gs){return Gs.signedDistanceFromCamera<=0})?[]:ua.map(function(Gs){return Gs.point})}var ba=[];if(sa.length>0){for(var Zn=sa[0].clone(),Aa=sa[0].clone(),na=1;na<sa.length;na++)Zn.x=Math.min(Zn.x,sa[na].x),Zn.y=Math.min(Zn.y,sa[na].y),Aa.x=Math.max(Aa.x,sa[na].x),Aa.y=Math.max(Aa.y,sa[na].y);ba=Zn.x>=rn.x&&Aa.x<=Xr.x&&Zn.y>=rn.y&&Aa.y<=Xr.y?[sa]:Aa.x<rn.x||Zn.x>Xr.x||Aa.y<rn.y||Zn.y>Xr.y?[]:i.clipLine([sa],rn.x,rn.y,Xr.x,Xr.y)}for(var La=0,za=ba;La<za.length;La+=1){var Gi;mn.reset(za[La],.25*Ar),Gi=mn.length<=.5*Ar?1:Math.ceil(mn.paddedLength/Sn)+1;for(var _i=0;_i<Gi;_i++){var Di=_i/Math.max(Gi-1,1),gi=mn.lerp(Di),Ui=gi.x+100,Qo=gi.y+100;Ft.push(Ui,Qo,Ar,0);var qo=Ui-Ar,vu=Qo-Ar,Mu=Ui+Ar,cs=Qo+Ar;if(Sr=Sr&&this.isOffscreen(qo,vu,Mu,cs),vr=vr||this.isInsideGrid(qo,vu,Mu,cs),!s&&this.grid.hitTestCircle(Ui,Qo,Ar,Ke)&&(Lr=!0,!ue))return{circles:[],offscreen:!1,collisionDetected:Lr}}}}return{circles:!ue&&Lr||!vr?[]:Ft,offscreen:Sr,collisionDetected:Lr}},wo.prototype.queryRenderedSymbols=function(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var a=[],n=1/0,l=1/0,g=-1/0,w=-1/0,L=0,z=s;L<z.length;L+=1){var ue=z[L],Ee=new i.Point(ue.x+100,ue.y+100);n=Math.min(n,Ee.x),l=Math.min(l,Ee.y),g=Math.max(g,Ee.x),w=Math.max(w,Ee.y),a.push(Ee)}for(var Ke={},tt={},rt=0,Ft=this.grid.query(n,l,g,w).concat(this.ignoredGrid.query(n,l,g,w));rt<Ft.length;rt+=1){var Nt=Ft[rt],Kt=Nt.key;if(Ke[Kt.bucketInstanceId]===void 0&&(Ke[Kt.bucketInstanceId]={}),!Ke[Kt.bucketInstanceId][Kt.featureIndex]){var jt=[new i.Point(Nt.x1,Nt.y1),new i.Point(Nt.x2,Nt.y1),new i.Point(Nt.x2,Nt.y2),new i.Point(Nt.x1,Nt.y2)];i.polygonIntersectsPolygon(a,jt)&&(Ke[Kt.bucketInstanceId][Kt.featureIndex]=!0,tt[Kt.bucketInstanceId]===void 0&&(tt[Kt.bucketInstanceId]=[]),tt[Kt.bucketInstanceId].push(Kt.featureIndex))}}return tt},wo.prototype.insertCollisionBox=function(s,a,n,l,g){(a?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:l,collisionGroupID:g},s[0],s[1],s[2],s[3])},wo.prototype.insertCollisionCircles=function(s,a,n,l,g){for(var w=a?this.ignoredGrid:this.grid,L={bucketInstanceId:n,featureIndex:l,collisionGroupID:g},z=0;z<s.length;z+=4)w.insertCircle(L,s[z],s[z+1],s[z+2])},wo.prototype.projectAndGetPerspectiveRatio=function(s,a,n){var l=[a,n,0,1];return Yi(l,l,s),{point:new i.Point((l[0]/l[3]+1)/2*this.transform.width+100,(-l[1]/l[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/l[3]*.5}},wo.prototype.isOffscreen=function(s,a,n,l){return n<100||s>=this.screenRightBoundary||l<100||a>this.screenBottomBoundary},wo.prototype.isInsideGrid=function(s,a,n,l){return n>=0&&s<this.gridRightBoundary&&l>=0&&a<this.gridBottomBoundary},wo.prototype.getViewportMatrix=function(){var s=i.identity([]);return i.translate(s,s,[-100,-100,0]),s};var oo=function(a,n,l,g){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?n:-n))):g&&l?1:0,this.placed=l};oo.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var so=function(a,n,l,g,w){this.text=new oo(a?a.text:null,n,l,w),this.icon=new oo(a?a.icon:null,n,g,w)};so.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Eu=function(a,n,l){this.text=a,this.icon=n,this.skipFade=l},$o=function(){this.invProjMatrix=i.create(),this.viewportMatrix=i.create(),this.circles=[]},Kl=function(a,n,l,g,w){this.bucketInstanceId=a,this.featureIndex=n,this.sourceLayerIndex=l,this.bucketIndex=g,this.tileID=w},ks=function(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}};function ho(s,a,n,l,g){var w=i.getAnchorAlignment(s),L=-(w.horizontalAlign-.5)*a,z=-(w.verticalAlign-.5)*n,ue=i.evaluateVariableOffset(s,l);return new i.Point(L+ue[0]*g,z+ue[1]*g)}function Vt(s,a,n,l,g,w){var L=s.x1,z=s.x2,ue=s.y1,Ee=s.y2,Ke=s.anchorPointX,tt=s.anchorPointY,rt=new i.Point(a,n);return l&&rt._rotate(g?w:-w),{x1:L+rt.x,y1:ue+rt.y,x2:z+rt.x,y2:Ee+rt.y,anchorPointX:Ke,anchorPointY:tt}}ks.prototype.get=function(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){var a=++this.maxGroupID;this.collisionGroups[s]={ID:a,predicate:function(l){return l.collisionGroupID===a}}}return this.collisionGroups[s]};var Le=function(a,n,l,g){this.transform=a.clone(),this.collisionIndex=new wo(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=n,this.retainedQueryData={},this.collisionGroups=new ks(l),this.collisionCircleArrays={},this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}};function Dt(s,a,n,l,g){s.emplaceBack(a?1:0,n?1:0,l||0,g||0),s.emplaceBack(a?1:0,n?1:0,l||0,g||0),s.emplaceBack(a?1:0,n?1:0,l||0,g||0),s.emplaceBack(a?1:0,n?1:0,l||0,g||0)}Le.prototype.getBucketParts=function(s,a,n,l){var g=n.getBucket(a),w=n.latestFeatureIndex;if(g&&w&&a.id===g.layerIds[0]){var L=n.collisionBoxArray,z=g.layers[0].layout,ue=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),Ee=n.tileSize/i.EXTENT,Ke=this.transform.calculatePosMatrix(n.tileID.toUnwrapped()),tt=z.get("text-pitch-alignment")==="map",rt=z.get("text-rotation-alignment")==="map",Ft=Ha(n,1,this.transform.zoom),Nt=di(Ke,tt,rt,this.transform,Ft),Kt=null;if(tt){var jt=ga(Ke,tt,rt,this.transform,Ft);Kt=i.multiply([],this.transform.labelPlaneMatrix,jt)}this.retainedQueryData[g.bucketInstanceId]=new Kl(g.bucketInstanceId,w,g.sourceLayerIndex,g.index,n.tileID);var Gt={bucket:g,layout:z,posMatrix:Ke,textLabelPlaneMatrix:Nt,labelToScreenMatrix:Kt,scale:ue,textPixelRatio:Ee,holdingForFade:n.holdingForFade(),collisionBoxArray:L,partiallyEvaluatedTextSize:i.evaluateSizeForZoom(g.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(g.sourceID)};if(l)for(var nr=0,rr=g.sortKeyRanges;nr<rr.length;nr+=1){var Lr=rr[nr];s.push({sortKey:Lr.sortKey,symbolInstanceStart:Lr.symbolInstanceStart,symbolInstanceEnd:Lr.symbolInstanceEnd,parameters:Gt})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:g.symbolInstances.length,parameters:Gt})}},Le.prototype.attemptAnchorPlacement=function(s,a,n,l,g,w,L,z,ue,Ee,Ke,tt,rt,Ft,Nt){var Kt,jt=[tt.textOffset0,tt.textOffset1],Gt=ho(s,n,l,jt,g),nr=this.collisionIndex.placeCollisionBox(Vt(a,Gt.x,Gt.y,w,L,this.transform.angle),Ke,z,ue,Ee.predicate);if(!Nt||this.collisionIndex.placeCollisionBox(Vt(Nt,Gt.x,Gt.y,w,L,this.transform.angle),Ke,z,ue,Ee.predicate).box.length!==0)return nr.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[tt.crossTileID]&&this.prevPlacement.placements[tt.crossTileID]&&this.prevPlacement.placements[tt.crossTileID].text&&(Kt=this.prevPlacement.variableOffsets[tt.crossTileID].anchor),this.variableOffsets[tt.crossTileID]={textOffset:jt,width:n,height:l,anchor:s,textBoxScale:g,prevAnchor:Kt},this.markUsedJustification(rt,s,tt,Ft),rt.allowVerticalPlacement&&(this.markUsedOrientation(rt,Ft,tt),this.placedOrientations[tt.crossTileID]=Ft),{shift:Gt,placedGlyphBoxes:nr}):void 0},Le.prototype.placeLayerBucketPart=function(s,a,n){var l=this,g=s.parameters,w=g.bucket,L=g.layout,z=g.posMatrix,ue=g.textLabelPlaneMatrix,Ee=g.labelToScreenMatrix,Ke=g.textPixelRatio,tt=g.holdingForFade,rt=g.collisionBoxArray,Ft=g.partiallyEvaluatedTextSize,Nt=g.collisionGroup,Kt=L.get("text-optional"),jt=L.get("icon-optional"),Gt=L.get("text-allow-overlap"),nr=L.get("icon-allow-overlap"),rr=L.get("text-rotation-alignment")==="map",Lr=L.get("text-pitch-alignment")==="map",vr=L.get("icon-text-fit")!=="none",Sr=L.get("symbol-z-order")==="viewport-y",Ar=Gt&&(nr||!w.hasIconData()||jt),rn=nr&&(Gt||!w.hasTextData()||Kt);!w.collisionArrays&&rt&&w.deserializeCollisionBoxes(rt);var Xr=function(Sn,ua){if(!a[Sn.crossTileID])if(tt)l.placements[Sn.crossTileID]=new Eu(!1,!1,!1);else{var ba,Zn=!1,Aa=!1,na=!0,La=null,za={box:null,offscreen:null},Gi={box:null,offscreen:null},_i=null,Di=null,gi=0,Ui=0,Qo=0;ua.textFeatureIndex?gi=ua.textFeatureIndex:Sn.useRuntimeCollisionCircles&&(gi=Sn.featureIndex),ua.verticalTextFeatureIndex&&(Ui=ua.verticalTextFeatureIndex);var qo=ua.textBox;if(qo){var vu=function(Ho){var _o=i.WritingMode.horizontal;if(w.allowVerticalPlacement&&!Ho&&l.prevPlacement){var uo=l.prevPlacement.placedOrientations[Sn.crossTileID];uo&&(l.placedOrientations[Sn.crossTileID]=uo,l.markUsedOrientation(w,_o=uo,Sn))}return _o},Mu=function(Ho,_o){if(w.allowVerticalPlacement&&Sn.numVerticalGlyphVertices>0&&ua.verticalTextBox)for(var uo=0,Ls=w.writingModes;uo<Ls.length&&(Ls[uo]===i.WritingMode.vertical?(za=_o(),Gi=za):za=Ho(),!(za&&za.box&&za.box.length));uo+=1);else za=Ho()};if(L.get("text-variable-anchor")){var cs=L.get("text-variable-anchor");if(l.prevPlacement&&l.prevPlacement.variableOffsets[Sn.crossTileID]){var Gs=l.prevPlacement.variableOffsets[Sn.crossTileID];cs.indexOf(Gs.anchor)>0&&(cs=cs.filter(function(No){return No!==Gs.anchor})).unshift(Gs.anchor)}var Pu=function(Ho,_o,uo){for(var Ls=Ho.x2-Ho.x1,nu=Ho.y2-Ho.y1,Hl=Sn.textBoxScale,Gc=vr&&!nr?_o:null,dl={box:[],offscreen:!1},lc=Gt?2*cs.length:cs.length,pl=0;pl<lc;++pl){var Rs=l.attemptAnchorPlacement(cs[pl%cs.length],Ho,Ls,nu,Hl,rr,Lr,Ke,z,Nt,pl>=cs.length,Sn,w,uo,Gc);if(Rs&&(dl=Rs.placedGlyphBoxes)&&dl.box&&dl.box.length){Zn=!0,La=Rs.shift;break}}return dl};Mu(function(){return Pu(qo,ua.iconBox,i.WritingMode.horizontal)},function(){var No=ua.verticalTextBox;return w.allowVerticalPlacement&&!(za&&za.box&&za.box.length)&&Sn.numVerticalGlyphVertices>0&&No?Pu(No,ua.verticalIconBox,i.WritingMode.vertical):{box:null,offscreen:null}}),za&&(Zn=za.box,na=za.offscreen);var sc=vu(za&&za.box);if(!Zn&&l.prevPlacement){var tu=l.prevPlacement.variableOffsets[Sn.crossTileID];tu&&(l.variableOffsets[Sn.crossTileID]=tu,l.markUsedJustification(w,tu.anchor,Sn,sc))}}else{var Xu=function(Ho,_o){var uo=l.collisionIndex.placeCollisionBox(Ho,Gt,Ke,z,Nt.predicate);return uo&&uo.box&&uo.box.length&&(l.markUsedOrientation(w,_o,Sn),l.placedOrientations[Sn.crossTileID]=_o),uo};Mu(function(){return Xu(qo,i.WritingMode.horizontal)},function(){var No=ua.verticalTextBox;return w.allowVerticalPlacement&&Sn.numVerticalGlyphVertices>0&&No?Xu(No,i.WritingMode.vertical):{box:null,offscreen:null}}),vu(za&&za.box&&za.box.length)}}if(Zn=(ba=za)&&ba.box&&ba.box.length>0,na=ba&&ba.offscreen,Sn.useRuntimeCollisionCircles){var uc=w.text.placedSymbolArray.get(Sn.centerJustifiedTextSymbolIndex),ru=i.evaluateSizeForFeature(w.textSizeData,Ft,uc),Lu=L.get("text-padding");_i=l.collisionIndex.placeCollisionCircles(Gt,uc,w.lineVertexArray,w.glyphOffsetArray,ru,z,ue,Ee,n,Lr,Nt.predicate,Sn.collisionCircleDiameter,Lu),Zn=Gt||_i.circles.length>0&&!_i.collisionDetected,na=na&&_i.offscreen}if(ua.iconFeatureIndex&&(Qo=ua.iconFeatureIndex),ua.iconBox){var fs=function(Ho){var _o=vr&&La?Vt(Ho,La.x,La.y,rr,Lr,l.transform.angle):Ho;return l.collisionIndex.placeCollisionBox(_o,nr,Ke,z,Nt.predicate)};Aa=Gi&&Gi.box&&Gi.box.length&&ua.verticalIconBox?(Di=fs(ua.verticalIconBox)).box.length>0:(Di=fs(ua.iconBox)).box.length>0,na=na&&Di.offscreen}var ao=Kt||Sn.numHorizontalGlyphVertices===0&&Sn.numVerticalGlyphVertices===0,Yu=jt||Sn.numIconVertices===0;if(ao||Yu?Yu?ao||(Aa=Aa&&Zn):Zn=Aa&&Zn:Aa=Zn=Aa&&Zn,Zn&&ba&&ba.box&&l.collisionIndex.insertCollisionBox(ba.box,L.get("text-ignore-placement"),w.bucketInstanceId,Gi&&Gi.box&&Ui?Ui:gi,Nt.ID),Aa&&Di&&l.collisionIndex.insertCollisionBox(Di.box,L.get("icon-ignore-placement"),w.bucketInstanceId,Qo,Nt.ID),_i&&(Zn&&l.collisionIndex.insertCollisionCircles(_i.circles,L.get("text-ignore-placement"),w.bucketInstanceId,gi,Nt.ID),n)){var Gl=w.bucketInstanceId,hs=l.collisionCircleArrays[Gl];hs===void 0&&(hs=l.collisionCircleArrays[Gl]=new $o);for(var Do=0;Do<_i.circles.length;Do+=4)hs.circles.push(_i.circles[Do+0]),hs.circles.push(_i.circles[Do+1]),hs.circles.push(_i.circles[Do+2]),hs.circles.push(_i.collisionDetected?1:0)}l.placements[Sn.crossTileID]=new Eu(Zn||Ar,Aa||rn,na||w.justReloaded),a[Sn.crossTileID]=!0}};if(Sr)for(var mn=w.getSortedSymbolIndexes(this.transform.angle),Ln=mn.length-1;Ln>=0;--Ln){var qn=mn[Ln];Xr(w.symbolInstances.get(qn),w.collisionArrays[qn])}else for(var sa=s.symbolInstanceStart;sa<s.symbolInstanceEnd;sa++)Xr(w.symbolInstances.get(sa),w.collisionArrays[sa]);if(n&&w.bucketInstanceId in this.collisionCircleArrays){var Sa=this.collisionCircleArrays[w.bucketInstanceId];i.invert(Sa.invProjMatrix,z),Sa.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1},Le.prototype.markUsedJustification=function(s,a,n,l){var g;g=l===i.WritingMode.vertical?n.verticalPlacedTextSymbolIndex:{left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex}[i.getAnchorJustification(a)];for(var w=0,L=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];w<L.length;w+=1){var z=L[w];z>=0&&(s.text.placedSymbolArray.get(z).crossTileID=g>=0&&z!==g?0:n.crossTileID)}},Le.prototype.markUsedOrientation=function(s,a,n){for(var l=a===i.WritingMode.horizontal||a===i.WritingMode.horizontalOnly?a:0,g=a===i.WritingMode.vertical?a:0,w=0,L=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];w<L.length;w+=1)s.text.placedSymbolArray.get(L[w]).placedOrientation=l;n.verticalPlacedTextSymbolIndex&&(s.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=g)},Le.prototype.commit=function(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;var a=this.prevPlacement,n=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;var l=a?a.symbolFadeChange(s):1,g=a?a.opacities:{},w=a?a.variableOffsets:{},L=a?a.placedOrientations:{};for(var z in this.placements){var ue=this.placements[z],Ee=g[z];Ee?(this.opacities[z]=new so(Ee,l,ue.text,ue.icon),n=n||ue.text!==Ee.text.placed||ue.icon!==Ee.icon.placed):(this.opacities[z]=new so(null,l,ue.text,ue.icon,ue.skipFade),n=n||ue.text||ue.icon)}for(var Ke in g){var tt=g[Ke];if(!this.opacities[Ke]){var rt=new so(tt,l,!1,!1);rt.isHidden()||(this.opacities[Ke]=rt,n=n||tt.text.placed||tt.icon.placed)}}for(var Ft in w)this.variableOffsets[Ft]||!this.opacities[Ft]||this.opacities[Ft].isHidden()||(this.variableOffsets[Ft]=w[Ft]);for(var Nt in L)this.placedOrientations[Nt]||!this.opacities[Nt]||this.opacities[Nt].isHidden()||(this.placedOrientations[Nt]=L[Nt]);n?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:s)},Le.prototype.updateLayerOpacities=function(s,a){for(var n={},l=0,g=a;l<g.length;l+=1){var w=g[l],L=w.getBucket(s);L&&w.latestFeatureIndex&&s.id===L.layerIds[0]&&this.updateBucketOpacities(L,n,w.collisionBoxArray)}},Le.prototype.updateBucketOpacities=function(s,a,n){var l=this;s.hasTextData()&&s.text.opacityVertexArray.clear(),s.hasIconData()&&s.icon.opacityVertexArray.clear(),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();var g=s.layers[0].layout,w=new so(null,0,!1,!1,!0),L=g.get("text-allow-overlap"),z=g.get("icon-allow-overlap"),ue=g.get("text-variable-anchor"),Ee=g.get("text-rotation-alignment")==="map",Ke=g.get("text-pitch-alignment")==="map",tt=g.get("icon-text-fit")!=="none",rt=new so(null,0,L&&(z||!s.hasIconData()||g.get("icon-optional")),z&&(L||!s.hasTextData()||g.get("text-optional")),!0);!s.collisionArrays&&n&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(n);for(var Ft=function(nr,rr,Lr){for(var vr=0;vr<rr/4;vr++)nr.opacityVertexArray.emplaceBack(Lr)},Nt=function(nr){var rr=s.symbolInstances.get(nr),Lr=rr.numHorizontalGlyphVertices,vr=rr.numVerticalGlyphVertices,Sr=rr.crossTileID,Ar=l.opacities[Sr];a[Sr]?Ar=w:Ar||(l.opacities[Sr]=Ar=rt),a[Sr]=!0;var rn=rr.numIconVertices>0,Xr=l.placedOrientations[rr.crossTileID],mn=Xr===i.WritingMode.vertical,Ln=Xr===i.WritingMode.horizontal||Xr===i.WritingMode.horizontalOnly;if(Lr>0||vr>0){var qn=Oo(Ar.text);Ft(s.text,Lr,mn?Fu:qn),Ft(s.text,vr,Ln?Fu:qn);var sa=Ar.text.isHidden();[rr.rightJustifiedTextSymbolIndex,rr.centerJustifiedTextSymbolIndex,rr.leftJustifiedTextSymbolIndex].forEach(function(za){za>=0&&(s.text.placedSymbolArray.get(za).hidden=sa||mn?1:0)}),rr.verticalPlacedTextSymbolIndex>=0&&(s.text.placedSymbolArray.get(rr.verticalPlacedTextSymbolIndex).hidden=sa||Ln?1:0);var Sa=l.variableOffsets[rr.crossTileID];Sa&&l.markUsedJustification(s,Sa.anchor,rr,Xr);var Za=l.placedOrientations[rr.crossTileID];Za&&(l.markUsedJustification(s,"left",rr,Za),l.markUsedOrientation(s,Za,rr))}if(rn){var Sn=Oo(Ar.icon),ua=!(tt&&rr.verticalPlacedIconSymbolIndex&&mn);rr.placedIconSymbolIndex>=0&&(Ft(s.icon,rr.numIconVertices,ua?Sn:Fu),s.icon.placedSymbolArray.get(rr.placedIconSymbolIndex).hidden=Ar.icon.isHidden()),rr.verticalPlacedIconSymbolIndex>=0&&(Ft(s.icon,rr.numVerticalIconVertices,ua?Fu:Sn),s.icon.placedSymbolArray.get(rr.verticalPlacedIconSymbolIndex).hidden=Ar.icon.isHidden())}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){var ba=s.collisionArrays[nr];if(ba){var Zn=new i.Point(0,0);if(ba.textBox||ba.verticalTextBox){var Aa=!0;if(ue){var na=l.variableOffsets[Sr];na?(Zn=ho(na.anchor,na.width,na.height,na.textOffset,na.textBoxScale),Ee&&Zn._rotate(Ke?l.transform.angle:-l.transform.angle)):Aa=!1}ba.textBox&&Dt(s.textCollisionBox.collisionVertexArray,Ar.text.placed,!Aa||mn,Zn.x,Zn.y),ba.verticalTextBox&&Dt(s.textCollisionBox.collisionVertexArray,Ar.text.placed,!Aa||Ln,Zn.x,Zn.y)}var La=Boolean(!Ln&&ba.verticalIconBox);ba.iconBox&&Dt(s.iconCollisionBox.collisionVertexArray,Ar.icon.placed,La,tt?Zn.x:0,tt?Zn.y:0),ba.verticalIconBox&&Dt(s.iconCollisionBox.collisionVertexArray,Ar.icon.placed,!La,tt?Zn.x:0,tt?Zn.y:0)}}},Kt=0;Kt<s.symbolInstances.length;Kt++)Nt(Kt);if(s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.bucketInstanceId in this.collisionCircleArrays){var jt=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=jt.invProjMatrix,s.placementViewportMatrix=jt.viewportMatrix,s.collisionCircleArray=jt.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}},Le.prototype.symbolFadeChange=function(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Le.prototype.zoomAdjustment=function(s){return Math.max(0,(this.transform.zoom-s)/1.5)},Le.prototype.hasTransitions=function(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration},Le.prototype.stillRecent=function(s,a){var n=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*n>s},Le.prototype.setStale=function(){this.stale=!0};var mr=Math.pow(2,25),Qr=Math.pow(2,24),En=Math.pow(2,17),Vn=Math.pow(2,16),Ci=Math.pow(2,9),po=Math.pow(2,8),mo=Math.pow(2,1);function Oo(s){if(s.opacity===0&&!s.placed)return 0;if(s.opacity===1&&s.placed)return 4294967295;var a=s.placed?1:0,n=Math.floor(127*s.opacity);return n*mr+a*Qr+n*En+a*Vn+n*Ci+a*po+n*mo+a}var Fu=0,Ml=function(a){this._sortAcrossTiles=a.layout.get("symbol-z-order")!=="viewport-y"&&a.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Ml.prototype.continuePlacement=function(s,a,n,l,g){for(var w=this._bucketParts;this._currentTileIndex<s.length;)if(a.getBucketParts(w,l,s[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,g())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort(function(L,z){return L.sortKey-z.sortKey}));this._currentPartIndex<w.length;)if(a.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,g())return!0;return!1};var bs=function(a,n,l,g,w,L,z){this.placement=new Le(a,w,L,z),this._currentPlacementIndex=n.length-1,this._forceFullPlacement=l,this._showCollisionBoxes=g,this._done=!1};bs.prototype.isDone=function(){return this._done},bs.prototype.continuePlacement=function(s,a,n){for(var l=this,g=i.browser.now(),w=function(){var Ee=i.browser.now()-g;return!l._forceFullPlacement&&Ee>2};this._currentPlacementIndex>=0;){var L=a[s[this._currentPlacementIndex]],z=this.placement.collisionIndex.transform.zoom;if(L.type==="symbol"&&(!L.minzoom||L.minzoom<=z)&&(!L.maxzoom||L.maxzoom>z)){if(this._inProgressLayer||(this._inProgressLayer=new Ml(L)),this._inProgressLayer.continuePlacement(n[L.source],this.placement,this._showCollisionBoxes,L,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},bs.prototype.commit=function(s){return this.placement.commit(s),this.placement};var vc=512/i.EXTENT/2,Tu=function(a,n,l){this.tileID=a,this.indexedSymbolInstances={},this.bucketInstanceId=l;for(var g=0;g<n.length;g++){var w=n.get(g),L=w.key;this.indexedSymbolInstances[L]||(this.indexedSymbolInstances[L]=[]),this.indexedSymbolInstances[L].push({crossTileID:w.crossTileID,coord:this.getScaledCoordinates(w,a)})}};Tu.prototype.getScaledCoordinates=function(s,a){var n=vc/Math.pow(2,a.canonical.z-this.tileID.canonical.z);return{x:Math.floor((a.canonical.x*i.EXTENT+s.anchorX)*n),y:Math.floor((a.canonical.y*i.EXTENT+s.anchorY)*n)}},Tu.prototype.findMatches=function(s,a,n){for(var l=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z),g=0;g<s.length;g++){var w=s.get(g);if(!w.crossTileID){var L=this.indexedSymbolInstances[w.key];if(L)for(var z=this.getScaledCoordinates(w,a),ue=0,Ee=L;ue<Ee.length;ue+=1){var Ke=Ee[ue];if(Math.abs(Ke.coord.x-z.x)<=l&&Math.abs(Ke.coord.y-z.y)<=l&&!n[Ke.crossTileID]){n[Ke.crossTileID]=!0,w.crossTileID=Ke.crossTileID;break}}}}};var Mo=function(){this.maxCrossTileID=0};Mo.prototype.generate=function(){return++this.maxCrossTileID};var zu=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};zu.prototype.handleWrapJump=function(s){var a=Math.round((s-this.lng)/360);if(a!==0)for(var n in this.indexes){var l=this.indexes[n],g={};for(var w in l){var L=l[w];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+a),g[L.tileID.key]=L}this.indexes[n]=g}this.lng=s},zu.prototype.addBucket=function(s,a,n){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(var l=0;l<a.symbolInstances.length;l++)a.symbolInstances.get(l).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]={});var g=this.usedCrossTileIDs[s.overscaledZ];for(var w in this.indexes){var L=this.indexes[w];if(Number(w)>s.overscaledZ)for(var z in L){var ue=L[z];ue.tileID.isChildOf(s)&&ue.findMatches(a.symbolInstances,s,g)}else{var Ee=L[s.scaledTo(Number(w)).key];Ee&&Ee.findMatches(a.symbolInstances,s,g)}}for(var Ke=0;Ke<a.symbolInstances.length;Ke++){var tt=a.symbolInstances.get(Ke);tt.crossTileID||(tt.crossTileID=n.generate(),g[tt.crossTileID]=!0)}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new Tu(s,a.symbolInstances,a.bucketInstanceId),!0},zu.prototype.removeBucketCrossTileIDs=function(s,a){for(var n in a.indexedSymbolInstances)for(var l=0,g=a.indexedSymbolInstances[n];l<g.length;l+=1)delete this.usedCrossTileIDs[s][g[l].crossTileID]},zu.prototype.removeStaleBuckets=function(s){var a=!1;for(var n in this.indexes){var l=this.indexes[n];for(var g in l)s[l[g].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,l[g]),delete l[g],a=!0)}return a};var Eo=function(){this.layerIndexes={},this.crossTileIDs=new Mo,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Eo.prototype.addLayer=function(s,a,n){var l=this.layerIndexes[s.id];l===void 0&&(l=this.layerIndexes[s.id]=new zu);var g=!1,w={};l.handleWrapJump(n);for(var L=0,z=a;L<z.length;L+=1){var ue=z[L],Ee=ue.getBucket(s);Ee&&s.id===Ee.layerIds[0]&&(Ee.bucketInstanceId||(Ee.bucketInstanceId=++this.maxBucketInstanceId),l.addBucket(ue.tileID,Ee,this.crossTileIDs)&&(g=!0),w[Ee.bucketInstanceId]=!0)}return l.removeStaleBuckets(w)&&(g=!0),g},Eo.prototype.pruneUnusedLayers=function(s){var a={};for(var n in s.forEach(function(l){a[l]=!0}),this.layerIndexes)a[n]||delete this.layerIndexes[n]};var Fi=function(a,n){return i.emitValidationErrors(a,n&&n.filter(function(l){return l.identifier!=="source.canvas"}))},Ys=i.pick(xn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ks=i.pick(xn,["setCenter","setZoom","setBearing","setPitch"]),js=function(){var s={},a=i.styleSpec.$version;for(var n in i.styleSpec.$root){var l,g=i.styleSpec.$root[n];g.required&&((l=n==="version"?a:g.type==="array"?[]:{})!=null&&(s[n]=l))}return s}(),Ri=function(s){function a(n,l){var g=this;l===void 0&&(l={}),s.call(this),this.map=n,this.dispatcher=new ht(er(),this),this.imageManager=new De,this.imageManager.setEventedParent(this),this.glyphManager=new ke(n._requestManager,l.localIdeographFontFamily),this.lineAtlas=new Me(256,512),this.crossTileSymbolIndex=new Eo,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new i.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",i.getReferrer());var w=this;this._rtlTextPluginCallback=a.registerForPluginStateChange(function(L){w.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:L.pluginStatus,pluginURL:L.pluginURL},function(z,ue){if(i.triggerPluginCompletionEvent(z),ue&&ue.every(function(Ke){return Ke}))for(var Ee in w.sourceCaches)w.sourceCaches[Ee].reload()})}),this.on("data",function(L){if(L.dataType==="source"&&L.sourceDataType==="metadata"){var z=g.sourceCaches[L.sourceId];if(z){var ue=z.getSource();if(ue&&ue.vectorLayerIds)for(var Ee in g._layers){var Ke=g._layers[Ee];Ke.source===ue.id&&g._validateLayer(Ke)}}}})}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.loadURL=function(n,l){var g=this;l===void 0&&(l={}),this.fire(new i.Event("dataloading",{dataType:"style"}));var w=typeof l.validate=="boolean"?l.validate:!i.isMapboxURL(n);n=this.map._requestManager.normalizeStyleURL(n,l.accessToken);var L=this.map._requestManager.transformRequest(n,i.ResourceType.Style);this._request=i.getJSON(L,function(z,ue){g._request=null,z?g.fire(new i.ErrorEvent(z)):ue&&g._load(ue,w)})},a.prototype.loadJSON=function(n,l){var g=this;l===void 0&&(l={}),this.fire(new i.Event("dataloading",{dataType:"style"})),this._request=i.browser.frame(function(){g._request=null,g._load(n,l.validate!==!1)})},a.prototype.loadEmpty=function(){this.fire(new i.Event("dataloading",{dataType:"style"})),this._load(js,!1)},a.prototype._load=function(n,l){if(!l||!Fi(this,i.validateStyle(n))){for(var g in this._loaded=!0,this.stylesheet=n,n.sources)this.addSource(g,n.sources[g],{validate:!1});n.sprite?this._loadSprite(n.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(n.glyphs);var w=hn(this.stylesheet.layers);this._order=w.map(function(Ee){return Ee.id}),this._layers={},this._serializedLayers={};for(var L=0,z=w;L<z.length;L+=1){var ue=z[L];(ue=i.createStyleLayer(ue)).setEventedParent(this,{layer:{id:ue.id}}),this._layers[ue.id]=ue,this._serializedLayers[ue.id]=ue.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new dt(this.stylesheet.light),this.fire(new i.Event("data",{dataType:"style"})),this.fire(new i.Event("style.load"))}},a.prototype._loadSprite=function(n){var l=this;this._spriteRequest=function(g,w,L){var z,ue,Ee,Ke=i.browser.devicePixelRatio>1?"@2x":"",tt=i.getJSON(w.transformRequest(w.normalizeSpriteURL(g,Ke,".json"),i.ResourceType.SpriteJSON),function(Nt,Kt){tt=null,Ee||(Ee=Nt,z=Kt,Ft())}),rt=i.getImage(w.transformRequest(w.normalizeSpriteURL(g,Ke,".png"),i.ResourceType.SpriteImage),function(Nt,Kt){rt=null,Ee||(Ee=Nt,ue=Kt,Ft())});function Ft(){if(Ee)L(Ee);else if(z&&ue){var Nt=i.browser.getImageData(ue),Kt={};for(var jt in z){var Gt=z[jt],nr=Gt.width,rr=Gt.height,Lr=Gt.x,vr=Gt.y,Sr=Gt.sdf,Ar=Gt.pixelRatio,rn=Gt.stretchX,Xr=Gt.stretchY,mn=Gt.content,Ln=new i.RGBAImage({width:nr,height:rr});i.RGBAImage.copy(Nt,Ln,{x:Lr,y:vr},{x:0,y:0},{width:nr,height:rr}),Kt[jt]={data:Ln,pixelRatio:Ar,sdf:Sr,stretchX:rn,stretchY:Xr,content:mn}}L(null,Kt)}}return{cancel:function(){tt&&(tt.cancel(),tt=null),rt&&(rt.cancel(),rt=null)}}}(n,this.map._requestManager,function(g,w){if(l._spriteRequest=null,g)l.fire(new i.ErrorEvent(g));else if(w)for(var L in w)l.imageManager.addImage(L,w[L]);l.imageManager.setLoaded(!0),l._availableImages=l.imageManager.listImages(),l.dispatcher.broadcast("setImages",l._availableImages),l.fire(new i.Event("data",{dataType:"style"}))})},a.prototype._validateLayer=function(n){var l=this.sourceCaches[n.source];if(l){var g=n.sourceLayer;if(g){var w=l.getSource();(w.type==="geojson"||w.vectorLayerIds&&w.vectorLayerIds.indexOf(g)===-1)&&this.fire(new i.ErrorEvent(new Error('Source layer "'+g+'" does not exist on source "'+w.id+'" as specified by style layer "'+n.id+'"')))}}},a.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()},a.prototype._serializeLayers=function(n){for(var l=[],g=0,w=n;g<w.length;g+=1){var L=this._layers[w[g]];L.type!=="custom"&&l.push(L.serialize())}return l},a.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(var l in this._layers)if(this._layers[l].hasTransition())return!0;return!1},a.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},a.prototype.update=function(n){if(this._loaded){var l=this._changed;if(this._changed){var g=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);for(var L in(g.length||w.length)&&this._updateWorkerLayers(g,w),this._updatedSources){var z=this._updatedSources[L];z==="reload"?this._reloadSource(L):z==="clear"&&this._clearSource(L)}for(var ue in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[ue].updateTransitions(n);this.light.updateTransitions(n),this._resetUpdates()}var Ee={};for(var Ke in this.sourceCaches){var tt=this.sourceCaches[Ke];Ee[Ke]=tt.used,tt.used=!1}for(var rt=0,Ft=this._order;rt<Ft.length;rt+=1){var Nt=this._layers[Ft[rt]];Nt.recalculate(n,this._availableImages),!Nt.isHidden(n.zoom)&&Nt.source&&(this.sourceCaches[Nt.source].used=!0)}for(var Kt in Ee){var jt=this.sourceCaches[Kt];Ee[Kt]!==jt.used&&jt.fire(new i.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Kt}))}this.light.recalculate(n),this.z=n.zoom,l&&this.fire(new i.Event("data",{dataType:"style"}))}},a.prototype._updateTilesForChangedImages=function(){var n=Object.keys(this._changedImages);if(n.length){for(var l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}},a.prototype._updateWorkerLayers=function(n,l){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(n),removedIds:l})},a.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},a.prototype.setState=function(n){var l=this;if(this._checkLoaded(),Fi(this,i.validateStyle(n)))return!1;(n=i.clone$1(n)).layers=hn(n.layers);var g=function(L,z){if(!L)return[{command:xn.setStyle,args:[z]}];var ue=[];try{if(!i.deepEqual(L.version,z.version))return[{command:xn.setStyle,args:[z]}];i.deepEqual(L.center,z.center)||ue.push({command:xn.setCenter,args:[z.center]}),i.deepEqual(L.zoom,z.zoom)||ue.push({command:xn.setZoom,args:[z.zoom]}),i.deepEqual(L.bearing,z.bearing)||ue.push({command:xn.setBearing,args:[z.bearing]}),i.deepEqual(L.pitch,z.pitch)||ue.push({command:xn.setPitch,args:[z.pitch]}),i.deepEqual(L.sprite,z.sprite)||ue.push({command:xn.setSprite,args:[z.sprite]}),i.deepEqual(L.glyphs,z.glyphs)||ue.push({command:xn.setGlyphs,args:[z.glyphs]}),i.deepEqual(L.transition,z.transition)||ue.push({command:xn.setTransition,args:[z.transition]}),i.deepEqual(L.light,z.light)||ue.push({command:xn.setLight,args:[z.light]});var Ee={},Ke=[];!function(rt,Ft,Nt,Kt){var jt;for(jt in Ft=Ft||{},rt=rt||{})rt.hasOwnProperty(jt)&&(Ft.hasOwnProperty(jt)||vn(jt,Nt,Kt));for(jt in Ft)Ft.hasOwnProperty(jt)&&(rt.hasOwnProperty(jt)?i.deepEqual(rt[jt],Ft[jt])||(rt[jt].type==="geojson"&&Ft[jt].type==="geojson"&&Va(rt,Ft,jt)?Nt.push({command:xn.setGeoJSONSourceData,args:[jt,Ft[jt].data]}):Pn(jt,Ft,Nt,Kt)):yn(jt,Ft,Nt))}(L.sources,z.sources,Ke,Ee);var tt=[];L.layers&&L.layers.forEach(function(rt){Ee[rt.source]?ue.push({command:xn.removeLayer,args:[rt.id]}):tt.push(rt)}),ue=ue.concat(Ke),function(rt,Ft,Nt){Ft=Ft||[];var Kt,jt,Gt,nr,rr,Lr,vr,Sr=(rt=rt||[]).map(Ma),Ar=Ft.map(Ma),rn=rt.reduce(Ia,{}),Xr=Ft.reduce(Ia,{}),mn=Sr.slice(),Ln=Object.create(null);for(Kt=0,jt=0;Kt<Sr.length;Kt++)Xr.hasOwnProperty(Gt=Sr[Kt])?jt++:(Nt.push({command:xn.removeLayer,args:[Gt]}),mn.splice(mn.indexOf(Gt,jt),1));for(Kt=0,jt=0;Kt<Ar.length;Kt++)mn[mn.length-1-Kt]!==(Gt=Ar[Ar.length-1-Kt])&&(rn.hasOwnProperty(Gt)?(Nt.push({command:xn.removeLayer,args:[Gt]}),mn.splice(mn.lastIndexOf(Gt,mn.length-jt),1)):jt++,Nt.push({command:xn.addLayer,args:[Xr[Gt],Lr=mn[mn.length-Kt]]}),mn.splice(mn.length-Kt,0,Gt),Ln[Gt]=!0);for(Kt=0;Kt<Ar.length;Kt++)if(nr=rn[Gt=Ar[Kt]],rr=Xr[Gt],!Ln[Gt]&&!i.deepEqual(nr,rr))if(i.deepEqual(nr.source,rr.source)&&i.deepEqual(nr["source-layer"],rr["source-layer"])&&i.deepEqual(nr.type,rr.type)){for(vr in va(nr.layout,rr.layout,Nt,Gt,null,xn.setLayoutProperty),va(nr.paint,rr.paint,Nt,Gt,null,xn.setPaintProperty),i.deepEqual(nr.filter,rr.filter)||Nt.push({command:xn.setFilter,args:[Gt,rr.filter]}),i.deepEqual(nr.minzoom,rr.minzoom)&&i.deepEqual(nr.maxzoom,rr.maxzoom)||Nt.push({command:xn.setLayerZoomRange,args:[Gt,rr.minzoom,rr.maxzoom]}),nr)nr.hasOwnProperty(vr)&&vr!=="layout"&&vr!=="paint"&&vr!=="filter"&&vr!=="metadata"&&vr!=="minzoom"&&vr!=="maxzoom"&&(vr.indexOf("paint.")===0?va(nr[vr],rr[vr],Nt,Gt,vr.slice(6),xn.setPaintProperty):i.deepEqual(nr[vr],rr[vr])||Nt.push({command:xn.setLayerProperty,args:[Gt,vr,rr[vr]]}));for(vr in rr)rr.hasOwnProperty(vr)&&!nr.hasOwnProperty(vr)&&vr!=="layout"&&vr!=="paint"&&vr!=="filter"&&vr!=="metadata"&&vr!=="minzoom"&&vr!=="maxzoom"&&(vr.indexOf("paint.")===0?va(nr[vr],rr[vr],Nt,Gt,vr.slice(6),xn.setPaintProperty):i.deepEqual(nr[vr],rr[vr])||Nt.push({command:xn.setLayerProperty,args:[Gt,vr,rr[vr]]}))}else Nt.push({command:xn.removeLayer,args:[Gt]}),Lr=mn[mn.lastIndexOf(Gt)+1],Nt.push({command:xn.addLayer,args:[rr,Lr]})}(tt,z.layers,ue)}catch(rt){console.warn("Unable to compute style diff:",rt),ue=[{command:xn.setStyle,args:[z]}]}return ue}(this.serialize(),n).filter(function(L){return!(L.command in Ks)});if(g.length===0)return!1;var w=g.filter(function(L){return!(L.command in Ys)});if(w.length>0)throw new Error("Unimplemented: "+w.map(function(L){return L.command}).join(", ")+".");return g.forEach(function(L){L.command!=="setTransition"&&l[L.command].apply(l,L.args)}),this.stylesheet=n,!0},a.prototype.addImage=function(n,l){if(this.getImage(n))return this.fire(new i.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(n,l),this._afterImageUpdated(n)},a.prototype.updateImage=function(n,l){this.imageManager.updateImage(n,l)},a.prototype.getImage=function(n){return this.imageManager.getImage(n)},a.prototype.removeImage=function(n){if(!this.getImage(n))return this.fire(new i.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(n),this._afterImageUpdated(n)},a.prototype._afterImageUpdated=function(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new i.Event("data",{dataType:"style"}))},a.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},a.prototype.addSource=function(n,l,g){var w=this;if(g===void 0&&(g={}),this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error("There is already a source with this ID");if(!l.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(l).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(i.validateStyle.source,"sources."+n,l,null,g))){this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);var L=this.sourceCaches[n]=new Lt(n,l,this.dispatcher);L.style=this,L.setEventedParent(this,function(){return{isSourceLoaded:w.loaded(),source:L.serialize(),sourceId:n}}),L.onAdd(this.map),this._changed=!0}},a.prototype.removeSource=function(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(var l in this._layers)if(this._layers[l].source===n)return this.fire(new i.ErrorEvent(new Error('Source "'+n+'" cannot be removed while layer "'+l+'" is using it.')));var g=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],g.fire(new i.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),g.setEventedParent(null),g.clearTiles(),g.onRemove&&g.onRemove(this.map),this._changed=!0},a.prototype.setGeoJSONSourceData=function(n,l){this._checkLoaded(),this.sourceCaches[n].getSource().setData(l),this._changed=!0},a.prototype.getSource=function(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()},a.prototype.addLayer=function(n,l,g){g===void 0&&(g={}),this._checkLoaded();var w=n.id;if(this.getLayer(w))this.fire(new i.ErrorEvent(new Error('Layer with id "'+w+'" already exists on this map')));else{var L;if(n.type==="custom"){if(Fi(this,i.validateCustomStyleLayer(n)))return;L=i.createStyleLayer(n)}else{if(typeof n.source=="object"&&(this.addSource(w,n.source),n=i.clone$1(n),n=i.extend(n,{source:w})),this._validate(i.validateStyle.layer,"layers."+w,n,{arrayIndex:-1},g))return;L=i.createStyleLayer(n),this._validateLayer(L),L.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[L.id]=L.serialize()}var z=l?this._order.indexOf(l):this._order.length;if(l&&z===-1)this.fire(new i.ErrorEvent(new Error('Layer with id "'+l+'" does not exist on this map.')));else{if(this._order.splice(z,0,w),this._layerOrderChanged=!0,this._layers[w]=L,this._removedLayers[w]&&L.source&&L.type!=="custom"){var ue=this._removedLayers[w];delete this._removedLayers[w],ue.type!==L.type?this._updatedSources[L.source]="clear":(this._updatedSources[L.source]="reload",this.sourceCaches[L.source].pause())}this._updateLayer(L),L.onAdd&&L.onAdd(this.map)}}},a.prototype.moveLayer=function(n,l){if(this._checkLoaded(),this._changed=!0,this._layers[n]){if(n!==l){var g=this._order.indexOf(n);this._order.splice(g,1);var w=l?this._order.indexOf(l):this._order.length;l&&w===-1?this.fire(new i.ErrorEvent(new Error('Layer with id "'+l+'" does not exist on this map.'))):(this._order.splice(w,0,n),this._layerOrderChanged=!0)}}else this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be moved.")))},a.prototype.removeLayer=function(n){this._checkLoaded();var l=this._layers[n];if(l){l.setEventedParent(null);var g=this._order.indexOf(n);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=l,delete this._layers[n],delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],l.onRemove&&l.onRemove(this.map)}else this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be removed.")))},a.prototype.getLayer=function(n){return this._layers[n]},a.prototype.hasLayer=function(n){return n in this._layers},a.prototype.setLayerZoomRange=function(n,l,g){this._checkLoaded();var w=this.getLayer(n);w?w.minzoom===l&&w.maxzoom===g||(l!=null&&(w.minzoom=l),g!=null&&(w.maxzoom=g),this._updateLayer(w)):this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot have zoom extent.")))},a.prototype.setFilter=function(n,l,g){g===void 0&&(g={}),this._checkLoaded();var w=this.getLayer(n);if(w){if(!i.deepEqual(w.filter,l))return l==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(i.validateStyle.filter,"layers."+w.id+".filter",l,null,g)||(w.filter=i.clone$1(l),this._updateLayer(w)))}else this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be filtered.")))},a.prototype.getFilter=function(n){return i.clone$1(this.getLayer(n).filter)},a.prototype.setLayoutProperty=function(n,l,g,w){w===void 0&&(w={}),this._checkLoaded();var L=this.getLayer(n);L?i.deepEqual(L.getLayoutProperty(l),g)||(L.setLayoutProperty(l,g,w),this._updateLayer(L)):this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getLayoutProperty=function(n,l){var g=this.getLayer(n);if(g)return g.getLayoutProperty(l);this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style.")))},a.prototype.setPaintProperty=function(n,l,g,w){w===void 0&&(w={}),this._checkLoaded();var L=this.getLayer(n);L?i.deepEqual(L.getPaintProperty(l),g)||(L.setPaintProperty(l,g,w)&&this._updateLayer(L),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getPaintProperty=function(n,l){return this.getLayer(n).getPaintProperty(l)},a.prototype.setFeatureState=function(n,l){this._checkLoaded();var g=n.source,w=n.sourceLayer,L=this.sourceCaches[g];if(L!==void 0){var z=L.getSource().type;z==="geojson"&&w?this.fire(new i.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):z!=="vector"||w?(n.id===void 0&&this.fire(new i.ErrorEvent(new Error("The feature id parameter must be provided."))),L.setFeatureState(w,n.id,l)):this.fire(new i.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new i.ErrorEvent(new Error("The source '"+g+"' does not exist in the map's style.")))},a.prototype.removeFeatureState=function(n,l){this._checkLoaded();var g=n.source,w=this.sourceCaches[g];if(w!==void 0){var L=w.getSource().type,z=L==="vector"?n.sourceLayer:void 0;L!=="vector"||z?l&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new i.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):w.removeFeatureState(z,n.id,l):this.fire(new i.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new i.ErrorEvent(new Error("The source '"+g+"' does not exist in the map's style.")))},a.prototype.getFeatureState=function(n){this._checkLoaded();var l=n.source,g=n.sourceLayer,w=this.sourceCaches[l];if(w!==void 0){if(w.getSource().type!=="vector"||g)return n.id===void 0&&this.fire(new i.ErrorEvent(new Error("The feature id parameter must be provided."))),w.getFeatureState(g,n.id);this.fire(new i.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new i.ErrorEvent(new Error("The source '"+l+"' does not exist in the map's style.")))},a.prototype.getTransition=function(){return i.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},a.prototype.serialize=function(){return i.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:i.mapObject(this.sourceCaches,function(n){return n.serialize()}),layers:this._serializeLayers(this._order)},function(n){return n!==void 0})},a.prototype._updateLayer=function(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._changed=!0},a.prototype._flattenAndSortRenderedFeatures=function(n){for(var l=this,g=function(Xr){return l._layers[Xr].type==="fill-extrusion"},w={},L=[],z=this._order.length-1;z>=0;z--){var ue=this._order[z];if(g(ue)){w[ue]=z;for(var Ee=0,Ke=n;Ee<Ke.length;Ee+=1){var tt=Ke[Ee][ue];if(tt)for(var rt=0,Ft=tt;rt<Ft.length;rt+=1)L.push(Ft[rt])}}}L.sort(function(rn,Xr){return Xr.intersectionZ-rn.intersectionZ});for(var Nt=[],Kt=this._order.length-1;Kt>=0;Kt--){var jt=this._order[Kt];if(g(jt))for(var Gt=L.length-1;Gt>=0;Gt--){var nr=L[Gt].feature;if(w[nr.layer.id]<Kt)break;Nt.push(nr),L.pop()}else for(var rr=0,Lr=n;rr<Lr.length;rr+=1){var vr=Lr[rr][jt];if(vr)for(var Sr=0,Ar=vr;Sr<Ar.length;Sr+=1)Nt.push(Ar[Sr].feature)}}return Nt},a.prototype.queryRenderedFeatures=function(n,l,g){l&&l.filter&&this._validate(i.validateStyle.filter,"queryRenderedFeatures.filter",l.filter,null,l);var w={};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new i.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var L=0,z=l.layers;L<z.length;L+=1){var ue=z[L],Ee=this._layers[ue];if(!Ee)return this.fire(new i.ErrorEvent(new Error("The layer '"+ue+"' does not exist in the map's style and cannot be queried for features."))),[];w[Ee.source]=!0}}var Ke=[];for(var tt in l.availableImages=this._availableImages,this.sourceCaches)l.layers&&!w[tt]||Ke.push(Mt(this.sourceCaches[tt],this._layers,this._serializedLayers,n,l,g));return this.placement&&Ke.push(function(rt,Ft,Nt,Kt,jt,Gt,nr){for(var rr={},Lr=Gt.queryRenderedSymbols(Kt),vr=[],Sr=0,Ar=Object.keys(Lr).map(Number);Sr<Ar.length;Sr+=1)vr.push(nr[Ar[Sr]]);vr.sort(ve);for(var rn=function(){var Sa=mn[Xr],Za=Sa.featureIndex.lookupSymbolFeatures(Lr[Sa.bucketInstanceId],Ft,Sa.bucketIndex,Sa.sourceLayerIndex,jt.filter,jt.layers,jt.availableImages,rt);for(var Sn in Za){var ua=rr[Sn]=rr[Sn]||[],ba=Za[Sn];ba.sort(function(na,La){var za=Sa.featureSortOrder;if(za){var Gi=za.indexOf(na.featureIndex);return za.indexOf(La.featureIndex)-Gi}return La.featureIndex-na.featureIndex});for(var Zn=0,Aa=ba;Zn<Aa.length;Zn+=1)ua.push(Aa[Zn])}},Xr=0,mn=vr;Xr<mn.length;Xr+=1)rn();var Ln=function(Sa){rr[Sa].forEach(function(Za){var Sn=Za.feature,ua=Nt[rt[Sa].source].getFeatureState(Sn.layer["source-layer"],Sn.id);Sn.source=Sn.layer.source,Sn.layer["source-layer"]&&(Sn.sourceLayer=Sn.layer["source-layer"]),Sn.state=ua})};for(var qn in rr)Ln(qn);return rr}(this._layers,this._serializedLayers,this.sourceCaches,n,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Ke)},a.prototype.querySourceFeatures=function(n,l){l&&l.filter&&this._validate(i.validateStyle.filter,"querySourceFeatures.filter",l.filter,null,l);var g=this.sourceCaches[n];return g?function(w,L){for(var z=w.getRenderableIds().map(function(Ft){return w.getTileByID(Ft)}),ue=[],Ee={},Ke=0;Ke<z.length;Ke++){var tt=z[Ke],rt=tt.tileID.canonical.key;Ee[rt]||(Ee[rt]=!0,tt.querySourceFeatures(ue,L))}return ue}(g,l):[]},a.prototype.addSourceType=function(n,l,g){return a.getSourceType(n)?g(new Error('A source type called "'+n+'" already exists.')):(a.setSourceType(n,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:l.workerSourceURL},g):g(null,null))},a.prototype.getLight=function(){return this.light.getLight()},a.prototype.setLight=function(n,l){l===void 0&&(l={}),this._checkLoaded();var g=this.light.getLight(),w=!1;for(var L in n)if(!i.deepEqual(n[L],g[L])){w=!0;break}if(w){var z={now:i.browser.now(),transition:i.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,l),this.light.updateTransitions(z)}},a.prototype._validate=function(n,l,g,w,L){return L===void 0&&(L={}),(!L||L.validate!==!1)&&Fi(this,n.call(i.validateStyle,i.extend({key:l,style:this.serialize(),value:g,styleSpec:i.styleSpec},w)))},a.prototype._remove=function(){for(var n in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[n].setEventedParent(null);for(var l in this.sourceCaches)this.sourceCaches[l].clearTiles(),this.sourceCaches[l].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},a.prototype._clearSource=function(n){this.sourceCaches[n].clearTiles()},a.prototype._reloadSource=function(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()},a.prototype._updateSources=function(n){for(var l in this.sourceCaches)this.sourceCaches[l].update(n)},a.prototype._generateCollisionBoxes=function(){for(var n in this.sourceCaches)this._reloadSource(n)},a.prototype._updatePlacement=function(n,l,g,w,L){L===void 0&&(L=!1);for(var z=!1,ue=!1,Ee={},Ke=0,tt=this._order;Ke<tt.length;Ke+=1){var rt=this._layers[tt[Ke]];if(rt.type==="symbol"){if(!Ee[rt.source]){var Ft=this.sourceCaches[rt.source];Ee[rt.source]=Ft.getRenderableIds(!0).map(function(nr){return Ft.getTileByID(nr)}).sort(function(nr,rr){return rr.tileID.overscaledZ-nr.tileID.overscaledZ||(nr.tileID.isLessThan(rr.tileID)?-1:1)})}var Nt=this.crossTileSymbolIndex.addLayer(rt,Ee[rt.source],n.center.lng);z=z||Nt}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((L=L||this._layerOrderChanged||g===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.browser.now(),n.zoom))&&(this.pauseablePlacement=new bs(n,this._order,L,l,g,w,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Ee),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.browser.now()),ue=!0),z&&this.pauseablePlacement.placement.setStale()),ue||z)for(var Kt=0,jt=this._order;Kt<jt.length;Kt+=1){var Gt=this._layers[jt[Kt]];Gt.type==="symbol"&&this.placement.updateLayerOpacities(Gt,Ee[Gt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.browser.now())},a.prototype._releaseSymbolFadeTiles=function(){for(var n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()},a.prototype.getImages=function(n,l,g){this.imageManager.getImages(l.icons,g),this._updateTilesForChangedImages();var w=this.sourceCaches[l.source];w&&w.setDependencies(l.tileID.key,l.type,l.icons)},a.prototype.getGlyphs=function(n,l,g){this.glyphManager.getGlyphs(l.stacks,g)},a.prototype.getResource=function(n,l,g){return i.makeRequest(l,g)},a}(i.Evented);Ri.getSourceType=function(s){return nt[s]},Ri.setSourceType=function(s,a){nt[s]=a},Ri.registerForPluginStateChange=i.registerForPluginStateChange;var Vi=i.createLayout([{name:"a_pos",type:"Int16",components:2}]),xs=ci(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),vl=ci(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Qu=ci(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Rt=ci(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),fr=ci("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Mr=ci(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Wn=ci(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Xa=ci("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),vi=ci("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Ki=ci("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Ya=ci(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Ii=ci(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Go=ci(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Cs=ci(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),pi=ci(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Pl=ci(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),$s=ci(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Es=ci(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),gl=ci(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),cu=ci(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),_u=ci(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),fu=ci(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),Uu=ci(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Js=ci(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Rc=ci(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),pf=ci(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function ci(s,a){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=a.match(/attribute ([\w]+) ([\w]+)/g),g=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=a.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),L=w?w.concat(g):g,z={};return{fragmentSource:s=s.replace(n,function(ue,Ee,Ke,tt,rt){return z[rt]=!0,Ee==="define"?`
#ifndef HAS_UNIFORM_u_`+rt+`
varying `+Ke+" "+tt+" "+rt+`;
#else
uniform `+Ke+" "+tt+" u_"+rt+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+rt+`
    `+Ke+" "+tt+" "+rt+" = u_"+rt+`;
#endif
`}),vertexSource:a=a.replace(n,function(ue,Ee,Ke,tt,rt){var Ft=tt==="float"?"vec2":"vec4",Nt=rt.match(/color/)?"color":Ft;return z[rt]?Ee==="define"?`
#ifndef HAS_UNIFORM_u_`+rt+`
uniform lowp float u_`+rt+`_t;
attribute `+Ke+" "+Ft+" a_"+rt+`;
varying `+Ke+" "+tt+" "+rt+`;
#else
uniform `+Ke+" "+tt+" u_"+rt+`;
#endif
`:Nt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+rt+`
    `+rt+" = a_"+rt+`;
#else
    `+Ke+" "+tt+" "+rt+" = u_"+rt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+rt+`
    `+rt+" = unpack_mix_"+Nt+"(a_"+rt+", u_"+rt+`_t);
#else
    `+Ke+" "+tt+" "+rt+" = u_"+rt+`;
#endif
`:Ee==="define"?`
#ifndef HAS_UNIFORM_u_`+rt+`
uniform lowp float u_`+rt+`_t;
attribute `+Ke+" "+Ft+" a_"+rt+`;
#else
uniform `+Ke+" "+tt+" u_"+rt+`;
#endif
`:Nt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+rt+`
    `+Ke+" "+tt+" "+rt+" = a_"+rt+`;
#else
    `+Ke+" "+tt+" "+rt+" = u_"+rt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+rt+`
    `+Ke+" "+tt+" "+rt+" = unpack_mix_"+Nt+"(a_"+rt+", u_"+rt+`_t);
#else
    `+Ke+" "+tt+" "+rt+" = u_"+rt+`;
#endif
`}),staticAttributes:l,staticUniforms:L}}var Ic=Object.freeze({__proto__:null,prelude:xs,background:vl,backgroundPattern:Qu,circle:Rt,clippingMask:fr,heatmap:Mr,heatmapTexture:Wn,collisionBox:Xa,collisionCircle:vi,debug:Ki,fill:Ya,fillOutline:Ii,fillOutlinePattern:Go,fillPattern:Cs,fillExtrusion:pi,fillExtrusionPattern:Pl,hillshadePrepare:$s,hillshade:Es,line:gl,lineGradient:cu,linePattern:_u,lineSDF:fu,raster:Uu,symbolIcon:Js,symbolSDF:Rc,symbolTextAndIcon:pf}),gc=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Qc(s){for(var a=[],n=0;n<s.length;n++)if(s[n]!==null){var l=s[n].split(" ");a.push(l.pop())}return a}gc.prototype.bind=function(s,a,n,l,g,w,L,z){this.context=s;for(var ue=this.boundPaintVertexBuffers.length!==l.length,Ee=0;!ue&&Ee<l.length;Ee++)this.boundPaintVertexBuffers[Ee]!==l[Ee]&&(ue=!0);s.extVertexArrayObject&&this.vao&&this.boundProgram===a&&this.boundLayoutVertexBuffer===n&&!ue&&this.boundIndexBuffer===g&&this.boundVertexOffset===w&&this.boundDynamicVertexBuffer===L&&this.boundDynamicVertexBuffer2===z?(s.bindVertexArrayOES.set(this.vao),L&&L.bind(),g&&g.dynamicDraw&&g.bind(),z&&z.bind()):this.freshBind(a,n,l,g,w,L,z)},gc.prototype.freshBind=function(s,a,n,l,g,w,L){var z,ue=s.numAttributes,Ee=this.context,Ke=Ee.gl;if(Ee.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Ee.extVertexArrayObject.createVertexArrayOES(),Ee.bindVertexArrayOES.set(this.vao),z=0,this.boundProgram=s,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=l,this.boundVertexOffset=g,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=L;else{z=Ee.currentNumAttributes||0;for(var tt=ue;tt<z;tt++)Ke.disableVertexAttribArray(tt)}a.enableAttributes(Ke,s);for(var rt=0,Ft=n;rt<Ft.length;rt+=1)Ft[rt].enableAttributes(Ke,s);w&&w.enableAttributes(Ke,s),L&&L.enableAttributes(Ke,s),a.bind(),a.setVertexAttribPointers(Ke,s,g);for(var Nt=0,Kt=n;Nt<Kt.length;Nt+=1){var jt=Kt[Nt];jt.bind(),jt.setVertexAttribPointers(Ke,s,g)}w&&(w.bind(),w.setVertexAttribPointers(Ke,s,g)),l&&l.bind(),L&&(L.bind(),L.setVertexAttribPointers(Ke,s,g)),Ee.currentNumAttributes=ue},gc.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var yl=function(a,n,l,g,w,L){var z=a.gl;this.program=z.createProgram();for(var ue=Qc(l.staticAttributes),Ee=g?g.getBinderAttributes():[],Ke=ue.concat(Ee),tt=l.staticUniforms?Qc(l.staticUniforms):[],rt=g?g.getBinderUniforms():[],Ft=[],Nt=0,Kt=tt.concat(rt);Nt<Kt.length;Nt+=1){var jt=Kt[Nt];Ft.indexOf(jt)<0&&Ft.push(jt)}var Gt=g?g.defines():[];L&&Gt.push("#define OVERDRAW_INSPECTOR;");var nr=Gt.concat(xs.fragmentSource,l.fragmentSource).join(`
`),rr=Gt.concat(xs.vertexSource,l.vertexSource).join(`
`),Lr=z.createShader(z.FRAGMENT_SHADER);if(z.isContextLost())this.failedToCreate=!0;else{z.shaderSource(Lr,nr),z.compileShader(Lr),z.attachShader(this.program,Lr);var vr=z.createShader(z.VERTEX_SHADER);if(z.isContextLost())this.failedToCreate=!0;else{z.shaderSource(vr,rr),z.compileShader(vr),z.attachShader(this.program,vr),this.attributes={};var Sr={};this.numAttributes=Ke.length;for(var Ar=0;Ar<this.numAttributes;Ar++)Ke[Ar]&&(z.bindAttribLocation(this.program,Ar,Ke[Ar]),this.attributes[Ke[Ar]]=Ar);z.linkProgram(this.program),z.deleteShader(vr),z.deleteShader(Lr);for(var rn=0;rn<Ft.length;rn++){var Xr=Ft[rn];if(Xr&&!Sr[Xr]){var mn=z.getUniformLocation(this.program,Xr);mn&&(Sr[Xr]=mn)}}this.fixedUniforms=w(a,Sr),this.binderUniforms=g?g.getUniforms(a,Sr):[]}}};function qc(s,a,n){var l=1/Ha(n,1,a.transform.tileZoom),g=Math.pow(2,n.tileID.overscaledZ),w=n.tileSize*Math.pow(2,a.transform.tileZoom)/g,L=w*(n.tileID.canonical.x+n.tileID.wrap*g),z=w*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[l,s.fromScale,s.toScale],u_fade:s.t,u_pixel_coord_upper:[L>>16,z>>16],u_pixel_coord_lower:[65535&L,65535&z]}}yl.prototype.draw=function(s,a,n,l,g,w,L,z,ue,Ee,Ke,tt,rt,Ft,Nt,Kt){var jt,Gt=s.gl;if(!this.failedToCreate){for(var nr in s.program.set(this.program),s.setDepthMode(n),s.setStencilMode(l),s.setColorMode(g),s.setCullFace(w),this.fixedUniforms)this.fixedUniforms[nr].set(L[nr]);Ft&&Ft.setUniforms(s,this.binderUniforms,tt,{zoom:rt});for(var rr=(jt={},jt[Gt.LINES]=2,jt[Gt.TRIANGLES]=3,jt[Gt.LINE_STRIP]=1,jt)[a],Lr=0,vr=Ke.get();Lr<vr.length;Lr+=1){var Sr=vr[Lr],Ar=Sr.vaos||(Sr.vaos={});(Ar[z]||(Ar[z]=new gc)).bind(s,this,ue,Ft?Ft.getPaintVertexBuffers():[],Ee,Sr.vertexOffset,Nt,Kt),Gt.drawElements(a,Sr.primitiveLength*rr,Gt.UNSIGNED_SHORT,Sr.primitiveOffset*rr*2)}}};var $i=function(a,n,l,g){var w=n.style.light,L=w.properties.get("position"),z=[L.x,L.y,L.z],ue=i.create$1();w.properties.get("anchor")==="viewport"&&i.fromRotation(ue,-n.transform.angle),i.transformMat3(z,z,ue);var Ee=w.properties.get("color");return{u_matrix:a,u_lightpos:z,u_lightintensity:w.properties.get("intensity"),u_lightcolor:[Ee.r,Ee.g,Ee.b],u_vertical_gradient:+l,u_opacity:g}},Su=function(a,n,l,g,w,L,z){return i.extend($i(a,n,l,g),qc(L,n,z),{u_height_factor:-Math.pow(2,w.overscaledZ)/z.tileSize/8})},bl=function(a){return{u_matrix:a}},as=function(a,n,l,g){return i.extend(bl(a),qc(l,n,g))},Dc=function(a,n){return{u_matrix:a,u_world:n}},yc=function(a,n,l,g,w){return i.extend(as(a,n,l,g),{u_world:w})},Ll=function(a,n,l,g){var w,L,z=a.transform;if(g.paint.get("circle-pitch-alignment")==="map"){var ue=Ha(l,1,z.zoom);w=!0,L=[ue,ue]}else w=!1,L=z.pixelsToGLUnits;return{u_camera_to_center_distance:z.cameraToCenterDistance,u_scale_with_map:+(g.paint.get("circle-pitch-scale")==="map"),u_matrix:a.translatePosMatrix(n.posMatrix,l,g.paint.get("circle-translate"),g.paint.get("circle-translate-anchor")),u_pitch_with_map:+w,u_device_pixel_ratio:i.browser.devicePixelRatio,u_extrude_scale:L}},qu=function(a,n,l){var g=Ha(l,1,n.zoom),w=Math.pow(2,n.zoom-l.tileID.overscaledZ),L=l.tileID.overscaleFactor();return{u_matrix:a,u_camera_to_center_distance:n.cameraToCenterDistance,u_pixels_to_tile_units:g,u_extrude_scale:[n.pixelsToGLUnits[0]/(g*w),n.pixelsToGLUnits[1]/(g*w)],u_overscale_factor:L}},Nc=function(a,n,l){return{u_matrix:a,u_inv_matrix:n,u_camera_to_center_distance:l.cameraToCenterDistance,u_viewport_size:[l.width,l.height]}},hu=function(a,n,l){return l===void 0&&(l=1),{u_matrix:a,u_color:n,u_overlay:0,u_overlay_scale:l}},Au=function(a){return{u_matrix:a}},ef=function(a,n,l,g){return{u_matrix:a,u_extrude_scale:Ha(n,1,l),u_intensity:g}},$l=function(a,n,l){var g=a.transform;return{u_matrix:kc(a,n,l),u_ratio:1/Ha(n,1,g.zoom),u_device_pixel_ratio:i.browser.devicePixelRatio,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},Ti=function(a,n,l,g){return i.extend($l(a,n,l),{u_image:0,u_image_height:g})},tf=function(a,n,l,g){var w=a.transform,L=Jl(n,w);return{u_matrix:kc(a,n,l),u_texsize:n.imageAtlasTexture.size,u_ratio:1/Ha(n,1,w.zoom),u_device_pixel_ratio:i.browser.devicePixelRatio,u_image:0,u_scale:[L,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]]}},mf=function(a,n,l,g,w){var L=a.lineAtlas,z=Jl(n,a.transform),ue=l.layout.get("line-cap")==="round",Ee=L.getDash(g.from,ue),Ke=L.getDash(g.to,ue),tt=Ee.width*w.fromScale,rt=Ke.width*w.toScale;return i.extend($l(a,n,l),{u_patternscale_a:[z/tt,-Ee.height/2],u_patternscale_b:[z/rt,-Ke.height/2],u_sdfgamma:L.width/(256*Math.min(tt,rt)*i.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Ee.y,u_tex_y_b:Ke.y,u_mix:w.t})};function Jl(s,a){return 1/Ha(s,1,a.tileZoom)}function kc(s,a,n){return s.translatePosMatrix(a.tileID.posMatrix,a,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}var Ql=function(a,n,l,g,w){return{u_matrix:a,u_tl_parent:n,u_scale_parent:l,u_buffer_scale:1,u_fade_t:g.mix,u_opacity:g.opacity*w.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:w.paint.get("raster-brightness-min"),u_brightness_high:w.paint.get("raster-brightness-max"),u_saturation_factor:(z=w.paint.get("raster-saturation"),z>0?1-1/(1.001-z):-z),u_contrast_factor:(L=w.paint.get("raster-contrast"),L>0?1/(1-L):1+L),u_spin_weights:el(w.paint.get("raster-hue-rotate"))};var L,z};function el(s){s*=Math.PI/180;var a=Math.sin(s),n=Math.cos(s);return[(2*n+1)/3,(-Math.sqrt(3)*a-n+1)/3,(Math.sqrt(3)*a-n+1)/3]}var Bu,xl=function(a,n,l,g,w,L,z,ue,Ee,Ke){var tt=w.transform;return{u_is_size_zoom_constant:+(a==="constant"||a==="source"),u_is_size_feature_constant:+(a==="constant"||a==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:tt.cameraToCenterDistance,u_pitch:tt.pitch/360*2*Math.PI,u_rotate_symbol:+l,u_aspect_ratio:tt.width/tt.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:L,u_label_plane_matrix:z,u_coord_matrix:ue,u_is_text:+Ee,u_pitch_with_map:+g,u_texsize:Ke,u_texture:0}},Po=function(a,n,l,g,w,L,z,ue,Ee,Ke,tt){var rt=w.transform;return i.extend(xl(a,n,l,g,w,L,z,ue,Ee,Ke),{u_gamma_scale:g?Math.cos(rt._pitch)*rt.cameraToCenterDistance:1,u_device_pixel_ratio:i.browser.devicePixelRatio,u_is_halo:+tt})},ql=function(a,n,l,g,w,L,z,ue,Ee,Ke){return i.extend(Po(a,n,l,g,w,L,z,ue,!0,Ee,!0),{u_texsize_icon:Ke,u_texture_icon:1})},Rl=function(a,n,l){return{u_matrix:a,u_opacity:n,u_color:l}},Il=function(a,n,l,g,w,L){return i.extend(function(z,ue,Ee,Ke){var tt=Ee.imageManager.getPattern(z.from.toString()),rt=Ee.imageManager.getPattern(z.to.toString()),Ft=Ee.imageManager.getPixelSize(),Nt=Ft.width,Kt=Ft.height,jt=Math.pow(2,Ke.tileID.overscaledZ),Gt=Ke.tileSize*Math.pow(2,Ee.transform.tileZoom)/jt,nr=Gt*(Ke.tileID.canonical.x+Ke.tileID.wrap*jt),rr=Gt*Ke.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:tt.tl,u_pattern_br_a:tt.br,u_pattern_tl_b:rt.tl,u_pattern_br_b:rt.br,u_texsize:[Nt,Kt],u_mix:ue.t,u_pattern_size_a:tt.displaySize,u_pattern_size_b:rt.displaySize,u_scale_a:ue.fromScale,u_scale_b:ue.toScale,u_tile_units_to_pixels:1/Ha(Ke,1,Ee.transform.tileZoom),u_pixel_coord_upper:[nr>>16,rr>>16],u_pixel_coord_lower:[65535&nr,65535&rr]}}(g,L,l,w),{u_matrix:a,u_opacity:n})},jc={fillExtrusion:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_lightpos:new i.Uniform3f(a,n.u_lightpos),u_lightintensity:new i.Uniform1f(a,n.u_lightintensity),u_lightcolor:new i.Uniform3f(a,n.u_lightcolor),u_vertical_gradient:new i.Uniform1f(a,n.u_vertical_gradient),u_opacity:new i.Uniform1f(a,n.u_opacity)}},fillExtrusionPattern:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_lightpos:new i.Uniform3f(a,n.u_lightpos),u_lightintensity:new i.Uniform1f(a,n.u_lightintensity),u_lightcolor:new i.Uniform3f(a,n.u_lightcolor),u_vertical_gradient:new i.Uniform1f(a,n.u_vertical_gradient),u_height_factor:new i.Uniform1f(a,n.u_height_factor),u_image:new i.Uniform1i(a,n.u_image),u_texsize:new i.Uniform2f(a,n.u_texsize),u_pixel_coord_upper:new i.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new i.Uniform2f(a,n.u_pixel_coord_lower),u_scale:new i.Uniform3f(a,n.u_scale),u_fade:new i.Uniform1f(a,n.u_fade),u_opacity:new i.Uniform1f(a,n.u_opacity)}},fill:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix)}},fillPattern:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_image:new i.Uniform1i(a,n.u_image),u_texsize:new i.Uniform2f(a,n.u_texsize),u_pixel_coord_upper:new i.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new i.Uniform2f(a,n.u_pixel_coord_lower),u_scale:new i.Uniform3f(a,n.u_scale),u_fade:new i.Uniform1f(a,n.u_fade)}},fillOutline:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_world:new i.Uniform2f(a,n.u_world)}},fillOutlinePattern:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_world:new i.Uniform2f(a,n.u_world),u_image:new i.Uniform1i(a,n.u_image),u_texsize:new i.Uniform2f(a,n.u_texsize),u_pixel_coord_upper:new i.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new i.Uniform2f(a,n.u_pixel_coord_lower),u_scale:new i.Uniform3f(a,n.u_scale),u_fade:new i.Uniform1f(a,n.u_fade)}},circle:function(a,n){return{u_camera_to_center_distance:new i.Uniform1f(a,n.u_camera_to_center_distance),u_scale_with_map:new i.Uniform1i(a,n.u_scale_with_map),u_pitch_with_map:new i.Uniform1i(a,n.u_pitch_with_map),u_extrude_scale:new i.Uniform2f(a,n.u_extrude_scale),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_matrix:new i.UniformMatrix4f(a,n.u_matrix)}},collisionBox:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_camera_to_center_distance:new i.Uniform1f(a,n.u_camera_to_center_distance),u_pixels_to_tile_units:new i.Uniform1f(a,n.u_pixels_to_tile_units),u_extrude_scale:new i.Uniform2f(a,n.u_extrude_scale),u_overscale_factor:new i.Uniform1f(a,n.u_overscale_factor)}},collisionCircle:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_inv_matrix:new i.UniformMatrix4f(a,n.u_inv_matrix),u_camera_to_center_distance:new i.Uniform1f(a,n.u_camera_to_center_distance),u_viewport_size:new i.Uniform2f(a,n.u_viewport_size)}},debug:function(a,n){return{u_color:new i.UniformColor(a,n.u_color),u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_overlay:new i.Uniform1i(a,n.u_overlay),u_overlay_scale:new i.Uniform1f(a,n.u_overlay_scale)}},clippingMask:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix)}},heatmap:function(a,n){return{u_extrude_scale:new i.Uniform1f(a,n.u_extrude_scale),u_intensity:new i.Uniform1f(a,n.u_intensity),u_matrix:new i.UniformMatrix4f(a,n.u_matrix)}},heatmapTexture:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_world:new i.Uniform2f(a,n.u_world),u_image:new i.Uniform1i(a,n.u_image),u_color_ramp:new i.Uniform1i(a,n.u_color_ramp),u_opacity:new i.Uniform1f(a,n.u_opacity)}},hillshade:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_image:new i.Uniform1i(a,n.u_image),u_latrange:new i.Uniform2f(a,n.u_latrange),u_light:new i.Uniform2f(a,n.u_light),u_shadow:new i.UniformColor(a,n.u_shadow),u_highlight:new i.UniformColor(a,n.u_highlight),u_accent:new i.UniformColor(a,n.u_accent)}},hillshadePrepare:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_image:new i.Uniform1i(a,n.u_image),u_dimension:new i.Uniform2f(a,n.u_dimension),u_zoom:new i.Uniform1f(a,n.u_zoom),u_unpack:new i.Uniform4f(a,n.u_unpack)}},line:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_ratio:new i.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_units_to_pixels:new i.Uniform2f(a,n.u_units_to_pixels)}},lineGradient:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_ratio:new i.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_units_to_pixels:new i.Uniform2f(a,n.u_units_to_pixels),u_image:new i.Uniform1i(a,n.u_image),u_image_height:new i.Uniform1f(a,n.u_image_height)}},linePattern:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_texsize:new i.Uniform2f(a,n.u_texsize),u_ratio:new i.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_image:new i.Uniform1i(a,n.u_image),u_units_to_pixels:new i.Uniform2f(a,n.u_units_to_pixels),u_scale:new i.Uniform3f(a,n.u_scale),u_fade:new i.Uniform1f(a,n.u_fade)}},lineSDF:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_ratio:new i.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_units_to_pixels:new i.Uniform2f(a,n.u_units_to_pixels),u_patternscale_a:new i.Uniform2f(a,n.u_patternscale_a),u_patternscale_b:new i.Uniform2f(a,n.u_patternscale_b),u_sdfgamma:new i.Uniform1f(a,n.u_sdfgamma),u_image:new i.Uniform1i(a,n.u_image),u_tex_y_a:new i.Uniform1f(a,n.u_tex_y_a),u_tex_y_b:new i.Uniform1f(a,n.u_tex_y_b),u_mix:new i.Uniform1f(a,n.u_mix)}},raster:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_tl_parent:new i.Uniform2f(a,n.u_tl_parent),u_scale_parent:new i.Uniform1f(a,n.u_scale_parent),u_buffer_scale:new i.Uniform1f(a,n.u_buffer_scale),u_fade_t:new i.Uniform1f(a,n.u_fade_t),u_opacity:new i.Uniform1f(a,n.u_opacity),u_image0:new i.Uniform1i(a,n.u_image0),u_image1:new i.Uniform1i(a,n.u_image1),u_brightness_low:new i.Uniform1f(a,n.u_brightness_low),u_brightness_high:new i.Uniform1f(a,n.u_brightness_high),u_saturation_factor:new i.Uniform1f(a,n.u_saturation_factor),u_contrast_factor:new i.Uniform1f(a,n.u_contrast_factor),u_spin_weights:new i.Uniform3f(a,n.u_spin_weights)}},symbolIcon:function(a,n){return{u_is_size_zoom_constant:new i.Uniform1i(a,n.u_is_size_zoom_constant),u_is_size_feature_constant:new i.Uniform1i(a,n.u_is_size_feature_constant),u_size_t:new i.Uniform1f(a,n.u_size_t),u_size:new i.Uniform1f(a,n.u_size),u_camera_to_center_distance:new i.Uniform1f(a,n.u_camera_to_center_distance),u_pitch:new i.Uniform1f(a,n.u_pitch),u_rotate_symbol:new i.Uniform1i(a,n.u_rotate_symbol),u_aspect_ratio:new i.Uniform1f(a,n.u_aspect_ratio),u_fade_change:new i.Uniform1f(a,n.u_fade_change),u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_label_plane_matrix:new i.UniformMatrix4f(a,n.u_label_plane_matrix),u_coord_matrix:new i.UniformMatrix4f(a,n.u_coord_matrix),u_is_text:new i.Uniform1i(a,n.u_is_text),u_pitch_with_map:new i.Uniform1i(a,n.u_pitch_with_map),u_texsize:new i.Uniform2f(a,n.u_texsize),u_texture:new i.Uniform1i(a,n.u_texture)}},symbolSDF:function(a,n){return{u_is_size_zoom_constant:new i.Uniform1i(a,n.u_is_size_zoom_constant),u_is_size_feature_constant:new i.Uniform1i(a,n.u_is_size_feature_constant),u_size_t:new i.Uniform1f(a,n.u_size_t),u_size:new i.Uniform1f(a,n.u_size),u_camera_to_center_distance:new i.Uniform1f(a,n.u_camera_to_center_distance),u_pitch:new i.Uniform1f(a,n.u_pitch),u_rotate_symbol:new i.Uniform1i(a,n.u_rotate_symbol),u_aspect_ratio:new i.Uniform1f(a,n.u_aspect_ratio),u_fade_change:new i.Uniform1f(a,n.u_fade_change),u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_label_plane_matrix:new i.UniformMatrix4f(a,n.u_label_plane_matrix),u_coord_matrix:new i.UniformMatrix4f(a,n.u_coord_matrix),u_is_text:new i.Uniform1i(a,n.u_is_text),u_pitch_with_map:new i.Uniform1i(a,n.u_pitch_with_map),u_texsize:new i.Uniform2f(a,n.u_texsize),u_texture:new i.Uniform1i(a,n.u_texture),u_gamma_scale:new i.Uniform1f(a,n.u_gamma_scale),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_is_halo:new i.Uniform1i(a,n.u_is_halo)}},symbolTextAndIcon:function(a,n){return{u_is_size_zoom_constant:new i.Uniform1i(a,n.u_is_size_zoom_constant),u_is_size_feature_constant:new i.Uniform1i(a,n.u_is_size_feature_constant),u_size_t:new i.Uniform1f(a,n.u_size_t),u_size:new i.Uniform1f(a,n.u_size),u_camera_to_center_distance:new i.Uniform1f(a,n.u_camera_to_center_distance),u_pitch:new i.Uniform1f(a,n.u_pitch),u_rotate_symbol:new i.Uniform1i(a,n.u_rotate_symbol),u_aspect_ratio:new i.Uniform1f(a,n.u_aspect_ratio),u_fade_change:new i.Uniform1f(a,n.u_fade_change),u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_label_plane_matrix:new i.UniformMatrix4f(a,n.u_label_plane_matrix),u_coord_matrix:new i.UniformMatrix4f(a,n.u_coord_matrix),u_is_text:new i.Uniform1i(a,n.u_is_text),u_pitch_with_map:new i.Uniform1i(a,n.u_pitch_with_map),u_texsize:new i.Uniform2f(a,n.u_texsize),u_texsize_icon:new i.Uniform2f(a,n.u_texsize_icon),u_texture:new i.Uniform1i(a,n.u_texture),u_texture_icon:new i.Uniform1i(a,n.u_texture_icon),u_gamma_scale:new i.Uniform1f(a,n.u_gamma_scale),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_is_halo:new i.Uniform1i(a,n.u_is_halo)}},background:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_opacity:new i.Uniform1f(a,n.u_opacity),u_color:new i.UniformColor(a,n.u_color)}},backgroundPattern:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_opacity:new i.Uniform1f(a,n.u_opacity),u_image:new i.Uniform1i(a,n.u_image),u_pattern_tl_a:new i.Uniform2f(a,n.u_pattern_tl_a),u_pattern_br_a:new i.Uniform2f(a,n.u_pattern_br_a),u_pattern_tl_b:new i.Uniform2f(a,n.u_pattern_tl_b),u_pattern_br_b:new i.Uniform2f(a,n.u_pattern_br_b),u_texsize:new i.Uniform2f(a,n.u_texsize),u_mix:new i.Uniform1f(a,n.u_mix),u_pattern_size_a:new i.Uniform2f(a,n.u_pattern_size_a),u_pattern_size_b:new i.Uniform2f(a,n.u_pattern_size_b),u_scale_a:new i.Uniform1f(a,n.u_scale_a),u_scale_b:new i.Uniform1f(a,n.u_scale_b),u_pixel_coord_upper:new i.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new i.Uniform2f(a,n.u_pixel_coord_lower),u_tile_units_to_pixels:new i.Uniform1f(a,n.u_tile_units_to_pixels)}}};function El(s,a,n,l,g,w,L){for(var z=s.context,ue=z.gl,Ee=s.useProgram("collisionBox"),Ke=[],tt=0,rt=0,Ft=0;Ft<l.length;Ft++){var Nt=l[Ft],Kt=a.getTile(Nt),jt=Kt.getBucket(n);if(jt){var Gt=Nt.posMatrix;g[0]===0&&g[1]===0||(Gt=s.translatePosMatrix(Nt.posMatrix,Kt,g,w));var nr=L?jt.textCollisionBox:jt.iconCollisionBox,rr=jt.collisionCircleArray;if(rr.length>0){var Lr=i.create(),vr=Gt;i.mul(Lr,jt.placementInvProjMatrix,s.transform.glCoordMatrix),i.mul(Lr,Lr,jt.placementViewportMatrix),Ke.push({circleArray:rr,circleOffset:rt,transform:vr,invTransform:Lr}),rt=tt+=rr.length/4}nr&&Ee.draw(z,ue.LINES,xe.disabled,st.disabled,s.colorModeForRenderPass(),Bt.disabled,qu(Gt,s.transform,Kt),n.id,nr.layoutVertexBuffer,nr.indexBuffer,nr.segments,null,s.transform.zoom,null,null,nr.collisionVertexBuffer)}}if(L&&Ke.length){var Sr=s.useProgram("collisionCircle"),Ar=new i.StructArrayLayout2f1f2i16;Ar.resize(4*tt),Ar._trim();for(var rn=0,Xr=0,mn=Ke;Xr<mn.length;Xr+=1)for(var Ln=mn[Xr],qn=0;qn<Ln.circleArray.length/4;qn++){var sa=4*qn,Sa=Ln.circleArray[sa+0],Za=Ln.circleArray[sa+1],Sn=Ln.circleArray[sa+2],ua=Ln.circleArray[sa+3];Ar.emplace(rn++,Sa,Za,Sn,ua,0),Ar.emplace(rn++,Sa,Za,Sn,ua,1),Ar.emplace(rn++,Sa,Za,Sn,ua,2),Ar.emplace(rn++,Sa,Za,Sn,ua,3)}(!Bu||Bu.length<2*tt)&&(Bu=function(Gi){var _i=2*Gi,Di=new i.StructArrayLayout3ui6;Di.resize(_i),Di._trim();for(var gi=0;gi<_i;gi++){var Ui=6*gi;Di.uint16[Ui+0]=4*gi+0,Di.uint16[Ui+1]=4*gi+1,Di.uint16[Ui+2]=4*gi+2,Di.uint16[Ui+3]=4*gi+2,Di.uint16[Ui+4]=4*gi+3,Di.uint16[Ui+5]=4*gi+0}return Di}(tt));for(var ba=z.createIndexBuffer(Bu,!0),Zn=z.createVertexBuffer(Ar,i.collisionCircleLayout.members,!0),Aa=0,na=Ke;Aa<na.length;Aa+=1){var La=na[Aa],za=Nc(La.transform,La.invTransform,s.transform);Sr.draw(z,ue.TRIANGLES,xe.disabled,st.disabled,s.colorModeForRenderPass(),Bt.disabled,za,n.id,Zn,ba,i.SegmentVector.simpleSegment(0,2*La.circleOffset,La.circleArray.length,La.circleArray.length/2),null,s.transform.zoom,null,null,null)}Zn.destroy(),ba.destroy()}}var Qs=i.identity(new Float32Array(16));function eo(s,a,n,l,g,w){var L=i.getAnchorAlignment(s),z=-(L.horizontalAlign-.5)*a,ue=-(L.verticalAlign-.5)*n,Ee=i.evaluateVariableOffset(s,l);return new i.Point((z/g+Ee[0])*w,(ue/g+Ee[1])*w)}function vf(s,a,n,l,g,w,L,z,ue,Ee,Ke){var tt=s.text.placedSymbolArray,rt=s.text.dynamicLayoutVertexArray,Ft=s.icon.dynamicLayoutVertexArray,Nt={};rt.clear();for(var Kt=0;Kt<tt.length;Kt++){var jt=tt.get(Kt),Gt=jt.hidden||!jt.crossTileID||s.allowVerticalPlacement&&!jt.placedOrientation?null:l[jt.crossTileID];if(Gt){var nr=new i.Point(jt.anchorX,jt.anchorY),rr=ya(nr,n?z:L),Lr=fa(w.cameraToCenterDistance,rr.signedDistanceFromCamera),vr=g.evaluateSizeForFeature(s.textSizeData,Ee,jt)*Lr/i.ONE_EM;n&&(vr*=s.tilePixelRatio/ue);for(var Sr=eo(Gt.anchor,Gt.width,Gt.height,Gt.textOffset,Gt.textBoxScale,vr),Ar=n?ya(nr.add(Sr),L).point:rr.point.add(a?Sr.rotate(-w.angle):Sr),rn=s.allowVerticalPlacement&&jt.placedOrientation===i.WritingMode.vertical?Math.PI/2:0,Xr=0;Xr<jt.numGlyphs;Xr++)i.addDynamicAttributes(rt,Ar,rn);Ke&&jt.associatedIconIndex>=0&&(Nt[jt.associatedIconIndex]={shiftedAnchor:Ar,angle:rn})}else oi(jt.numGlyphs,rt)}if(Ke){Ft.clear();for(var mn=s.icon.placedSymbolArray,Ln=0;Ln<mn.length;Ln++){var qn=mn.get(Ln);if(qn.hidden)oi(qn.numGlyphs,Ft);else{var sa=Nt[Ln];if(sa)for(var Sa=0;Sa<qn.numGlyphs;Sa++)i.addDynamicAttributes(Ft,sa.shiftedAnchor,sa.angle);else oi(qn.numGlyphs,Ft)}}s.icon.dynamicLayoutVertexBuffer.updateData(Ft)}s.text.dynamicLayoutVertexBuffer.updateData(rt)}function gf(s,a,n){return n.iconsInText&&a?"symbolTextAndIcon":s?"symbolSDF":"symbolIcon"}function Tl(s,a,n,l,g,w,L,z,ue,Ee,Ke,tt){for(var rt=s.context,Ft=rt.gl,Nt=s.transform,Kt=z==="map",jt=ue==="map",Gt=Kt&&n.layout.get("symbol-placement")!=="point",nr=Kt&&!jt&&!Gt,rr=n.layout.get("symbol-sort-key").constantOr(1)!==void 0,Lr=!1,vr=s.depthModeForSublayer(0,xe.ReadOnly),Sr=n.layout.get("text-variable-anchor"),Ar=[],rn=0,Xr=l;rn<Xr.length;rn+=1){var mn=Xr[rn],Ln=a.getTile(mn),qn=Ln.getBucket(n);if(qn){var sa=g?qn.text:qn.icon;if(sa&&sa.segments.get().length){var Sa=sa.programConfigurations.get(n.id),Za=g||qn.sdfIcons,Sn=g?qn.textSizeData:qn.iconSizeData,ua=jt||Nt.pitch!==0,ba=s.useProgram(gf(Za,g,qn),Sa),Zn=i.evaluateSizeForZoom(Sn,Nt.zoom),Aa=void 0,na=[0,0],La=void 0,za=void 0,Gi=null,_i=void 0;if(g)La=Ln.glyphAtlasTexture,za=Ft.LINEAR,Aa=Ln.glyphAtlasTexture.size,qn.iconsInText&&(na=Ln.imageAtlasTexture.size,Gi=Ln.imageAtlasTexture,_i=ua||s.options.rotating||s.options.zooming||Sn.kind==="composite"||Sn.kind==="camera"?Ft.LINEAR:Ft.NEAREST);else{var Di=n.layout.get("icon-size").constantOr(0)!==1||qn.iconsNeedLinear;La=Ln.imageAtlasTexture,za=Za||s.options.rotating||s.options.zooming||Di||ua?Ft.LINEAR:Ft.NEAREST,Aa=Ln.imageAtlasTexture.size}var gi=Ha(Ln,1,s.transform.zoom),Ui=di(mn.posMatrix,jt,Kt,s.transform,gi),Qo=ga(mn.posMatrix,jt,Kt,s.transform,gi),qo=Sr&&qn.hasTextData(),vu=n.layout.get("icon-text-fit")!=="none"&&qo&&qn.hasIconData();Gt&&ns(qn,mn.posMatrix,s,g,Ui,Qo,jt,Ee);var Mu=s.translatePosMatrix(mn.posMatrix,Ln,w,L),cs=Gt||g&&Sr||vu?Qs:Ui,Gs=s.translatePosMatrix(Qo,Ln,w,L,!0),Pu=Za&&n.paint.get(g?"text-halo-width":"icon-halo-width").constantOr(1)!==0,sc={program:ba,buffers:sa,uniformValues:Za?qn.iconsInText?ql(Sn.kind,Zn,nr,jt,s,Mu,cs,Gs,Aa,na):Po(Sn.kind,Zn,nr,jt,s,Mu,cs,Gs,g,Aa,!0):xl(Sn.kind,Zn,nr,jt,s,Mu,cs,Gs,g,Aa),atlasTexture:La,atlasTextureIcon:Gi,atlasInterpolation:za,atlasInterpolationIcon:_i,isSDF:Za,hasHalo:Pu};if(rr&&qn.canOverlap){Lr=!0;for(var tu=0,Xu=sa.segments.get();tu<Xu.length;tu+=1){var uc=Xu[tu];Ar.push({segments:new i.SegmentVector([uc]),sortKey:uc.sortKey,state:sc})}}else Ar.push({segments:sa.segments,sortKey:0,state:sc})}}}Lr&&Ar.sort(function(Gl,hs){return Gl.sortKey-hs.sortKey});for(var ru=0,Lu=Ar;ru<Lu.length;ru+=1){var fs=Lu[ru],ao=fs.state;if(rt.activeTexture.set(Ft.TEXTURE0),ao.atlasTexture.bind(ao.atlasInterpolation,Ft.CLAMP_TO_EDGE),ao.atlasTextureIcon&&(rt.activeTexture.set(Ft.TEXTURE1),ao.atlasTextureIcon&&ao.atlasTextureIcon.bind(ao.atlasInterpolationIcon,Ft.CLAMP_TO_EDGE)),ao.isSDF){var Yu=ao.uniformValues;ao.hasHalo&&(Yu.u_is_halo=1,ec(ao.buffers,fs.segments,n,s,ao.program,vr,Ke,tt,Yu)),Yu.u_is_halo=0}ec(ao.buffers,fs.segments,n,s,ao.program,vr,Ke,tt,ao.uniformValues)}}function ec(s,a,n,l,g,w,L,z,ue){var Ee=l.context;g.draw(Ee,Ee.gl.TRIANGLES,w,L,z,Bt.disabled,ue,n.id,s.layoutVertexBuffer,s.indexBuffer,a,n.paint,l.transform.zoom,s.programConfigurations.get(n.id),s.dynamicLayoutVertexBuffer,s.opacityVertexBuffer)}function tl(s,a,n,l,g,w,L){var z,ue,Ee,Ke,tt,rt=s.context.gl,Ft=n.paint.get("fill-pattern"),Nt=Ft&&Ft.constantOr(1),Kt=n.getCrossfadeParameters();L?(ue=Nt&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",z=rt.LINES):(ue=Nt?"fillPattern":"fill",z=rt.TRIANGLES);for(var jt=0,Gt=l;jt<Gt.length;jt+=1){var nr=Gt[jt],rr=a.getTile(nr);if(!Nt||rr.patternsLoaded()){var Lr=rr.getBucket(n);if(Lr){var vr=Lr.programConfigurations.get(n.id),Sr=s.useProgram(ue,vr);Nt&&(s.context.activeTexture.set(rt.TEXTURE0),rr.imageAtlasTexture.bind(rt.LINEAR,rt.CLAMP_TO_EDGE),vr.updatePaintBuffers(Kt));var Ar=Ft.constantOr(null);if(Ar&&rr.imageAtlas){var rn=rr.imageAtlas,Xr=rn.patternPositions[Ar.to.toString()],mn=rn.patternPositions[Ar.from.toString()];Xr&&mn&&vr.setConstantPatternPositions(Xr,mn)}var Ln=s.translatePosMatrix(nr.posMatrix,rr,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(L){Ke=Lr.indexBuffer2,tt=Lr.segments2;var qn=[rt.drawingBufferWidth,rt.drawingBufferHeight];Ee=ue==="fillOutlinePattern"&&Nt?yc(Ln,s,Kt,rr,qn):Dc(Ln,qn)}else Ke=Lr.indexBuffer,tt=Lr.segments,Ee=Nt?as(Ln,s,Kt,rr):bl(Ln);Sr.draw(s.context,z,g,s.stencilModeForClipping(nr),w,Bt.disabled,Ee,n.id,Lr.layoutVertexBuffer,Ke,tt,n.paint,s.transform.zoom,vr)}}}}function Dl(s,a,n,l,g,w,L){for(var z=s.context,ue=z.gl,Ee=n.paint.get("fill-extrusion-pattern"),Ke=Ee.constantOr(1),tt=n.getCrossfadeParameters(),rt=n.paint.get("fill-extrusion-opacity"),Ft=0,Nt=l;Ft<Nt.length;Ft+=1){var Kt=Nt[Ft],jt=a.getTile(Kt),Gt=jt.getBucket(n);if(Gt){var nr=Gt.programConfigurations.get(n.id),rr=s.useProgram(Ke?"fillExtrusionPattern":"fillExtrusion",nr);Ke&&(s.context.activeTexture.set(ue.TEXTURE0),jt.imageAtlasTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE),nr.updatePaintBuffers(tt));var Lr=Ee.constantOr(null);if(Lr&&jt.imageAtlas){var vr=jt.imageAtlas,Sr=vr.patternPositions[Lr.to.toString()],Ar=vr.patternPositions[Lr.from.toString()];Sr&&Ar&&nr.setConstantPatternPositions(Sr,Ar)}var rn=s.translatePosMatrix(Kt.posMatrix,jt,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),Xr=n.paint.get("fill-extrusion-vertical-gradient"),mn=Ke?Su(rn,s,Xr,rt,Kt,tt,jt):$i(rn,s,Xr,rt);rr.draw(z,z.gl.TRIANGLES,g,w,L,Bt.backCCW,mn,n.id,Gt.layoutVertexBuffer,Gt.indexBuffer,Gt.segments,n.paint,s.transform.zoom,nr)}}}function bc(s,a,n,l,g,w){var L=s.context,z=L.gl,ue=a.fbo;if(ue){var Ee=s.useProgram("hillshade");L.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,ue.colorAttachment.get());var Ke=function(tt,rt,Ft){var Nt=Ft.paint.get("hillshade-shadow-color"),Kt=Ft.paint.get("hillshade-highlight-color"),jt=Ft.paint.get("hillshade-accent-color"),Gt=Ft.paint.get("hillshade-illumination-direction")*(Math.PI/180);Ft.paint.get("hillshade-illumination-anchor")==="viewport"&&(Gt-=tt.transform.angle);var nr,rr,Lr,vr=!tt.options.moving;return{u_matrix:tt.transform.calculatePosMatrix(rt.tileID.toUnwrapped(),vr),u_image:0,u_latrange:(nr=rt.tileID,rr=Math.pow(2,nr.canonical.z),Lr=nr.canonical.y,[new i.MercatorCoordinate(0,Lr/rr).toLngLat().lat,new i.MercatorCoordinate(0,(Lr+1)/rr).toLngLat().lat]),u_light:[Ft.paint.get("hillshade-exaggeration"),Gt],u_shadow:Nt,u_highlight:Kt,u_accent:jt}}(s,a,n);Ee.draw(L,z.TRIANGLES,l,g,w,Bt.disabled,Ke,n.id,s.rasterBoundsBuffer,s.quadTriangleIndexBuffer,s.rasterBoundsSegments)}}function xc(s,a,n,l,g,w){var L=s.context,z=L.gl,ue=a.dem;if(ue&&ue.data){var Ee=ue.dim,Ke=ue.stride,tt=ue.getPixels();if(L.activeTexture.set(z.TEXTURE1),L.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||s.getTileTexture(Ke),a.demTexture){var rt=a.demTexture;rt.update(tt,{premultiply:!1}),rt.bind(z.NEAREST,z.CLAMP_TO_EDGE)}else a.demTexture=new i.Texture(L,tt,z.RGBA,{premultiply:!1}),a.demTexture.bind(z.NEAREST,z.CLAMP_TO_EDGE);L.activeTexture.set(z.TEXTURE0);var Ft=a.fbo;if(!Ft){var Nt=new i.Texture(L,{width:Ee,height:Ee,data:null},z.RGBA);Nt.bind(z.LINEAR,z.CLAMP_TO_EDGE),(Ft=a.fbo=L.createFramebuffer(Ee,Ee,!0)).colorAttachment.set(Nt.texture)}L.bindFramebuffer.set(Ft.framebuffer),L.viewport.set([0,0,Ee,Ee]),s.useProgram("hillshadePrepare").draw(L,z.TRIANGLES,l,g,w,Bt.disabled,function(Kt,jt){var Gt=jt.stride,nr=i.create();return i.ortho(nr,0,i.EXTENT,-i.EXTENT,0,0,1),i.translate(nr,nr,[0,-i.EXTENT,0]),{u_matrix:nr,u_image:1,u_dimension:[Gt,Gt],u_zoom:Kt.overscaledZ,u_unpack:jt.getUnpackVector()}}(a.tileID,ue),n.id,s.rasterBoundsBuffer,s.quadTriangleIndexBuffer,s.rasterBoundsSegments),a.needsHillshadePrepare=!1}}function rl(s,a,n,l,g){var w=l.paint.get("raster-fade-duration");if(w>0){var L=i.browser.now(),z=(L-s.timeAdded)/w,ue=a?(L-a.timeAdded)/w:-1,Ee=n.getSource(),Ke=g.coveringZoomLevel({tileSize:Ee.tileSize,roundZoom:Ee.roundZoom}),tt=!a||Math.abs(a.tileID.overscaledZ-Ke)>Math.abs(s.tileID.overscaledZ-Ke),rt=tt&&s.refreshedUponExpiration?1:i.clamp(tt?z:1-ue,0,1);return s.refreshedUponExpiration&&z>=1&&(s.refreshedUponExpiration=!1),a?{opacity:1,mix:1-rt}:{opacity:rt,mix:0}}return{opacity:1,mix:0}}var rf=new i.Color(1,0,0,1),nl=new i.Color(0,1,0,1),qs=new i.Color(0,0,1,1),_l=new i.Color(1,0,1,1),tc=new i.Color(0,1,1,1);function Fc(s,a,n,l){Fs(s,0,a+n/2,s.transform.width,n,l)}function nf(s,a,n,l){Fs(s,a-n/2,0,n,s.transform.height,l)}function Fs(s,a,n,l,g,w){var L=s.context,z=L.gl;z.enable(z.SCISSOR_TEST),z.scissor(a*i.browser.devicePixelRatio,n*i.browser.devicePixelRatio,l*i.browser.devicePixelRatio,g*i.browser.devicePixelRatio),L.clear({color:w}),z.disable(z.SCISSOR_TEST)}function yf(s,a,n){var l=s.context,g=l.gl,w=n.posMatrix,L=s.useProgram("debug"),z=xe.disabled,ue=st.disabled,Ee=s.colorModeForRenderPass();l.activeTexture.set(g.TEXTURE0),s.emptyTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),L.draw(l,g.LINE_STRIP,z,ue,Ee,Bt.disabled,hu(w,i.Color.red),"$debug",s.debugBuffer,s.tileBorderIndexBuffer,s.debugSegments);var Ke=a.getTileByID(n.key).latestRawTileData,tt=Math.floor((Ke&&Ke.byteLength||0)/1024),rt=a.getTile(n).tileSize,Ft=512/Math.min(rt,512)*(n.overscaledZ/s.transform.zoom)*.5,Nt=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(Nt+=" => "+n.overscaledZ),function(Kt,jt){Kt.initDebugOverlayCanvas();var Gt=Kt.debugOverlayCanvas,nr=Kt.context.gl,rr=Kt.debugOverlayCanvas.getContext("2d");rr.clearRect(0,0,Gt.width,Gt.height),rr.shadowColor="white",rr.shadowBlur=2,rr.lineWidth=1.5,rr.strokeStyle="white",rr.textBaseline="top",rr.font="bold 36px Open Sans, sans-serif",rr.fillText(jt,5,5),rr.strokeText(jt,5,5),Kt.debugOverlayTexture.update(Gt),Kt.debugOverlayTexture.bind(nr.LINEAR,nr.CLAMP_TO_EDGE)}(s,Nt+" "+tt+"kb"),L.draw(l,g.TRIANGLES,z,ue,Ct.alphaBlended,Bt.disabled,hu(w,i.Color.transparent,Ft),"$debug",s.debugBuffer,s.quadTriangleIndexBuffer,s.debugSegments)}var al={symbol:function(a,n,l,g,w){if(a.renderPass==="translucent"){var L=st.disabled,z=a.colorModeForRenderPass();l.layout.get("text-variable-anchor")&&function(ue,Ee,Ke,tt,rt,Ft,Nt){for(var Kt=Ee.transform,jt=rt==="map",Gt=Ft==="map",nr=0,rr=ue;nr<rr.length;nr+=1){var Lr=rr[nr],vr=tt.getTile(Lr),Sr=vr.getBucket(Ke);if(Sr&&Sr.text&&Sr.text.segments.get().length){var Ar=i.evaluateSizeForZoom(Sr.textSizeData,Kt.zoom),rn=Ha(vr,1,Ee.transform.zoom),Xr=di(Lr.posMatrix,Gt,jt,Ee.transform,rn),mn=Ke.layout.get("icon-text-fit")!=="none"&&Sr.hasIconData();if(Ar){var Ln=Math.pow(2,Kt.zoom-vr.tileID.overscaledZ);vf(Sr,jt,Gt,Nt,i.symbolSize,Kt,Xr,Lr.posMatrix,Ln,Ar,mn)}}}}(g,a,l,n,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),w),l.paint.get("icon-opacity").constantOr(1)!==0&&Tl(a,n,l,g,!1,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),l.layout.get("icon-rotation-alignment"),l.layout.get("icon-pitch-alignment"),l.layout.get("icon-keep-upright"),L,z),l.paint.get("text-opacity").constantOr(1)!==0&&Tl(a,n,l,g,!0,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),l.layout.get("text-keep-upright"),L,z),n.map.showCollisionBoxes&&(El(a,n,l,g,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),El(a,n,l,g,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))}},circle:function(a,n,l,g){if(a.renderPass==="translucent"){var w=l.paint.get("circle-opacity"),L=l.paint.get("circle-stroke-width"),z=l.paint.get("circle-stroke-opacity"),ue=l.layout.get("circle-sort-key").constantOr(1)!==void 0;if(w.constantOr(1)!==0||L.constantOr(1)!==0&&z.constantOr(1)!==0){for(var Ee=a.context,Ke=Ee.gl,tt=a.depthModeForSublayer(0,xe.ReadOnly),rt=st.disabled,Ft=a.colorModeForRenderPass(),Nt=[],Kt=0;Kt<g.length;Kt++){var jt=g[Kt],Gt=n.getTile(jt),nr=Gt.getBucket(l);if(nr){var rr=nr.programConfigurations.get(l.id),Lr={programConfiguration:rr,program:a.useProgram("circle",rr),layoutVertexBuffer:nr.layoutVertexBuffer,indexBuffer:nr.indexBuffer,uniformValues:Ll(a,jt,Gt,l)};if(ue)for(var vr=0,Sr=nr.segments.get();vr<Sr.length;vr+=1){var Ar=Sr[vr];Nt.push({segments:new i.SegmentVector([Ar]),sortKey:Ar.sortKey,state:Lr})}else Nt.push({segments:nr.segments,sortKey:0,state:Lr})}}ue&&Nt.sort(function(qn,sa){return qn.sortKey-sa.sortKey});for(var rn=0,Xr=Nt;rn<Xr.length;rn+=1){var mn=Xr[rn],Ln=mn.state;Ln.program.draw(Ee,Ke.TRIANGLES,tt,rt,Ft,Bt.disabled,Ln.uniformValues,l.id,Ln.layoutVertexBuffer,Ln.indexBuffer,mn.segments,l.paint,a.transform.zoom,Ln.programConfiguration)}}}},heatmap:function(a,n,l,g){if(l.paint.get("heatmap-opacity")!==0)if(a.renderPass==="offscreen"){var w=a.context,L=w.gl,z=st.disabled,ue=new Ct([L.ONE,L.ONE],i.Color.transparent,[!0,!0,!0,!0]);!function(Nt,Kt,jt){var Gt=Nt.gl;Nt.activeTexture.set(Gt.TEXTURE1),Nt.viewport.set([0,0,Kt.width/4,Kt.height/4]);var nr=jt.heatmapFbo;if(nr)Gt.bindTexture(Gt.TEXTURE_2D,nr.colorAttachment.get()),Nt.bindFramebuffer.set(nr.framebuffer);else{var rr=Gt.createTexture();Gt.bindTexture(Gt.TEXTURE_2D,rr),Gt.texParameteri(Gt.TEXTURE_2D,Gt.TEXTURE_WRAP_S,Gt.CLAMP_TO_EDGE),Gt.texParameteri(Gt.TEXTURE_2D,Gt.TEXTURE_WRAP_T,Gt.CLAMP_TO_EDGE),Gt.texParameteri(Gt.TEXTURE_2D,Gt.TEXTURE_MIN_FILTER,Gt.LINEAR),Gt.texParameteri(Gt.TEXTURE_2D,Gt.TEXTURE_MAG_FILTER,Gt.LINEAR),nr=jt.heatmapFbo=Nt.createFramebuffer(Kt.width/4,Kt.height/4,!1),function(Lr,vr,Sr,Ar){var rn=Lr.gl;rn.texImage2D(rn.TEXTURE_2D,0,rn.RGBA,vr.width/4,vr.height/4,0,rn.RGBA,Lr.extRenderToTextureHalfFloat?Lr.extTextureHalfFloat.HALF_FLOAT_OES:rn.UNSIGNED_BYTE,null),Ar.colorAttachment.set(Sr)}(Nt,Kt,rr,nr)}}(w,a,l),w.clear({color:i.Color.transparent});for(var Ee=0;Ee<g.length;Ee++){var Ke=g[Ee];if(!n.hasRenderableParent(Ke)){var tt=n.getTile(Ke),rt=tt.getBucket(l);if(rt){var Ft=rt.programConfigurations.get(l.id);a.useProgram("heatmap",Ft).draw(w,L.TRIANGLES,xe.disabled,z,ue,Bt.disabled,ef(Ke.posMatrix,tt,a.transform.zoom,l.paint.get("heatmap-intensity")),l.id,rt.layoutVertexBuffer,rt.indexBuffer,rt.segments,l.paint,a.transform.zoom,Ft)}}}w.viewport.set([0,0,a.width,a.height])}else a.renderPass==="translucent"&&(a.context.setColorMode(a.colorModeForRenderPass()),function(Nt,Kt){var jt=Nt.context,Gt=jt.gl,nr=Kt.heatmapFbo;if(nr){jt.activeTexture.set(Gt.TEXTURE0),Gt.bindTexture(Gt.TEXTURE_2D,nr.colorAttachment.get()),jt.activeTexture.set(Gt.TEXTURE1);var rr=Kt.colorRampTexture;rr||(rr=Kt.colorRampTexture=new i.Texture(jt,Kt.colorRamp,Gt.RGBA)),rr.bind(Gt.LINEAR,Gt.CLAMP_TO_EDGE),Nt.useProgram("heatmapTexture").draw(jt,Gt.TRIANGLES,xe.disabled,st.disabled,Nt.colorModeForRenderPass(),Bt.disabled,function(Lr,vr,Sr,Ar){var rn=i.create();i.ortho(rn,0,Lr.width,Lr.height,0,0,1);var Xr=Lr.context.gl;return{u_matrix:rn,u_world:[Xr.drawingBufferWidth,Xr.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:vr.paint.get("heatmap-opacity")}}(Nt,Kt),Kt.id,Nt.viewportBuffer,Nt.quadTriangleIndexBuffer,Nt.viewportSegments,Kt.paint,Nt.transform.zoom)}}(a,l))},line:function(a,n,l,g){if(a.renderPass==="translucent"){var w=l.paint.get("line-opacity"),L=l.paint.get("line-width");if(w.constantOr(1)!==0&&L.constantOr(1)!==0)for(var z=a.depthModeForSublayer(0,xe.ReadOnly),ue=a.colorModeForRenderPass(),Ee=l.paint.get("line-dasharray"),Ke=l.paint.get("line-pattern"),tt=Ke.constantOr(1),rt=l.paint.get("line-gradient"),Ft=l.getCrossfadeParameters(),Nt=tt?"linePattern":Ee?"lineSDF":rt?"lineGradient":"line",Kt=a.context,jt=Kt.gl,Gt=!0,nr=0,rr=g;nr<rr.length;nr+=1){var Lr=rr[nr],vr=n.getTile(Lr);if(!tt||vr.patternsLoaded()){var Sr=vr.getBucket(l);if(Sr){var Ar=Sr.programConfigurations.get(l.id),rn=a.context.program.get(),Xr=a.useProgram(Nt,Ar),mn=Gt||Xr.program!==rn,Ln=Ke.constantOr(null);if(Ln&&vr.imageAtlas){var qn=vr.imageAtlas,sa=qn.patternPositions[Ln.to.toString()],Sa=qn.patternPositions[Ln.from.toString()];sa&&Sa&&Ar.setConstantPatternPositions(sa,Sa)}var Za=tt?tf(a,vr,l,Ft):Ee?mf(a,vr,l,Ee,Ft):rt?Ti(a,vr,l,Sr.lineClipsArray.length):$l(a,vr,l);if(tt)Kt.activeTexture.set(jt.TEXTURE0),vr.imageAtlasTexture.bind(jt.LINEAR,jt.CLAMP_TO_EDGE),Ar.updatePaintBuffers(Ft);else if(Ee&&(mn||a.lineAtlas.dirty))Kt.activeTexture.set(jt.TEXTURE0),a.lineAtlas.bind(Kt);else if(rt){var Sn=Sr.gradients[l.id],ua=Sn.texture;if(l.gradientVersion!==Sn.version){var ba=256;if(l.stepInterpolant){var Zn=n.getSource().maxzoom,Aa=Lr.canonical.z===Zn?Math.ceil(1<<a.transform.maxZoom-Lr.canonical.z):1;ba=i.clamp(i.nextPowerOfTwo(Sr.maxLineLength/i.EXTENT*1024*Aa),256,Kt.maxTextureSize)}Sn.gradient=i.renderColorRamp({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:ba,image:Sn.gradient||void 0,clips:Sr.lineClipsArray}),Sn.texture?Sn.texture.update(Sn.gradient):Sn.texture=new i.Texture(Kt,Sn.gradient,jt.RGBA),Sn.version=l.gradientVersion,ua=Sn.texture}Kt.activeTexture.set(jt.TEXTURE0),ua.bind(l.stepInterpolant?jt.NEAREST:jt.LINEAR,jt.CLAMP_TO_EDGE)}Xr.draw(Kt,jt.TRIANGLES,z,a.stencilModeForClipping(Lr),ue,Bt.disabled,Za,l.id,Sr.layoutVertexBuffer,Sr.indexBuffer,Sr.segments,l.paint,a.transform.zoom,Ar,Sr.layoutVertexBuffer2),Gt=!1}}}}},fill:function(a,n,l,g){var w=l.paint.get("fill-color"),L=l.paint.get("fill-opacity");if(L.constantOr(1)!==0){var z=a.colorModeForRenderPass(),ue=l.paint.get("fill-pattern"),Ee=a.opaquePassEnabledForLayer()&&!ue.constantOr(1)&&w.constantOr(i.Color.transparent).a===1&&L.constantOr(0)===1?"opaque":"translucent";if(a.renderPass===Ee){var Ke=a.depthModeForSublayer(1,a.renderPass==="opaque"?xe.ReadWrite:xe.ReadOnly);tl(a,n,l,g,Ke,z,!1)}if(a.renderPass==="translucent"&&l.paint.get("fill-antialias")){var tt=a.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,xe.ReadOnly);tl(a,n,l,g,tt,z,!0)}}},"fill-extrusion":function(a,n,l,g){var w=l.paint.get("fill-extrusion-opacity");if(w!==0&&a.renderPass==="translucent"){var L=new xe(a.context.gl.LEQUAL,xe.ReadWrite,a.depthRangeFor3D);if(w!==1||l.paint.get("fill-extrusion-pattern").constantOr(1))Dl(a,n,l,g,L,st.disabled,Ct.disabled),Dl(a,n,l,g,L,a.stencilModeFor3D(),a.colorModeForRenderPass());else{var z=a.colorModeForRenderPass();Dl(a,n,l,g,L,st.disabled,z)}}},hillshade:function(a,n,l,g){if(a.renderPass==="offscreen"||a.renderPass==="translucent"){for(var w=a.context,L=a.depthModeForSublayer(0,xe.ReadOnly),z=a.colorModeForRenderPass(),ue=a.renderPass==="translucent"?a.stencilConfigForOverlap(g):[{},g],Ee=ue[0],Ke=0,tt=ue[1];Ke<tt.length;Ke+=1){var rt=tt[Ke],Ft=n.getTile(rt);Ft.needsHillshadePrepare&&a.renderPass==="offscreen"?xc(a,Ft,l,L,st.disabled,z):a.renderPass==="translucent"&&bc(a,Ft,l,L,Ee[rt.overscaledZ],z)}w.viewport.set([0,0,a.width,a.height])}},raster:function(a,n,l,g){if(a.renderPass==="translucent"&&l.paint.get("raster-opacity")!==0&&g.length)for(var w=a.context,L=w.gl,z=n.getSource(),ue=a.useProgram("raster"),Ee=a.colorModeForRenderPass(),Ke=z instanceof be?[{},g]:a.stencilConfigForOverlap(g),tt=Ke[0],rt=Ke[1],Ft=rt[rt.length-1].overscaledZ,Nt=!a.options.moving,Kt=0,jt=rt;Kt<jt.length;Kt+=1){var Gt=jt[Kt],nr=a.depthModeForSublayer(Gt.overscaledZ-Ft,l.paint.get("raster-opacity")===1?xe.ReadWrite:xe.ReadOnly,L.LESS),rr=n.getTile(Gt),Lr=a.transform.calculatePosMatrix(Gt.toUnwrapped(),Nt);rr.registerFadeDuration(l.paint.get("raster-fade-duration"));var vr=n.findLoadedParent(Gt,0),Sr=rl(rr,vr,n,l,a.transform),Ar=void 0,rn=void 0,Xr=l.paint.get("raster-resampling")==="nearest"?L.NEAREST:L.LINEAR;w.activeTexture.set(L.TEXTURE0),rr.texture.bind(Xr,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),w.activeTexture.set(L.TEXTURE1),vr?(vr.texture.bind(Xr,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),Ar=Math.pow(2,vr.tileID.overscaledZ-rr.tileID.overscaledZ),rn=[rr.tileID.canonical.x*Ar%1,rr.tileID.canonical.y*Ar%1]):rr.texture.bind(Xr,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST);var mn=Ql(Lr,rn||[0,0],Ar||1,Sr,l);z instanceof be?ue.draw(w,L.TRIANGLES,nr,st.disabled,Ee,Bt.disabled,mn,l.id,z.boundsBuffer,a.quadTriangleIndexBuffer,z.boundsSegments):ue.draw(w,L.TRIANGLES,nr,tt[Gt.overscaledZ],Ee,Bt.disabled,mn,l.id,a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments)}},background:function(a,n,l){var g=l.paint.get("background-color"),w=l.paint.get("background-opacity");if(w!==0){var L=a.context,z=L.gl,ue=a.transform,Ee=ue.tileSize,Ke=l.paint.get("background-pattern");if(!a.isPatternMissing(Ke)){var tt=!Ke&&g.a===1&&w===1&&a.opaquePassEnabledForLayer()?"opaque":"translucent";if(a.renderPass===tt){var rt=st.disabled,Ft=a.depthModeForSublayer(0,tt==="opaque"?xe.ReadWrite:xe.ReadOnly),Nt=a.colorModeForRenderPass(),Kt=a.useProgram(Ke?"backgroundPattern":"background"),jt=ue.coveringTiles({tileSize:Ee});Ke&&(L.activeTexture.set(z.TEXTURE0),a.imageManager.bind(a.context));for(var Gt=l.getCrossfadeParameters(),nr=0,rr=jt;nr<rr.length;nr+=1){var Lr=rr[nr],vr=a.transform.calculatePosMatrix(Lr.toUnwrapped()),Sr=Ke?Il(vr,w,a,Ke,{tileID:Lr,tileSize:Ee},Gt):Rl(vr,w,g);Kt.draw(L,z.TRIANGLES,Ft,rt,Nt,Bt.disabled,Sr,l.id,a.tileExtentBuffer,a.quadTriangleIndexBuffer,a.tileExtentSegments)}}}}},debug:function(a,n,l){for(var g=0;g<l.length;g++)yf(a,n,l[g])},custom:function(a,n,l){var g=a.context,w=l.implementation;if(a.renderPass==="offscreen"){var L=w.prerender;L&&(a.setCustomLayerDefaults(),g.setColorMode(a.colorModeForRenderPass()),L.call(w,g.gl,a.transform.customLayerMatrix()),g.setDirty(),a.setBaseState())}else if(a.renderPass==="translucent"){a.setCustomLayerDefaults(),g.setColorMode(a.colorModeForRenderPass()),g.setStencilMode(st.disabled);var z=w.renderingMode==="3d"?new xe(a.context.gl.LEQUAL,xe.ReadWrite,a.depthRangeFor3D):a.depthModeForSublayer(0,xe.ReadOnly);g.setDepthMode(z),w.render(g.gl,a.transform.customLayerMatrix()),g.setDirty(),a.setBaseState(),g.bindFramebuffer.set(null)}}},wi=function(a,n){this.context=new Xe(a),this.transform=n,this._tileTextures={},this.setup(),this.numSublayers=Lt.maxUnderzooming+Lt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Eo,this.gpuTimers={}};wi.prototype.resize=function(s,a){if(this.width=s*i.browser.devicePixelRatio,this.height=a*i.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var n=0,l=this.style._order;n<l.length;n+=1)this.style._layers[l[n]].resize()},wi.prototype.setup=function(){var s=this.context,a=new i.StructArrayLayout2i4;a.emplaceBack(0,0),a.emplaceBack(i.EXTENT,0),a.emplaceBack(0,i.EXTENT),a.emplaceBack(i.EXTENT,i.EXTENT),this.tileExtentBuffer=s.createVertexBuffer(a,Vi.members),this.tileExtentSegments=i.SegmentVector.simpleSegment(0,0,4,2);var n=new i.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(i.EXTENT,0),n.emplaceBack(0,i.EXTENT),n.emplaceBack(i.EXTENT,i.EXTENT),this.debugBuffer=s.createVertexBuffer(n,Vi.members),this.debugSegments=i.SegmentVector.simpleSegment(0,0,4,5);var l=new i.StructArrayLayout4i8;l.emplaceBack(0,0,0,0),l.emplaceBack(i.EXTENT,0,i.EXTENT,0),l.emplaceBack(0,i.EXTENT,0,i.EXTENT),l.emplaceBack(i.EXTENT,i.EXTENT,i.EXTENT,i.EXTENT),this.rasterBoundsBuffer=s.createVertexBuffer(l,Se.members),this.rasterBoundsSegments=i.SegmentVector.simpleSegment(0,0,4,2);var g=new i.StructArrayLayout2i4;g.emplaceBack(0,0),g.emplaceBack(1,0),g.emplaceBack(0,1),g.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(g,Vi.members),this.viewportSegments=i.SegmentVector.simpleSegment(0,0,4,2);var w=new i.StructArrayLayout1ui2;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=s.createIndexBuffer(w);var L=new i.StructArrayLayout3ui6;L.emplaceBack(0,1,2),L.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(L),this.emptyTexture=new i.Texture(s,{width:1,height:1,data:new Uint8Array([0,0,0,0])},s.gl.RGBA);var z=this.context.gl;this.stencilClearMode=new st({func:z.ALWAYS,mask:0},0,255,z.ZERO,z.ZERO,z.ZERO)},wi.prototype.clearStencil=function(){var s=this.context,a=s.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var n=i.create();i.ortho(n,0,this.width,this.height,0,0,1),i.scale(n,n,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(s,a.TRIANGLES,xe.disabled,this.stencilClearMode,Ct.disabled,Bt.disabled,Au(n),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},wi.prototype._renderTileClippingMasks=function(s,a){if(this.currentStencilSource!==s.source&&s.isTileClipped()&&a&&a.length){this.currentStencilSource=s.source;var n=this.context,l=n.gl;this.nextStencilID+a.length>256&&this.clearStencil(),n.setColorMode(Ct.disabled),n.setDepthMode(xe.disabled);var g=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var w=0,L=a;w<L.length;w+=1){var z=L[w],ue=this._tileClippingMaskIDs[z.key]=this.nextStencilID++;g.draw(n,l.TRIANGLES,xe.disabled,new st({func:l.ALWAYS,mask:0},ue,255,l.KEEP,l.KEEP,l.REPLACE),Ct.disabled,Bt.disabled,Au(z.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},wi.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var s=this.nextStencilID++,a=this.context.gl;return new st({func:a.NOTEQUAL,mask:255},s,255,a.KEEP,a.KEEP,a.REPLACE)},wi.prototype.stencilModeForClipping=function(s){var a=this.context.gl;return new st({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,a.KEEP,a.KEEP,a.REPLACE)},wi.prototype.stencilConfigForOverlap=function(s){var a,n=this.context.gl,l=s.sort(function(ue,Ee){return Ee.overscaledZ-ue.overscaledZ}),g=l[l.length-1].overscaledZ,w=l[0].overscaledZ-g+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();for(var L={},z=0;z<w;z++)L[z+g]=new st({func:n.GEQUAL,mask:255},z+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=w,[L,l]}return[(a={},a[g]=st.disabled,a),l]},wi.prototype.colorModeForRenderPass=function(){var s=this.context.gl;return this._showOverdrawInspector?new Ct([s.CONSTANT_COLOR,s.ONE],new i.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ct.unblended:Ct.alphaBlended},wi.prototype.depthModeForSublayer=function(s,a,n){if(!this.opaquePassEnabledForLayer())return xe.disabled;var l=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new xe(n||this.context.gl.LEQUAL,a,[l,l])},wi.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},wi.prototype.render=function(s,a){var n=this;this.style=s,this.options=a,this.lineAtlas=s.lineAtlas,this.imageManager=s.imageManager,this.glyphManager=s.glyphManager,this.symbolFadeChange=s.placement.symbolFadeChange(i.browser.now()),this.imageManager.beginFrame();var l=this.style._order,g=this.style.sourceCaches;for(var w in g){var L=g[w];L.used&&L.prepare(this.context)}var z,ue,Ee={},Ke={},tt={};for(var rt in g){var Ft=g[rt];Ee[rt]=Ft.getVisibleCoordinates(),Ke[rt]=Ee[rt].slice().reverse(),tt[rt]=Ft.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Nt=0;Nt<l.length;Nt++)if(this.style._layers[l[Nt]].is3D()){this.opaquePassCutoff=Nt;break}this.renderPass="offscreen";for(var Kt=0,jt=l;Kt<jt.length;Kt+=1){var Gt=this.style._layers[jt[Kt]];if(Gt.hasOffscreenPass()&&!Gt.isHidden(this.transform.zoom)){var nr=Ke[Gt.source];(Gt.type==="custom"||nr.length)&&this.renderLayer(this,g[Gt.source],Gt,nr)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?i.Color.black:i.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(s._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=l.length-1;this.currentLayer>=0;this.currentLayer--){var rr=this.style._layers[l[this.currentLayer]],Lr=g[rr.source],vr=Ee[rr.source];this._renderTileClippingMasks(rr,vr),this.renderLayer(this,Lr,rr,vr)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<l.length;this.currentLayer++){var Sr=this.style._layers[l[this.currentLayer]],Ar=g[Sr.source],rn=(Sr.type==="symbol"?tt:Ke)[Sr.source];this._renderTileClippingMasks(Sr,Ee[Sr.source]),this.renderLayer(this,Ar,Sr,rn)}this.options.showTileBoundaries&&(i.values(this.style._layers).forEach(function(Xr){Xr.source&&!Xr.isHidden(n.transform.zoom)&&(Xr.source!==(ue&&ue.id)&&(ue=n.style.sourceCaches[Xr.source]),(!z||z.getSource().maxzoom<ue.getSource().maxzoom)&&(z=ue))}),z&&al.debug(this,z,z.getVisibleCoordinates())),this.options.showPadding&&function(Xr){var mn=Xr.transform.padding;Fc(Xr,Xr.transform.height-(mn.top||0),3,rf),Fc(Xr,mn.bottom||0,3,nl),nf(Xr,mn.left||0,3,qs),nf(Xr,Xr.transform.width-(mn.right||0),3,_l);var Ln=Xr.transform.centerPoint;!function(qn,sa,Sa,Za){Fs(qn,sa-1,Sa-10,2,20,Za),Fs(qn,sa-10,Sa-1,20,2,Za)}(Xr,Ln.x,Xr.transform.height-Ln.y,tc)}(this),this.context.setDefault()},wi.prototype.renderLayer=function(s,a,n,l){n.isHidden(this.transform.zoom)||(n.type==="background"||n.type==="custom"||l.length)&&(this.id=n.id,this.gpuTimingStart(n),al[n.type](s,a,n,l,this.style.placement.variableOffsets),this.gpuTimingEnd())},wi.prototype.gpuTimingStart=function(s){if(this.options.gpuTiming){var a=this.context.extTimerQuery,n=this.gpuTimers[s.id];n||(n=this.gpuTimers[s.id]={calls:0,cpuTime:0,query:a.createQueryEXT()}),n.calls++,a.beginQueryEXT(a.TIME_ELAPSED_EXT,n.query)}},wi.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var s=this.context.extTimerQuery;s.endQueryEXT(s.TIME_ELAPSED_EXT)}},wi.prototype.collectGpuTimers=function(){var s=this.gpuTimers;return this.gpuTimers={},s},wi.prototype.queryGpuTimers=function(s){var a={};for(var n in s){var l=s[n],g=this.context.extTimerQuery,w=g.getQueryObjectEXT(l.query,g.QUERY_RESULT_EXT)/1e6;g.deleteQueryEXT(l.query),a[n]=w}return a},wi.prototype.translatePosMatrix=function(s,a,n,l,g){if(!n[0]&&!n[1])return s;var w=g?l==="map"?this.transform.angle:0:l==="viewport"?-this.transform.angle:0;if(w){var L=Math.sin(w),z=Math.cos(w);n=[n[0]*z-n[1]*L,n[0]*L+n[1]*z]}var ue=[g?n[0]:Ha(a,n[0],this.transform.zoom),g?n[1]:Ha(a,n[1],this.transform.zoom),0],Ee=new Float32Array(16);return i.translate(Ee,s,ue),Ee},wi.prototype.saveTileTexture=function(s){var a=this._tileTextures[s.size[0]];a?a.push(s):this._tileTextures[s.size[0]]=[s]},wi.prototype.getTileTexture=function(s){var a=this._tileTextures[s];return a&&a.length>0?a.pop():null},wi.prototype.isPatternMissing=function(s){if(!s)return!1;if(!s.from||!s.to)return!0;var a=this.imageManager.getPattern(s.from.toString()),n=this.imageManager.getPattern(s.to.toString());return!a||!n},wi.prototype.useProgram=function(s,a){this.cache=this.cache||{};var n=""+s+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[n]||(this.cache[n]=new yl(this.context,s,Ic[s],a,jc[s],this._showOverdrawInspector)),this.cache[n]},wi.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},wi.prototype.setBaseState=function(){var s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)},wi.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=i.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},wi.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var il=function(a,n){this.points=a,this.planes=n};il.fromInvProjectionMatrix=function(s,a,n){var l=Math.pow(2,n),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(L){return i.transformMat4([],L,s)}).map(function(L){return i.scale$1([],L,1/L[3]/a*l)}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(L){var z=i.sub([],g[L[0]],g[L[1]]),ue=i.sub([],g[L[2]],g[L[1]]),Ee=i.normalize([],i.cross([],z,ue)),Ke=-i.dot(Ee,g[L[1]]);return Ee.concat(Ke)});return new il(g,w)};var Vu=function(a,n){this.min=a,this.max=n,this.center=i.scale$2([],i.add([],this.min,this.max),.5)};Vu.prototype.quadrant=function(s){for(var a=[s%2==0,s<2],n=i.clone$2(this.min),l=i.clone$2(this.max),g=0;g<a.length;g++)n[g]=a[g]?this.min[g]:this.center[g],l[g]=a[g]?this.center[g]:this.max[g];return l[2]=this.max[2],new Vu(n,l)},Vu.prototype.distanceX=function(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]},Vu.prototype.distanceY=function(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]},Vu.prototype.intersects=function(s){for(var a=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],n=!0,l=0;l<s.planes.length;l++){for(var g=s.planes[l],w=0,L=0;L<a.length;L++)w+=i.dot$1(g,a[L])>=0;if(w===0)return 0;w!==a.length&&(n=!1)}if(n)return 2;for(var z=0;z<3;z++){for(var ue=Number.MAX_VALUE,Ee=-Number.MAX_VALUE,Ke=0;Ke<s.points.length;Ke++){var tt=s.points[Ke][z]-this.min[z];ue=Math.min(ue,tt),Ee=Math.max(Ee,tt)}if(Ee<0||ue>this.max[z]-this.min[z])return 0}return 1};var ui=function(a,n,l,g){if(a===void 0&&(a=0),n===void 0&&(n=0),l===void 0&&(l=0),g===void 0&&(g=0),isNaN(a)||a<0||isNaN(n)||n<0||isNaN(l)||l<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=n,this.left=l,this.right=g};ui.prototype.interpolate=function(s,a,n){return a.top!=null&&s.top!=null&&(this.top=i.number(s.top,a.top,n)),a.bottom!=null&&s.bottom!=null&&(this.bottom=i.number(s.bottom,a.bottom,n)),a.left!=null&&s.left!=null&&(this.left=i.number(s.left,a.left,n)),a.right!=null&&s.right!=null&&(this.right=i.number(s.right,a.right,n)),this},ui.prototype.getCenter=function(s,a){var n=i.clamp((this.left+s-this.right)/2,0,s),l=i.clamp((this.top+a-this.bottom)/2,0,a);return new i.Point(n,l)},ui.prototype.equals=function(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right},ui.prototype.clone=function(){return new ui(this.top,this.bottom,this.left,this.right)},ui.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var kn=function(a,n,l,g,w){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=w===void 0||w,this._minZoom=a||0,this._maxZoom=n||22,this._minPitch=l==null?0:l,this._maxPitch=g==null?60:g,this.setMaxBounds(),this.width=0,this.height=0,this._center=new i.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ui,this._posMatrixCache={},this._alignedPosMatrixCache={}},Oi={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};kn.prototype.clone=function(){var s=new kn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return s.tileSize=this.tileSize,s.latRange=this.latRange,s.width=this.width,s.height=this.height,s._center=this._center,s.zoom=this.zoom,s.angle=this.angle,s._fov=this._fov,s._pitch=this._pitch,s._unmodified=this._unmodified,s._edgeInsets=this._edgeInsets.clone(),s._calcMatrices(),s},Oi.minZoom.get=function(){return this._minZoom},Oi.minZoom.set=function(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))},Oi.maxZoom.get=function(){return this._maxZoom},Oi.maxZoom.set=function(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))},Oi.minPitch.get=function(){return this._minPitch},Oi.minPitch.set=function(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))},Oi.maxPitch.get=function(){return this._maxPitch},Oi.maxPitch.set=function(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))},Oi.renderWorldCopies.get=function(){return this._renderWorldCopies},Oi.renderWorldCopies.set=function(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s},Oi.worldSize.get=function(){return this.tileSize*this.scale},Oi.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Oi.size.get=function(){return new i.Point(this.width,this.height)},Oi.bearing.get=function(){return-this.angle/Math.PI*180},Oi.bearing.set=function(s){var a=-i.wrap(s,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=i.create$2(),i.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Oi.pitch.get=function(){return this._pitch/Math.PI*180},Oi.pitch.set=function(s){var a=i.clamp(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())},Oi.fov.get=function(){return this._fov/Math.PI*180},Oi.fov.set=function(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=s/180*Math.PI,this._calcMatrices())},Oi.zoom.get=function(){return this._zoom},Oi.zoom.set=function(s){var a=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom,this._constrain(),this._calcMatrices())},Oi.center.get=function(){return this._center},Oi.center.set=function(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._constrain(),this._calcMatrices())},Oi.padding.get=function(){return this._edgeInsets.toJSON()},Oi.padding.set=function(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())},Oi.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},kn.prototype.isPaddingEqual=function(s){return this._edgeInsets.equals(s)},kn.prototype.interpolatePadding=function(s,a,n){this._unmodified=!1,this._edgeInsets.interpolate(s,a,n),this._constrain(),this._calcMatrices()},kn.prototype.coveringZoomLevel=function(s){var a=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,a)},kn.prototype.getVisibleUnwrappedCoordinates=function(s){var a=[new i.UnwrappedTileID(0,s)];if(this._renderWorldCopies)for(var n=this.pointCoordinate(new i.Point(0,0)),l=this.pointCoordinate(new i.Point(this.width,0)),g=this.pointCoordinate(new i.Point(this.width,this.height)),w=this.pointCoordinate(new i.Point(0,this.height)),L=Math.floor(Math.min(n.x,l.x,g.x,w.x)),z=Math.floor(Math.max(n.x,l.x,g.x,w.x)),ue=L-1;ue<=z+1;ue++)ue!==0&&a.push(new i.UnwrappedTileID(ue,s));return a},kn.prototype.coveringTiles=function(s){var a=this.coveringZoomLevel(s),n=a;if(s.minzoom!==void 0&&a<s.minzoom)return[];s.maxzoom!==void 0&&a>s.maxzoom&&(a=s.maxzoom);var l=i.MercatorCoordinate.fromLngLat(this.center),g=Math.pow(2,a),w=[g*l.x,g*l.y,0],L=il.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,a),z=s.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(z=a);var ue=function(mn){return{aabb:new Vu([mn*g,0,0],[(mn+1)*g,g,0]),zoom:0,x:0,y:0,wrap:mn,fullyVisible:!1}},Ee=[],Ke=[],tt=a,rt=s.reparseOverscaled?n:a;if(this._renderWorldCopies)for(var Ft=1;Ft<=3;Ft++)Ee.push(ue(-Ft)),Ee.push(ue(Ft));for(Ee.push(ue(0));Ee.length>0;){var Nt=Ee.pop(),Kt=Nt.x,jt=Nt.y,Gt=Nt.fullyVisible;if(!Gt){var nr=Nt.aabb.intersects(L);if(nr===0)continue;Gt=nr===2}var rr=Nt.aabb.distanceX(w),Lr=Nt.aabb.distanceY(w),vr=Math.max(Math.abs(rr),Math.abs(Lr));if(Nt.zoom===tt||vr>3+(1<<tt-Nt.zoom)-2&&Nt.zoom>=z)Ke.push({tileID:new i.OverscaledTileID(Nt.zoom===tt?rt:Nt.zoom,Nt.wrap,Nt.zoom,Kt,jt),distanceSq:i.sqrLen([w[0]-.5-Kt,w[1]-.5-jt])});else for(var Sr=0;Sr<4;Sr++){var Ar=(Kt<<1)+Sr%2,rn=(jt<<1)+(Sr>>1);Ee.push({aabb:Nt.aabb.quadrant(Sr),zoom:Nt.zoom+1,x:Ar,y:rn,wrap:Nt.wrap,fullyVisible:Gt})}}return Ke.sort(function(Xr,mn){return Xr.distanceSq-mn.distanceSq}).map(function(Xr){return Xr.tileID})},kn.prototype.resize=function(s,a){this.width=s,this.height=a,this.pixelsToGLUnits=[2/s,-2/a],this._constrain(),this._calcMatrices()},Oi.unmodified.get=function(){return this._unmodified},kn.prototype.zoomScale=function(s){return Math.pow(2,s)},kn.prototype.scaleZoom=function(s){return Math.log(s)/Math.LN2},kn.prototype.project=function(s){var a=i.clamp(s.lat,-this.maxValidLatitude,this.maxValidLatitude);return new i.Point(i.mercatorXfromLng(s.lng)*this.worldSize,i.mercatorYfromLat(a)*this.worldSize)},kn.prototype.unproject=function(s){return new i.MercatorCoordinate(s.x/this.worldSize,s.y/this.worldSize).toLngLat()},Oi.point.get=function(){return this.project(this.center)},kn.prototype.setLocationAtPoint=function(s,a){var n=this.pointCoordinate(a),l=this.pointCoordinate(this.centerPoint),g=this.locationCoordinate(s),w=new i.MercatorCoordinate(g.x-(n.x-l.x),g.y-(n.y-l.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())},kn.prototype.locationPoint=function(s){return this.coordinatePoint(this.locationCoordinate(s))},kn.prototype.pointLocation=function(s){return this.coordinateLocation(this.pointCoordinate(s))},kn.prototype.locationCoordinate=function(s){return i.MercatorCoordinate.fromLngLat(s)},kn.prototype.coordinateLocation=function(s){return s.toLngLat()},kn.prototype.pointCoordinate=function(s){var a=[s.x,s.y,0,1],n=[s.x,s.y,1,1];i.transformMat4(a,a,this.pixelMatrixInverse),i.transformMat4(n,n,this.pixelMatrixInverse);var l=a[3],g=n[3],w=a[1]/l,L=n[1]/g,z=a[2]/l,ue=n[2]/g,Ee=z===ue?0:(0-z)/(ue-z);return new i.MercatorCoordinate(i.number(a[0]/l,n[0]/g,Ee)/this.worldSize,i.number(w,L,Ee)/this.worldSize)},kn.prototype.coordinatePoint=function(s){var a=[s.x*this.worldSize,s.y*this.worldSize,0,1];return i.transformMat4(a,a,this.pixelMatrix),new i.Point(a[0]/a[3],a[1]/a[3])},kn.prototype.getBounds=function(){return new i.LngLatBounds().extend(this.pointLocation(new i.Point(0,0))).extend(this.pointLocation(new i.Point(this.width,0))).extend(this.pointLocation(new i.Point(this.width,this.height))).extend(this.pointLocation(new i.Point(0,this.height)))},kn.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new i.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},kn.prototype.setMaxBounds=function(s){s?(this.lngRange=[s.getWest(),s.getEast()],this.latRange=[s.getSouth(),s.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},kn.prototype.calculatePosMatrix=function(s,a){a===void 0&&(a=!1);var n=s.key,l=a?this._alignedPosMatrixCache:this._posMatrixCache;if(l[n])return l[n];var g=s.canonical,w=this.worldSize/this.zoomScale(g.z),L=g.x+Math.pow(2,g.z)*s.wrap,z=i.identity(new Float64Array(16));return i.translate(z,z,[L*w,g.y*w,0]),i.scale(z,z,[w/i.EXTENT,w/i.EXTENT,1]),i.multiply(z,a?this.alignedProjMatrix:this.projMatrix,z),l[n]=new Float32Array(z),l[n]},kn.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},kn.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var s,a,n,l,g=-90,w=90,L=-180,z=180,ue=this.size,Ee=this._unmodified;if(this.latRange){var Ke=this.latRange;g=i.mercatorYfromLat(Ke[1])*this.worldSize,s=(w=i.mercatorYfromLat(Ke[0])*this.worldSize)-g<ue.y?ue.y/(w-g):0}if(this.lngRange){var tt=this.lngRange;L=i.mercatorXfromLng(tt[0])*this.worldSize,a=(z=i.mercatorXfromLng(tt[1])*this.worldSize)-L<ue.x?ue.x/(z-L):0}var rt=this.point,Ft=Math.max(a||0,s||0);if(Ft)return this.center=this.unproject(new i.Point(a?(z+L)/2:rt.x,s?(w+g)/2:rt.y)),this.zoom+=this.scaleZoom(Ft),this._unmodified=Ee,void(this._constraining=!1);if(this.latRange){var Nt=rt.y,Kt=ue.y/2;Nt-Kt<g&&(l=g+Kt),Nt+Kt>w&&(l=w-Kt)}if(this.lngRange){var jt=rt.x,Gt=ue.x/2;jt-Gt<L&&(n=L+Gt),jt+Gt>z&&(n=z-Gt)}n===void 0&&l===void 0||(this.center=this.unproject(new i.Point(n!==void 0?n:rt.x,l!==void 0?l:rt.y))),this._unmodified=Ee,this._constraining=!1}},kn.prototype._calcMatrices=function(){if(this.height){var s=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var a=Math.PI/2+this._pitch,n=this._fov*(.5+s.y/this.height),l=Math.sin(n)*this.cameraToCenterDistance/Math.sin(i.clamp(Math.PI-a-n,.01,Math.PI-.01)),g=this.point,w=g.x,L=g.y,z=1.01*(Math.cos(Math.PI/2-this._pitch)*l+this.cameraToCenterDistance),ue=this.height/50,Ee=new Float64Array(16);i.perspective(Ee,this._fov,this.width/this.height,ue,z),Ee[8]=2*-s.x/this.width,Ee[9]=2*s.y/this.height,i.scale(Ee,Ee,[1,-1,1]),i.translate(Ee,Ee,[0,0,-this.cameraToCenterDistance]),i.rotateX(Ee,Ee,this._pitch),i.rotateZ(Ee,Ee,this.angle),i.translate(Ee,Ee,[-w,-L,0]),this.mercatorMatrix=i.scale([],Ee,[this.worldSize,this.worldSize,this.worldSize]),i.scale(Ee,Ee,[1,1,i.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=Ee,this.invProjMatrix=i.invert([],this.projMatrix);var Ke=this.width%2/2,tt=this.height%2/2,rt=Math.cos(this.angle),Ft=Math.sin(this.angle),Nt=w-Math.round(w)+rt*Ke+Ft*tt,Kt=L-Math.round(L)+rt*tt+Ft*Ke,jt=new Float64Array(Ee);if(i.translate(jt,jt,[Nt>.5?Nt-1:Nt,Kt>.5?Kt-1:Kt,0]),this.alignedProjMatrix=jt,Ee=i.create(),i.scale(Ee,Ee,[this.width/2,-this.height/2,1]),i.translate(Ee,Ee,[1,-1,0]),this.labelPlaneMatrix=Ee,Ee=i.create(),i.scale(Ee,Ee,[1,-1,1]),i.translate(Ee,Ee,[-1,-1,0]),i.scale(Ee,Ee,[2/this.width,2/this.height,1]),this.glCoordMatrix=Ee,this.pixelMatrix=i.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(Ee=i.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=Ee,this._posMatrixCache={},this._alignedPosMatrixCache={}}},kn.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var s=this.pointCoordinate(new i.Point(0,0)),a=[s.x*this.worldSize,s.y*this.worldSize,0,1];return i.transformMat4(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance},kn.prototype.getCameraPoint=function(){var s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.Point(0,s))},kn.prototype.getCameraQueryGeometry=function(s){var a=this.getCameraPoint();if(s.length===1)return[s[0],a];for(var n=a.x,l=a.y,g=a.x,w=a.y,L=0,z=s;L<z.length;L+=1){var ue=z[L];n=Math.min(n,ue.x),l=Math.min(l,ue.y),g=Math.max(g,ue.x),w=Math.max(w,ue.y)}return[new i.Point(n,l),new i.Point(g,l),new i.Point(g,w),new i.Point(n,w),new i.Point(n,l)]},Object.defineProperties(kn.prototype,Oi);var ws=function(a){var n,l,g,w;this._hashName=a&&encodeURIComponent(a),i.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(n=this._updateHashUnthrottled.bind(this),l=!1,g=null,w=function(){g=null,l&&(n(),g=setTimeout(w,300),l=!1)},function(){return l=!0,g||w(),g})};ws.prototype.addTo=function(s){return this._map=s,i.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},ws.prototype.remove=function(){return i.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},ws.prototype.getHashString=function(s){var a=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,l=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),g=Math.pow(10,l),w=Math.round(a.lng*g)/g,L=Math.round(a.lat*g)/g,z=this._map.getBearing(),ue=this._map.getPitch(),Ee="";if(Ee+=s?"/"+w+"/"+L+"/"+n:n+"/"+L+"/"+w,(z||ue)&&(Ee+="/"+Math.round(10*z)/10),ue&&(Ee+="/"+Math.round(ue)),this._hashName){var Ke=this._hashName,tt=!1,rt=i.window.location.hash.slice(1).split("&").map(function(Ft){var Nt=Ft.split("=")[0];return Nt===Ke?(tt=!0,Nt+"="+Ee):Ft}).filter(function(Ft){return Ft});return tt||rt.push(Ke+"="+Ee),"#"+rt.join("&")}return"#"+Ee},ws.prototype._getCurrentHash=function(){var s,a=this,n=i.window.location.hash.replace("#","");return this._hashName?(n.split("&").map(function(l){return l.split("=")}).forEach(function(l){l[0]===a._hashName&&(s=l)}),(s&&s[1]||"").split("/")):n.split("/")},ws.prototype._onHashChange=function(){var s=this._getCurrentHash();if(s.length>=3&&!s.some(function(n){return isNaN(n)})){var a=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(s[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:a,pitch:+(s[4]||0)}),!0}return!1},ws.prototype._updateHashUnthrottled=function(){var s=i.window.location.href.replace(/(#.+)?$/,this.getHashString());try{i.window.history.replaceState(i.window.history.state,null,s)}catch(a){}};var Nl={linearity:.3,easing:i.bezier(0,0,.3,1)},Gu=i.extend({deceleration:2500,maxSpeed:1400},Nl),ol=i.extend({deceleration:20,maxSpeed:1400},Nl),bf=i.extend({deceleration:1e3,maxSpeed:360},Nl),is=i.extend({deceleration:1e3,maxSpeed:90},Nl),Sl=function(a){this._map=a,this.clear()};function sl(s,a){(!s.duration||s.duration<a.duration)&&(s.duration=a.duration,s.easing=a.easing)}function ul(s,a,n){var l=n.maxSpeed,g=n.linearity,w=n.deceleration,L=i.clamp(s*g/(a/1e3),-l,l),z=Math.abs(L)/(w*g);return{easing:n.easing,duration:1e3*z,amount:L*(z/2)}}Sl.prototype.clear=function(){this._inertiaBuffer=[]},Sl.prototype.record=function(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.browser.now(),settings:s})},Sl.prototype._drainInertiaBuffer=function(){for(var s=this._inertiaBuffer,a=i.browser.now();s.length>0&&a-s[0].time>160;)s.shift()},Sl.prototype._onMoveEnd=function(s){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var a={zoom:0,bearing:0,pitch:0,pan:new i.Point(0,0),pinchAround:void 0,around:void 0},n=0,l=this._inertiaBuffer;n<l.length;n+=1){var g=l[n].settings;a.zoom+=g.zoomDelta||0,a.bearing+=g.bearingDelta||0,a.pitch+=g.pitchDelta||0,g.panDelta&&a.pan._add(g.panDelta),g.around&&(a.around=g.around),g.pinchAround&&(a.pinchAround=g.pinchAround)}var w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,L={};if(a.pan.mag()){var z=ul(a.pan.mag(),w,i.extend({},Gu,s||{}));L.offset=a.pan.mult(z.amount/a.pan.mag()),L.center=this._map.transform.center,sl(L,z)}if(a.zoom){var ue=ul(a.zoom,w,ol);L.zoom=this._map.transform.zoom+ue.amount,sl(L,ue)}if(a.bearing){var Ee=ul(a.bearing,w,bf);L.bearing=this._map.transform.bearing+i.clamp(Ee.amount,-179,179),sl(L,Ee)}if(a.pitch){var Ke=ul(a.pitch,w,is);L.pitch=this._map.transform.pitch+Ke.amount,sl(L,Ke)}if(L.zoom||L.bearing){var tt=a.pinchAround===void 0?a.around:a.pinchAround;L.around=tt?this._map.unproject(tt):this._map.getCenter()}return this.clear(),i.extend(L,{noMoveStart:!0})}};var zi=function(s){function a(l,g,w,L){L===void 0&&(L={});var z=D.mousePos(g.getCanvasContainer(),w),ue=g.unproject(z);s.call(this,l,i.extend({point:z,lngLat:ue,originalEvent:w},L)),this._defaultPrevented=!1,this.target=g}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,n),a}(i.Event),Ts=function(s){function a(l,g,w){var L=l==="touchend"?w.changedTouches:w.touches,z=D.touchPos(g.getCanvasContainer(),L),ue=z.map(function(tt){return g.unproject(tt)}),Ee=z.reduce(function(tt,rt,Ft,Nt){return tt.add(rt.div(Nt.length))},new i.Point(0,0)),Ke=g.unproject(Ee);s.call(this,l,{points:z,point:Ee,lngLats:ue,lngLat:Ke,originalEvent:w}),this._defaultPrevented=!1}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,n),a}(i.Event),kl=function(s){function a(l,g,w){s.call(this,l,{originalEvent:w}),this._defaultPrevented=!1}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,n),a}(i.Event),to=function(a,n){this._map=a,this._clickTolerance=n.clickTolerance};to.prototype.reset=function(){delete this._mousedownPos},to.prototype.wheel=function(s){return this._firePreventable(new kl(s.type,this._map,s))},to.prototype.mousedown=function(s,a){return this._mousedownPos=a,this._firePreventable(new zi(s.type,this._map,s))},to.prototype.mouseup=function(s){this._map.fire(new zi(s.type,this._map,s))},to.prototype.click=function(s,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new zi(s.type,this._map,s))},to.prototype.dblclick=function(s){return this._firePreventable(new zi(s.type,this._map,s))},to.prototype.mouseover=function(s){this._map.fire(new zi(s.type,this._map,s))},to.prototype.mouseout=function(s){this._map.fire(new zi(s.type,this._map,s))},to.prototype.touchstart=function(s){return this._firePreventable(new Ts(s.type,this._map,s))},to.prototype.touchmove=function(s){this._map.fire(new Ts(s.type,this._map,s))},to.prototype.touchend=function(s){this._map.fire(new Ts(s.type,this._map,s))},to.prototype.touchcancel=function(s){this._map.fire(new Ts(s.type,this._map,s))},to.prototype._firePreventable=function(s){if(this._map.fire(s),s.defaultPrevented)return{}},to.prototype.isEnabled=function(){return!0},to.prototype.isActive=function(){return!1},to.prototype.enable=function(){},to.prototype.disable=function(){};var In=function(a){this._map=a};In.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},In.prototype.mousemove=function(s){this._map.fire(new zi(s.type,this._map,s))},In.prototype.mousedown=function(){this._delayContextMenu=!0},In.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new zi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},In.prototype.contextmenu=function(s){this._delayContextMenu?this._contextMenuEvent=s:this._map.fire(new zi(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()},In.prototype.isEnabled=function(){return!0},In.prototype.isActive=function(){return!1},In.prototype.enable=function(){},In.prototype.disable=function(){};var zs=function(a,n){this._map=a,this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=n.clickTolerance||1};function ti(s,a){for(var n={},l=0;l<s.length;l++)n[s[l].identifier]=a[l];return n}zs.prototype.isEnabled=function(){return!!this._enabled},zs.prototype.isActive=function(){return!!this._active},zs.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},zs.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},zs.prototype.mousedown=function(s,a){this.isEnabled()&&s.shiftKey&&s.button===0&&(D.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)},zs.prototype.mousemoveWindow=function(s,a){if(this._active){var n=a;if(!(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)){var l=this._startPos;this._lastPos=n,this._box||(this._box=D.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",s));var g=Math.min(l.x,n.x),w=Math.max(l.x,n.x),L=Math.min(l.y,n.y),z=Math.max(l.y,n.y);D.setTransform(this._box,"translate("+g+"px,"+L+"px)"),this._box.style.width=w-g+"px",this._box.style.height=z-L+"px"}}},zs.prototype.mouseupWindow=function(s,a){var n=this;if(this._active&&s.button===0){var l=this._startPos,g=a;if(this.reset(),D.suppressClick(),l.x!==g.x||l.y!==g.y)return this._map.fire(new i.Event("boxzoomend",{originalEvent:s})),{cameraAnimation:function(L){return L.fitScreenCoordinates(l,g,n._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",s)}},zs.prototype.keydown=function(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))},zs.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(D.remove(this._box),this._box=null),D.enableDrag(),delete this._startPos,delete this._lastPos},zs.prototype._fireEvent=function(s,a){return this._map.fire(new i.Event(s,{originalEvent:a}))};var jl=function(a){this.reset(),this.numTouches=a.numTouches};jl.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},jl.prototype.touchstart=function(s,a,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=s.timeStamp),n.length===this.numTouches&&(this.centroid=function(l){for(var g=new i.Point(0,0),w=0,L=l;w<L.length;w+=1)g._add(L[w]);return g.div(l.length)}(a),this.touches=ti(n,a)))},jl.prototype.touchmove=function(s,a,n){if(!this.aborted&&this.centroid){var l=ti(n,a);for(var g in this.touches){var w=l[g];(!w||w.dist(this.touches[g])>30)&&(this.aborted=!0)}}},jl.prototype.touchend=function(s,a,n){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),n.length===0){var l=!this.aborted&&this.centroid;if(this.reset(),l)return l}};var du=function(a){this.singleTap=new jl(a),this.numTaps=a.numTaps,this.reset()};du.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},du.prototype.touchstart=function(s,a,n){this.singleTap.touchstart(s,a,n)},du.prototype.touchmove=function(s,a,n){this.singleTap.touchmove(s,a,n)},du.prototype.touchend=function(s,a,n){var l=this.singleTap.touchend(s,a,n);if(l){var g=s.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(l)<30;if(g&&w||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=l,this.count===this.numTaps)return this.reset(),l}};var Us=function(){this._zoomIn=new du({numTouches:1,numTaps:2}),this._zoomOut=new du({numTouches:2,numTaps:1}),this.reset()};Us.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Us.prototype.touchstart=function(s,a,n){this._zoomIn.touchstart(s,a,n),this._zoomOut.touchstart(s,a,n)},Us.prototype.touchmove=function(s,a,n){this._zoomIn.touchmove(s,a,n),this._zoomOut.touchmove(s,a,n)},Us.prototype.touchend=function(s,a,n){var l=this,g=this._zoomIn.touchend(s,a,n),w=this._zoomOut.touchend(s,a,n);return g?(this._active=!0,s.preventDefault(),setTimeout(function(){return l.reset()},0),{cameraAnimation:function(z){return z.easeTo({duration:300,zoom:z.getZoom()+1,around:z.unproject(g)},{originalEvent:s})}}):w?(this._active=!0,s.preventDefault(),setTimeout(function(){return l.reset()},0),{cameraAnimation:function(z){return z.easeTo({duration:300,zoom:z.getZoom()-1,around:z.unproject(w)},{originalEvent:s})}}):void 0},Us.prototype.touchcancel=function(){this.reset()},Us.prototype.enable=function(){this._enabled=!0},Us.prototype.disable=function(){this._enabled=!1,this.reset()},Us.prototype.isEnabled=function(){return this._enabled},Us.prototype.isActive=function(){return this._active};var ll={0:1,2:2},qr=function(a){this.reset(),this._clickTolerance=a.clickTolerance||1};qr.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},qr.prototype._correctButton=function(s,a){return!1},qr.prototype._move=function(s,a){return{}},qr.prototype.mousedown=function(s,a){if(!this._lastPoint){var n=D.mouseButton(s);this._correctButton(s,n)&&(this._lastPoint=a,this._eventButton=n)}},qr.prototype.mousemoveWindow=function(s,a){var n=this._lastPoint;if(n){if(s.preventDefault(),function(l,g){var w=ll[g];return l.buttons===void 0||(l.buttons&w)!==w}(s,this._eventButton))this.reset();else if(this._moved||!(a.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=a,this._move(n,a)}},qr.prototype.mouseupWindow=function(s){this._lastPoint&&D.mouseButton(s)===this._eventButton&&(this._moved&&D.suppressClick(),this.reset())},qr.prototype.enable=function(){this._enabled=!0},qr.prototype.disable=function(){this._enabled=!1,this.reset()},qr.prototype.isEnabled=function(){return this._enabled},qr.prototype.isActive=function(){return this._active};var Ec=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.mousedown=function(n,l){s.prototype.mousedown.call(this,n,l),this._lastPoint&&(this._active=!0)},a.prototype._correctButton=function(n,l){return l===0&&!n.ctrlKey},a.prototype._move=function(n,l){return{around:l,panDelta:l.sub(n)}},a}(qr),os=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype._correctButton=function(n,l){return l===0&&n.ctrlKey||l===2},a.prototype._move=function(n,l){var g=.8*(l.x-n.x);if(g)return this._active=!0,{bearingDelta:g}},a.prototype.contextmenu=function(n){n.preventDefault()},a}(qr),ro=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype._correctButton=function(n,l){return l===0&&n.ctrlKey||l===2},a.prototype._move=function(n,l){var g=-.5*(l.y-n.y);if(g)return this._active=!0,{pitchDelta:g}},a.prototype.contextmenu=function(n){n.preventDefault()},a}(qr),Jo=function(a){this._minTouches=1,this._clickTolerance=a.clickTolerance||1,this.reset()};Jo.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new i.Point(0,0)},Jo.prototype.touchstart=function(s,a,n){return this._calculateTransform(s,a,n)},Jo.prototype.touchmove=function(s,a,n){if(this._active&&!(n.length<this._minTouches))return s.preventDefault(),this._calculateTransform(s,a,n)},Jo.prototype.touchend=function(s,a,n){this._calculateTransform(s,a,n),this._active&&n.length<this._minTouches&&this.reset()},Jo.prototype.touchcancel=function(){this.reset()},Jo.prototype._calculateTransform=function(s,a,n){n.length>0&&(this._active=!0);var l=ti(n,a),g=new i.Point(0,0),w=new i.Point(0,0),L=0;for(var z in l){var ue=l[z],Ee=this._touches[z];Ee&&(g._add(ue),w._add(ue.sub(Ee)),L++,l[z]=ue)}if(this._touches=l,!(L<this._minTouches)&&w.mag()){var Ke=w.div(L);if(this._sum._add(Ke),!(this._sum.mag()<this._clickTolerance))return{around:g.div(L),panDelta:Ke}}},Jo.prototype.enable=function(){this._enabled=!0},Jo.prototype.disable=function(){this._enabled=!1,this.reset()},Jo.prototype.isEnabled=function(){return this._enabled},Jo.prototype.isActive=function(){return this._active};var Os=function(){this.reset()};function Fl(s,a,n){for(var l=0;l<s.length;l++)if(s[l].identifier===n)return a[l]}function zc(s,a){return Math.log(s/a)/Math.LN2}Os.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Os.prototype._start=function(s){},Os.prototype._move=function(s,a,n){return{}},Os.prototype.touchstart=function(s,a,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([a[0],a[1]]))},Os.prototype.touchmove=function(s,a,n){if(this._firstTwoTouches){s.preventDefault();var l=this._firstTwoTouches,g=l[1],w=Fl(n,a,l[0]),L=Fl(n,a,g);if(w&&L){var z=this._aroundCenter?null:w.add(L).div(2);return this._move([w,L],z,s)}}},Os.prototype.touchend=function(s,a,n){if(this._firstTwoTouches){var l=this._firstTwoTouches,g=l[1],w=Fl(n,a,l[0]),L=Fl(n,a,g);w&&L||(this._active&&D.suppressClick(),this.reset())}},Os.prototype.touchcancel=function(){this.reset()},Os.prototype.enable=function(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"},Os.prototype.disable=function(){this._enabled=!1,this.reset()},Os.prototype.isEnabled=function(){return this._enabled},Os.prototype.isActive=function(){return this._active};var Bs=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.reset=function(){s.prototype.reset.call(this),delete this._distance,delete this._startDistance},a.prototype._start=function(n){this._startDistance=this._distance=n[0].dist(n[1])},a.prototype._move=function(n,l){var g=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(zc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:zc(this._distance,g),pinchAround:l}},a}(Os);function Cu(s,a){return 180*s.angleWith(a)/Math.PI}var zl=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.reset=function(){s.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},a.prototype._start=function(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])},a.prototype._move=function(n,l){var g=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Cu(this._vector,g),pinchAround:l}},a.prototype._isBelowThreshold=function(n){this._minDiameter=Math.min(this._minDiameter,n.mag());var l=25/(Math.PI*this._minDiameter)*360,g=Cu(n,this._startVector);return Math.abs(g)<l},a}(Os);function Ul(s){return Math.abs(s.y)>Math.abs(s.x)}var af=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.reset=function(){s.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},a.prototype._start=function(n){this._lastPoints=n,Ul(n[0].sub(n[1]))&&(this._valid=!1)},a.prototype._move=function(n,l,g){var w=n[0].sub(this._lastPoints[0]),L=n[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(w,L,g.timeStamp),this._valid)return this._lastPoints=n,this._active=!0,{pitchDelta:(w.y+L.y)/2*-.5}},a.prototype.gestureBeginsVertically=function(n,l,g){if(this._valid!==void 0)return this._valid;var w=n.mag()>=2,L=l.mag()>=2;if(w||L){if(!w||!L)return this._firstMove===void 0&&(this._firstMove=g),g-this._firstMove<100&&void 0;var z=n.y>0==l.y>0;return Ul(n)&&Ul(l)&&z}},a}(Os),Uc={panStep:100,bearingStep:15,pitchStep:10},Lo=function(){var a=Uc;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1};function ss(s){return s*(2-s)}Lo.prototype.reset=function(){this._active=!1},Lo.prototype.keydown=function(s){var a=this;if(!(s.altKey||s.ctrlKey||s.metaKey)){var n=0,l=0,g=0,w=0,L=0;switch(s.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:s.shiftKey?l=-1:(s.preventDefault(),w=-1);break;case 39:s.shiftKey?l=1:(s.preventDefault(),w=1);break;case 38:s.shiftKey?g=1:(s.preventDefault(),L=-1);break;case 40:s.shiftKey?g=-1:(s.preventDefault(),L=1);break;default:return}return this._rotationDisabled&&(l=0,g=0),{cameraAnimation:function(ue){var Ee=ue.getZoom();ue.easeTo({duration:300,easeId:"keyboardHandler",easing:ss,zoom:n?Math.round(Ee)+n*(s.shiftKey?2:1):Ee,bearing:ue.getBearing()+l*a._bearingStep,pitch:ue.getPitch()+g*a._pitchStep,offset:[-w*a._panStep,-L*a._panStep],center:ue.getCenter()},{originalEvent:s})}}}},Lo.prototype.enable=function(){this._enabled=!0},Lo.prototype.disable=function(){this._enabled=!1,this.reset()},Lo.prototype.isEnabled=function(){return this._enabled},Lo.prototype.isActive=function(){return this._active},Lo.prototype.disableRotation=function(){this._rotationDisabled=!0},Lo.prototype.enableRotation=function(){this._rotationDisabled=!1};var Pa=function(a,n){this._map=a,this._el=a.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,i.bindAll(["_onTimeout"],this)};Pa.prototype.setZoomRate=function(s){this._defaultZoomRate=s},Pa.prototype.setWheelZoomRate=function(s){this._wheelZoomRate=s},Pa.prototype.isEnabled=function(){return!!this._enabled},Pa.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Pa.prototype.isZooming=function(){return!!this._zooming},Pa.prototype.enable=function(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=s&&s.around==="center")},Pa.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Pa.prototype.wheel=function(s){if(this.isEnabled()){var a=s.deltaMode===i.window.WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY,n=i.browser.now(),l=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,a!==0&&a%4.000244140625==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":l>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(l*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),s.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=s,this._delta-=a,this._active||this._start(s)),s.preventDefault()}},Pa.prototype._onTimeout=function(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)},Pa.prototype._start=function(s){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var a=D.mousePos(this._el,s);this._around=i.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(a)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Pa.prototype.renderFrame=function(){var s=this;if(this._frameId&&(this._frameId=null,this.isActive())){var a=this._map.transform;if(this._delta!==0){var n=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,l=2/(1+Math.exp(-Math.abs(this._delta*n)));this._delta<0&&l!==0&&(l=1/l);var g=typeof this._targetZoom=="number"?a.zoomScale(this._targetZoom):a.scale;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(g*l))),this._type==="wheel"&&(this._startZoom=a.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var w,L=typeof this._targetZoom=="number"?this._targetZoom:a.zoom,z=this._startZoom,ue=this._easing,Ee=!1;if(this._type==="wheel"&&z&&ue){var Ke=Math.min((i.browser.now()-this._lastWheelEventTime)/200,1),tt=ue(Ke);w=i.number(z,L,tt),Ke<1?this._frameId||(this._frameId=!0):Ee=!0}else w=L,Ee=!0;return this._active=!0,Ee&&(this._active=!1,this._finishTimeout=setTimeout(function(){s._zooming=!1,s._handler._triggerRenderFrame(),delete s._targetZoom,delete s._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Ee,zoomDelta:w-a.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Pa.prototype._smoothOutEasing=function(s){var a=i.ease;if(this._prevEase){var n=this._prevEase,l=(i.browser.now()-n.start)/n.duration,g=n.easing(l+.01)-n.easing(l),w=.27/Math.sqrt(g*g+1e-4)*.01,L=Math.sqrt(.0729-w*w);a=i.bezier(w,L,.25,1)}return this._prevEase={start:i.browser.now(),duration:s,easing:a},a},Pa.prototype.reset=function(){this._active=!1};var eu=function(a,n){this._clickZoom=a,this._tapZoom=n};eu.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},eu.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},eu.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},eu.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Ro=function(){this.reset()};Ro.prototype.reset=function(){this._active=!1},Ro.prototype.dblclick=function(s,a){return s.preventDefault(),{cameraAnimation:function(l){l.easeTo({duration:300,zoom:l.getZoom()+(s.shiftKey?-1:1),around:l.unproject(a)},{originalEvent:s})}}},Ro.prototype.enable=function(){this._enabled=!0},Ro.prototype.disable=function(){this._enabled=!1,this.reset()},Ro.prototype.isEnabled=function(){return this._enabled},Ro.prototype.isActive=function(){return this._active};var To=function(){this._tap=new du({numTouches:1,numTaps:1}),this.reset()};To.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},To.prototype.touchstart=function(s,a,n){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=a[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(s,a,n))},To.prototype.touchmove=function(s,a,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;var l=a[0],g=l.y-this._swipePoint.y;return this._swipePoint=l,s.preventDefault(),this._active=!0,{zoomDelta:g/128}}}else this._tap.touchmove(s,a,n)},To.prototype.touchend=function(s,a,n){this._tapTime?this._swipePoint&&n.length===0&&this.reset():this._tap.touchend(s,a,n)&&(this._tapTime=s.timeStamp)},To.prototype.touchcancel=function(){this.reset()},To.prototype.enable=function(){this._enabled=!0},To.prototype.disable=function(){this._enabled=!1,this.reset()},To.prototype.isEnabled=function(){return this._enabled},To.prototype.isActive=function(){return this._active};var Al=function(a,n,l){this._el=a,this._mousePan=n,this._touchPan=l};Al.prototype.enable=function(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Al.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Al.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Al.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var cl=function(a,n,l){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=n,this._mousePitch=l};cl.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},cl.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},cl.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},cl.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var pu=function(a,n,l,g){this._el=a,this._touchZoom=n,this._touchRotate=l,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0};pu.prototype.enable=function(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},pu.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},pu.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},pu.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},pu.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},pu.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var _s=function(a){return a.zoom||a.drag||a.pitch||a.rotate},Tc=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a}(i.Event);function Jn(s){return s.panDelta&&s.panDelta.mag()||s.zoomDelta||s.bearingDelta||s.pitchDelta}var jn=function(a,n){this._map=a,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Sl(a),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n),i.bindAll(["handleEvent","handleWindowEvent"],this);var l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[i.window.document,"mousemove",{capture:!0}],[i.window.document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[i.window,"blur",void 0]];for(var g=0,w=this._listeners;g<w.length;g+=1){var L=w[g],z=L[0];D.addEventListener(z,L[1],z===i.window.document?this.handleWindowEvent:this.handleEvent,L[2])}};jn.prototype.destroy=function(){for(var s=0,a=this._listeners;s<a.length;s+=1){var n=a[s],l=n[0];D.removeEventListener(l,n[1],l===i.window.document?this.handleWindowEvent:this.handleEvent,n[2])}},jn.prototype._addDefaultHandlers=function(s){var a=this._map,n=a.getCanvasContainer();this._add("mapEvent",new to(a,s));var l=a.boxZoom=new zs(a,s);this._add("boxZoom",l);var g=new Us,w=new Ro;a.doubleClickZoom=new eu(w,g),this._add("tapZoom",g),this._add("clickZoom",w);var L=new To;this._add("tapDragZoom",L);var z=a.touchPitch=new af;this._add("touchPitch",z);var ue=new os(s),Ee=new ro(s);a.dragRotate=new cl(s,ue,Ee),this._add("mouseRotate",ue,["mousePitch"]),this._add("mousePitch",Ee,["mouseRotate"]);var Ke=new Ec(s),tt=new Jo(s);a.dragPan=new Al(n,Ke,tt),this._add("mousePan",Ke),this._add("touchPan",tt,["touchZoom","touchRotate"]);var rt=new zl,Ft=new Bs;a.touchZoomRotate=new pu(n,Ft,rt,L),this._add("touchRotate",rt,["touchPan","touchZoom"]),this._add("touchZoom",Ft,["touchPan","touchRotate"]);var Nt=a.scrollZoom=new Pa(a,this);this._add("scrollZoom",Nt,["mousePan"]);var Kt=a.keyboard=new Lo;this._add("keyboard",Kt),this._add("blockableMapEvent",new In(a));for(var jt=0,Gt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];jt<Gt.length;jt+=1){var nr=Gt[jt];s.interactive&&s[nr]&&a[nr].enable(s[nr])}},jn.prototype._add=function(s,a,n){this._handlers.push({handlerName:s,handler:a,allowed:n}),this._handlersById[s]=a},jn.prototype.stop=function(s){if(!this._updatingCamera){for(var a=0,n=this._handlers;a<n.length;a+=1)n[a].handler.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[]}},jn.prototype.isActive=function(){for(var s=0,a=this._handlers;s<a.length;s+=1)if(a[s].handler.isActive())return!0;return!1},jn.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},jn.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},jn.prototype.isMoving=function(){return Boolean(_s(this._eventsInProgress))||this.isZooming()},jn.prototype._blockedByActive=function(s,a,n){for(var l in s)if(l!==n&&(!a||a.indexOf(l)<0))return!0;return!1},jn.prototype.handleWindowEvent=function(s){this.handleEvent(s,s.type+"Window")},jn.prototype._getMapTouches=function(s){for(var a=[],n=0,l=s;n<l.length;n+=1){var g=l[n];this._el.contains(g.target)&&a.push(g)}return a},jn.prototype.handleEvent=function(s,a){if(s.type!=="blur"){this._updatingCamera=!0;for(var n=s.type==="renderFrame"?void 0:s,l={needsRenderFrame:!1},g={},w={},L=s.touches?this._getMapTouches(s.touches):void 0,z=L?D.touchPos(this._el,L):D.mousePos(this._el,s),ue=0,Ee=this._handlers;ue<Ee.length;ue+=1){var Ke=Ee[ue],tt=Ke.handlerName,rt=Ke.handler,Ft=Ke.allowed;if(rt.isEnabled()){var Nt=void 0;this._blockedByActive(w,Ft,tt)?rt.reset():rt[a||s.type]&&(Nt=rt[a||s.type](s,z,L),this.mergeHandlerResult(l,g,Nt,tt,n),Nt&&Nt.needsRenderFrame&&this._triggerRenderFrame()),(Nt||rt.isActive())&&(w[tt]=rt)}}var Kt={};for(var jt in this._previousActiveHandlers)w[jt]||(Kt[jt]=n);this._previousActiveHandlers=w,(Object.keys(Kt).length||Jn(l))&&(this._changes.push([l,g,Kt]),this._triggerRenderFrame()),(Object.keys(w).length||Jn(l))&&this._map._stop(!0),this._updatingCamera=!1;var Gt=l.cameraAnimation;Gt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Gt(this._map))}else this.stop(!0)},jn.prototype.mergeHandlerResult=function(s,a,n,l,g){if(n){i.extend(s,n);var w={handlerName:l,originalEvent:n.originalEvent||g};n.zoomDelta!==void 0&&(a.zoom=w),n.panDelta!==void 0&&(a.drag=w),n.pitchDelta!==void 0&&(a.pitch=w),n.bearingDelta!==void 0&&(a.rotate=w)}},jn.prototype._applyChanges=function(){for(var s={},a={},n={},l=0,g=this._changes;l<g.length;l+=1){var w=g[l],L=w[0],z=w[1],ue=w[2];L.panDelta&&(s.panDelta=(s.panDelta||new i.Point(0,0))._add(L.panDelta)),L.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+L.zoomDelta),L.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+L.bearingDelta),L.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+L.pitchDelta),L.around!==void 0&&(s.around=L.around),L.pinchAround!==void 0&&(s.pinchAround=L.pinchAround),L.noInertia&&(s.noInertia=L.noInertia),i.extend(a,z),i.extend(n,ue)}this._updateMapTransform(s,a,n),this._changes=[]},jn.prototype._updateMapTransform=function(s,a,n){var l=this._map,g=l.transform;if(!Jn(s))return this._fireEvents(a,n,!0);var w=s.panDelta,L=s.zoomDelta,z=s.bearingDelta,ue=s.pitchDelta,Ee=s.around,Ke=s.pinchAround;Ke!==void 0&&(Ee=Ke),l._stop(!0),Ee=Ee||l.transform.centerPoint;var tt=g.pointLocation(w?Ee.sub(w):Ee);z&&(g.bearing+=z),ue&&(g.pitch+=ue),L&&(g.zoom+=L),g.setLocationAtPoint(tt,Ee),this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(a,n,!0)},jn.prototype._fireEvents=function(s,a,n){var l=this,g=_s(this._eventsInProgress),w=_s(s),L={};for(var z in s)this._eventsInProgress[z]||(L[z+"start"]=s[z].originalEvent),this._eventsInProgress[z]=s[z];for(var ue in!g&&w&&this._fireEvent("movestart",w.originalEvent),L)this._fireEvent(ue,L[ue]);for(var Ee in w&&this._fireEvent("move",w.originalEvent),s)this._fireEvent(Ee,s[Ee].originalEvent);var Ke,tt={};for(var rt in this._eventsInProgress){var Ft=this._eventsInProgress[rt],Nt=Ft.handlerName,Kt=Ft.originalEvent;this._handlersById[Nt].isActive()||(delete this._eventsInProgress[rt],tt[rt+"end"]=Ke=a[Nt]||Kt)}for(var jt in tt)this._fireEvent(jt,tt[jt]);var Gt=_s(this._eventsInProgress);if(n&&(g||w)&&!Gt){this._updatingCamera=!0;var nr=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),rr=function(vr){return vr!==0&&-l._bearingSnap<vr&&vr<l._bearingSnap};nr?(rr(nr.bearing||this._map.getBearing())&&(nr.bearing=0),this._map.easeTo(nr,{originalEvent:Ke})):(this._map.fire(new i.Event("moveend",{originalEvent:Ke})),rr(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},jn.prototype._fireEvent=function(s,a){this._map.fire(new i.Event(s,a?{originalEvent:a}:{}))},jn.prototype._requestFrame=function(){var s=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(a){delete s._frameId,s.handleEvent(new Tc("renderFrame",{timeStamp:a})),s._applyChanges()})},jn.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var _c=function(s){function a(n,l){s.call(this),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=l.bearingSnap,i.bindAll(["_renderFrameCallback"],this)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getCenter=function(){return new i.LngLat(this.transform.center.lng,this.transform.center.lat)},a.prototype.setCenter=function(n,l){return this.jumpTo({center:n},l)},a.prototype.panBy=function(n,l,g){return n=i.Point.convert(n).mult(-1),this.panTo(this.transform.center,i.extend({offset:n},l),g)},a.prototype.panTo=function(n,l,g){return this.easeTo(i.extend({center:n},l),g)},a.prototype.getZoom=function(){return this.transform.zoom},a.prototype.setZoom=function(n,l){return this.jumpTo({zoom:n},l),this},a.prototype.zoomTo=function(n,l,g){return this.easeTo(i.extend({zoom:n},l),g)},a.prototype.zoomIn=function(n,l){return this.zoomTo(this.getZoom()+1,n,l),this},a.prototype.zoomOut=function(n,l){return this.zoomTo(this.getZoom()-1,n,l),this},a.prototype.getBearing=function(){return this.transform.bearing},a.prototype.setBearing=function(n,l){return this.jumpTo({bearing:n},l),this},a.prototype.getPadding=function(){return this.transform.padding},a.prototype.setPadding=function(n,l){return this.jumpTo({padding:n},l),this},a.prototype.rotateTo=function(n,l,g){return this.easeTo(i.extend({bearing:n},l),g)},a.prototype.resetNorth=function(n,l){return this.rotateTo(0,i.extend({duration:1e3},n),l),this},a.prototype.resetNorthPitch=function(n,l){return this.easeTo(i.extend({bearing:0,pitch:0,duration:1e3},n),l),this},a.prototype.snapToNorth=function(n,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,l):this},a.prototype.getPitch=function(){return this.transform.pitch},a.prototype.setPitch=function(n,l){return this.jumpTo({pitch:n},l),this},a.prototype.cameraForBounds=function(n,l){n=i.LngLatBounds.convert(n);var g=l&&l.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),g,l)},a.prototype._cameraForBoxAndBearing=function(n,l,g,w){var L={top:0,bottom:0,right:0,left:0};if(typeof(w=i.extend({padding:L,offset:[0,0],maxZoom:this.transform.maxZoom},w)).padding=="number"){var z=w.padding;w.padding={top:z,bottom:z,right:z,left:z}}w.padding=i.extend(L,w.padding);var ue=this.transform,Ee=ue.padding,Ke=ue.project(i.LngLat.convert(n)),tt=ue.project(i.LngLat.convert(l)),rt=Ke.rotate(-g*Math.PI/180),Ft=tt.rotate(-g*Math.PI/180),Nt=new i.Point(Math.max(rt.x,Ft.x),Math.max(rt.y,Ft.y)),Kt=new i.Point(Math.min(rt.x,Ft.x),Math.min(rt.y,Ft.y)),jt=Nt.sub(Kt),Gt=(ue.width-(Ee.left+Ee.right+w.padding.left+w.padding.right))/jt.x,nr=(ue.height-(Ee.top+Ee.bottom+w.padding.top+w.padding.bottom))/jt.y;if(!(nr<0||Gt<0)){var rr=Math.min(ue.scaleZoom(ue.scale*Math.min(Gt,nr)),w.maxZoom),Lr=typeof w.offset.x=="number"?new i.Point(w.offset.x,w.offset.y):i.Point.convert(w.offset),vr=new i.Point((w.padding.left-w.padding.right)/2,(w.padding.top-w.padding.bottom)/2).rotate(g*Math.PI/180),Sr=Lr.add(vr).mult(ue.scale/ue.zoomScale(rr));return{center:ue.unproject(Ke.add(tt).div(2).sub(Sr)),zoom:rr,bearing:g}}i.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},a.prototype.fitBounds=function(n,l,g){return this._fitInternal(this.cameraForBounds(n,l),l,g)},a.prototype.fitScreenCoordinates=function(n,l,g,w,L){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(i.Point.convert(n)),this.transform.pointLocation(i.Point.convert(l)),g,w),w,L)},a.prototype._fitInternal=function(n,l,g){return n?(delete(l=i.extend(n,l)).padding,l.linear?this.easeTo(l,g):this.flyTo(l,g)):this},a.prototype.jumpTo=function(n,l){this.stop();var g=this.transform,w=!1,L=!1,z=!1;return"zoom"in n&&g.zoom!==+n.zoom&&(w=!0,g.zoom=+n.zoom),n.center!==void 0&&(g.center=i.LngLat.convert(n.center)),"bearing"in n&&g.bearing!==+n.bearing&&(L=!0,g.bearing=+n.bearing),"pitch"in n&&g.pitch!==+n.pitch&&(z=!0,g.pitch=+n.pitch),n.padding==null||g.isPaddingEqual(n.padding)||(g.padding=n.padding),this.fire(new i.Event("movestart",l)).fire(new i.Event("move",l)),w&&this.fire(new i.Event("zoomstart",l)).fire(new i.Event("zoom",l)).fire(new i.Event("zoomend",l)),L&&this.fire(new i.Event("rotatestart",l)).fire(new i.Event("rotate",l)).fire(new i.Event("rotateend",l)),z&&this.fire(new i.Event("pitchstart",l)).fire(new i.Event("pitch",l)).fire(new i.Event("pitchend",l)),this.fire(new i.Event("moveend",l))},a.prototype.easeTo=function(n,l){var g=this;this._stop(!1,n.easeId),((n=i.extend({offset:[0,0],duration:500,easing:i.ease},n)).animate===!1||!n.essential&&i.browser.prefersReducedMotion)&&(n.duration=0);var w=this.transform,L=this.getZoom(),z=this.getBearing(),ue=this.getPitch(),Ee=this.getPadding(),Ke="zoom"in n?+n.zoom:L,tt="bearing"in n?this._normalizeBearing(n.bearing,z):z,rt="pitch"in n?+n.pitch:ue,Ft="padding"in n?n.padding:w.padding,Nt=i.Point.convert(n.offset),Kt=w.centerPoint.add(Nt),jt=w.pointLocation(Kt),Gt=i.LngLat.convert(n.center||jt);this._normalizeCenter(Gt);var nr,rr,Lr=w.project(jt),vr=w.project(Gt).sub(Lr),Sr=w.zoomScale(Ke-L);n.around&&(nr=i.LngLat.convert(n.around),rr=w.locationPoint(nr));var Ar={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Ke!==L,this._rotating=this._rotating||z!==tt,this._pitching=this._pitching||rt!==ue,this._padding=!w.isPaddingEqual(Ft),this._easeId=n.easeId,this._prepareEase(l,n.noMoveStart,Ar),this._ease(function(rn){if(g._zooming&&(w.zoom=i.number(L,Ke,rn)),g._rotating&&(w.bearing=i.number(z,tt,rn)),g._pitching&&(w.pitch=i.number(ue,rt,rn)),g._padding&&(w.interpolatePadding(Ee,Ft,rn),Kt=w.centerPoint.add(Nt)),nr)w.setLocationAtPoint(nr,rr);else{var Xr=w.zoomScale(w.zoom-L),mn=Ke>L?Math.min(2,Sr):Math.max(.5,Sr),Ln=Math.pow(mn,1-rn),qn=w.unproject(Lr.add(vr.mult(rn*Ln)).mult(Xr));w.setLocationAtPoint(w.renderWorldCopies?qn.wrap():qn,Kt)}g._fireMoveEvents(l)},function(rn){g._afterEase(l,rn)},n),this},a.prototype._prepareEase=function(n,l,g){g===void 0&&(g={}),this._moving=!0,l||g.moving||this.fire(new i.Event("movestart",n)),this._zooming&&!g.zooming&&this.fire(new i.Event("zoomstart",n)),this._rotating&&!g.rotating&&this.fire(new i.Event("rotatestart",n)),this._pitching&&!g.pitching&&this.fire(new i.Event("pitchstart",n))},a.prototype._fireMoveEvents=function(n){this.fire(new i.Event("move",n)),this._zooming&&this.fire(new i.Event("zoom",n)),this._rotating&&this.fire(new i.Event("rotate",n)),this._pitching&&this.fire(new i.Event("pitch",n))},a.prototype._afterEase=function(n,l){if(!this._easeId||!l||this._easeId!==l){delete this._easeId;var g=this._zooming,w=this._rotating,L=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new i.Event("zoomend",n)),w&&this.fire(new i.Event("rotateend",n)),L&&this.fire(new i.Event("pitchend",n)),this.fire(new i.Event("moveend",n))}},a.prototype.flyTo=function(n,l){var g=this;if(!n.essential&&i.browser.prefersReducedMotion){var w=i.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(w,l)}this.stop(),n=i.extend({offset:[0,0],speed:1.2,curve:1.42,easing:i.ease},n);var L=this.transform,z=this.getZoom(),ue=this.getBearing(),Ee=this.getPitch(),Ke=this.getPadding(),tt="zoom"in n?i.clamp(+n.zoom,L.minZoom,L.maxZoom):z,rt="bearing"in n?this._normalizeBearing(n.bearing,ue):ue,Ft="pitch"in n?+n.pitch:Ee,Nt="padding"in n?n.padding:L.padding,Kt=L.zoomScale(tt-z),jt=i.Point.convert(n.offset),Gt=L.centerPoint.add(jt),nr=L.pointLocation(Gt),rr=i.LngLat.convert(n.center||nr);this._normalizeCenter(rr);var Lr=L.project(nr),vr=L.project(rr).sub(Lr),Sr=n.curve,Ar=Math.max(L.width,L.height),rn=Ar/Kt,Xr=vr.mag();if("minZoom"in n){var mn=i.clamp(Math.min(n.minZoom,z,tt),L.minZoom,L.maxZoom),Ln=Ar/L.zoomScale(mn-z);Sr=Math.sqrt(Ln/Xr*2)}var qn=Sr*Sr;function sa(na){var La=(rn*rn-Ar*Ar+(na?-1:1)*qn*qn*Xr*Xr)/(2*(na?rn:Ar)*qn*Xr);return Math.log(Math.sqrt(La*La+1)-La)}function Sa(na){return(Math.exp(na)-Math.exp(-na))/2}function Za(na){return(Math.exp(na)+Math.exp(-na))/2}var Sn=sa(0),ua=function(La){return Za(Sn)/Za(Sn+Sr*La)},ba=function(La){return Ar*((Za(Sn)*(Sa(za=Sn+Sr*La)/Za(za))-Sa(Sn))/qn)/Xr;var za},Zn=(sa(1)-Sn)/Sr;if(Math.abs(Xr)<1e-6||!isFinite(Zn)){if(Math.abs(Ar-rn)<1e-6)return this.easeTo(n,l);var Aa=rn<Ar?-1:1;Zn=Math.abs(Math.log(rn/Ar))/Sr,ba=function(){return 0},ua=function(La){return Math.exp(Aa*Sr*La)}}return n.duration="duration"in n?+n.duration:1e3*Zn/("screenSpeed"in n?+n.screenSpeed/Sr:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=ue!==rt,this._pitching=Ft!==Ee,this._padding=!L.isPaddingEqual(Nt),this._prepareEase(l,!1),this._ease(function(na){var La=na*Zn,za=1/ua(La);L.zoom=na===1?tt:z+L.scaleZoom(za),g._rotating&&(L.bearing=i.number(ue,rt,na)),g._pitching&&(L.pitch=i.number(Ee,Ft,na)),g._padding&&(L.interpolatePadding(Ke,Nt,na),Gt=L.centerPoint.add(jt));var Gi=na===1?rr:L.unproject(Lr.add(vr.mult(ba(La))).mult(za));L.setLocationAtPoint(L.renderWorldCopies?Gi.wrap():Gi,Gt),g._fireMoveEvents(l)},function(){return g._afterEase(l)},n),this},a.prototype.isEasing=function(){return!!this._easeFrameId},a.prototype.stop=function(){return this._stop()},a.prototype._stop=function(n,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var g=this._onEaseEnd;delete this._onEaseEnd,g.call(this,l)}if(!n){var w=this.handlers;w&&w.stop(!1)}return this},a.prototype._ease=function(n,l,g){g.animate===!1||g.duration===0?(n(1),l()):(this._easeStart=i.browser.now(),this._easeOptions=g,this._onEaseFrame=n,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},a.prototype._renderFrameCallback=function(){var n=Math.min((i.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},a.prototype._normalizeBearing=function(n,l){n=i.wrap(n,-180,180);var g=Math.abs(n-l);return Math.abs(n-360-l)<g&&(n-=360),Math.abs(n+360-l)<g&&(n+=360),n},a.prototype._normalizeCenter=function(n){var l=this.transform;if(l.renderWorldCopies&&!l.lngRange){var g=n.lng-l.center.lng;n.lng+=g>180?-360:g<-180?360:0}},a}(i.Evented),us=function(a){a===void 0&&(a={}),this.options=a,i.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};us.prototype.getDefaultPosition=function(){return"bottom-right"},us.prototype.onAdd=function(s){var a=this.options&&this.options.compact;return this._map=s,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=D.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=D.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),a&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),a===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},us.prototype.onRemove=function(){D.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},us.prototype._setElementTitle=function(s,a){var n=this._map._getUIString("AttributionControl."+a);s.title=n,s.setAttribute("aria-label",n)},us.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},us.prototype._updateEditLink=function(){var s=this._editLink;s||(s=this._editLink=this._container.querySelector(".mapbox-improve-map"));var a=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.config.ACCESS_TOKEN}];if(s){var n=a.reduce(function(l,g,w){return g.value&&(l+=g.key+"="+g.value+(w<a.length-1?"&":"")),l},"?");s.href=i.config.FEEDBACK_URL+"/"+n+(this._map._hash?this._map._hash.getHashString(!0):""),s.rel="noopener nofollow",this._setElementTitle(s,"MapFeedback")}},us.prototype._updateData=function(s){!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},us.prototype._updateAttributions=function(){if(this._map.style){var s=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=s.concat(this.options.customAttribution.map(function(z){return typeof z!="string"?"":z})):typeof this.options.customAttribution=="string"&&s.push(this.options.customAttribution)),this._map.style.stylesheet){var a=this._map.style.stylesheet;this.styleOwner=a.owner,this.styleId=a.id}var n=this._map.style.sourceCaches;for(var l in n){var g=n[l];if(g.used){var w=g.getSource();w.attribution&&s.indexOf(w.attribution)<0&&s.push(w.attribution)}}s.sort(function(z,ue){return z.length-ue.length});var L=(s=s.filter(function(z,ue){for(var Ee=ue+1;Ee<s.length;Ee++)if(s[Ee].indexOf(z)>=0)return!1;return!0})).join(" | ");L!==this._attribHTML&&(this._attribHTML=L,s.length?(this._innerContainer.innerHTML=L,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},us.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Io=function(){i.bindAll(["_updateLogo"],this),i.bindAll(["_updateCompact"],this)};Io.prototype.onAdd=function(s){this._map=s,this._container=D.create("div","mapboxgl-ctrl");var a=D.create("a","mapboxgl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://www.mapbox.com/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Io.prototype.onRemove=function(){D.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Io.prototype.getDefaultPosition=function(){return"bottom-left"},Io.prototype._updateLogo=function(s){s&&s.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},Io.prototype._logoRequired=function(){if(this._map.style){var s=this._map.style.sourceCaches;for(var a in s)if(s[a].getSource().mapbox_logo)return!0;return!1}},Io.prototype._updateCompact=function(){var s=this._container.children;if(s.length){var a=s[0];this._map.getCanvasContainer().offsetWidth<250?a.classList.add("mapboxgl-compact"):a.classList.remove("mapboxgl-compact")}};var vo=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};vo.prototype.add=function(s){var a=++this._id;return this._queue.push({callback:s,id:a,cancelled:!1}),a},vo.prototype.remove=function(s){for(var a=this._currentlyRunning,n=0,l=a?this._queue.concat(a):this._queue;n<l.length;n+=1){var g=l[n];if(g.id===s)return void(g.cancelled=!0)}},vo.prototype.run=function(s){s===void 0&&(s=0);var a=this._currentlyRunning=this._queue;this._queue=[];for(var n=0,l=a;n<l.length;n+=1){var g=l[n];if(!g.cancelled&&(g.callback(s),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},vo.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Ss={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},wu=i.window.HTMLImageElement,rc=i.window.HTMLElement,Ka=i.window.ImageBitmap,no={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},fl=function(s){function a(l){var g=this;if((l=i.extend({},no,l)).minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var w=new kn(l.minZoom,l.maxZoom,l.minPitch,l.maxPitch,l.renderWorldCopies);if(s.call(this,w,l),this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._failIfMajorPerformanceCaveat=l.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=l.preserveDrawingBuffer,this._antialias=l.antialias,this._trackResize=l.trackResize,this._bearingSnap=l.bearingSnap,this._refreshExpiredTiles=l.refreshExpiredTiles,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=l.collectResourceTiming,this._renderTaskQueue=new vo,this._controls=[],this._mapId=i.uniqueId(),this._locale=i.extend({},Ss,l.locale),this._clickTolerance=l.clickTolerance,this._requestManager=new i.RequestManager(l.transformRequest,l.accessToken),typeof l.container=="string"){if(this._container=i.window.document.getElementById(l.container),!this._container)throw new Error("Container '"+l.container+"' not found.")}else{if(!(l.container instanceof rc))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),i.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return g._update(!1)}),this.on("moveend",function(){return g._update(!1)}),this.on("zoom",function(){return g._update(!0)}),i.window!==void 0&&(i.window.addEventListener("online",this._onWindowOnline,!1),i.window.addEventListener("resize",this._onWindowResize,!1),i.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new jn(this,l),this._hash=l.hash&&new ws(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,i.extend({},l.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=l.localIdeographFontFamily,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new us({customAttribution:l.customAttribution})),this.addControl(new Io,l.logoPosition),this.on("style.load",function(){g.transform.unmodified&&g.jumpTo(g.style.stylesheet)}),this.on("data",function(L){g._update(L.dataType==="style"),g.fire(new i.Event(L.dataType+"data",L))}),this.on("dataloading",function(L){g.fire(new i.Event(L.dataType+"dataloading",L))})}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return a.prototype._getMapId=function(){return this._mapId},a.prototype.addControl=function(l,g){if(g===void 0&&(g=l.getDefaultPosition?l.getDefaultPosition():"top-right"),!l||!l.onAdd)return this.fire(new i.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var w=l.onAdd(this);this._controls.push(l);var L=this._controlPositions[g];return g.indexOf("bottom")!==-1?L.insertBefore(w,L.firstChild):L.appendChild(w),this},a.prototype.removeControl=function(l){if(!l||!l.onRemove)return this.fire(new i.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var g=this._controls.indexOf(l);return g>-1&&this._controls.splice(g,1),l.onRemove(this),this},a.prototype.hasControl=function(l){return this._controls.indexOf(l)>-1},a.prototype.resize=function(l){var g=this._containerDimensions(),w=g[0],L=g[1];this._resizeCanvas(w,L),this.transform.resize(w,L),this.painter.resize(w,L);var z=!this._moving;return z&&(this.stop(),this.fire(new i.Event("movestart",l)).fire(new i.Event("move",l))),this.fire(new i.Event("resize",l)),z&&this.fire(new i.Event("moveend",l)),this},a.prototype.getBounds=function(){return this.transform.getBounds()},a.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},a.prototype.setMaxBounds=function(l){return this.transform.setMaxBounds(i.LngLatBounds.convert(l)),this._update()},a.prototype.setMinZoom=function(l){if((l=l==null?-2:l)>=-2&&l<=this.transform.maxZoom)return this.transform.minZoom=l,this._update(),this.getZoom()<l&&this.setZoom(l),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},a.prototype.getMinZoom=function(){return this.transform.minZoom},a.prototype.setMaxZoom=function(l){if((l=l==null?22:l)>=this.transform.minZoom)return this.transform.maxZoom=l,this._update(),this.getZoom()>l&&this.setZoom(l),this;throw new Error("maxZoom must be greater than the current minZoom")},a.prototype.getMaxZoom=function(){return this.transform.maxZoom},a.prototype.setMinPitch=function(l){if((l=l==null?0:l)<0)throw new Error("minPitch must be greater than or equal to 0");if(l>=0&&l<=this.transform.maxPitch)return this.transform.minPitch=l,this._update(),this.getPitch()<l&&this.setPitch(l),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},a.prototype.getMinPitch=function(){return this.transform.minPitch},a.prototype.setMaxPitch=function(l){if((l=l==null?60:l)>60)throw new Error("maxPitch must be less than or equal to 60");if(l>=this.transform.minPitch)return this.transform.maxPitch=l,this._update(),this.getPitch()>l&&this.setPitch(l),this;throw new Error("maxPitch must be greater than the current minPitch")},a.prototype.getMaxPitch=function(){return this.transform.maxPitch},a.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},a.prototype.setRenderWorldCopies=function(l){return this.transform.renderWorldCopies=l,this._update()},a.prototype.project=function(l){return this.transform.locationPoint(i.LngLat.convert(l))},a.prototype.unproject=function(l){return this.transform.pointLocation(i.Point.convert(l))},a.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},a.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},a.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},a.prototype._createDelegatedListener=function(l,g,w){var L,z=this;if(l==="mouseenter"||l==="mouseover"){var ue=!1;return{layer:g,listener:w,delegates:{mousemove:function(tt){var rt=z.getLayer(g)?z.queryRenderedFeatures(tt.point,{layers:[g]}):[];rt.length?ue||(ue=!0,w.call(z,new zi(l,z,tt.originalEvent,{features:rt}))):ue=!1},mouseout:function(){ue=!1}}}}if(l==="mouseleave"||l==="mouseout"){var Ee=!1;return{layer:g,listener:w,delegates:{mousemove:function(tt){(z.getLayer(g)?z.queryRenderedFeatures(tt.point,{layers:[g]}):[]).length?Ee=!0:Ee&&(Ee=!1,w.call(z,new zi(l,z,tt.originalEvent)))},mouseout:function(tt){Ee&&(Ee=!1,w.call(z,new zi(l,z,tt.originalEvent)))}}}}return{layer:g,listener:w,delegates:(L={},L[l]=function(Ke){var tt=z.getLayer(g)?z.queryRenderedFeatures(Ke.point,{layers:[g]}):[];tt.length&&(Ke.features=tt,w.call(z,Ke),delete Ke.features)},L)}},a.prototype.on=function(l,g,w){if(w===void 0)return s.prototype.on.call(this,l,g);var L=this._createDelegatedListener(l,g,w);for(var z in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[l]=this._delegatedListeners[l]||[],this._delegatedListeners[l].push(L),L.delegates)this.on(z,L.delegates[z]);return this},a.prototype.once=function(l,g,w){if(w===void 0)return s.prototype.once.call(this,l,g);var L=this._createDelegatedListener(l,g,w);for(var z in L.delegates)this.once(z,L.delegates[z]);return this},a.prototype.off=function(l,g,w){var L=this;return w===void 0?s.prototype.off.call(this,l,g):(this._delegatedListeners&&this._delegatedListeners[l]&&function(z){for(var ue=z[l],Ee=0;Ee<ue.length;Ee++){var Ke=ue[Ee];if(Ke.layer===g&&Ke.listener===w){for(var tt in Ke.delegates)L.off(tt,Ke.delegates[tt]);return ue.splice(Ee,1),L}}}(this._delegatedListeners),this)},a.prototype.queryRenderedFeatures=function(l,g){if(!this.style)return[];var w;if(g!==void 0||l===void 0||l instanceof i.Point||Array.isArray(l)||(g=l,l=void 0),g=g||{},(l=l||[[0,0],[this.transform.width,this.transform.height]])instanceof i.Point||typeof l[0]=="number")w=[i.Point.convert(l)];else{var L=i.Point.convert(l[0]),z=i.Point.convert(l[1]);w=[L,new i.Point(z.x,L.y),z,new i.Point(L.x,z.y),L]}return this.style.queryRenderedFeatures(w,g,this.transform)},a.prototype.querySourceFeatures=function(l,g){return this.style.querySourceFeatures(l,g)},a.prototype.setStyle=function(l,g){return(g=i.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},g)).diff!==!1&&g.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&l?(this._diffStyle(l,g),this):(this._localIdeographFontFamily=g.localIdeographFontFamily,this._updateStyle(l,g))},a.prototype._getUIString=function(l){var g=this._locale[l];if(g==null)throw new Error("Missing UI string '"+l+"'");return g},a.prototype._updateStyle=function(l,g){return this.style&&(this.style.setEventedParent(null),this.style._remove()),l?(this.style=new Ri(this,g||{}),this.style.setEventedParent(this,{style:this.style}),typeof l=="string"?this.style.loadURL(l):this.style.loadJSON(l),this):(delete this.style,this)},a.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Ri(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},a.prototype._diffStyle=function(l,g){var w=this;if(typeof l=="string"){var L=this._requestManager.normalizeStyleURL(l),z=this._requestManager.transformRequest(L,i.ResourceType.Style);i.getJSON(z,function(ue,Ee){ue?w.fire(new i.ErrorEvent(ue)):Ee&&w._updateDiff(Ee,g)})}else typeof l=="object"&&this._updateDiff(l,g)},a.prototype._updateDiff=function(l,g){try{this.style.setState(l)&&this._update(!0)}catch(w){i.warnOnce("Unable to perform style diff: "+(w.message||w.error||w)+".  Rebuilding the style from scratch."),this._updateStyle(l,g)}},a.prototype.getStyle=function(){if(this.style)return this.style.serialize()},a.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():i.warnOnce("There is no style added to the map.")},a.prototype.addSource=function(l,g){return this._lazyInitEmptyStyle(),this.style.addSource(l,g),this._update(!0)},a.prototype.isSourceLoaded=function(l){var g=this.style&&this.style.sourceCaches[l];if(g!==void 0)return g.loaded();this.fire(new i.ErrorEvent(new Error("There is no source with ID '"+l+"'")))},a.prototype.areTilesLoaded=function(){var l=this.style&&this.style.sourceCaches;for(var g in l){var w=l[g]._tiles;for(var L in w){var z=w[L];if(z.state!=="loaded"&&z.state!=="errored")return!1}}return!0},a.prototype.addSourceType=function(l,g,w){return this._lazyInitEmptyStyle(),this.style.addSourceType(l,g,w)},a.prototype.removeSource=function(l){return this.style.removeSource(l),this._update(!0)},a.prototype.getSource=function(l){return this.style.getSource(l)},a.prototype.addImage=function(l,g,w){w===void 0&&(w={});var L=w.pixelRatio;L===void 0&&(L=1);var z=w.sdf;z===void 0&&(z=!1);var ue=w.stretchX,Ee=w.stretchY,Ke=w.content;if(this._lazyInitEmptyStyle(),g instanceof wu||Ka&&g instanceof Ka){var tt=i.browser.getImageData(g);this.style.addImage(l,{data:new i.RGBAImage({width:tt.width,height:tt.height},tt.data),pixelRatio:L,stretchX:ue,stretchY:Ee,content:Ke,sdf:z,version:0})}else{if(g.width===void 0||g.height===void 0)return this.fire(new i.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var rt=g;this.style.addImage(l,{data:new i.RGBAImage({width:g.width,height:g.height},new Uint8Array(g.data)),pixelRatio:L,stretchX:ue,stretchY:Ee,content:Ke,sdf:z,version:0,userImage:rt}),rt.onAdd&&rt.onAdd(this,l)}},a.prototype.updateImage=function(l,g){var w=this.style.getImage(l);if(!w)return this.fire(new i.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var L=g instanceof wu||Ka&&g instanceof Ka?i.browser.getImageData(g):g,z=L.width,ue=L.height,Ee=L.data;return z===void 0||ue===void 0?this.fire(new i.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):z!==w.data.width||ue!==w.data.height?this.fire(new i.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(w.data.replace(Ee,!(g instanceof wu||Ka&&g instanceof Ka)),void this.style.updateImage(l,w))},a.prototype.hasImage=function(l){return l?!!this.style.getImage(l):(this.fire(new i.ErrorEvent(new Error("Missing required image id"))),!1)},a.prototype.removeImage=function(l){this.style.removeImage(l)},a.prototype.loadImage=function(l,g){i.getImage(this._requestManager.transformRequest(l,i.ResourceType.Image),g)},a.prototype.listImages=function(){return this.style.listImages()},a.prototype.addLayer=function(l,g){return this._lazyInitEmptyStyle(),this.style.addLayer(l,g),this._update(!0)},a.prototype.moveLayer=function(l,g){return this.style.moveLayer(l,g),this._update(!0)},a.prototype.removeLayer=function(l){return this.style.removeLayer(l),this._update(!0)},a.prototype.getLayer=function(l){return this.style.getLayer(l)},a.prototype.setLayerZoomRange=function(l,g,w){return this.style.setLayerZoomRange(l,g,w),this._update(!0)},a.prototype.setFilter=function(l,g,w){return w===void 0&&(w={}),this.style.setFilter(l,g,w),this._update(!0)},a.prototype.getFilter=function(l){return this.style.getFilter(l)},a.prototype.setPaintProperty=function(l,g,w,L){return L===void 0&&(L={}),this.style.setPaintProperty(l,g,w,L),this._update(!0)},a.prototype.getPaintProperty=function(l,g){return this.style.getPaintProperty(l,g)},a.prototype.setLayoutProperty=function(l,g,w,L){return L===void 0&&(L={}),this.style.setLayoutProperty(l,g,w,L),this._update(!0)},a.prototype.getLayoutProperty=function(l,g){return this.style.getLayoutProperty(l,g)},a.prototype.setLight=function(l,g){return g===void 0&&(g={}),this._lazyInitEmptyStyle(),this.style.setLight(l,g),this._update(!0)},a.prototype.getLight=function(){return this.style.getLight()},a.prototype.setFeatureState=function(l,g){return this.style.setFeatureState(l,g),this._update()},a.prototype.removeFeatureState=function(l,g){return this.style.removeFeatureState(l,g),this._update()},a.prototype.getFeatureState=function(l){return this.style.getFeatureState(l)},a.prototype.getContainer=function(){return this._container},a.prototype.getCanvasContainer=function(){return this._canvasContainer},a.prototype.getCanvas=function(){return this._canvas},a.prototype._containerDimensions=function(){var l=0,g=0;return this._container&&(l=this._container.clientWidth||400,g=this._container.clientHeight||300),[l,g]},a.prototype._detectMissingCSS=function(){i.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},a.prototype._setupContainer=function(){var l=this._container;l.classList.add("mapboxgl-map"),(this._missingCSSCanary=D.create("div","mapboxgl-canary",l)).style.visibility="hidden",this._detectMissingCSS();var g=this._canvasContainer=D.create("div","mapboxgl-canvas-container",l);this._interactive&&g.classList.add("mapboxgl-interactive"),this._canvas=D.create("canvas","mapboxgl-canvas",g),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var w=this._containerDimensions();this._resizeCanvas(w[0],w[1]);var L=this._controlContainer=D.create("div","mapboxgl-control-container",l),z=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(ue){z[ue]=D.create("div","mapboxgl-ctrl-"+ue,L)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},a.prototype._resizeCanvas=function(l,g){var w=i.browser.devicePixelRatio||1;this._canvas.width=w*l,this._canvas.height=w*g,this._canvas.style.width=l+"px",this._canvas.style.height=g+"px"},a.prototype._setupPainter=function(){var l=i.extend({},Z.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),g=this._canvas.getContext("webgl",l)||this._canvas.getContext("experimental-webgl",l);g?(this.painter=new wi(g,this.transform),i.webpSupported.testSupport(g)):this.fire(new i.ErrorEvent(new Error("Failed to initialize WebGL")))},a.prototype._contextLost=function(l){l.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.Event("webglcontextlost",{originalEvent:l}))},a.prototype._contextRestored=function(l){this._setupPainter(),this.resize(),this._update(),this.fire(new i.Event("webglcontextrestored",{originalEvent:l}))},a.prototype._onMapScroll=function(l){if(l.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},a.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},a.prototype._update=function(l){return this.style?(this._styleDirty=this._styleDirty||l,this._sourcesDirty=!0,this.triggerRepaint(),this):this},a.prototype._requestRenderFrame=function(l){return this._update(),this._renderTaskQueue.add(l)},a.prototype._cancelRenderFrame=function(l){this._renderTaskQueue.remove(l)},a.prototype._render=function(l){var g,w=this,L=0,z=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(g=z.createQueryEXT(),z.beginQueryEXT(z.TIME_ELAPSED_EXT,g),L=i.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(l),!this._removed){var ue=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Ee=this.transform.zoom,Ke=i.browser.now();this.style.zoomHistory.update(Ee,Ke);var tt=new i.EvaluationParameters(Ee,{now:Ke,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),rt=tt.crossFadingFactor();rt===1&&rt===this._crossFadingFactor||(ue=!0,this._crossFadingFactor=rt),this.style.update(tt)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new i.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new i.Event("load"))),this.style&&(this.style.hasTransitions()||ue)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Ft=i.browser.now()-L;z.endQueryEXT(z.TIME_ELAPSED_EXT,g),setTimeout(function(){var jt=z.getQueryObjectEXT(g,z.QUERY_RESULT_EXT)/1e6;z.deleteQueryEXT(g),w.fire(new i.Event("gpu-timing-frame",{cpuTime:Ft,gpuTime:jt}))},50)}if(this.listens("gpu-timing-layer")){var Nt=this.painter.collectGpuTimers();setTimeout(function(){var jt=w.painter.queryGpuTimers(Nt);w.fire(new i.Event("gpu-timing-layer",{layerTimes:jt}))},50)}var Kt=this._sourcesDirty||this._styleDirty||this._placementDirty;return Kt||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new i.Event("idle")),!this._loaded||this._fullyLoaded||Kt||(this._fullyLoaded=!0),this}},a.prototype.remove=function(){this._hash&&this._hash.remove();for(var l=0,g=this._controls;l<g.length;l+=1)g[l].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),i.window!==void 0&&(i.window.removeEventListener("resize",this._onWindowResize,!1),i.window.removeEventListener("orientationchange",this._onWindowResize,!1),i.window.removeEventListener("online",this._onWindowOnline,!1));var w=this.painter.context.gl.getExtension("WEBGL_lose_context");w&&w.loseContext(),mu(this._canvasContainer),mu(this._controlContainer),mu(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new i.Event("remove"))},a.prototype.triggerRepaint=function(){var l=this;this.style&&!this._frame&&(this._frame=i.browser.frame(function(g){l._frame=null,l._render(g)}))},a.prototype._onWindowOnline=function(){this._update()},a.prototype._onWindowResize=function(l){this._trackResize&&this.resize({originalEvent:l})._update()},n.showTileBoundaries.get=function(){return!!this._showTileBoundaries},n.showTileBoundaries.set=function(l){this._showTileBoundaries!==l&&(this._showTileBoundaries=l,this._update())},n.showPadding.get=function(){return!!this._showPadding},n.showPadding.set=function(l){this._showPadding!==l&&(this._showPadding=l,this._update())},n.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},n.showCollisionBoxes.set=function(l){this._showCollisionBoxes!==l&&(this._showCollisionBoxes=l,l?this.style._generateCollisionBoxes():this._update())},n.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},n.showOverdrawInspector.set=function(l){this._showOverdrawInspector!==l&&(this._showOverdrawInspector=l,this._update())},n.repaint.get=function(){return!!this._repaint},n.repaint.set=function(l){this._repaint!==l&&(this._repaint=l,this.triggerRepaint())},n.vertices.get=function(){return!!this._vertices},n.vertices.set=function(l){this._vertices=l,this._update()},a.prototype._setCacheLimits=function(l,g){i.setCacheLimits(l,g)},n.version.get=function(){return i.version},Object.defineProperties(a.prototype,n),a}(_c);function mu(s){s.parentNode&&s.parentNode.removeChild(s)}var hl={showCompass:!0,showZoom:!0,visualizePitch:!1},Ou=function(a){var n=this;this.options=i.extend({},hl,a),this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(l){return l.preventDefault()}),this.options.showZoom&&(i.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(l){return n._map.zoomIn({},{originalEvent:l})}),D.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(l){return n._map.zoomOut({},{originalEvent:l})}),D.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(i.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(l){n.options.visualizePitch?n._map.resetNorthPitch({},{originalEvent:l}):n._map.resetNorth({},{originalEvent:l})}),this._compassIcon=D.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Ou.prototype._updateZoomButtons=function(){var s=this._map.getZoom(),a=s===this._map.getMaxZoom(),n=s===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())},Ou.prototype._rotateCompassArrow=function(){var s=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=s},Ou.prototype.onAdd=function(s){return this._map=s,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ms(this._map,this._compass,this.options.visualizePitch)),this._container},Ou.prototype.onRemove=function(){D.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Ou.prototype._createButton=function(s,a){var n=D.create("button",s,this._container);return n.type="button",n.addEventListener("click",a),n},Ou.prototype._setButtonTitle=function(s,a){var n=this._map._getUIString("NavigationControl."+a);s.title=n,s.setAttribute("aria-label",n)};var Ms=function(a,n,l){l===void 0&&(l=!1),this._clickTolerance=10,this.element=n,this.mouseRotate=new os({clickTolerance:a.dragRotate._mouseRotate._clickTolerance}),this.map=a,l&&(this.mousePitch=new ro({clickTolerance:a.dragRotate._mousePitch._clickTolerance})),i.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),D.addEventListener(n,"mousedown",this.mousedown),D.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),D.addEventListener(n,"touchmove",this.touchmove),D.addEventListener(n,"touchend",this.touchend),D.addEventListener(n,"touchcancel",this.reset)};function Bc(s,a,n){if(s=new i.LngLat(s.lng,s.lat),a){var l=new i.LngLat(s.lng-360,s.lat),g=new i.LngLat(s.lng+360,s.lat),w=n.locationPoint(s).distSqr(a);n.locationPoint(l).distSqr(a)<w?s=l:n.locationPoint(g).distSqr(a)<w&&(s=g)}for(;Math.abs(s.lng-n.center.lng)>180;){var L=n.locationPoint(s);if(L.x>=0&&L.y>=0&&L.x<=n.width&&L.y<=n.height)break;s.lng>n.center.lng?s.lng-=360:s.lng+=360}return s}Ms.prototype.down=function(s,a){this.mouseRotate.mousedown(s,a),this.mousePitch&&this.mousePitch.mousedown(s,a),D.disableDrag()},Ms.prototype.move=function(s,a){var n=this.map,l=this.mouseRotate.mousemoveWindow(s,a);if(l&&l.bearingDelta&&n.setBearing(n.getBearing()+l.bearingDelta),this.mousePitch){var g=this.mousePitch.mousemoveWindow(s,a);g&&g.pitchDelta&&n.setPitch(n.getPitch()+g.pitchDelta)}},Ms.prototype.off=function(){var s=this.element;D.removeEventListener(s,"mousedown",this.mousedown),D.removeEventListener(s,"touchstart",this.touchstart,{passive:!1}),D.removeEventListener(s,"touchmove",this.touchmove),D.removeEventListener(s,"touchend",this.touchend),D.removeEventListener(s,"touchcancel",this.reset),this.offTemp()},Ms.prototype.offTemp=function(){D.enableDrag(),D.removeEventListener(i.window,"mousemove",this.mousemove),D.removeEventListener(i.window,"mouseup",this.mouseup)},Ms.prototype.mousedown=function(s){this.down(i.extend({},s,{ctrlKey:!0,preventDefault:function(){return s.preventDefault()}}),D.mousePos(this.element,s)),D.addEventListener(i.window,"mousemove",this.mousemove),D.addEventListener(i.window,"mouseup",this.mouseup)},Ms.prototype.mousemove=function(s){this.move(s,D.mousePos(this.element,s))},Ms.prototype.mouseup=function(s){this.mouseRotate.mouseupWindow(s),this.mousePitch&&this.mousePitch.mouseupWindow(s),this.offTemp()},Ms.prototype.touchstart=function(s){s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=D.touchPos(this.element,s.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return s.preventDefault()}},this._startPos))},Ms.prototype.touchmove=function(s){s.targetTouches.length!==1?this.reset():(this._lastPos=D.touchPos(this.element,s.targetTouches)[0],this.move({preventDefault:function(){return s.preventDefault()}},this._lastPos))},Ms.prototype.touchend=function(s){s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Ms.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Vs={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function xf(s,a,n){var l=s.classList;for(var g in Vs)l.remove("mapboxgl-"+n+"-anchor-"+g);l.add("mapboxgl-"+n+"-anchor-"+a)}var Bl,Vl=function(s){function a(n,l){if(s.call(this),(n instanceof i.window.HTMLElement||l)&&(n=i.extend({element:n},l)),i.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,n&&n.element)this._element=n.element,this._offset=i.Point.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=D.create("div"),this._element.setAttribute("aria-label","Map marker");var g=D.createNS("http://www.w3.org/2000/svg","svg");g.setAttributeNS(null,"display","block"),g.setAttributeNS(null,"height","41px"),g.setAttributeNS(null,"width","27px"),g.setAttributeNS(null,"viewBox","0 0 27 41");var w=D.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");var L=D.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"fill-rule","nonzero");var z=D.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"transform","translate(3.0, 29.0)"),z.setAttributeNS(null,"fill","#000000");for(var ue=0,Ee=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];ue<Ee.length;ue+=1){var Ke=Ee[ue],tt=D.createNS("http://www.w3.org/2000/svg","ellipse");tt.setAttributeNS(null,"opacity","0.04"),tt.setAttributeNS(null,"cx","10.5"),tt.setAttributeNS(null,"cy","5.80029008"),tt.setAttributeNS(null,"rx",Ke.rx),tt.setAttributeNS(null,"ry",Ke.ry),z.appendChild(tt)}var rt=D.createNS("http://www.w3.org/2000/svg","g");rt.setAttributeNS(null,"fill",this._color);var Ft=D.createNS("http://www.w3.org/2000/svg","path");Ft.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),rt.appendChild(Ft);var Nt=D.createNS("http://www.w3.org/2000/svg","g");Nt.setAttributeNS(null,"opacity","0.25"),Nt.setAttributeNS(null,"fill","#000000");var Kt=D.createNS("http://www.w3.org/2000/svg","path");Kt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Nt.appendChild(Kt);var jt=D.createNS("http://www.w3.org/2000/svg","g");jt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),jt.setAttributeNS(null,"fill","#FFFFFF");var Gt=D.createNS("http://www.w3.org/2000/svg","g");Gt.setAttributeNS(null,"transform","translate(8.0, 8.0)");var nr=D.createNS("http://www.w3.org/2000/svg","circle");nr.setAttributeNS(null,"fill","#000000"),nr.setAttributeNS(null,"opacity","0.25"),nr.setAttributeNS(null,"cx","5.5"),nr.setAttributeNS(null,"cy","5.5"),nr.setAttributeNS(null,"r","5.4999962");var rr=D.createNS("http://www.w3.org/2000/svg","circle");rr.setAttributeNS(null,"fill","#FFFFFF"),rr.setAttributeNS(null,"cx","5.5"),rr.setAttributeNS(null,"cy","5.5"),rr.setAttributeNS(null,"r","5.4999962"),Gt.appendChild(nr),Gt.appendChild(rr),L.appendChild(z),L.appendChild(rt),L.appendChild(Nt),L.appendChild(jt),L.appendChild(Gt),g.appendChild(L),g.setAttributeNS(null,"height",41*this._scale+"px"),g.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(g),this._offset=i.Point.convert(n&&n.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Lr){Lr.preventDefault()}),this._element.addEventListener("mousedown",function(Lr){Lr.preventDefault()}),xf(this._element,this._anchor,"marker"),this._popup=null}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.addTo=function(n){return this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},a.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),D.remove(this._element),this._popup&&this._popup.remove(),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(n){return this._lngLat=i.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},a.prototype.getElement=function(){return this._element},a.prototype.setPopup=function(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){var l=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[l,-1*(24.6+l)],"bottom-right":[-l,-1*(24.6+l)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=n,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},a.prototype._onKeyPress=function(n){var l=n.code,g=n.charCode||n.keyCode;l!=="Space"&&l!=="Enter"&&g!==32&&g!==13||this.togglePopup()},a.prototype._onMapClick=function(n){var l=n.originalEvent.target,g=this._element;this._popup&&(l===g||g.contains(l))&&this.togglePopup()},a.prototype.getPopup=function(){return this._popup},a.prototype.togglePopup=function(){var n=this._popup;return n?(n.isOpen()?n.remove():n.addTo(this._map),this):this},a.prototype._update=function(n){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Bc(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var l="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?l="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(l="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var g="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?g="rotateX(0deg)":this._pitchAlignment==="map"&&(g="rotateX("+this._map.getPitch()+"deg)"),n&&n.type!=="moveend"||(this._pos=this._pos.round()),D.setTransform(this._element,Vs[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+g+" "+l)}},a.prototype.getOffset=function(){return this._offset},a.prototype.setOffset=function(n){return this._offset=i.Point.convert(n),this._update(),this},a.prototype._onMove=function(n){if(!this._isDragging){var l=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.Event("dragstart"))),this.fire(new i.Event("drag")))},a.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new i.Event("dragend")),this._state="inactive"},a.prototype._addDragHandler=function(n){this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},a.prototype.setDraggable=function(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},a.prototype.isDraggable=function(){return this._draggable},a.prototype.setRotation=function(n){return this._rotation=n||0,this._update(),this},a.prototype.getRotation=function(){return this._rotation},a.prototype.setRotationAlignment=function(n){return this._rotationAlignment=n||"auto",this._update(),this},a.prototype.getRotationAlignment=function(){return this._rotationAlignment},a.prototype.setPitchAlignment=function(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this},a.prototype.getPitchAlignment=function(){return this._pitchAlignment},a}(i.Evented),Sc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},ls=0,Hu=!1,Vc=function(s){function a(n){s.call(this),this.options=i.extend({},Sc,n),i.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.onAdd=function(n){var l;return this._map=n,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),l=this._setupUI,Bl!==void 0?l(Bl):i.window.navigator.permissions!==void 0?i.window.navigator.permissions.query({name:"geolocation"}).then(function(g){l(Bl=g.state!=="denied")}):l(Bl=!!i.window.navigator.geolocation),this._container},a.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(i.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),D.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ls=0,Hu=!1},a.prototype._isOutOfMapMaxBounds=function(n){var l=this._map.getMaxBounds(),g=n.coords;return l&&(g.longitude<l.getWest()||g.longitude>l.getEast()||g.latitude<l.getSouth()||g.latitude>l.getNorth())},a.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},a.prototype._onSuccess=function(n){if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new i.Event("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new i.Event("geolocate",n)),this._finish()}},a.prototype._updateCamera=function(n){var l=new i.LngLat(n.coords.longitude,n.coords.latitude),g=n.coords.accuracy,w=this._map.getBearing(),L=i.extend({bearing:w},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(g),L,{geolocateSource:!0})},a.prototype._updateMarker=function(n){if(n){var l=new i.LngLat(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},a.prototype._updateCircleRadius=function(){var n=this._map._container.clientHeight/2,l=this._map.unproject([0,n]),g=this._map.unproject([1,n]),w=l.distanceTo(g),L=Math.ceil(2*this._accuracy/w);this._circleElement.style.width=L+"px",this._circleElement.style.height=L+"px"},a.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},a.prototype._onError=function(n){if(this._map){if(this.options.trackUserLocation)if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&Hu)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new i.Event("error",n)),this._finish()}},a.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},a.prototype._setupUI=function(n){var l=this;if(this._container.addEventListener("contextmenu",function(L){return L.preventDefault()}),this._geolocateButton=D.create("button","mapboxgl-ctrl-geolocate",this._container),D.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",n===!1){i.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var g=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=g,this._geolocateButton.setAttribute("aria-label",g)}else{var w=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=w,this._geolocateButton.setAttribute("aria-label",w)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=D.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Vl(this._dotElement),this._circleElement=D.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Vl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(L){L.geolocateSource||l._watchState!=="ACTIVE_LOCK"||L.originalEvent&&L.originalEvent.type==="resize"||(l._watchState="BACKGROUND",l._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),l._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),l.fire(new i.Event("trackuserlocationend")))})},a.prototype.trigger=function(){if(!this._setup)return i.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ls--,Hu=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var n;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++ls>1?(n={maximumAge:6e5,timeout:0},Hu=!0):(n=this.options.positionOptions,Hu=!1),this._geolocationWatchID=i.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,n)}}else i.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},a.prototype._clearWatch=function(){i.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},a}(i.Evented),Cl={maxWidth:100,unit:"metric"},Zu=function(a){this.options=i.extend({},Cl,a),i.bindAll(["_onMove","setUnit"],this)};function nc(s,a,n){var l=n&&n.maxWidth||100,g=s._container.clientHeight/2,w=s.unproject([0,g]),L=s.unproject([l,g]),z=w.distanceTo(L);if(n&&n.unit==="imperial"){var ue=3.2808*z;ue>5280?Wu(a,l,ue/5280,s._getUIString("ScaleControl.Miles")):Wu(a,l,ue,s._getUIString("ScaleControl.Feet"))}else n&&n.unit==="nautical"?Wu(a,l,z/1852,s._getUIString("ScaleControl.NauticalMiles")):z>=1e3?Wu(a,l,z/1e3,s._getUIString("ScaleControl.Kilometers")):Wu(a,l,z,s._getUIString("ScaleControl.Meters"))}function Wu(s,a,n,l){var g,w,L,z=(g=n,(w=Math.pow(10,(""+Math.floor(g)).length-1))*(L=(L=g/w)>=10?10:L>=5?5:L>=3?3:L>=2?2:L>=1?1:function(ue){var Ee=Math.pow(10,Math.ceil(-Math.log(ue)/Math.LN10));return Math.round(ue*Ee)/Ee}(L)));s.style.width=a*(z/n)+"px",s.innerHTML=z+"&nbsp;"+l}Zu.prototype.getDefaultPosition=function(){return"bottom-left"},Zu.prototype._onMove=function(){nc(this._map,this._container,this.options)},Zu.prototype.onAdd=function(s){return this._map=s,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",s.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Zu.prototype.onRemove=function(){D.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Zu.prototype.setUnit=function(s){this.options.unit=s,nc(this._map,this._container,this.options)};var Ps=function(a){this._fullscreen=!1,a&&a.container&&(a.container instanceof i.window.HTMLElement?this._container=a.container:i.warnOnce("Full screen control 'container' must be a DOM element.")),i.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in i.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in i.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in i.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in i.window.document&&(this._fullscreenchange="MSFullscreenChange")};Ps.prototype.onAdd=function(s){return this._map=s,this._container||(this._container=this._map.getContainer()),this._controlContainer=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Ps.prototype.onRemove=function(){D.remove(this._controlContainer),this._map=null,i.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Ps.prototype._checkFullscreenSupport=function(){return!!(i.window.document.fullscreenEnabled||i.window.document.mozFullScreenEnabled||i.window.document.msFullscreenEnabled||i.window.document.webkitFullscreenEnabled)},Ps.prototype._setupUI=function(){var s=this._fullscreenButton=D.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);D.create("span","mapboxgl-ctrl-icon",s).setAttribute("aria-hidden",!0),s.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),i.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Ps.prototype._updateTitle=function(){var s=this._getTitle();this._fullscreenButton.setAttribute("aria-label",s),this._fullscreenButton.title=s},Ps.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Ps.prototype._isFullscreen=function(){return this._fullscreen},Ps.prototype._changeIcon=function(){(i.window.document.fullscreenElement||i.window.document.mozFullScreenElement||i.window.document.webkitFullscreenElement||i.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Ps.prototype._onClickFullscreen=function(){this._isFullscreen()?i.window.document.exitFullscreen?i.window.document.exitFullscreen():i.window.document.mozCancelFullScreen?i.window.document.mozCancelFullScreen():i.window.document.msExitFullscreen?i.window.document.msExitFullscreen():i.window.document.webkitCancelFullScreen&&i.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var of={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ac=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),ic=function(s){function a(n){s.call(this),this.options=i.extend(Object.create(of),n),i.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.addTo=function(n){return this._map&&this.remove(),this._map=n,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new i.Event("open")),this},a.prototype.isOpen=function(){return!!this._map},a.prototype.remove=function(){return this._content&&D.remove(this._content),this._container&&(D.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new i.Event("close")),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(n){return this._lngLat=i.LngLat.convert(n),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},a.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},a.prototype.getElement=function(){return this._container},a.prototype.setText=function(n){return this.setDOMContent(i.window.document.createTextNode(n))},a.prototype.setHTML=function(n){var l,g=i.window.document.createDocumentFragment(),w=i.window.document.createElement("body");for(w.innerHTML=n;l=w.firstChild;)g.appendChild(l);return this.setDOMContent(g)},a.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},a.prototype.setMaxWidth=function(n){return this.options.maxWidth=n,this._update(),this},a.prototype.setDOMContent=function(n){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=D.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(n),this._createCloseButton(),this._update(),this._focusFirstElement(),this},a.prototype.addClassName=function(n){this._container&&this._container.classList.add(n)},a.prototype.removeClassName=function(n){this._container&&this._container.classList.remove(n)},a.prototype.setOffset=function(n){return this.options.offset=n,this._update(),this},a.prototype.toggleClassName=function(n){if(this._container)return this._container.classList.toggle(n)},a.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=D.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},a.prototype._onMouseUp=function(n){this._update(n.point)},a.prototype._onMouseMove=function(n){this._update(n.point)},a.prototype._onDrag=function(n){this._update(n.point)},a.prototype._update=function(n){var l=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=D.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=D.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(tt){return l._container.classList.add(tt)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Bc(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||n)){var g=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat),w=this.options.anchor,L=function tt(rt){if(rt){if(typeof rt=="number"){var Ft=Math.round(Math.sqrt(.5*Math.pow(rt,2)));return{center:new i.Point(0,0),top:new i.Point(0,rt),"top-left":new i.Point(Ft,Ft),"top-right":new i.Point(-Ft,Ft),bottom:new i.Point(0,-rt),"bottom-left":new i.Point(Ft,-Ft),"bottom-right":new i.Point(-Ft,-Ft),left:new i.Point(rt,0),right:new i.Point(-rt,0)}}if(rt instanceof i.Point||Array.isArray(rt)){var Nt=i.Point.convert(rt);return{center:Nt,top:Nt,"top-left":Nt,"top-right":Nt,bottom:Nt,"bottom-left":Nt,"bottom-right":Nt,left:Nt,right:Nt}}return{center:i.Point.convert(rt.center||[0,0]),top:i.Point.convert(rt.top||[0,0]),"top-left":i.Point.convert(rt["top-left"]||[0,0]),"top-right":i.Point.convert(rt["top-right"]||[0,0]),bottom:i.Point.convert(rt.bottom||[0,0]),"bottom-left":i.Point.convert(rt["bottom-left"]||[0,0]),"bottom-right":i.Point.convert(rt["bottom-right"]||[0,0]),left:i.Point.convert(rt.left||[0,0]),right:i.Point.convert(rt.right||[0,0])}}return tt(new i.Point(0,0))}(this.options.offset);if(!w){var z,ue=this._container.offsetWidth,Ee=this._container.offsetHeight;z=g.y+L.bottom.y<Ee?["top"]:g.y>this._map.transform.height-Ee?["bottom"]:[],g.x<ue/2?z.push("left"):g.x>this._map.transform.width-ue/2&&z.push("right"),w=z.length===0?"bottom":z.join("-")}var Ke=g.add(L[w]).round();D.setTransform(this._container,Vs[w]+" translate("+Ke.x+"px,"+Ke.y+"px)"),xf(this._container,w,"popup")}},a.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var n=this._container.querySelector(ac);n&&n.focus()}},a.prototype._onClose=function(){this.remove()},a}(i.Evented),oc={version:i.version,supported:Z,setRTLTextPlugin:i.setRTLTextPlugin,getRTLTextPluginStatus:i.getRTLTextPluginStatus,Map:fl,NavigationControl:Ou,GeolocateControl:Vc,AttributionControl:us,ScaleControl:Zu,FullscreenControl:Ps,Popup:ic,Marker:Vl,Style:Ri,LngLat:i.LngLat,LngLatBounds:i.LngLatBounds,Point:i.Point,MercatorCoordinate:i.MercatorCoordinate,Evented:i.Evented,config:i.config,prewarm:function(){er().acquire(cr)},clearPrewarmedResources:function(){var a=Mn;a&&(a.isPreloaded()&&a.numActive()===1?(a.release(cr),Mn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return i.config.ACCESS_TOKEN},set accessToken(s){i.config.ACCESS_TOKEN=s},get baseApiUrl(){return i.config.API_URL},set baseApiUrl(s){i.config.API_URL=s},get workerCount(){return Ur.workerCount},set workerCount(s){Ur.workerCount=s},get maxParallelImageRequests(){return i.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(s){i.config.MAX_PARALLEL_IMAGE_REQUESTS=s},clearStorage:function(a){i.clearTileCache(a)},workerUrl:""};return oc}),Y})},"4cb6":function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("xfSm");E.METADATA_KEY=b;var m=o("9Fde");E.Container=m.Container;var Y=o("FV85");E.BindingScopeEnum=Y.BindingScopeEnum,E.BindingTypeEnum=Y.BindingTypeEnum,E.TargetTypeEnum=Y.TargetTypeEnum;var F=o("dxzI");E.AsyncContainerModule=F.AsyncContainerModule,E.ContainerModule=F.ContainerModule;var i=o("cZ5Q");E.injectable=i.injectable;var Z=o("0gSV");E.tagged=Z.tagged;var D=o("ZzCi");E.named=D.named;var $=o("Yk9n");E.inject=$.inject,E.LazyServiceIdentifer=$.LazyServiceIdentifer;var te=o("jYx5");E.optional=te.optional;var fe=o("n2J3");E.unmanaged=fe.unmanaged;var K=o("jIg/");E.multiInject=K.multiInject;var Ge=o("oaX6");E.targetName=Ge.targetName;var pe=o("Sk89");E.postConstruct=pe.postConstruct;var Ze=o("wnjb");E.MetadataReader=Ze.MetadataReader;var Pe=o("d9O0");E.id=Pe.id;var mt=o("Ztfv");E.decorate=mt.decorate;var De=o("RR/i");E.traverseAncerstors=De.traverseAncerstors,E.taggedConstraint=De.taggedConstraint,E.namedConstraint=De.namedConstraint,E.typeConstraint=De.typeConstraint;var At=o("ujMp");E.getServiceIdentifierAsString=At.getServiceIdentifierAsString;var it=o("78VC");E.multiBindToService=it.multiBindToService},"4qC0":function(ze,E,o){var b=o("NykK"),m=o("Z0cm"),Y=o("ExA7"),F="[object String]";function i(Z){return typeof Z=="string"||!m(Z)&&Y(Z)&&b(Z)==F}ze.exports=i},"5Tg0":function(ze,E,o){(function(b){var m=o("Kz5y"),Y=E&&!E.nodeType&&E,F=Y&&typeof b=="object"&&b&&!b.nodeType&&b,i=F&&F.exports===Y,Z=i?m.Buffer:void 0,D=Z?Z.allocUnsafe:void 0;function $(te,fe){if(fe)return te.slice();var K=te.length,Ge=D?D(K):new te.constructor(K);return te.copy(Ge),Ge}b.exports=$}).call(this,o("YuTi")(ze))},"5gLl":function(ze,E,o){"use strict";o.d(E,"a",function(){return K});var b=o("lSNA"),m=o.n(b),Y=o("LvWW"),F=o.n(Y),i=o("AKIq"),Z=o.n(i),D=o("cWyK"),$=o.n(D);function te(Ge,pe){var Ze=Object.keys(Ge);if(Object.getOwnPropertySymbols){var Pe=Object.getOwnPropertySymbols(Ge);pe&&(Pe=Pe.filter(function(mt){return Object.getOwnPropertyDescriptor(Ge,mt).enumerable})),Ze.push.apply(Ze,Pe)}return Ze}function fe(Ge){for(var pe=1;pe<arguments.length;pe++){var Ze=arguments[pe]!=null?arguments[pe]:{};pe%2?te(Object(Ze),!0).forEach(function(Pe){m()(Ge,Pe,Ze[Pe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ge,Object.getOwnPropertyDescriptors(Ze)):te(Object(Ze)).forEach(function(Pe){Object.defineProperty(Ge,Pe,Object.getOwnPropertyDescriptor(Ze,Pe))})}return Ge}function K(Ge,pe){var Ze=[],Pe={};if(Ge.features=Ge.features.filter(function(De){var At=De.geometry;return De!=null&&At&&At.type&&At.coordinates&&At.coordinates.length>0}),F()(Ge,!0),Ge.features.length===0)return{dataArray:[],featureKeys:Pe};var mt=0;return D.flattenEach(Ge,function(De,At){var it=Object(i.getCoords)(De),vt=At,Je=fe(fe({},De.properties),{},{coordinates:it,_id:vt});Ze.push(Je)}),{dataArray:Ze,featureKeys:Pe}}},"5ku3":function(ze,E,o){"use strict";(function(b){o.d(E,"a",function(){return F});var m=o("U8pU"),Y=o("I0ug");function F(){var Z=(typeof b=="undefined"?"undefined":Object(m.a)(b))==="object"&&String(b)==="[object process]"&&!b.browser;return!Z||Object(Y.a)()}function i(){return F()&&typeof document!="undefined"}}).call(this,o("Q2Ig"))},"5zYK":function(ze,E,o){"use strict";o.d(E,"a",function(){return te});var b=o("lSNA"),m=o.n(b),Y=o("RIqP"),F=o.n(Y),i=o("LvWW"),Z=o.n(i);function D(fe,K){var Ge=Object.keys(fe);if(Object.getOwnPropertySymbols){var pe=Object.getOwnPropertySymbols(fe);K&&(pe=pe.filter(function(Ze){return Object.getOwnPropertyDescriptor(fe,Ze).enumerable})),Ge.push.apply(Ge,pe)}return Ge}function $(fe){for(var K=1;K<arguments.length;K++){var Ge=arguments[K]!=null?arguments[K]:{};K%2?D(Object(Ge),!0).forEach(function(pe){m()(fe,pe,Ge[pe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(fe,Object.getOwnPropertyDescriptors(Ge)):D(Object(Ge)).forEach(function(pe){Object.defineProperty(fe,pe,Object.getOwnPropertyDescriptor(Ge,pe))})}return fe}function te(fe,K){var Ge=K.x,pe=K.y,Ze=K.x1,Pe=K.y1,mt=K.coordinates,De=[];return fe.forEach(function(At,it){var vt=[];if(Ge&&pe&&(vt=[parseFloat(At[Ge]),parseFloat(At[pe])]),Ge&&pe&&Ze&&Pe){var Je=[parseFloat(At[Ge]),parseFloat(At[pe])],_t=[parseFloat(At[Ze]),parseFloat(At[Pe])];vt=[Je,_t]}if(mt){var wt="Polygon";Array.isArray(mt[0])||(wt="Point"),Array.isArray(mt[0])&&!Array.isArray(mt[0][0])&&(wt="LineString");var ke={type:wt,coordinates:F()(At[mt])};Z()(ke,!0),vt=ke.coordinates}var Re=$($({},At),{},{_id:it,coordinates:vt});De.push(Re)}),{dataArray:De}}},"6AGu":function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("FV85"),m=o("LKzl"),Y=function(){function F(i){this._binding=i}return F.prototype.inRequestScope=function(){return this._binding.scope=b.BindingScopeEnum.Request,new m.BindingWhenOnSyntax(this._binding)},F.prototype.inSingletonScope=function(){return this._binding.scope=b.BindingScopeEnum.Singleton,new m.BindingWhenOnSyntax(this._binding)},F.prototype.inTransientScope=function(){return this._binding.scope=b.BindingScopeEnum.Transient,new m.BindingWhenOnSyntax(this._binding)},F}();E.BindingInSyntax=Y},"6NqC":function(ze,E){},"6acW":function(ze,E,o){var b=o("dt0z"),m=o("gQMU");function Y(F){return m(b(F).toLowerCase())}ze.exports=Y},"6nK8":function(ze,E,o){var b=o("dVn5"),m=o("fo6e"),Y=o("dt0z"),F=o("9NmV");function i(Z,D,$){return Z=Y(Z),D=$?void 0:D,D===void 0?m(Z)?F(Z):b(Z):Z.match(D)||[]}ze.exports=i},"711d":function(ze,E){function o(b){return function(m){return m==null?void 0:m[b]}}ze.exports=o},"78VC":function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.multiBindToService=function(b){return function(m){return function(){for(var Y=[],F=0;F<arguments.length;F++)Y[F]=arguments[F];return Y.forEach(function(i){return b.bind(i).toService(m)})}}}},"7Ix3":function(ze,E){function o(b){var m=[];if(b!=null)for(var Y in Object(b))m.push(Y);return m}ze.exports=o},"7tbW":function(ze,E,o){var b=o("LGYb");function m(Y){return Y&&Y.length?b(Y):[]}ze.exports=m},"8/Fi":function(ze,E,o){"use strict";var b=o("J4zp"),m=o.n(b),Y=o("9nhX"),F=o.n(Y),i=["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"];function Z(ht){return i.indexOf(ht)}var D=2,$=4,te=64,fe=128,K=256,Ge=512,pe=8192,Ze=16384,Pe=32768,mt=32768*2,De=131072,At=262144,it=524288,vt=1048576,Je=2097152,_t=4194304,wt=8388608,ke=16777216,Re=16777216*2;function Ve(ht,Zt){return ht=F()(Math.floor(ht),0,255),Zt=F()(Math.floor(Zt),0,255),256*ht+Zt}function dt(ht){var Zt=ht.color,Qt=ht.radius,ur=ht.tileX,oe=ht.tileY,Q=ht.shape,H=ht.opacity,Se=ht.stroke,be=ht.strokeWidth,Te=ht.strokeOpacity,me=[],nt=[],Jt=[],Mt=[Ve(Zt[0],Zt[1]),Ve(Zt[2],Zt[3])],ve=[Ve(Se[0],Se[1]),Ve(Se[2],Se[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(ge){var He=m()(ge,2),ot=He[0],we=He[1];me.push([].concat(Mt,[(ot+1)*wt+(we+1)*Je+Z(Q)*De+Qt,(ur+512)*it+(oe+512)*te])),nt.push([].concat(ve,[be,Te])),Jt.push([H,0,0,0])}),{packedBuffer:me,packedBuffer2:nt,packedBuffer3:Jt}}function Me(ht,Zt){if(ht===0&&!Zt)return 0;if(ht===1&&Zt)return 4294967295;var Qt=Zt?1:0,ur=Math.floor(ht*127);return ur*Re+Qt*ke+ur*De+Qt*mt+ur*Ge+Qt*K+ur*D+Qt}},"88Gu":function(ze,E){var o=800,b=16,m=Date.now;function Y(F){var i=0,Z=0;return function(){var D=m(),$=b-(D-Z);if(Z=D,$>0){if(++i>=o)return arguments[0]}else i=0;return F.apply(void 0,arguments)}}ze.exports=Y},"8ml+":function(ze,E,o){"use strict";var b=o("h1nZ");o.o(b,"CityBuildingLayer")&&o.d(E,"CityBuildingLayer",function(){return b.CityBuildingLayer}),o.o(b,"Control")&&o.d(E,"Control",function(){return b.Control}),o.o(b,"HeatmapLayer")&&o.d(E,"HeatmapLayer",function(){return b.HeatmapLayer}),o.o(b,"ImageLayer")&&o.d(E,"ImageLayer",function(){return b.ImageLayer}),o.o(b,"LineLayer")&&o.d(E,"LineLayer",function(){return b.LineLayer}),o.o(b,"Logo")&&o.d(E,"Logo",function(){return b.Logo}),o.o(b,"Marker")&&o.d(E,"Marker",function(){return b.Marker}),o.o(b,"PointLayer")&&o.d(E,"PointLayer",function(){return b.PointLayer}),o.o(b,"PolygonLayer")&&o.d(E,"PolygonLayer",function(){return b.PolygonLayer}),o.o(b,"Popup")&&o.d(E,"Popup",function(){return b.Popup}),o.o(b,"RasterLayer")&&o.d(E,"RasterLayer",function(){return b.RasterLayer}),o.o(b,"Scale")&&o.d(E,"Scale",function(){return b.Scale}),o.o(b,"Scene")&&o.d(E,"Scene",function(){return b.Scene}),o.o(b,"Zoom")&&o.d(E,"Zoom",function(){return b.Zoom});var m=o("kQ+U");o.d(E,"Scene",function(){return m.a});var Y=o("sxDa");o.d(E,"CityBuildingLayer",function(){return Y.a}),o.d(E,"HeatmapLayer",function(){return Y.b}),o.d(E,"ImageLayer",function(){return Y.c}),o.d(E,"LineLayer",function(){return Y.d}),o.d(E,"PointLayer",function(){return Y.e}),o.d(E,"PolygonLayer",function(){return Y.f}),o.d(E,"RasterLayer",function(){return Y.g});var F=o("k5/I");o.d(E,"Control",function(){return F.a}),o.d(E,"Logo",function(){return F.b}),o.d(E,"Marker",function(){return F.c}),o.d(E,"Popup",function(){return F.d}),o.d(E,"Scale",function(){return F.e}),o.d(E,"Zoom",function(){return F.f});var i=o("Hel2"),Z=o("RL2/")},"8uyu":function(ze,E){},"9Fde":function(ze,E,o){"use strict";var b=this&&this.__awaiter||function(mt,De,At,it){return new(At||(At=Promise))(function(vt,Je){function _t(Re){try{ke(it.next(Re))}catch(Ve){Je(Ve)}}function wt(Re){try{ke(it.throw(Re))}catch(Ve){Je(Ve)}}function ke(Re){Re.done?vt(Re.value):new At(function(Ve){Ve(Re.value)}).then(_t,wt)}ke((it=it.apply(mt,De||[])).next())})},m=this&&this.__generator||function(mt,De){var At={label:0,sent:function(){if(Je[0]&1)throw Je[1];return Je[1]},trys:[],ops:[]},it,vt,Je,_t;return _t={next:wt(0),throw:wt(1),return:wt(2)},typeof Symbol=="function"&&(_t[Symbol.iterator]=function(){return this}),_t;function wt(Re){return function(Ve){return ke([Re,Ve])}}function ke(Re){if(it)throw new TypeError("Generator is already executing.");for(;At;)try{if(it=1,vt&&(Je=vt[Re[0]&2?"return":Re[0]?"throw":"next"])&&!(Je=Je.call(vt,Re[1])).done)return Je;(vt=0,Je)&&(Re=[0,Je.value]);switch(Re[0]){case 0:case 1:Je=Re;break;case 4:return At.label++,{value:Re[1],done:!1};case 5:At.label++,vt=Re[1],Re=[0];continue;case 7:Re=At.ops.pop(),At.trys.pop();continue;default:if(!(Je=At.trys,Je=Je.length>0&&Je[Je.length-1])&&(Re[0]===6||Re[0]===2)){At=0;continue}if(Re[0]===3&&(!Je||Re[1]>Je[0]&&Re[1]<Je[3])){At.label=Re[1];break}if(Re[0]===6&&At.label<Je[1]){At.label=Je[1],Je=Re;break}if(Je&&At.label<Je[2]){At.label=Je[2],At.ops.push(Re);break}Je[2]&&At.ops.pop(),At.trys.pop();continue}Re=De.call(mt,At)}catch(Ve){Re=[6,Ve],vt=0}finally{it=Je=0}if(Re[0]&5)throw Re[1];return{value:Re[0]?Re[1]:void 0,done:!0}}};Object.defineProperty(E,"__esModule",{value:!0});var Y=o("LgvC"),F=o("MON2"),i=o("FV85"),Z=o("xfSm"),D=o("wnjb"),$=o("h7MG"),te=o("aPG5"),fe=o("gzZq"),K=o("d9O0"),Ge=o("ujMp"),pe=o("HpQ9"),Ze=o("AwBQ"),Pe=function(){function mt(De){var At=De||{};if(typeof At!="object")throw new Error(""+F.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(At.defaultScope===void 0)At.defaultScope=i.BindingScopeEnum.Transient;else if(At.defaultScope!==i.BindingScopeEnum.Singleton&&At.defaultScope!==i.BindingScopeEnum.Transient&&At.defaultScope!==i.BindingScopeEnum.Request)throw new Error(""+F.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(At.autoBindInjectable===void 0)At.autoBindInjectable=!1;else if(typeof At.autoBindInjectable!="boolean")throw new Error(""+F.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(At.skipBaseClassChecks===void 0)At.skipBaseClassChecks=!1;else if(typeof At.skipBaseClassChecks!="boolean")throw new Error(""+F.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:At.autoBindInjectable,defaultScope:At.defaultScope,skipBaseClassChecks:At.skipBaseClassChecks},this.id=K.id(),this._bindingDictionary=new Ze.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new D.MetadataReader}return mt.merge=function(De,At){var it=new mt,vt=$.getBindingDictionary(it),Je=$.getBindingDictionary(De),_t=$.getBindingDictionary(At);function wt(ke,Re){ke.traverse(function(Ve,dt){dt.forEach(function(Me){Re.add(Me.serviceIdentifier,Me.clone())})})}return wt(Je,vt),wt(_t,vt),it},mt.prototype.load=function(){for(var De=[],At=0;At<arguments.length;At++)De[At]=arguments[At];for(var it=this._getContainerModuleHelpersFactory(),vt=0,Je=De;vt<Je.length;vt++){var _t=Je[vt],wt=it(_t.id);_t.registry(wt.bindFunction,wt.unbindFunction,wt.isboundFunction,wt.rebindFunction)}},mt.prototype.loadAsync=function(){for(var De=[],At=0;At<arguments.length;At++)De[At]=arguments[At];return b(this,void 0,void 0,function(){var it,vt,Je,_t,wt;return m(this,function(ke){switch(ke.label){case 0:it=this._getContainerModuleHelpersFactory(),vt=0,Je=De,ke.label=1;case 1:return vt<Je.length?(_t=Je[vt],wt=it(_t.id),[4,_t.registry(wt.bindFunction,wt.unbindFunction,wt.isboundFunction,wt.rebindFunction)]):[3,4];case 2:ke.sent(),ke.label=3;case 3:return vt++,[3,1];case 4:return[2]}})})},mt.prototype.unload=function(){for(var De=this,At=[],it=0;it<arguments.length;it++)At[it]=arguments[it];var vt=function(_t){return function(wt){return wt.moduleId===_t}};At.forEach(function(Je){var _t=vt(Je.id);De._bindingDictionary.removeByCondition(_t)})},mt.prototype.bind=function(De){var At=this.options.defaultScope||i.BindingScopeEnum.Transient,it=new Y.Binding(De,At);return this._bindingDictionary.add(De,it),new fe.BindingToSyntax(it)},mt.prototype.rebind=function(De){return this.unbind(De),this.bind(De)},mt.prototype.unbind=function(De){try{this._bindingDictionary.remove(De)}catch(At){throw new Error(F.CANNOT_UNBIND+" "+Ge.getServiceIdentifierAsString(De))}},mt.prototype.unbindAll=function(){this._bindingDictionary=new Ze.Lookup},mt.prototype.isBound=function(De){var At=this._bindingDictionary.hasKey(De);return!At&&this.parent&&(At=this.parent.isBound(De)),At},mt.prototype.isBoundNamed=function(De,At){return this.isBoundTagged(De,Z.NAMED_TAG,At)},mt.prototype.isBoundTagged=function(De,At,it){var vt=!1;if(this._bindingDictionary.hasKey(De)){var Je=this._bindingDictionary.get(De),_t=$.createMockRequest(this,De,At,it);vt=Je.some(function(wt){return wt.constraint(_t)})}return!vt&&this.parent&&(vt=this.parent.isBoundTagged(De,At,it)),vt},mt.prototype.snapshot=function(){this._snapshots.push(pe.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},mt.prototype.restore=function(){var De=this._snapshots.pop();if(De===void 0)throw new Error(F.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=De.bindings,this._middleware=De.middleware},mt.prototype.createChild=function(De){var At=new mt(De||this.options);return At.parent=this,At},mt.prototype.applyMiddleware=function(){for(var De=[],At=0;At<arguments.length;At++)De[At]=arguments[At];var it=this._middleware?this._middleware:this._planAndResolve();this._middleware=De.reduce(function(vt,Je){return Je(vt)},it)},mt.prototype.applyCustomMetadataReader=function(De){this._metadataReader=De},mt.prototype.get=function(De){return this._get(!1,!1,i.TargetTypeEnum.Variable,De)},mt.prototype.getTagged=function(De,At,it){return this._get(!1,!1,i.TargetTypeEnum.Variable,De,At,it)},mt.prototype.getNamed=function(De,At){return this.getTagged(De,Z.NAMED_TAG,At)},mt.prototype.getAll=function(De){return this._get(!0,!0,i.TargetTypeEnum.Variable,De)},mt.prototype.getAllTagged=function(De,At,it){return this._get(!1,!0,i.TargetTypeEnum.Variable,De,At,it)},mt.prototype.getAllNamed=function(De,At){return this.getAllTagged(De,Z.NAMED_TAG,At)},mt.prototype.resolve=function(De){var At=this.createChild();return At.bind(De).toSelf(),At.get(De)},mt.prototype._getContainerModuleHelpersFactory=function(){var De=this,At=function(ke,Re){ke._binding.moduleId=Re},it=function(ke){return function(Re){var Ve=De.bind.bind(De),dt=Ve(Re);return At(dt,ke),dt}},vt=function(ke){return function(Re){var Ve=De.unbind.bind(De);Ve(Re)}},Je=function(ke){return function(Re){var Ve=De.isBound.bind(De);return Ve(Re)}},_t=function(ke){return function(Re){var Ve=De.rebind.bind(De),dt=Ve(Re);return At(dt,ke),dt}};return function(wt){return{bindFunction:it(wt),isboundFunction:Je(wt),rebindFunction:_t(wt),unbindFunction:vt(wt)}}},mt.prototype._get=function(De,At,it,vt,Je,_t){var wt=null,ke={avoidConstraints:De,contextInterceptor:function(Ve){return Ve},isMultiInject:At,key:Je,serviceIdentifier:vt,targetType:it,value:_t};if(this._middleware){if(wt=this._middleware(ke),wt==null)throw new Error(F.INVALID_MIDDLEWARE_RETURN)}else wt=this._planAndResolve()(ke);return wt},mt.prototype._planAndResolve=function(){var De=this;return function(At){var it=$.plan(De._metadataReader,De,At.isMultiInject,At.targetType,At.serviceIdentifier,At.key,At.value,At.avoidConstraints);it=At.contextInterceptor(it);var vt=te.resolve(it);return vt}},mt}();E.Container=Pe},"9NmV":function(ze,E){var o="\\ud800-\\udfff",b="\\u0300-\\u036f",m="\\ufe20-\\ufe2f",Y="\\u20d0-\\u20ff",F=b+m+Y,i="\\u2700-\\u27bf",Z="a-z\\xdf-\\xf6\\xf8-\\xff",D="\\xac\\xb1\\xd7\\xf7",$="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",te="\\u2000-\\u206f",fe=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",K="A-Z\\xc0-\\xd6\\xd8-\\xde",Ge="\\ufe0e\\ufe0f",pe=D+$+te+fe,Ze="['\u2019]",Pe="["+pe+"]",mt="["+F+"]",De="\\d+",At="["+i+"]",it="["+Z+"]",vt="[^"+o+pe+De+i+Z+K+"]",Je="\\ud83c[\\udffb-\\udfff]",_t="(?:"+mt+"|"+Je+")",wt="[^"+o+"]",ke="(?:\\ud83c[\\udde6-\\uddff]){2}",Re="[\\ud800-\\udbff][\\udc00-\\udfff]",Ve="["+K+"]",dt="\\u200d",Me="(?:"+it+"|"+vt+")",ht="(?:"+Ve+"|"+vt+")",Zt="(?:"+Ze+"(?:d|ll|m|re|s|t|ve))?",Qt="(?:"+Ze+"(?:D|LL|M|RE|S|T|VE))?",ur=_t+"?",oe="["+Ge+"]?",Q="(?:"+dt+"(?:"+[wt,ke,Re].join("|")+")"+oe+ur+")*",H="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Se="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",be=oe+ur+Q,Te="(?:"+[At,ke,Re].join("|")+")"+be,me=RegExp([Ve+"?"+it+"+"+Zt+"(?="+[Pe,Ve,"$"].join("|")+")",ht+"+"+Qt+"(?="+[Pe,Ve+Me,"$"].join("|")+")",Ve+"?"+Me+"+"+Zt,Ve+"+"+Qt,Se,H,De,Te].join("|"),"g");function nt(Jt){return Jt.match(me)||[]}ze.exports=nt},"9lTW":function(ze,E,o){"use strict";(function(b){var m=o("MgzW");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function Y(Me,ht){if(Me===ht)return 0;for(var Zt=Me.length,Qt=ht.length,ur=0,oe=Math.min(Zt,Qt);ur<oe;++ur)if(Me[ur]!==ht[ur]){Zt=Me[ur],Qt=ht[ur];break}return Zt<Qt?-1:Qt<Zt?1:0}function F(Me){return b.Buffer&&typeof b.Buffer.isBuffer=="function"?b.Buffer.isBuffer(Me):!!(Me!=null&&Me._isBuffer)}var i=o("MCLT"),Z=Object.prototype.hasOwnProperty,D=Array.prototype.slice,$=function(){return function(){}.name==="foo"}();function te(Me){return Object.prototype.toString.call(Me)}function fe(Me){return F(Me)||typeof b.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(Me):Me?Me instanceof DataView?!0:!!(Me.buffer&&Me.buffer instanceof ArrayBuffer):!1}var K=ze.exports=At,Ge=/\s*function\s+([^\(\s]*)\s*/;function pe(Me){if(!i.isFunction(Me))return;if($)return Me.name;var ht=Me.toString(),Zt=ht.match(Ge);return Zt&&Zt[1]}K.AssertionError=function(ht){this.name="AssertionError",this.actual=ht.actual,this.expected=ht.expected,this.operator=ht.operator,ht.message?(this.message=ht.message,this.generatedMessage=!1):(this.message=mt(this),this.generatedMessage=!0);var Zt=ht.stackStartFunction||De;if(Error.captureStackTrace)Error.captureStackTrace(this,Zt);else{var Qt=new Error;if(Qt.stack){var ur=Qt.stack,oe=pe(Zt),Q=ur.indexOf(`
`+oe);if(Q>=0){var H=ur.indexOf(`
`,Q+1);ur=ur.substring(H+1)}this.stack=ur}}},i.inherits(K.AssertionError,Error);function Ze(Me,ht){return typeof Me=="string"?Me.length<ht?Me:Me.slice(0,ht):Me}function Pe(Me){if($||!i.isFunction(Me))return i.inspect(Me);var ht=pe(Me),Zt=ht?": "+ht:"";return"[Function"+Zt+"]"}function mt(Me){return Ze(Pe(Me.actual),128)+" "+Me.operator+" "+Ze(Pe(Me.expected),128)}function De(Me,ht,Zt,Qt,ur){throw new K.AssertionError({message:Zt,actual:Me,expected:ht,operator:Qt,stackStartFunction:ur})}K.fail=De;function At(Me,ht){Me||De(Me,!0,ht,"==",K.ok)}K.ok=At,K.equal=function(ht,Zt,Qt){ht!=Zt&&De(ht,Zt,Qt,"==",K.equal)},K.notEqual=function(ht,Zt,Qt){ht==Zt&&De(ht,Zt,Qt,"!=",K.notEqual)},K.deepEqual=function(ht,Zt,Qt){it(ht,Zt,!1)||De(ht,Zt,Qt,"deepEqual",K.deepEqual)},K.deepStrictEqual=function(ht,Zt,Qt){it(ht,Zt,!0)||De(ht,Zt,Qt,"deepStrictEqual",K.deepStrictEqual)};function it(Me,ht,Zt,Qt){if(Me===ht)return!0;if(F(Me)&&F(ht))return Y(Me,ht)===0;if(i.isDate(Me)&&i.isDate(ht))return Me.getTime()===ht.getTime();if(i.isRegExp(Me)&&i.isRegExp(ht))return Me.source===ht.source&&Me.global===ht.global&&Me.multiline===ht.multiline&&Me.lastIndex===ht.lastIndex&&Me.ignoreCase===ht.ignoreCase;if((Me===null||typeof Me!="object")&&(ht===null||typeof ht!="object"))return Zt?Me===ht:Me==ht;if(fe(Me)&&fe(ht)&&te(Me)===te(ht)&&!(Me instanceof Float32Array||Me instanceof Float64Array))return Y(new Uint8Array(Me.buffer),new Uint8Array(ht.buffer))===0;if(F(Me)!==F(ht))return!1;Qt=Qt||{actual:[],expected:[]};var ur=Qt.actual.indexOf(Me);return ur!==-1&&ur===Qt.expected.indexOf(ht)?!0:(Qt.actual.push(Me),Qt.expected.push(ht),Je(Me,ht,Zt,Qt))}function vt(Me){return Object.prototype.toString.call(Me)=="[object Arguments]"}function Je(Me,ht,Zt,Qt){if(Me==null||ht===null||ht===void 0)return!1;if(i.isPrimitive(Me)||i.isPrimitive(ht))return Me===ht;if(Zt&&Object.getPrototypeOf(Me)!==Object.getPrototypeOf(ht))return!1;var ur=vt(Me),oe=vt(ht);if(ur&&!oe||!ur&&oe)return!1;if(ur)return Me=D.call(Me),ht=D.call(ht),it(Me,ht,Zt);var Q=dt(Me),H=dt(ht),Se,be;if(Q.length!==H.length)return!1;for(Q.sort(),H.sort(),be=Q.length-1;be>=0;be--)if(Q[be]!==H[be])return!1;for(be=Q.length-1;be>=0;be--)if(Se=Q[be],!it(Me[Se],ht[Se],Zt,Qt))return!1;return!0}K.notDeepEqual=function(ht,Zt,Qt){it(ht,Zt,!1)&&De(ht,Zt,Qt,"notDeepEqual",K.notDeepEqual)},K.notDeepStrictEqual=_t;function _t(Me,ht,Zt){it(Me,ht,!0)&&De(Me,ht,Zt,"notDeepStrictEqual",_t)}K.strictEqual=function(ht,Zt,Qt){ht!==Zt&&De(ht,Zt,Qt,"===",K.strictEqual)},K.notStrictEqual=function(ht,Zt,Qt){ht===Zt&&De(ht,Zt,Qt,"!==",K.notStrictEqual)};function wt(Me,ht){if(!Me||!ht)return!1;if(Object.prototype.toString.call(ht)=="[object RegExp]")return ht.test(Me);try{if(Me instanceof ht)return!0}catch(Zt){}return Error.isPrototypeOf(ht)?!1:ht.call({},Me)===!0}function ke(Me){var ht;try{Me()}catch(Zt){ht=Zt}return ht}function Re(Me,ht,Zt,Qt){var ur;if(typeof ht!="function")throw new TypeError('"block" argument must be a function');typeof Zt=="string"&&(Qt=Zt,Zt=null),ur=ke(ht),Qt=(Zt&&Zt.name?" ("+Zt.name+").":".")+(Qt?" "+Qt:"."),Me&&!ur&&De(ur,Zt,"Missing expected exception"+Qt);var oe=typeof Qt=="string",Q=!Me&&i.isError(ur),H=!Me&&ur&&!Zt;if((Q&&oe&&wt(ur,Zt)||H)&&De(ur,Zt,"Got unwanted exception"+Qt),Me&&ur&&Zt&&!wt(ur,Zt)||!Me&&ur)throw ur}K.throws=function(Me,ht,Zt){Re(!0,Me,ht,Zt)},K.doesNotThrow=function(Me,ht,Zt){Re(!1,Me,ht,Zt)},K.ifError=function(Me){if(Me)throw Me};function Ve(Me,ht){Me||De(Me,!0,ht,"==",Ve)}K.strict=m(Ve,K,{equal:K.strictEqual,deepEqual:K.deepStrictEqual,notEqual:K.notStrictEqual,notDeepEqual:K.notDeepStrictEqual}),K.strict.strict=K.strict;var dt=Object.keys||function(Me){var ht=[];for(var Zt in Me)Z.call(Me,Zt)&&ht.push(Zt);return ht}}).call(this,o("yLpj"))},"9nhX":function(ze,E,o){var b=o("g4R6"),m=o("tLB3");function Y(F,i,Z){return Z===void 0&&(Z=i,i=void 0),Z!==void 0&&(Z=m(Z),Z=Z===Z?Z:0),i!==void 0&&(i=m(i),i=i===i?i:0),b(m(F),i,Z)}ze.exports=Y},AFH1:function(ze,E,o){"use strict";o.d(E,"a",function(){return b});var b;(function(m){m.TOPRIGHT="topright",m.TOPLEFT="topleft",m.BOTTOMRIGHT="bottomright",m.BOTTOMLEFT="bottomleft"})(b||(b={}))},AKIq:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("/rf6");function m(fe){if(!fe)throw new Error("coord is required");if(!Array.isArray(fe)){if(fe.type==="Feature"&&fe.geometry!==null&&fe.geometry.type==="Point")return fe.geometry.coordinates;if(fe.type==="Point")return fe.coordinates}if(Array.isArray(fe)&&fe.length>=2&&!Array.isArray(fe[0])&&!Array.isArray(fe[1]))return fe;throw new Error("coord must be GeoJSON Point or an Array of numbers")}E.getCoord=m;function Y(fe){if(Array.isArray(fe))return fe;if(fe.type==="Feature"){if(fe.geometry!==null)return fe.geometry.coordinates}else if(fe.coordinates)return fe.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}E.getCoords=Y;function F(fe){if(fe.length>1&&b.isNumber(fe[0])&&b.isNumber(fe[1]))return!0;if(Array.isArray(fe[0])&&fe[0].length)return F(fe[0]);throw new Error("coordinates must only contain numbers")}E.containsNumber=F;function i(fe,K,Ge){if(!K||!Ge)throw new Error("type and name required");if(!fe||fe.type!==K)throw new Error("Invalid input to "+Ge+": must be a "+K+", given "+fe.type)}E.geojsonType=i;function Z(fe,K,Ge){if(!fe)throw new Error("No feature passed");if(!Ge)throw new Error(".featureOf() requires a name");if(!fe||fe.type!=="Feature"||!fe.geometry)throw new Error("Invalid input to "+Ge+", Feature with geometry required");if(!fe.geometry||fe.geometry.type!==K)throw new Error("Invalid input to "+Ge+": must be a "+K+", given "+fe.geometry.type)}E.featureOf=Z;function D(fe,K,Ge){if(!fe)throw new Error("No featureCollection passed");if(!Ge)throw new Error(".collectionOf() requires a name");if(!fe||fe.type!=="FeatureCollection")throw new Error("Invalid input to "+Ge+", FeatureCollection required");for(var pe=0,Ze=fe.features;pe<Ze.length;pe++){var Pe=Ze[pe];if(!Pe||Pe.type!=="Feature"||!Pe.geometry)throw new Error("Invalid input to "+Ge+", Feature with geometry required");if(!Pe.geometry||Pe.geometry.type!==K)throw new Error("Invalid input to "+Ge+": must be a "+K+", given "+Pe.geometry.type)}}E.collectionOf=D;function $(fe){return fe.type==="Feature"?fe.geometry:fe}E.getGeom=$;function te(fe,K){return fe.type==="FeatureCollection"?"FeatureCollection":fe.type==="GeometryCollection"?"GeometryCollection":fe.type==="Feature"&&fe.geometry!==null?fe.geometry.type:fe.type}E.getType=te},APxj:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("Ucsi");function m(Y,F){F===void 0&&(F=!0);var i=b.makePropertyInjectDecorator(Y,F),Z=b.makePropertyInjectNamedDecorator(Y,F),D=b.makePropertyInjectTaggedDecorator(Y,F),$=b.makePropertyMultiInjectDecorator(Y,F);return{lazyInject:i,lazyInjectNamed:Z,lazyInjectTagged:D,lazyMultiInject:$}}E.default=m},AwBQ:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("MON2"),m=function(){function Y(){this._map=new Map}return Y.prototype.getMap=function(){return this._map},Y.prototype.add=function(F,i){if(F==null)throw new Error(b.NULL_ARGUMENT);if(i==null)throw new Error(b.NULL_ARGUMENT);var Z=this._map.get(F);Z!==void 0?(Z.push(i),this._map.set(F,Z)):this._map.set(F,[i])},Y.prototype.get=function(F){if(F==null)throw new Error(b.NULL_ARGUMENT);var i=this._map.get(F);if(i!==void 0)return i;throw new Error(b.KEY_NOT_FOUND)},Y.prototype.remove=function(F){if(F==null)throw new Error(b.NULL_ARGUMENT);if(!this._map.delete(F))throw new Error(b.KEY_NOT_FOUND)},Y.prototype.removeByCondition=function(F){var i=this;this._map.forEach(function(Z,D){var $=Z.filter(function(te){return!F(te)});$.length>0?i._map.set(D,$):i._map.delete(D)})},Y.prototype.hasKey=function(F){if(F==null)throw new Error(b.NULL_ARGUMENT);return this._map.has(F)},Y.prototype.clone=function(){var F=new Y;return this._map.forEach(function(i,Z){i.forEach(function(D){return F.add(Z,D.clone())})}),F},Y.prototype.traverse=function(F){this._map.forEach(function(i,Z){F(Z,i)})},Y}();E.Lookup=m},"B6l+":function(ze,E,o){var b=o("Sq3C"),m=o("Z1HP"),Y=o("Sxd8"),F=o("dt0z");function i(Z,D,$){Z=F(Z),D=Y(D);var te=D?m(Z):0;return D&&te<D?Z+b(D-te,$):Z}ze.exports=i},BGjm:function(ze,E){ze.exports=o;function o(b,m){m||(m=document);var Y=m.head||m.getElementsByTagName("head")[0];if(!Y){Y=m.createElement("head");var F=m.body||m.getElementsByTagName("body")[0];F?F.parentNode.insertBefore(Y,F):m.documentElement.appendChild(Y)}var i=m.createElement("style");return i.type="text/css",i.styleSheet?i.styleSheet.cssText=b:i.appendChild(m.createTextNode(b)),Y.appendChild(i),i}},BMrR:function(ze,E,o){"use strict";var b=o("qrJ5");E.a=b.a},BkRI:function(ze,E,o){var b=o("OBhP"),m=1,Y=4;function F(i){return b(i,m|Y)}ze.exports=F},BpBL:function(ze,E,o){"use strict";o.d(E,"a",function(){return m});var b=o("Hel2");function m(F,i){var Z=i.extent,D=new Promise(function(te){Y(F,function(fe){te(fe)})}),$={images:D,_id:1,dataArray:[{_id:0,coordinates:[[Z[0],Z[1]],[Z[2],Z[3]]]}]};return $}function Y(F,i){var Z=F,D=[];if(typeof Z=="string")Object(b.o)({url:Z},function(fe,K){D.push(K),i(D)});else{var $=Z.length,te=0;Z.forEach(function(fe){Object(b.o)({url:fe},function(K,Ge){te++,D.push(Ge),te===$&&i(D)})})}return m}},CZoQ:function(ze,E){function o(b,m,Y){for(var F=Y-1,i=b.length;++F<i;)if(b[F]===m)return F;return-1}ze.exports=o},"D+ow":function(ze,E){},D9lx:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("6AGu"),m=o("406g"),Y=o("z4Hk"),F=function(){function i(Z){this._binding=Z,this._bindingWhenSyntax=new Y.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new m.BindingOnSyntax(this._binding),this._bindingInSyntax=new b.BindingInSyntax(Z)}return i.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},i.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},i.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},i.prototype.when=function(Z){return this._bindingWhenSyntax.when(Z)},i.prototype.whenTargetNamed=function(Z){return this._bindingWhenSyntax.whenTargetNamed(Z)},i.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},i.prototype.whenTargetTagged=function(Z,D){return this._bindingWhenSyntax.whenTargetTagged(Z,D)},i.prototype.whenInjectedInto=function(Z){return this._bindingWhenSyntax.whenInjectedInto(Z)},i.prototype.whenParentNamed=function(Z){return this._bindingWhenSyntax.whenParentNamed(Z)},i.prototype.whenParentTagged=function(Z,D){return this._bindingWhenSyntax.whenParentTagged(Z,D)},i.prototype.whenAnyAncestorIs=function(Z){return this._bindingWhenSyntax.whenAnyAncestorIs(Z)},i.prototype.whenNoAncestorIs=function(Z){return this._bindingWhenSyntax.whenNoAncestorIs(Z)},i.prototype.whenAnyAncestorNamed=function(Z){return this._bindingWhenSyntax.whenAnyAncestorNamed(Z)},i.prototype.whenAnyAncestorTagged=function(Z,D){return this._bindingWhenSyntax.whenAnyAncestorTagged(Z,D)},i.prototype.whenNoAncestorNamed=function(Z){return this._bindingWhenSyntax.whenNoAncestorNamed(Z)},i.prototype.whenNoAncestorTagged=function(Z,D){return this._bindingWhenSyntax.whenNoAncestorTagged(Z,D)},i.prototype.whenAnyAncestorMatches=function(Z){return this._bindingWhenSyntax.whenAnyAncestorMatches(Z)},i.prototype.whenNoAncestorMatches=function(Z){return this._bindingWhenSyntax.whenNoAncestorMatches(Z)},i.prototype.onActivation=function(Z){return this._bindingOnSyntax.onActivation(Z)},i}();E.BindingInWhenOnSyntax=F},"Dw+G":function(ze,E,o){var b=o("juv8"),m=o("mTTR");function Y(F,i){return F&&b(i,m(i),F)}ze.exports=Y},DzJC:function(ze,E,o){var b=o("sEfC"),m=o("GoyQ"),Y="Expected a function";function F(i,Z,D){var $=!0,te=!0;if(typeof i!="function")throw new TypeError(Y);return m(D)&&($="leading"in D?!!D.leading:$,te="trailing"in D?!!D.trailing:te),b(i,Z,{leading:$,maxWait:Z,trailing:te})}ze.exports=F},EA7m:function(ze,E,o){var b=o("zZ0H"),m=o("Ioao"),Y=o("wclG");function F(i,Z){return Y(m(i,Z,b),i+"")}ze.exports=F},EEGq:function(ze,E,o){var b=o("juv8"),m=o("oCl/");function Y(F,i){return b(F,m(F),i)}ze.exports=Y},EfZ0:function(ze,E,o){"use strict";o.d(E,"a",function(){return b});var b={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"}},Em2t:function(ze,E,o){var b=o("bahg"),m=o("quyA"),Y=o("0JQy");function F(i){return m(i)?Y(i):b(i)}ze.exports=F},FI6e:function(ze,E){},FV85:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b={Request:"Request",Singleton:"Singleton",Transient:"Transient"};E.BindingScopeEnum=b;var m={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};E.BindingTypeEnum=m;var Y={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};E.TargetTypeEnum=Y},FmoU:function(ze,E,o){"use strict";o.d(E,"a",function(){return vt}),o.d(E,"b",function(){return ke});var b=function(Q,H,Se){Q.prototype=H.prototype=Se,Se.constructor=Q};function m(Q,H){var Se=Object.create(Q.prototype);for(var be in H)Se[be]=H[be];return Se}function Y(){}var F=.7,i=1/F,Z="\\s*([+-]?\\d+)\\s*",D="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",$="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",te=/^#([0-9a-f]{3,8})$/,fe=new RegExp("^rgb\\("+[Z,Z,Z]+"\\)$"),K=new RegExp("^rgb\\("+[$,$,$]+"\\)$"),Ge=new RegExp("^rgba\\("+[Z,Z,Z,D]+"\\)$"),pe=new RegExp("^rgba\\("+[$,$,$,D]+"\\)$"),Ze=new RegExp("^hsl\\("+[D,$,$]+"\\)$"),Pe=new RegExp("^hsla\\("+[D,$,$,D]+"\\)$"),mt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};b(Y,vt,{copy:function(H){return Object.assign(new this.constructor,this,H)},displayable:function(){return this.rgb().displayable()},hex:De,formatHex:De,formatHsl:At,formatRgb:it,toString:it});function De(){return this.rgb().formatHex()}function At(){return Zt(this).formatHsl()}function it(){return this.rgb().formatRgb()}function vt(Q){var H,Se;return Q=(Q+"").trim().toLowerCase(),(H=te.exec(Q))?(Se=H[1].length,H=parseInt(H[1],16),Se===6?Je(H):Se===3?new Re(H>>8&15|H>>4&240,H>>4&15|H&240,(H&15)<<4|H&15,1):Se===8?_t(H>>24&255,H>>16&255,H>>8&255,(H&255)/255):Se===4?_t(H>>12&15|H>>8&240,H>>8&15|H>>4&240,H>>4&15|H&240,((H&15)<<4|H&15)/255):null):(H=fe.exec(Q))?new Re(H[1],H[2],H[3],1):(H=K.exec(Q))?new Re(H[1]*255/100,H[2]*255/100,H[3]*255/100,1):(H=Ge.exec(Q))?_t(H[1],H[2],H[3],H[4]):(H=pe.exec(Q))?_t(H[1]*255/100,H[2]*255/100,H[3]*255/100,H[4]):(H=Ze.exec(Q))?ht(H[1],H[2]/100,H[3]/100,1):(H=Pe.exec(Q))?ht(H[1],H[2]/100,H[3]/100,H[4]):mt.hasOwnProperty(Q)?Je(mt[Q]):Q==="transparent"?new Re(NaN,NaN,NaN,0):null}function Je(Q){return new Re(Q>>16&255,Q>>8&255,Q&255,1)}function _t(Q,H,Se,be){return be<=0&&(Q=H=Se=NaN),new Re(Q,H,Se,be)}function wt(Q){return Q instanceof Y||(Q=vt(Q)),Q?(Q=Q.rgb(),new Re(Q.r,Q.g,Q.b,Q.opacity)):new Re}function ke(Q,H,Se,be){return arguments.length===1?wt(Q):new Re(Q,H,Se,be==null?1:be)}function Re(Q,H,Se,be){this.r=+Q,this.g=+H,this.b=+Se,this.opacity=+be}b(Re,ke,m(Y,{brighter:function(H){return H=H==null?i:Math.pow(i,H),new Re(this.r*H,this.g*H,this.b*H,this.opacity)},darker:function(H){return H=H==null?F:Math.pow(F,H),new Re(this.r*H,this.g*H,this.b*H,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ve,formatHex:Ve,formatRgb:dt,toString:dt}));function Ve(){return"#"+Me(this.r)+Me(this.g)+Me(this.b)}function dt(){var Q=this.opacity;return Q=isNaN(Q)?1:Math.max(0,Math.min(1,Q)),(Q===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(Q===1?")":", "+Q+")")}function Me(Q){return Q=Math.max(0,Math.min(255,Math.round(Q)||0)),(Q<16?"0":"")+Q.toString(16)}function ht(Q,H,Se,be){return be<=0?Q=H=Se=NaN:Se<=0||Se>=1?Q=H=NaN:H<=0&&(Q=NaN),new ur(Q,H,Se,be)}function Zt(Q){if(Q instanceof ur)return new ur(Q.h,Q.s,Q.l,Q.opacity);if(Q instanceof Y||(Q=vt(Q)),!Q)return new ur;if(Q instanceof ur)return Q;Q=Q.rgb();var H=Q.r/255,Se=Q.g/255,be=Q.b/255,Te=Math.min(H,Se,be),me=Math.max(H,Se,be),nt=NaN,Jt=me-Te,Mt=(me+Te)/2;return Jt?(H===me?nt=(Se-be)/Jt+(Se<be)*6:Se===me?nt=(be-H)/Jt+2:nt=(H-Se)/Jt+4,Jt/=Mt<.5?me+Te:2-me-Te,nt*=60):Jt=Mt>0&&Mt<1?0:nt,new ur(nt,Jt,Mt,Q.opacity)}function Qt(Q,H,Se,be){return arguments.length===1?Zt(Q):new ur(Q,H,Se,be==null?1:be)}function ur(Q,H,Se,be){this.h=+Q,this.s=+H,this.l=+Se,this.opacity=+be}b(ur,Qt,m(Y,{brighter:function(H){return H=H==null?i:Math.pow(i,H),new ur(this.h,this.s,this.l*H,this.opacity)},darker:function(H){return H=H==null?F:Math.pow(F,H),new ur(this.h,this.s,this.l*H,this.opacity)},rgb:function(){var H=this.h%360+(this.h<0)*360,Se=isNaN(H)||isNaN(this.s)?0:this.s,be=this.l,Te=be+(be<.5?be:1-be)*Se,me=2*be-Te;return new Re(oe(H>=240?H-240:H+120,me,Te),oe(H,me,Te),oe(H<120?H+240:H-120,me,Te),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var H=this.opacity;return H=isNaN(H)?1:Math.max(0,Math.min(1,H)),(H===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(H===1?")":", "+H+")")}}));function oe(Q,H,Se){return(Q<60?H+(Se-H)*Q/60:Q<180?Se:Q<240?H+(Se-H)*(240-Q)/60:H)*255}},G6z8:function(ze,E,o){var b=o("fR/l"),m=o("oCl/"),Y=o("mTTR");function F(i){return b(i,Y,m)}ze.exports=F},GXnB:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("xfSm"),m=function(){function Y(F,i){this.key=F,this.value=i}return Y.prototype.toString=function(){return this.key===b.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},Y}();E.Metadata=m},Gi0A:function(ze,E,o){var b=o("QqLw"),m=o("ExA7"),Y="[object Map]";function F(i){return m(i)&&b(i)==Y}ze.exports=F},HTcj:function(ze,E,o){"use strict";var b=o("GNNt"),m=o("wEI+"),Y={"ant-pro-grid-content":"ant-pro-grid-content",wide:"wide"},F=o("q1tI"),i=o.n(F),Z=o("TSYQ"),D=o.n(Z),$=o("jYQm"),te=function(Ge){var pe=Object(F.useContext)($.a),Ze=Ge.children,Pe=Ge.contentWidth,mt=Ge.className,De=Ge.style,At=Object(F.useContext)(m.b.ConfigContext),it=At.getPrefixCls,vt=Ge.prefixCls||it("pro"),Je=Pe||pe.contentWidth,_t="".concat(vt,"-grid-content");return i.a.createElement("div",{className:D()(_t,mt,{wide:Je==="Fixed"}),style:De},i.a.createElement("div",{className:"".concat(vt,"-grid-content-children")},Ze))},fe=E.a=te},Hel2:function(ze,E,o){"use strict";o.d(E,"o",function(){return Mt}),o.d(E,"m",function(){return we}),o.d(E,"p",function(){return q}),o.d(E,"d",function(){return at}),o.d(E,"q",function(){return J}),o.d(E,"r",function(){return ne}),o.d(E,"j",function(){return et}),o.d(E,"h",function(){return kt}),o.d(E,"b",function(){return dr}),o.d(E,"i",function(){return Ye}),o.d(E,"s",function(){return bt}),o.d(E,"k",function(){return Et}),o.d(E,"l",function(){return Fe}),o.d(E,"n",function(){return pt}),o.d(E,"f",function(){return yt}),o.d(E,"e",function(){return Ht}),o.d(E,"g",function(){return hr}),o.d(E,"a",function(){return b}),o.d(E,"c",function(){return m});var b={};o.r(b),o.d(b,"getContainer",function(){return Z}),o.d(b,"trim",function(){return D}),o.d(b,"splitWords",function(){return $}),o.d(b,"create",function(){return fe}),o.d(b,"remove",function(){return K}),o.d(b,"addClass",function(){return Ge}),o.d(b,"removeClass",function(){return pe}),o.d(b,"hasClass",function(){return Ze}),o.d(b,"setClass",function(){return Pe}),o.d(b,"getClass",function(){return mt}),o.d(b,"empty",function(){return De}),o.d(b,"setTransform",function(){return it}),o.d(b,"triggerResize",function(){return vt}),o.d(b,"printCanvas",function(){return Je});var m={};o.r(m),o.d(m,"sum",function(){return Bn}),o.d(m,"max",function(){return Hr}),o.d(m,"min",function(){return gr}),o.d(m,"mean",function(){return zn}),o.d(m,"mode",function(){return oa}),o.d(m,"statMap",function(){return $n}),o.d(m,"getColumn",function(){return Yn}),o.d(m,"getSatByColumn",function(){return On});function Y(U){var W=131,le=137,xe=0;U+="x";for(var st=Math.floor(9007199254740991/le),Ct=0;Ct<U.length;Ct++)xe>st&&(xe=Math.floor(xe/le)),xe=xe*W+U.charCodeAt(Ct);return xe}function F(U){U=U.toString();for(var W=5381,le=U.length;le;)W=W*33^U.charCodeAt(--le);return W>>>0}var i=window.document.documentElement.style;function Z(U){var W=U;return typeof U=="string"&&(W=document.getElementById(U)),W}function D(U){return U.trim?U.trim():U.replace(/^\s+|\s+$/g,"")}function $(U){return D(U).split(/\s+/)}function te(U){if(!i)return U[0];for(var W in U)if(U[W]&&U[W]in i)return U[W];return U[0]}function fe(U,W,le){var xe=document.createElement(U);return xe.className=W||"",le&&le.appendChild(xe),xe}function K(U){var W=U.parentNode;W&&W.removeChild(U)}function Ge(U,W){if(U.classList!==void 0)for(var le=$(W),xe=0,st=le.length;xe<st;xe++)U.classList.add(le[xe]);else if(!Ze(U,W)){var Ct=mt(U);Pe(U,(Ct?Ct+" ":"")+W)}}function pe(U,W){U.classList!==void 0?U.classList.remove(W):Pe(U,D((" "+mt(U)+" ").replace(" "+W+" "," ")))}function Ze(U,W){if(U.classList!==void 0)return U.classList.contains(W);var le=mt(U);return le.length>0&&new RegExp("(^|\\s)"+W+"(\\s|$)").test(le)}function Pe(U,W){U instanceof HTMLElement?U.className=W:U.className.baseVal=W}function mt(U){return U instanceof SVGElement&&(U=U.correspondingElement),U.className.baseVal===void 0?U.className:U.className.baseVal}function De(U){for(;U&&U.firstChild;)U.removeChild(U.firstChild)}var At=te(["transform","WebkitTransform"]);function it(U,W){U.style[At]=W}function vt(){if(typeof Event=="function")window.dispatchEvent(new Event("resize"));else{var U=window.document.createEvent("UIEvents");U.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(U)}}function Je(U){var W=["padding: "+(U.height/2-8)+"px "+U.width/2+"px;","line-height: "+U.height+"px;","background-image: url("+U.toDataURL()+");"];console.log(`%c
`,W.join(""))}var _t=o("lwsE"),wt=o.n(_t),ke=o("W8MJ"),Re=o.n(ke),Ve=o("7W2i"),dt=o.n(Ve),Me=o("a1gu"),ht=o.n(Me),Zt=o("Nsbk"),Qt=o.n(Zt),ur=o("oShl"),oe=o.n(ur);function Q(U){var W=H();return function(){var xe=Qt()(U),st;if(W){var Ct=Qt()(this).constructor;st=Reflect.construct(xe,arguments,Ct)}else st=xe.apply(this,arguments);return ht()(this,st)}}function H(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(U){return!1}}var Se=function(U){dt()(le,U);var W=Q(le);function le(xe,st,Ct){var Bt;return wt()(this,le),Bt=W.call(this,xe),Bt.status=void 0,Bt.url=void 0,Bt.status=st,Bt.url=Ct,Bt.name=Bt.constructor.name,Bt.message=xe,Bt}return Re()(le,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}]),le}(oe()(Error));function be(U){var W=new XMLHttpRequest;W.open("GET",U.url,!0);for(var le in U.headers)U.headers.hasOwnProperty(le)&&W.setRequestHeader(le,U.headers[le]);return W.withCredentials=U.credentials==="include",W}var Te=function(W,le){var xe=be(W);return xe.setRequestHeader("Accept","application/json"),xe.onerror=function(){le(new Error(xe.statusText))},xe.onload=function(){if(xe.status>=200&&xe.status<300&&xe.response){var st;try{st=JSON.parse(xe.response)}catch(Ct){return le(Ct)}le(null,st)}else xe.status===401?le(new Se("".concat(xe.statusText),xe.status,W.url)):le(new Se(xe.statusText,xe.status,W.url))},xe.send(),xe},me=function(W,le){var xe=be(W);return xe.responseType="arraybuffer",xe.onerror=function(){le(new Error(xe.statusText))},xe.onload=function(){var st=xe.response;if(st.byteLength===0&&xe.status===200)return le(new Error("http status 200 returned without content."));xe.status>=200&&xe.status<300&&xe.response?le(null,{data:st,cacheControl:xe.getResponseHeader("Cache-Control"),expires:xe.getResponseHeader("Expires")}):le(new Se(xe.statusText,xe.status,W.url))},xe.send(),xe};function nt(U){var W=window.document.createElement("a");return W.href=U,W.protocol===window.document.location.protocol&&W.host===window.document.location.host}var Jt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",Mt=function(W,le){return me(W,function(xe,st){if(xe)le(xe);else if(st){var Ct=new window.Image;Ct.crossOrigin="anonymous";var Bt=window.URL||window.webkitURL;Ct.onload=function(){le(null,Ct),Bt.revokeObjectURL(Ct.src)};var Xe=new window.Blob([new Uint8Array(st.data)],{type:"image/png"});Ct.src=st.data.byteLength?Bt.createObjectURL(Xe):Jt}})},ve=o("J4zp"),ge=o.n(ve),He=o("/rf6"),ot=2*Math.PI*6378137/2;function we(U){var W=[Infinity,Infinity,-Infinity,-Infinity];return U.forEach(function(le){var xe=le.coordinates;gt(W,xe)}),W}function gt(U,W){return Array.isArray(W[0])?W.forEach(function(le){gt(U,le)}):(U[0]>W[0]&&(U[0]=W[0]),U[1]>W[1]&&(U[1]=W[1]),U[2]<W[0]&&(U[2]=W[0]),U[3]<W[1]&&(U[3]=W[1])),U}function C(U,W){return R(U,W)}function R(U,W){return Array.isArray(U[0])?U.map(function(le){return R(le,W)}):W(U)}function q(U){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,le=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};U=Tt(U,W);var xe=U[0],st=U[1],Ct=xe*ot/180,Bt=Math.log(Math.tan((90+st)*Math.PI/360))/(Math.PI/180);return Bt=Bt*ot/180,le.enable&&(Ct=Number(Ct.toFixed(le.decimal)),Bt=Number(Bt.toFixed(le.decimal))),U.length===3?[Ct,Bt,U[2]]:[Ct,Bt]}function ce(U){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,le=U[0],xe=U[1],st=le/ot*180,Ct=xe/ot*180;return Ct=180/Math.PI*(2*Math.atan(Math.exp(Ct*Math.PI/180))-Math.PI/2),W!=null&&(st=Number(st.toFixed(W)),Ct=Number(Ct.toFixed(W))),U.length===3?[st,Ct,U[2]]:[st,Ct]}function We(U){if(U==null)throw new Error("lng is required");return(U>180||U<-180)&&(U=U%360,U>180&&(U=-360+U),U<-180&&(U=360+U),U===0&&(U=0)),U}function qe(U){if(U==null)throw new Error("lat is required");return(U>90||U<-90)&&(U=U%180,U>90&&(U=-180+U),U<-90&&(U=180+U),U===0&&(U=0)),U}function Tt(U,W){if(W===!1)return U;var le=We(U[0]),xe=qe(U[1]);return xe>85&&(xe=85),xe<-85&&(xe=-85),U.length===3?[le,xe,U[2]]:[le,xe]}function at(U){var W=85.0511287798,le=Math.max(Math.min(W,U[1]),-W),xe=256<<20,st=Math.PI/180,Ct=U[0]*st,Bt=le*st;Bt=Math.log(Math.tan(Math.PI/4+Bt/2));var Xe=.5/Math.PI,Lt=.5,lr=-.5/Math.PI;return st=.5,Ct=xe*(Xe*Ct+Lt),Bt=xe*(lr*Bt+st),[Math.floor(Ct),Math.floor(Bt)]}function Ut(U){var W=.5/Math.PI,le=.5,xe=-.5/Math.PI,st=.5,Ct=256<<20,Bt=ge()(U,2),Xe=Bt[0],Lt=Bt[1];Xe=(Xe/Ct-le)/W,Lt=(Lt/Ct-st)/xe,Lt=(Math.atan(Math.pow(Math.E,Lt))-Math.PI/4)*2,st=Math.PI/180;var lr=Lt/st,zr=Xe/st;return[zr,lr]}function J(U,W,le){var xe=Object(He.degreesToRadians)(W[1]-U[1]),st=Object(He.degreesToRadians)(W[0]-U[0]),Ct=Object(He.degreesToRadians)(U[1]),Bt=Object(He.degreesToRadians)(W[1]),Xe=Math.pow(Math.sin(xe/2),2)+Math.pow(Math.sin(st/2),2)*Math.cos(Ct)*Math.cos(Bt);return Object(He.radiansToLength)(2*Math.atan2(Math.sqrt(Xe),Math.sqrt(1-Xe)),le="meters")}function Qe(U){var W=Math.PI/180,le=85.0511287798,xe=6378137,st=Math.max(Math.min(le,U[1]),-le),Ct=Math.sin(st*W),Bt=xe*U[0]*W,Xe=xe*Math.log((1+Ct)/(1-Ct))/2;return[Bt,Xe]}function ne(U,W){var le=Math.abs(U[1][1]-U[0][1])*W,xe=Math.abs(U[1][0]-U[0][0])*W;return[[U[0][0]-xe,U[0][1]-le],[U[1][0]+xe,U[1][1]+le]]}function et(U,W){return U[0][0]<=W[0][0]&&U[0][1]<=W[0][1]&&U[1][0]>=W[1][0]&&U[1][1]>=W[1][1]}function kt(U){return[[U[0],U[1]],[U[2],U[3]]]}var dr=function(){function U(){var W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,le=arguments.length>1?arguments[1]:void 0;wt()(this,U),this.limit=void 0,this.cache=void 0,this.destroy=void 0,this.order=void 0,this.limit=W,this.destroy=le||this.defaultDestroy,this.order=[],this.clear()}return Re()(U,[{key:"clear",value:function(){var le=this;this.order.forEach(function(xe){le.delete(xe)}),this.cache={},this.order=[]}},{key:"get",value:function(le){var xe=this.cache[le];return xe&&(this.deleteOrder(le),this.appendOrder(le)),xe}},{key:"set",value:function(le,xe){this.cache[le]?(this.delete(le),this.cache[le]=xe,this.appendOrder(le)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[le]=xe,this.appendOrder(le))}},{key:"delete",value:function(le){var xe=this.cache[le];xe&&(this.deleteCache(le),this.deleteOrder(le),this.destroy(xe,le))}},{key:"deleteCache",value:function(le){delete this.cache[le]}},{key:"deleteOrder",value:function(le){var xe=this.order.findIndex(function(st){return st===le});xe>=0&&this.order.splice(xe,1)}},{key:"appendOrder",value:function(le){this.order.push(le)}},{key:"defaultDestroy",value:function(le,xe){return null}}]),U}();function Ye(U,W){U.forEach(function(le){if(!W[le])return;W[le]=W[le].bind(W)})}var xt=o("FmoU");function bt(U){var W=xt.a(U),le=[0,0,0,0];return W!=null&&(le[0]=W.r/255,le[1]=W.g/255,le[2]=W.b/255,le[3]=W.opacity),le}function Et(U){var W=U&&U[0],le=U&&U[1],xe=U&&U[2],st=W+le*256+xe*65536-1;return st}function Fe(U){return[U+1&255,U+1>>8&255,U+1>>8>>8&255]}function pt(U){var W=document.createElement("canvas"),le=W.getContext("2d");W.width=256,W.height=1;for(var xe=le.createLinearGradient(0,0,256,1),st=null,Ct=U.positions[0],Bt=U.positions[U.positions.length-1],Xe=0;Xe<U.colors.length;++Xe){var Lt=(U.positions[Xe]-Ct)/(Bt-Ct);xe.addColorStop(Lt,U.colors[Xe])}return le.fillStyle=xe,le.fillRect(0,0,256,1),st=new Uint8ClampedArray(le.getImageData(0,0,256,1).data),new ImageData(st,256,1)}var yt;(function(U){U.CENTER="center",U.TOP="top",U["TOP-LEFT"]="top-left",U["TOP-RIGHT"]="top-right",U.BOTTOM="bottom",U["BOTTOM-LEFT"]="bottom-left",U.LEFT="left",U.RIGHT="right"})(yt||(yt={}));var Ht={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function hr(U,W,le){var xe=U.classList;for(var st in Ht)Ht.hasOwnProperty(st)&&xe.remove("l7-".concat(le,"-anchor-").concat(st));xe.add("l7-".concat(le,"-anchor-").concat(W))}function Hr(U){if(U.length===0)throw new Error("max requires at least one data point");for(var W=U[0],le=1;le<U.length;le++)U[le]>W&&(W=U[le]);return W*1}function gr(U){if(U.length===0)throw new Error("min requires at least one data point");for(var W=U[0],le=1;le<U.length;le++)U[le]<W&&(W=U[le]);return W*1}function Bn(U){if(U.length===0)return 0;for(var W=U[0]*1,le=1;le<U.length;le++)W+=U[le]*1;return W}function zn(U){if(U.length===0)throw new Error("mean requires at least one data point");return Bn(U)/U.length}function oa(U){if(U.length===0)throw new Error("mean requires at least one data point");if(U.length<3)return U[0];U.sort();for(var W=U[0],le=NaN,xe=0,st=1,Ct=1;Ct<U.length+1;Ct++)U[Ct]!==W?(st>xe&&(xe=st,le=W),st=1,W=U[Ct]):st++;return le*1}var $n={min:gr,max:Hr,mean:zn,sum:Bn,mode:oa};function Yn(U,W){return U.map(function(le){return le[W]})}function On(U,W){return $n[U](W)}},HpQ9:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=function(){function m(){}return m.of=function(Y,F){var i=new m;return i.bindings=Y,i.middleware=F,i},m}();E.ContainerSnapshot=b},HthE:function(ze,E,o){"use strict";o.d(E,"a",function(){return b}),o.d(E,"b",function(){return m});var b;(function(Y){Y[Y.LNGLAT=1]="LNGLAT",Y[Y.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",Y[Y.VECTOR_TILE=3]="VECTOR_TILE",Y[Y.IDENTITY=4]="IDENTITY",Y[Y.P20=5]="P20",Y[Y.P20_OFFSET=6]="P20_OFFSET",Y[Y.METER_OFFSET=7]="METER_OFFSET"})(b||(b={}));var m={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter"}},I0ug:function(ze,E,o){"use strict";(function(b){o.d(E,"a",function(){return Y});var m=o("U8pU");function Y(F){if(typeof window!="undefined"&&Object(m.a)(window.process)==="object"&&window.process.type==="renderer")return!0;if(typeof b!="undefined"&&Object(m.a)(b.versions)==="object"&&Boolean(b.versions.electron))return!0;var i=(typeof navigator=="undefined"?"undefined":Object(m.a)(navigator))==="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,Z=F||i;return!!(Z&&Z.indexOf("Electron")>=0)}}).call(this,o("Q2Ig"))},IOcx:function(ze,E,o){"use strict";o.d(E,"a",function(){return b}),o.d(E,"b",function(){return ht}),o.d(E,"c",function(){return Zt}),o.d(E,"d",function(){return Qt}),o.d(E,"e",function(){return ur});var b={};o.r(b),o.d(b,"create",function(){return Y}),o.d(b,"clone",function(){return F}),o.d(b,"copy",function(){return i}),o.d(b,"identity",function(){return Z}),o.d(b,"fromValues",function(){return D}),o.d(b,"set",function(){return $}),o.d(b,"transpose",function(){return te}),o.d(b,"invert",function(){return fe}),o.d(b,"adjoint",function(){return K}),o.d(b,"determinant",function(){return Ge}),o.d(b,"multiply",function(){return pe}),o.d(b,"rotate",function(){return Ze}),o.d(b,"scale",function(){return Pe}),o.d(b,"fromRotation",function(){return mt}),o.d(b,"fromScaling",function(){return De}),o.d(b,"str",function(){return At}),o.d(b,"frob",function(){return it}),o.d(b,"LDU",function(){return vt}),o.d(b,"add",function(){return Je}),o.d(b,"subtract",function(){return _t}),o.d(b,"exactEquals",function(){return wt}),o.d(b,"equals",function(){return ke}),o.d(b,"multiplyScalar",function(){return Re}),o.d(b,"multiplyScalarAndAdd",function(){return Ve}),o.d(b,"mul",function(){return dt}),o.d(b,"sub",function(){return Me});var m=o("yU0y");function Y(){var oe=new m.a(4);return m.a!=Float32Array&&(oe[1]=0,oe[2]=0),oe[0]=1,oe[3]=1,oe}function F(oe){var Q=new m.a(4);return Q[0]=oe[0],Q[1]=oe[1],Q[2]=oe[2],Q[3]=oe[3],Q}function i(oe,Q){return oe[0]=Q[0],oe[1]=Q[1],oe[2]=Q[2],oe[3]=Q[3],oe}function Z(oe){return oe[0]=1,oe[1]=0,oe[2]=0,oe[3]=1,oe}function D(oe,Q,H,Se){var be=new m.a(4);return be[0]=oe,be[1]=Q,be[2]=H,be[3]=Se,be}function $(oe,Q,H,Se,be){return oe[0]=Q,oe[1]=H,oe[2]=Se,oe[3]=be,oe}function te(oe,Q){if(oe===Q){var H=Q[1];oe[1]=Q[2],oe[2]=H}else oe[0]=Q[0],oe[1]=Q[2],oe[2]=Q[1],oe[3]=Q[3];return oe}function fe(oe,Q){var H=Q[0],Se=Q[1],be=Q[2],Te=Q[3],me=H*Te-be*Se;return me?(me=1/me,oe[0]=Te*me,oe[1]=-Se*me,oe[2]=-be*me,oe[3]=H*me,oe):null}function K(oe,Q){var H=Q[0];return oe[0]=Q[3],oe[1]=-Q[1],oe[2]=-Q[2],oe[3]=H,oe}function Ge(oe){return oe[0]*oe[3]-oe[2]*oe[1]}function pe(oe,Q,H){var Se=Q[0],be=Q[1],Te=Q[2],me=Q[3],nt=H[0],Jt=H[1],Mt=H[2],ve=H[3];return oe[0]=Se*nt+Te*Jt,oe[1]=be*nt+me*Jt,oe[2]=Se*Mt+Te*ve,oe[3]=be*Mt+me*ve,oe}function Ze(oe,Q,H){var Se=Q[0],be=Q[1],Te=Q[2],me=Q[3],nt=Math.sin(H),Jt=Math.cos(H);return oe[0]=Se*Jt+Te*nt,oe[1]=be*Jt+me*nt,oe[2]=Se*-nt+Te*Jt,oe[3]=be*-nt+me*Jt,oe}function Pe(oe,Q,H){var Se=Q[0],be=Q[1],Te=Q[2],me=Q[3],nt=H[0],Jt=H[1];return oe[0]=Se*nt,oe[1]=be*nt,oe[2]=Te*Jt,oe[3]=me*Jt,oe}function mt(oe,Q){var H=Math.sin(Q),Se=Math.cos(Q);return oe[0]=Se,oe[1]=H,oe[2]=-H,oe[3]=Se,oe}function De(oe,Q){return oe[0]=Q[0],oe[1]=0,oe[2]=0,oe[3]=Q[1],oe}function At(oe){return"mat2("+oe[0]+", "+oe[1]+", "+oe[2]+", "+oe[3]+")"}function it(oe){return Math.hypot(oe[0],oe[1],oe[2],oe[3])}function vt(oe,Q,H,Se){return oe[2]=Se[2]/Se[0],H[0]=Se[0],H[1]=Se[1],H[3]=Se[3]-oe[2]*H[1],[oe,Q,H]}function Je(oe,Q,H){return oe[0]=Q[0]+H[0],oe[1]=Q[1]+H[1],oe[2]=Q[2]+H[2],oe[3]=Q[3]+H[3],oe}function _t(oe,Q,H){return oe[0]=Q[0]-H[0],oe[1]=Q[1]-H[1],oe[2]=Q[2]-H[2],oe[3]=Q[3]-H[3],oe}function wt(oe,Q){return oe[0]===Q[0]&&oe[1]===Q[1]&&oe[2]===Q[2]&&oe[3]===Q[3]}function ke(oe,Q){var H=oe[0],Se=oe[1],be=oe[2],Te=oe[3],me=Q[0],nt=Q[1],Jt=Q[2],Mt=Q[3];return Math.abs(H-me)<=m.b*Math.max(1,Math.abs(H),Math.abs(me))&&Math.abs(Se-nt)<=m.b*Math.max(1,Math.abs(Se),Math.abs(nt))&&Math.abs(be-Jt)<=m.b*Math.max(1,Math.abs(be),Math.abs(Jt))&&Math.abs(Te-Mt)<=m.b*Math.max(1,Math.abs(Te),Math.abs(Mt))}function Re(oe,Q,H){return oe[0]=Q[0]*H,oe[1]=Q[1]*H,oe[2]=Q[2]*H,oe[3]=Q[3]*H,oe}function Ve(oe,Q,H,Se){return oe[0]=Q[0]+H[0]*Se,oe[1]=Q[1]+H[1]*Se,oe[2]=Q[2]+H[2]*Se,oe[3]=Q[3]+H[3]*Se,oe}var dt=pe,Me=_t,ht=o("ZaHm"),Zt=o("ZxFD"),Qt=o("n+fv"),ur=o("bl9R")},ISu3:function(ze,E,o){"use strict";o.d(E,"a",function(){return Y}),o.d(E,"c",function(){return F}),o.d(E,"b",function(){return i}),o.d(E,"d",function(){return Z});var b={},m={},Y=function($){return m[$]},F=function($,te){m[$]=te},i=function($){return b[$]},Z=function($,te){b[$]=te}},Ioao:function(ze,E,o){var b=o("heNW"),m=Math.max;function Y(F,i,Z){return i=m(i===void 0?F.length-1:i,0),function(){for(var D=arguments,$=-1,te=m(D.length-i,0),fe=Array(te);++$<te;)fe[$]=D[i+$];$=-1;for(var K=Array(i+1);++$<i;)K[$]=D[$];return K[i]=Z(fe),b(F,this,K)}}ze.exports=Y},J2iB:function(ze,E){function o(b){return b==null}ze.exports=o},J7lC:function(ze,E){},K9nA:function(ze,E,o){"use strict";(function(b,m){o.d(E,"b",function(){return Z}),o.d(E,"a",function(){return te});var Y=o("U8pU"),F={self:typeof self!="undefined"&&self,window:typeof window!="undefined"&&window,global:typeof b!="undefined"&&b,document:typeof document!="undefined"&&document,process:(typeof m=="undefined"?"undefined":Object(Y.a)(m))==="object"&&m},i=F.self||F.window||F.global,Z=F.window||F.self||F.global,D=F.global||F.self||F.window,$=F.document||{},te=F.process||{},fe=console}).call(this,o("yLpj"),o("Q2Ig"))},KKCa:function(ze,E){typeof Object.create=="function"?ze.exports=function(b,m){b.super_=m,b.prototype=Object.create(m.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}})}:ze.exports=function(b,m){b.super_=m;var Y=function(){};Y.prototype=m.prototype,b.prototype=new Y,b.prototype.constructor=b}},KwMD:function(ze,E){function o(b,m,Y,F){for(var i=b.length,Z=Y+(F?1:-1);F?Z--:++Z<i;)if(m(b[Z],Z,b))return Z;return-1}ze.exports=o},KxBF:function(ze,E){function o(b,m,Y){var F=-1,i=b.length;m<0&&(m=-m>i?0:i+m),Y=Y>i?i:Y,Y<0&&(Y+=i),i=m>Y?0:Y-m>>>0,m>>>=0;for(var Z=Array(i);++F<i;)Z[F]=b[F+m];return Z}ze.exports=o},L56e:function(ze,E,o){"use strict";o.d(E,"a",function(){return b});var b=["mapload"]},LGYb:function(ze,E,o){var b=o("1hJj"),m=o("jbM+"),Y=o("Xt/L"),F=o("xYSL"),i=o("dQpi"),Z=o("rEGp"),D=200;function $(te,fe,K){var Ge=-1,pe=m,Ze=te.length,Pe=!0,mt=[],De=mt;if(K)Pe=!1,pe=Y;else if(Ze>=D){var At=fe?null:i(te);if(At)return Z(At);Pe=!1,pe=F,De=new b}else De=fe?[]:mt;e:for(;++Ge<Ze;){var it=te[Ge],vt=fe?fe(it):it;if(it=K||it!==0?it:0,Pe&&vt===vt){for(var Je=De.length;Je--;)if(De[Je]===vt)continue e;fe&&De.push(vt),mt.push(it)}else pe(De,vt,K)||(De!==mt&&De.push(vt),mt.push(it))}return mt}ze.exports=$},LKzl:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("406g"),m=o("z4Hk"),Y=function(){function F(i){this._binding=i,this._bindingWhenSyntax=new m.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new b.BindingOnSyntax(this._binding)}return F.prototype.when=function(i){return this._bindingWhenSyntax.when(i)},F.prototype.whenTargetNamed=function(i){return this._bindingWhenSyntax.whenTargetNamed(i)},F.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},F.prototype.whenTargetTagged=function(i,Z){return this._bindingWhenSyntax.whenTargetTagged(i,Z)},F.prototype.whenInjectedInto=function(i){return this._bindingWhenSyntax.whenInjectedInto(i)},F.prototype.whenParentNamed=function(i){return this._bindingWhenSyntax.whenParentNamed(i)},F.prototype.whenParentTagged=function(i,Z){return this._bindingWhenSyntax.whenParentTagged(i,Z)},F.prototype.whenAnyAncestorIs=function(i){return this._bindingWhenSyntax.whenAnyAncestorIs(i)},F.prototype.whenNoAncestorIs=function(i){return this._bindingWhenSyntax.whenNoAncestorIs(i)},F.prototype.whenAnyAncestorNamed=function(i){return this._bindingWhenSyntax.whenAnyAncestorNamed(i)},F.prototype.whenAnyAncestorTagged=function(i,Z){return this._bindingWhenSyntax.whenAnyAncestorTagged(i,Z)},F.prototype.whenNoAncestorNamed=function(i){return this._bindingWhenSyntax.whenNoAncestorNamed(i)},F.prototype.whenNoAncestorTagged=function(i,Z){return this._bindingWhenSyntax.whenNoAncestorTagged(i,Z)},F.prototype.whenAnyAncestorMatches=function(i){return this._bindingWhenSyntax.whenAnyAncestorMatches(i)},F.prototype.whenNoAncestorMatches=function(i){return this._bindingWhenSyntax.whenNoAncestorMatches(i)},F.prototype.onActivation=function(i){return this._bindingOnSyntax.onActivation(i)},F}();E.BindingWhenOnSyntax=Y},LcsW:function(ze,E,o){var b=o("kekF"),m=b(Object.getPrototypeOf,Object);ze.exports=m},LgvC:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("FV85"),m=o("d9O0"),Y=function(){function F(i,Z){this.id=m.id(),this.activated=!1,this.serviceIdentifier=i,this.scope=Z,this.type=b.BindingTypeEnum.Invalid,this.constraint=function(D){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return F.prototype.clone=function(){var i=new F(this.serviceIdentifier,this.scope);return i.activated=!1,i.implementationType=this.implementationType,i.dynamicValue=this.dynamicValue,i.scope=this.scope,i.type=this.type,i.factory=this.factory,i.provider=this.provider,i.constraint=this.constraint,i.onActivation=this.onActivation,i.cache=this.cache,i},F}();E.Binding=Y},LsHQ:function(ze,E,o){var b=o("EA7m"),m=o("mv/X");function Y(F){return b(function(i,Z){var D=-1,$=Z.length,te=$>1?Z[$-1]:void 0,fe=$>2?Z[2]:void 0;for(te=F.length>3&&typeof te=="function"?($--,te):void 0,fe&&m(Z[0],Z[1],fe)&&(te=$<3?void 0:te,$=1),i=Object(i);++D<$;){var K=Z[D];K&&F(i,K,D,te)}return i})}ze.exports=Y},LvWW:function(ze,E,o){var b=o("mhV4");ze.exports=m;function m($,te){switch($&&$.type||null){case"FeatureCollection":return $.features=$.features.map(Y(m,te)),$;case"GeometryCollection":return $.geometries=$.geometries.map(Y(m,te)),$;case"Feature":return $.geometry=m($.geometry,te),$;case"Polygon":case"MultiPolygon":return F($,te);default:return $}}function Y($,te){return function(fe){return $(fe,te)}}function F($,te){return $.type==="Polygon"?$.coordinates=i($.coordinates,te):$.type==="MultiPolygon"&&($.coordinates=$.coordinates.map(Y(i,te))),$}function i($,te){te=!!te,$[0]=Z($[0],te);for(var fe=1;fe<$.length;fe++)$[fe]=Z($[fe],!te);return $}function Z($,te){return D($)===te?$:$.reverse()}function D($){return b.ring($)>=0}},MCLT:function(ze,E,o){(function(b){var m=Object.getOwnPropertyDescriptors||function(me){for(var nt=Object.keys(me),Jt={},Mt=0;Mt<nt.length;Mt++)Jt[nt[Mt]]=Object.getOwnPropertyDescriptor(me,nt[Mt]);return Jt},Y=/%[sdj%]/g;E.format=function(Te){if(!Je(Te)){for(var me=[],nt=0;nt<arguments.length;nt++)me.push(Z(arguments[nt]));return me.join(" ")}for(var nt=1,Jt=arguments,Mt=Jt.length,ve=String(Te).replace(Y,function(He){if(He==="%%")return"%";if(nt>=Mt)return He;switch(He){case"%s":return String(Jt[nt++]);case"%d":return Number(Jt[nt++]);case"%j":try{return JSON.stringify(Jt[nt++])}catch(ot){return"[Circular]"}default:return He}}),ge=Jt[nt];nt<Mt;ge=Jt[++nt])At(ge)||!Re(ge)?ve+=" "+ge:ve+=" "+Z(ge);return ve},E.deprecate=function(Te,me){if(typeof b!="undefined"&&b.noDeprecation===!0)return Te;if(typeof b=="undefined")return function(){return E.deprecate(Te,me).apply(this,arguments)};var nt=!1;function Jt(){if(!nt){if(b.throwDeprecation)throw new Error(me);b.traceDeprecation?console.trace(me):console.error(me),nt=!0}return Te.apply(this,arguments)}return Jt};var F={},i;E.debuglog=function(Te){if(wt(i)&&(i=Object({NODE_ENV:"production"}).NODE_DEBUG||""),Te=Te.toUpperCase(),!F[Te])if(new RegExp("\\b"+Te+"\\b","i").test(i)){var me=b.pid;F[Te]=function(){var nt=E.format.apply(E,arguments);console.error("%s %d: %s",Te,me,nt)}}else F[Te]=function(){};return F[Te]};function Z(Te,me){var nt={seen:[],stylize:$};return arguments.length>=3&&(nt.depth=arguments[2]),arguments.length>=4&&(nt.colors=arguments[3]),De(me)?nt.showHidden=me:me&&E._extend(nt,me),wt(nt.showHidden)&&(nt.showHidden=!1),wt(nt.depth)&&(nt.depth=2),wt(nt.colors)&&(nt.colors=!1),wt(nt.customInspect)&&(nt.customInspect=!0),nt.colors&&(nt.stylize=D),fe(nt,Te,nt.depth)}E.inspect=Z,Z.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},Z.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function D(Te,me){var nt=Z.styles[me];return nt?"["+Z.colors[nt][0]+"m"+Te+"["+Z.colors[nt][1]+"m":Te}function $(Te,me){return Te}function te(Te){var me={};return Te.forEach(function(nt,Jt){me[nt]=!0}),me}function fe(Te,me,nt){if(Te.customInspect&&me&&Me(me.inspect)&&me.inspect!==E.inspect&&!(me.constructor&&me.constructor.prototype===me)){var Jt=me.inspect(nt,Te);return Je(Jt)||(Jt=fe(Te,Jt,nt)),Jt}var Mt=K(Te,me);if(Mt)return Mt;var ve=Object.keys(me),ge=te(ve);if(Te.showHidden&&(ve=Object.getOwnPropertyNames(me)),dt(me)&&(ve.indexOf("message")>=0||ve.indexOf("description")>=0))return Ge(me);if(ve.length===0){if(Me(me)){var He=me.name?": "+me.name:"";return Te.stylize("[Function"+He+"]","special")}if(ke(me))return Te.stylize(RegExp.prototype.toString.call(me),"regexp");if(Ve(me))return Te.stylize(Date.prototype.toString.call(me),"date");if(dt(me))return Ge(me)}var ot="",we=!1,gt=["{","}"];if(mt(me)&&(we=!0,gt=["[","]"]),Me(me)){var C=me.name?": "+me.name:"";ot=" [Function"+C+"]"}if(ke(me)&&(ot=" "+RegExp.prototype.toString.call(me)),Ve(me)&&(ot=" "+Date.prototype.toUTCString.call(me)),dt(me)&&(ot=" "+Ge(me)),ve.length===0&&(!we||me.length==0))return gt[0]+ot+gt[1];if(nt<0)return ke(me)?Te.stylize(RegExp.prototype.toString.call(me),"regexp"):Te.stylize("[Object]","special");Te.seen.push(me);var R;return we?R=pe(Te,me,nt,ge,ve):R=ve.map(function(q){return Ze(Te,me,nt,ge,q,we)}),Te.seen.pop(),Pe(R,ot,gt)}function K(Te,me){if(wt(me))return Te.stylize("undefined","undefined");if(Je(me)){var nt="'"+JSON.stringify(me).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return Te.stylize(nt,"string")}if(vt(me))return Te.stylize(""+me,"number");if(De(me))return Te.stylize(""+me,"boolean");if(At(me))return Te.stylize("null","null")}function Ge(Te){return"["+Error.prototype.toString.call(Te)+"]"}function pe(Te,me,nt,Jt,Mt){for(var ve=[],ge=0,He=me.length;ge<He;++ge)Q(me,String(ge))?ve.push(Ze(Te,me,nt,Jt,String(ge),!0)):ve.push("");return Mt.forEach(function(ot){ot.match(/^\d+$/)||ve.push(Ze(Te,me,nt,Jt,ot,!0))}),ve}function Ze(Te,me,nt,Jt,Mt,ve){var ge,He,ot;if(ot=Object.getOwnPropertyDescriptor(me,Mt)||{value:me[Mt]},ot.get?ot.set?He=Te.stylize("[Getter/Setter]","special"):He=Te.stylize("[Getter]","special"):ot.set&&(He=Te.stylize("[Setter]","special")),Q(Jt,Mt)||(ge="["+Mt+"]"),He||(Te.seen.indexOf(ot.value)<0?(At(nt)?He=fe(Te,ot.value,null):He=fe(Te,ot.value,nt-1),He.indexOf(`
`)>-1&&(ve?He=He.split(`
`).map(function(we){return"  "+we}).join(`
`).substr(2):He=`
`+He.split(`
`).map(function(we){return"   "+we}).join(`
`))):He=Te.stylize("[Circular]","special")),wt(ge)){if(ve&&Mt.match(/^\d+$/))return He;ge=JSON.stringify(""+Mt),ge.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(ge=ge.substr(1,ge.length-2),ge=Te.stylize(ge,"name")):(ge=ge.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),ge=Te.stylize(ge,"string"))}return ge+": "+He}function Pe(Te,me,nt){var Jt=0,Mt=Te.reduce(function(ve,ge){return Jt++,ge.indexOf(`
`)>=0&&Jt++,ve+ge.replace(/\u001b\[\d\d?m/g,"").length+1},0);return Mt>60?nt[0]+(me===""?"":me+`
 `)+" "+Te.join(`,
  `)+" "+nt[1]:nt[0]+me+" "+Te.join(", ")+" "+nt[1]}function mt(Te){return Array.isArray(Te)}E.isArray=mt;function De(Te){return typeof Te=="boolean"}E.isBoolean=De;function At(Te){return Te===null}E.isNull=At;function it(Te){return Te==null}E.isNullOrUndefined=it;function vt(Te){return typeof Te=="number"}E.isNumber=vt;function Je(Te){return typeof Te=="string"}E.isString=Je;function _t(Te){return typeof Te=="symbol"}E.isSymbol=_t;function wt(Te){return Te===void 0}E.isUndefined=wt;function ke(Te){return Re(Te)&&Zt(Te)==="[object RegExp]"}E.isRegExp=ke;function Re(Te){return typeof Te=="object"&&Te!==null}E.isObject=Re;function Ve(Te){return Re(Te)&&Zt(Te)==="[object Date]"}E.isDate=Ve;function dt(Te){return Re(Te)&&(Zt(Te)==="[object Error]"||Te instanceof Error)}E.isError=dt;function Me(Te){return typeof Te=="function"}E.isFunction=Me;function ht(Te){return Te===null||typeof Te=="boolean"||typeof Te=="number"||typeof Te=="string"||typeof Te=="symbol"||typeof Te=="undefined"}E.isPrimitive=ht,E.isBuffer=o("1gqn");function Zt(Te){return Object.prototype.toString.call(Te)}function Qt(Te){return Te<10?"0"+Te.toString(10):Te.toString(10)}var ur=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function oe(){var Te=new Date,me=[Qt(Te.getHours()),Qt(Te.getMinutes()),Qt(Te.getSeconds())].join(":");return[Te.getDate(),ur[Te.getMonth()],me].join(" ")}E.log=function(){console.log("%s - %s",oe(),E.format.apply(E,arguments))},E.inherits=o("KKCa"),E._extend=function(Te,me){if(!me||!Re(me))return Te;for(var nt=Object.keys(me),Jt=nt.length;Jt--;)Te[nt[Jt]]=me[nt[Jt]];return Te};function Q(Te,me){return Object.prototype.hasOwnProperty.call(Te,me)}var H=typeof Symbol!="undefined"?Symbol("util.promisify.custom"):void 0;E.promisify=function(me){if(typeof me!="function")throw new TypeError('The "original" argument must be of type Function');if(H&&me[H]){var nt=me[H];if(typeof nt!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(nt,H,{value:nt,enumerable:!1,writable:!1,configurable:!0}),nt}function nt(){for(var Jt,Mt,ve=new Promise(function(ot,we){Jt=ot,Mt=we}),ge=[],He=0;He<arguments.length;He++)ge.push(arguments[He]);ge.push(function(ot,we){ot?Mt(ot):Jt(we)});try{me.apply(this,ge)}catch(ot){Mt(ot)}return ve}return Object.setPrototypeOf(nt,Object.getPrototypeOf(me)),H&&Object.defineProperty(nt,H,{value:nt,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(nt,m(me))},E.promisify.custom=H;function Se(Te,me){if(!Te){var nt=new Error("Promise was rejected with a falsy value");nt.reason=Te,Te=nt}return me(Te)}function be(Te){if(typeof Te!="function")throw new TypeError('The "original" argument must be of type Function');function me(){for(var nt=[],Jt=0;Jt<arguments.length;Jt++)nt.push(arguments[Jt]);var Mt=nt.pop();if(typeof Mt!="function")throw new TypeError("The last argument must be of type Function");var ve=this,ge=function(){return Mt.apply(ve,arguments)};Te.apply(this,nt).then(function(He){b.nextTick(ge,null,He)},function(He){b.nextTick(Se,He,ge)})}return Object.setPrototypeOf(me,Object.getPrototypeOf(Te)),Object.defineProperties(me,m(Te)),me}E.callbackify=be}).call(this,o("Q2Ig"))},MON2:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",E.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",E.NULL_ARGUMENT="NULL argument",E.KEY_NOT_FOUND="Key Not Found",E.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",E.CANNOT_UNBIND="Could not unbind serviceIdentifier:",E.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",E.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",E.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",E.UNDEFINED_INJECT_ANNOTATION=function(b){return"@inject called with undefined this could mean that the class "+b+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},E.CIRCULAR_DEPENDENCY="Circular dependency found:",E.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",E.INVALID_BINDING_TYPE="Invalid binding type:",E.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",E.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",E.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",E.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",E.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",E.ARGUMENTS_LENGTH_MISMATCH=function(){for(var b=[],m=0;m<arguments.length;m++)b[m]=arguments[m];return"The number of constructor arguments in the derived class "+(b[0]+" must be >= than the number of constructor arguments of its base class.")},E.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",E.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",E.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",E.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",E.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",E.POST_CONSTRUCT_ERROR=function(){for(var b=[],m=0;m<arguments.length;m++)b[m]=arguments[m];return"@postConstruct error in class "+b[0]+": "+b[1]},E.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var b=[],m=0;m<arguments.length;m++)b[m]=arguments[m];return"It looks like there is a circular dependency "+("in one of the '"+b[0]+"' bindings. Please investigate bindings with")+("service identifier '"+b[1]+"'.")},E.STACK_OVERFLOW="Maximum call stack size exceeded"},MrPd:function(ze,E,o){var b=o("hypo"),m=o("ljhN"),Y=Object.prototype,F=Y.hasOwnProperty;function i(Z,D,$){var te=Z[D];(!(F.call(Z,D)&&m(te,$))||$===void 0&&!(D in Z))&&b(Z,D,$)}ze.exports=i},O0oS:function(ze,E,o){var b=o("Cwc5"),m=function(){try{var Y=b(Object,"defineProperty");return Y({},"",{}),Y}catch(F){}}();ze.exports=m},O1je:function(ze,E){},OBhP:function(ze,E,o){var b=o("fmRc"),m=o("gFfm"),Y=o("MrPd"),F=o("WwFo"),i=o("Dw+G"),Z=o("5Tg0"),D=o("Q1l4"),$=o("VOtZ"),te=o("EEGq"),fe=o("qZTm"),K=o("G6z8"),Ge=o("QqLw"),pe=o("yHx3"),Ze=o("wrZu"),Pe=o("+iFO"),mt=o("Z0cm"),De=o("DSRE"),At=o("zEVN"),it=o("GoyQ"),vt=o("1+5i"),Je=o("7GkX"),_t=o("mTTR"),wt=1,ke=2,Re=4,Ve="[object Arguments]",dt="[object Array]",Me="[object Boolean]",ht="[object Date]",Zt="[object Error]",Qt="[object Function]",ur="[object GeneratorFunction]",oe="[object Map]",Q="[object Number]",H="[object Object]",Se="[object RegExp]",be="[object Set]",Te="[object String]",me="[object Symbol]",nt="[object WeakMap]",Jt="[object ArrayBuffer]",Mt="[object DataView]",ve="[object Float32Array]",ge="[object Float64Array]",He="[object Int8Array]",ot="[object Int16Array]",we="[object Int32Array]",gt="[object Uint8Array]",C="[object Uint8ClampedArray]",R="[object Uint16Array]",q="[object Uint32Array]",ce={};ce[Ve]=ce[dt]=ce[Jt]=ce[Mt]=ce[Me]=ce[ht]=ce[ve]=ce[ge]=ce[He]=ce[ot]=ce[we]=ce[oe]=ce[Q]=ce[H]=ce[Se]=ce[be]=ce[Te]=ce[me]=ce[gt]=ce[C]=ce[R]=ce[q]=!0,ce[Zt]=ce[Qt]=ce[nt]=!1;function We(qe,Tt,at,Ut,J,Qe){var ne,et=Tt&wt,kt=Tt&ke,dr=Tt&Re;if(at&&(ne=J?at(qe,Ut,J,Qe):at(qe)),ne!==void 0)return ne;if(!it(qe))return qe;var Ye=mt(qe);if(Ye){if(ne=pe(qe),!et)return D(qe,ne)}else{var xt=Ge(qe),bt=xt==Qt||xt==ur;if(De(qe))return Z(qe,et);if(xt==H||xt==Ve||bt&&!J){if(ne=kt||bt?{}:Pe(qe),!et)return kt?te(qe,i(ne,qe)):$(qe,F(ne,qe))}else{if(!ce[xt])return J?qe:{};ne=Ze(qe,xt,et)}}Qe||(Qe=new b);var Et=Qe.get(qe);if(Et)return Et;Qe.set(qe,ne),vt(qe)?qe.forEach(function(yt){ne.add(We(yt,Tt,at,yt,qe,Qe))}):At(qe)&&qe.forEach(function(yt,Ht){ne.set(Ht,We(yt,Tt,at,Ht,qe,Qe))});var Fe=dr?kt?K:fe:kt?_t:Je,pt=Ye?void 0:Fe(qe);return m(pt||qe,function(yt,Ht){pt&&(Ht=yt,yt=qe[Ht]),Y(ne,Ht,We(yt,Tt,at,Ht,qe,Qe))}),ne}ze.exports=We},PSsN:function(ze,E){},PUg6:function(ze,E,o){"use strict";o.d(E,"a",function(){return b});var b;(function(m){m.normal="normal",m.additive="additive",m.subtractive="subtractive",m.min="min",m.max="max",m.none="none"})(b||(b={}))},Q1l4:function(ze,E){function o(b,m){var Y=-1,F=b.length;for(m||(m=Array(F));++Y<F;)m[Y]=b[Y];return m}ze.exports=o},QGbF:function(ze,E){},"QQZ/":function(ze,E,o){var b=o("Sq3C"),m=o("Z1HP"),Y=o("Sxd8"),F=o("dt0z");function i(Z,D,$){Z=F(Z),D=Y(D);var te=D?m(Z):0;return D&&te<D?b(D-te,$)+Z:Z}ze.exports=i},QcOe:function(ze,E,o){var b=o("GoyQ"),m=o("6sVZ"),Y=o("7Ix3"),F=Object.prototype,i=F.hasOwnProperty;function Z(D){if(!b(D))return Y(D);var $=m(D),te=[];for(var fe in D)fe=="constructor"&&($||!i.call(D,fe))||te.push(fe);return te}ze.exports=Z},QkVN:function(ze,E,o){var b=o("+Qka"),m=o("LsHQ"),Y=m(function(F,i,Z){b(F,i,Z)});ze.exports=Y},"R/W3":function(ze,E,o){var b=o("KwMD"),m=o("2ajD"),Y=o("CZoQ");function F(i,Z,D){return Z===Z?Y(i,Z,D):b(i,m,D)}ze.exports=F},"RL2/":function(ze,E,o){"use strict";var b="2.3.1"},RMtq:function(ze,E){},"RR/i":function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("xfSm"),m=o("GXnB"),Y=function D($,te){var fe=$.parentRequest;return fe!==null?te(fe)?!0:D(fe,te):!1};E.traverseAncerstors=Y;var F=function($){return function(te){var fe=function(Ge){return Ge!==null&&Ge.target!==null&&Ge.target.matchesTag($)(te)};return fe.metaData=new m.Metadata($,te),fe}};E.taggedConstraint=F;var i=F(b.NAMED_TAG);E.namedConstraint=i;var Z=function($){return function(te){var fe=null;if(te!==null)if(fe=te.bindings[0],typeof $=="string"){var K=fe.serviceIdentifier;return K===$}else{var Ge=te.bindings[0].implementationType;return $===Ge}return!1}};E.typeConstraint=Z},Sk89:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("MON2"),m=o("xfSm"),Y=o("GXnB");function F(){return function(i,Z,D){var $=new Y.Metadata(m.POST_CONSTRUCT,Z);if(Reflect.hasOwnMetadata(m.POST_CONSTRUCT,i.constructor))throw new Error(b.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(m.POST_CONSTRUCT,$,i.constructor)}}E.postConstruct=F},Sq3C:function(ze,E,o){var b=o("sKgW"),m=o("zoYe"),Y=o("wy8a"),F=o("quyA"),i=o("Z1HP"),Z=o("Em2t"),D=Math.ceil;function $(te,fe){fe=fe===void 0?" ":m(fe);var K=fe.length;if(K<2)return K?b(fe,te):fe;var Ge=b(fe,D(te/i(fe)));return F(fe)?Y(Z(Ge),0,te).join(""):Ge.slice(0,te)}ze.exports=$},Sxd8:function(ze,E,o){var b=o("ZCgT");function m(Y){var F=b(Y),i=F%1;return F===F?i?F-i:F:0}ze.exports=m},T1AV:function(ze,E,o){var b=o("t2Dn"),m=o("5Tg0"),Y=o("yP5f"),F=o("Q1l4"),i=o("+iFO"),Z=o("03A+"),D=o("Z0cm"),$=o("3L66"),te=o("DSRE"),fe=o("lSCD"),K=o("GoyQ"),Ge=o("YO3V"),pe=o("c6wG"),Ze=o("itsj"),Pe=o("jeLo");function mt(De,At,it,vt,Je,_t,wt){var ke=Ze(De,it),Re=Ze(At,it),Ve=wt.get(Re);if(Ve){b(De,it,Ve);return}var dt=_t?_t(ke,Re,it+"",De,At,wt):void 0,Me=dt===void 0;if(Me){var ht=D(Re),Zt=!ht&&te(Re),Qt=!ht&&!Zt&&pe(Re);dt=Re,ht||Zt||Qt?D(ke)?dt=ke:$(ke)?dt=F(ke):Zt?(Me=!1,dt=m(Re,!0)):Qt?(Me=!1,dt=Y(Re,!0)):dt=[]:Ge(Re)||Z(Re)?(dt=ke,Z(ke)?dt=Pe(ke):(!K(ke)||fe(ke))&&(dt=i(Re))):Me=!1}Me&&(wt.set(Re,dt),Je(dt,Re,vt,_t,wt),wt.delete(Re)),b(De,it,dt)}ze.exports=mt},TKrE:function(ze,E,o){var b=o("qRkn"),m=o("dt0z"),Y=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,F="\\u0300-\\u036f",i="\\ufe20-\\ufe2f",Z="\\u20d0-\\u20ff",D=F+i+Z,$="["+D+"]",te=RegExp($,"g");function fe(K){return K=m(K),K&&K.replace(Y,b).replace(te,"")}ze.exports=fe},"U+yc":function(ze,E){function o(b,m,Y,F,i){var Z={};return Object.keys(F).forEach(function(D){Z[D]=F[D]}),Z.enumerable=!!Z.enumerable,Z.configurable=!!Z.configurable,("value"in Z||Z.initializer)&&(Z.writable=!0),Z=Y.slice().reverse().reduce(function(D,$){return $(b,m,D)||D},Z),i&&Z.initializer!==void 0&&(Z.value=Z.initializer?Z.initializer.call(i):void 0,Z.initializer=void 0),Z.initializer===void 0&&(Object.defineProperty(b,m,Z),Z=null),Z}ze.exports=o},U1ZX:function(ze,E){},UB5X:function(ze,E,o){var b=o("NykK"),m=o("ExA7"),Y="[object Number]";function F(i){return typeof i=="number"||m(i)&&b(i)==Y}ze.exports=F},Ucsi:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=Symbol.for("INJECTION");function m(D,$,te,fe){function K(){return fe&&!Reflect.hasMetadata(b,this,$)&&Reflect.defineMetadata(b,te(),this,$),Reflect.hasMetadata(b,this,$)?Reflect.getMetadata(b,this,$):te()}function Ge(pe){Reflect.defineMetadata(b,pe,this,$)}Object.defineProperty(D,$,{configurable:!0,enumerable:!0,get:K,set:Ge})}function Y(D,$){return function(te){return function(fe,K){var Ge=function(){return D.get(te)};m(fe,K,Ge,$)}}}E.makePropertyInjectDecorator=Y;function F(D,$){return function(te,fe){return function(K,Ge){var pe=function(){return D.getNamed(te,fe)};m(K,Ge,pe,$)}}}E.makePropertyInjectNamedDecorator=F;function i(D,$){return function(te,fe,K){return function(Ge,pe){var Ze=function(){return D.getTagged(te,fe,K)};m(Ge,pe,Ze,$)}}}E.makePropertyInjectTaggedDecorator=i;function Z(D,$){return function(te){return function(fe,K){var Ge=function(){return D.getAll(te)};m(fe,K,Ge,$)}}}E.makePropertyMultiInjectDecorator=Z},V1cb:function(ze,E,o){"use strict";o.d(E,"a",function(){return b});var b;(function(m){m.Hover="hover",m.Click="click",m.Select="select",m.Active="active",m.Drag="drag"})(b||(b={}))},VIsB:function(ze,E,o){"use strict";o.d(E,"a",function(){return Z});var b=o("Hel2");function m(Ge,pe){var Ze;if(typeof Symbol=="undefined"||Ge[Symbol.iterator]==null){if(Array.isArray(Ge)||(Ze=Y(Ge))||pe&&Ge&&typeof Ge.length=="number"){Ze&&(Ge=Ze);var Pe=0,mt=function(){};return{s:mt,n:function(){return Pe>=Ge.length?{done:!0}:{done:!1,value:Ge[Pe++]}},e:function(Je){throw Je},f:mt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var De=!0,At=!1,it;return{s:function(){Ze=Ge[Symbol.iterator]()},n:function(){var Je=Ze.next();return De=Je.done,Je},e:function(Je){At=!0,it=Je},f:function(){try{!De&&Ze.return!=null&&Ze.return()}finally{if(At)throw it}}}}function Y(Ge,pe){if(!Ge)return;if(typeof Ge=="string")return F(Ge,pe);var Ze=Object.prototype.toString.call(Ge).slice(8,-1);if(Ze==="Object"&&Ge.constructor&&(Ze=Ge.constructor.name),Ze==="Map"||Ze==="Set")return Array.from(Ge);if(Ze==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ze))return F(Ge,pe)}function F(Ge,pe){(pe==null||pe>Ge.length)&&(pe=Ge.length);for(var Ze=0,Pe=new Array(pe);Ze<pe;Ze++)Pe[Ze]=Ge[Ze];return Pe}var i=6378e3;function Z(Ge,pe){var Ze=Ge.dataArray,Pe=pe.size,mt=Pe===void 0?10:Pe,De=mt/(2*Math.PI*i)*(256<<20)/2,At=D(Ze,mt),it=At.gridHash,vt=At.gridOffset,Je=K(it,vt,pe);return{yOffset:De,xOffset:De,radius:De,type:"grid",dataArray:Je}}function D(Ge,pe){var Ze=Infinity,Pe=-Infinity,mt,De=m(Ge),At;try{for(De.s();!(At=De.n()).done;){var it=At.value;mt=it.coordinates[1],Number.isFinite(mt)&&(Ze=mt<Ze?mt:Ze,Pe=mt>Pe?mt:Pe)}}catch(Qt){De.e(Qt)}finally{De.f()}var vt=(Ze+Pe)/2,Je=$(pe,vt);if(Je.xOffset<=0||Je.yOffset<=0)return{gridHash:{},gridOffset:Je};var _t={},wt=m(Ge),ke;try{for(wt.s();!(ke=wt.n()).done;){var Re=ke.value,Ve=Re.coordinates[1],dt=Re.coordinates[0];if(Number.isFinite(Ve)&&Number.isFinite(dt)){var Me=Math.floor((Ve+90)/Je.yOffset),ht=Math.floor((dt+180)/Je.xOffset),Zt="".concat(Me,"-").concat(ht);_t[Zt]=_t[Zt]||{count:0,points:[]},_t[Zt].count+=1,_t[Zt].points.push(Re)}}}catch(Qt){wt.e(Qt)}finally{wt.f()}return{gridHash:_t,gridOffset:Je}}function $(Ge,pe){var Ze=te(Ge),Pe=fe(pe,Ge);return{yOffset:Ze,xOffset:Pe}}function te(Ge){return Ge/i*(180/Math.PI)}function fe(Ge,pe){return pe/i*(180/Math.PI)/Math.cos(Ge*Math.PI/180)}function K(Ge,pe,Ze){return Object.keys(Ge).reduce(function(Pe,mt,De){var At=mt.split("-"),it=parseInt(At[0],10),vt=parseInt(At[1],10),Je={};if(Ze.field&&Ze.method){var _t=b.c.getColumn(Ge[mt].points,Ze.field);Je[Ze.method]=b.c.statMap[Ze.method](_t)}return Object.assign(Je,{_id:De,coordinates:Object(b.d)([-180+pe.xOffset*(vt+.5),-90+pe.yOffset*(it+.5)]),rawData:Ge[mt].points,count:Ge[mt].count}),Pe.push(Je),Pe},[])}},VOtZ:function(ze,E,o){var b=o("juv8"),m=o("MvSz");function Y(F,i){return b(F,m(F),i)}ze.exports=Y},VmRL:function(ze,E,o){"use strict";ze.exports=b,ze.exports.default=b;function b(oe,Q,H){H=H||2;var Se=Q&&Q.length,be=Se?Q[0]*H:oe.length,Te=m(oe,0,be,H,!0),me=[];if(!Te||Te.next===Te.prev)return me;var nt,Jt,Mt,ve,ge,He,ot;if(Se&&(Te=te(oe,Q,Te,H)),oe.length>80*H){nt=Mt=oe[0],Jt=ve=oe[1];for(var we=H;we<be;we+=H)ge=oe[we],He=oe[we+1],ge<nt&&(nt=ge),He<Jt&&(Jt=He),ge>Mt&&(Mt=ge),He>ve&&(ve=He);ot=Math.max(Mt-nt,ve-Jt),ot=ot!==0?1/ot:0}return F(Te,me,H,nt,Jt,ot),me}function m(oe,Q,H,Se,be){var Te,me;if(be===ur(oe,Q,H,Se)>0)for(Te=Q;Te<H;Te+=Se)me=ht(Te,oe[Te],oe[Te+1],me);else for(Te=H-Se;Te>=Q;Te-=Se)me=ht(Te,oe[Te],oe[Te+1],me);return me&&Je(me,me.next)&&(Zt(me),me=me.next),me}function Y(oe,Q){if(!oe)return oe;Q||(Q=oe);var H=oe,Se;do if(Se=!1,!H.steiner&&(Je(H,H.next)||vt(H.prev,H,H.next)===0)){if(Zt(H),H=Q=H.prev,H===H.next)break;Se=!0}else H=H.next;while(Se||H!==Q);return Q}function F(oe,Q,H,Se,be,Te,me){if(!oe)return;!me&&Te&&Ze(oe,Se,be,Te);for(var nt=oe,Jt,Mt;oe.prev!==oe.next;){if(Jt=oe.prev,Mt=oe.next,Te?Z(oe,Se,be,Te):i(oe)){Q.push(Jt.i/H),Q.push(oe.i/H),Q.push(Mt.i/H),Zt(oe),oe=Mt.next,nt=Mt.next;continue}if(oe=Mt,oe===nt){me?me===1?(oe=D(Y(oe),Q,H),F(oe,Q,H,Se,be,Te,2)):me===2&&$(oe,Q,H,Se,be,Te):F(Y(oe),Q,H,Se,be,Te,1);break}}}function i(oe){var Q=oe.prev,H=oe,Se=oe.next;if(vt(Q,H,Se)>=0)return!1;for(var be=oe.next.next;be!==oe.prev;){if(At(Q.x,Q.y,H.x,H.y,Se.x,Se.y,be.x,be.y)&&vt(be.prev,be,be.next)>=0)return!1;be=be.next}return!0}function Z(oe,Q,H,Se){var be=oe.prev,Te=oe,me=oe.next;if(vt(be,Te,me)>=0)return!1;for(var nt=be.x<Te.x?be.x<me.x?be.x:me.x:Te.x<me.x?Te.x:me.x,Jt=be.y<Te.y?be.y<me.y?be.y:me.y:Te.y<me.y?Te.y:me.y,Mt=be.x>Te.x?be.x>me.x?be.x:me.x:Te.x>me.x?Te.x:me.x,ve=be.y>Te.y?be.y>me.y?be.y:me.y:Te.y>me.y?Te.y:me.y,ge=mt(nt,Jt,Q,H,Se),He=mt(Mt,ve,Q,H,Se),ot=oe.prevZ,we=oe.nextZ;ot&&ot.z>=ge&&we&&we.z<=He;){if(ot!==oe.prev&&ot!==oe.next&&At(be.x,be.y,Te.x,Te.y,me.x,me.y,ot.x,ot.y)&&vt(ot.prev,ot,ot.next)>=0)return!1;if(ot=ot.prevZ,we!==oe.prev&&we!==oe.next&&At(be.x,be.y,Te.x,Te.y,me.x,me.y,we.x,we.y)&&vt(we.prev,we,we.next)>=0)return!1;we=we.nextZ}for(;ot&&ot.z>=ge;){if(ot!==oe.prev&&ot!==oe.next&&At(be.x,be.y,Te.x,Te.y,me.x,me.y,ot.x,ot.y)&&vt(ot.prev,ot,ot.next)>=0)return!1;ot=ot.prevZ}for(;we&&we.z<=He;){if(we!==oe.prev&&we!==oe.next&&At(be.x,be.y,Te.x,Te.y,me.x,me.y,we.x,we.y)&&vt(we.prev,we,we.next)>=0)return!1;we=we.nextZ}return!0}function D(oe,Q,H){var Se=oe;do{var be=Se.prev,Te=Se.next.next;!Je(be,Te)&&_t(be,Se,Se.next,Te)&&Ve(be,Te)&&Ve(Te,be)&&(Q.push(be.i/H),Q.push(Se.i/H),Q.push(Te.i/H),Zt(Se),Zt(Se.next),Se=oe=Te),Se=Se.next}while(Se!==oe);return Y(Se)}function $(oe,Q,H,Se,be,Te){var me=oe;do{for(var nt=me.next.next;nt!==me.prev;){if(me.i!==nt.i&&it(me,nt)){var Jt=Me(me,nt);me=Y(me,me.next),Jt=Y(Jt,Jt.next),F(me,Q,H,Se,be,Te),F(Jt,Q,H,Se,be,Te);return}nt=nt.next}me=me.next}while(me!==oe)}function te(oe,Q,H,Se){var be=[],Te,me,nt,Jt,Mt;for(Te=0,me=Q.length;Te<me;Te++)nt=Q[Te]*Se,Jt=Te<me-1?Q[Te+1]*Se:oe.length,Mt=m(oe,nt,Jt,Se,!1),Mt===Mt.next&&(Mt.steiner=!0),be.push(De(Mt));for(be.sort(fe),Te=0;Te<be.length;Te++)K(be[Te],H),H=Y(H,H.next);return H}function fe(oe,Q){return oe.x-Q.x}function K(oe,Q){if(Q=Ge(oe,Q),Q){var H=Me(Q,oe);Y(Q,Q.next),Y(H,H.next)}}function Ge(oe,Q){var H=Q,Se=oe.x,be=oe.y,Te=-Infinity,me;do{if(be<=H.y&&be>=H.next.y&&H.next.y!==H.y){var nt=H.x+(be-H.y)*(H.next.x-H.x)/(H.next.y-H.y);if(nt<=Se&&nt>Te){if(Te=nt,nt===Se){if(be===H.y)return H;if(be===H.next.y)return H.next}me=H.x<H.next.x?H:H.next}}H=H.next}while(H!==Q);if(!me)return null;if(Se===Te)return me;var Jt=me,Mt=me.x,ve=me.y,ge=Infinity,He;H=me;do Se>=H.x&&H.x>=Mt&&Se!==H.x&&At(be<ve?Se:Te,be,Mt,ve,be<ve?Te:Se,be,H.x,H.y)&&(He=Math.abs(be-H.y)/(Se-H.x),Ve(H,oe)&&(He<ge||He===ge&&(H.x>me.x||H.x===me.x&&pe(me,H)))&&(me=H,ge=He)),H=H.next;while(H!==Jt);return me}function pe(oe,Q){return vt(oe.prev,oe,Q.prev)<0&&vt(Q.next,oe,oe.next)<0}function Ze(oe,Q,H,Se){var be=oe;do be.z===null&&(be.z=mt(be.x,be.y,Q,H,Se)),be.prevZ=be.prev,be.nextZ=be.next,be=be.next;while(be!==oe);be.prevZ.nextZ=null,be.prevZ=null,Pe(be)}function Pe(oe){var Q,H,Se,be,Te,me,nt,Jt,Mt=1;do{for(H=oe,oe=null,Te=null,me=0;H;){for(me++,Se=H,nt=0,Q=0;Q<Mt&&!(nt++,Se=Se.nextZ,!Se);Q++);for(Jt=Mt;nt>0||Jt>0&&Se;)nt!==0&&(Jt===0||!Se||H.z<=Se.z)?(be=H,H=H.nextZ,nt--):(be=Se,Se=Se.nextZ,Jt--),Te?Te.nextZ=be:oe=be,be.prevZ=Te,Te=be;H=Se}Te.nextZ=null,Mt*=2}while(me>1);return oe}function mt(oe,Q,H,Se,be){return oe=32767*(oe-H)*be,Q=32767*(Q-Se)*be,oe=(oe|oe<<8)&16711935,oe=(oe|oe<<4)&252645135,oe=(oe|oe<<2)&858993459,oe=(oe|oe<<1)&1431655765,Q=(Q|Q<<8)&16711935,Q=(Q|Q<<4)&252645135,Q=(Q|Q<<2)&858993459,Q=(Q|Q<<1)&1431655765,oe|Q<<1}function De(oe){var Q=oe,H=oe;do(Q.x<H.x||Q.x===H.x&&Q.y<H.y)&&(H=Q),Q=Q.next;while(Q!==oe);return H}function At(oe,Q,H,Se,be,Te,me,nt){return(be-me)*(Q-nt)-(oe-me)*(Te-nt)>=0&&(oe-me)*(Se-nt)-(H-me)*(Q-nt)>=0&&(H-me)*(Te-nt)-(be-me)*(Se-nt)>=0}function it(oe,Q){return oe.next.i!==Q.i&&oe.prev.i!==Q.i&&!Re(oe,Q)&&(Ve(oe,Q)&&Ve(Q,oe)&&dt(oe,Q)&&(vt(oe.prev,oe,Q.prev)||vt(oe,Q.prev,Q))||Je(oe,Q)&&vt(oe.prev,oe,oe.next)>0&&vt(Q.prev,Q,Q.next)>0)}function vt(oe,Q,H){return(Q.y-oe.y)*(H.x-Q.x)-(Q.x-oe.x)*(H.y-Q.y)}function Je(oe,Q){return oe.x===Q.x&&oe.y===Q.y}function _t(oe,Q,H,Se){var be=ke(vt(oe,Q,H)),Te=ke(vt(oe,Q,Se)),me=ke(vt(H,Se,oe)),nt=ke(vt(H,Se,Q));return be!==Te&&me!==nt||(be===0&&wt(oe,H,Q)||(Te===0&&wt(oe,Se,Q)||me===0&&wt(H,oe,Se)))?!0:!!(nt===0&&wt(H,Q,Se))}function wt(oe,Q,H){return Q.x<=Math.max(oe.x,H.x)&&Q.x>=Math.min(oe.x,H.x)&&Q.y<=Math.max(oe.y,H.y)&&Q.y>=Math.min(oe.y,H.y)}function ke(oe){return oe>0?1:oe<0?-1:0}function Re(oe,Q){var H=oe;do{if(H.i!==oe.i&&H.next.i!==oe.i&&H.i!==Q.i&&H.next.i!==Q.i&&_t(H,H.next,oe,Q))return!0;H=H.next}while(H!==oe);return!1}function Ve(oe,Q){return vt(oe.prev,oe,oe.next)<0?vt(oe,Q,oe.next)>=0&&vt(oe,oe.prev,Q)>=0:vt(oe,Q,oe.prev)<0||vt(oe,oe.next,Q)<0}function dt(oe,Q){var H=oe,Se=!1,be=(oe.x+Q.x)/2,Te=(oe.y+Q.y)/2;do H.y>Te!==H.next.y>Te&&H.next.y!==H.y&&be<(H.next.x-H.x)*(Te-H.y)/(H.next.y-H.y)+H.x&&(Se=!Se),H=H.next;while(H!==oe);return Se}function Me(oe,Q){var H=new Qt(oe.i,oe.x,oe.y),Se=new Qt(Q.i,Q.x,Q.y),be=oe.next,Te=Q.prev;return oe.next=Q,Q.prev=oe,H.next=be,be.prev=H,Se.next=H,H.prev=Se,Te.next=Se,Se.prev=Te,Se}function ht(oe,Q,H,Se){var be=new Qt(oe,Q,H);return Se?(be.next=Se.next,be.prev=Se,Se.next.prev=be,Se.next=be):(be.prev=be,be.next=be),be}function Zt(oe){oe.next.prev=oe.prev,oe.prev.next=oe.next,oe.prevZ&&(oe.prevZ.nextZ=oe.nextZ),oe.nextZ&&(oe.nextZ.prevZ=oe.prevZ)}function Qt(oe,Q,H){this.i=oe,this.x=Q,this.y=H,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}b.deviation=function(oe,Q,H,Se){var be=Q&&Q.length,Te=be?Q[0]*H:oe.length,me=Math.abs(ur(oe,0,Te,H));if(be)for(var nt=0,Jt=Q.length;nt<Jt;nt++){var Mt=Q[nt]*H,ve=nt<Jt-1?Q[nt+1]*H:oe.length;me-=Math.abs(ur(oe,Mt,ve,H))}var ge=0;for(nt=0;nt<Se.length;nt+=3){var He=Se[nt]*H,ot=Se[nt+1]*H,we=Se[nt+2]*H;ge+=Math.abs((oe[He]-oe[we])*(oe[ot+1]-oe[He+1])-(oe[He]-oe[ot])*(oe[we+1]-oe[He+1]))}return me===0&&ge===0?0:Math.abs((ge-me)/me)};function ur(oe,Q,H,Se){for(var be=0,Te=Q,me=H-Se;Te<H;Te+=Se)be+=(oe[me]-oe[Te])*(oe[Te+1]+oe[me+1]),me=Te;return be}b.flatten=function(oe){for(var Q=oe[0][0].length,H={vertices:[],holes:[],dimensions:Q},Se=0,be=0;be<oe.length;be++){for(var Te=0;Te<oe[be].length;Te++)for(var me=0;me<Q;me++)H.vertices.push(oe[be][Te][me]);be>0&&(Se+=oe[be-1].length,H.holes.push(Se))}return H}},WFAs:function(ze,E){var o=Array.isArray;ze.exports=o},WwFo:function(ze,E,o){var b=o("juv8"),m=o("7GkX");function Y(F,i){return F&&b(i,m(i),F)}ze.exports=Y},XYm9:function(ze,E,o){var b=o("+K+b");function m(Y,F){var i=F?b(Y.buffer):Y.buffer;return new Y.constructor(i,Y.byteOffset,Y.byteLength)}ze.exports=m},"Xt/L":function(ze,E){function o(b,m,Y){for(var F=-1,i=b==null?0:b.length;++F<i;)if(Y(m,b[F]))return!0;return!1}ze.exports=o},Y8BV:function(ze,E,o){"use strict";o.d(E,"a",function(){return b});function b(m,Y){var F=Y.callback;return F&&(m.dataArray=m.dataArray.filter(F)),m}},YO3V:function(ze,E,o){var b=o("NykK"),m=o("LcsW"),Y=o("ExA7"),F="[object Object]",i=Function.prototype,Z=Object.prototype,D=i.toString,$=Z.hasOwnProperty,te=D.call(Object);function fe(K){if(!Y(K)||b(K)!=F)return!1;var Ge=m(K);if(Ge===null)return!0;var pe=$.call(Ge,"constructor")&&Ge.constructor;return typeof pe=="function"&&pe instanceof pe&&D.call(pe)==te}ze.exports=fe},Yk9n:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("MON2"),m=o("xfSm"),Y=o("GXnB"),F=o("Ztfv"),i=function(){function D($){this._cb=$}return D.prototype.unwrap=function(){return this._cb()},D}();E.LazyServiceIdentifer=i;function Z(D){return function($,te,fe){if(D===void 0)throw new Error(b.UNDEFINED_INJECT_ANNOTATION($.name));var K=new Y.Metadata(m.INJECT_TAG,D);typeof fe=="number"?F.tagParameter($,te,fe,K):F.tagProperty($,te,K)}}E.inject=Z},Z1HP:function(ze,E,o){var b=o("ycre"),m=o("quyA"),Y=o("q4HE");function F(i){return m(i)?Y(i):b(i)}ze.exports=F},ZCgT:function(ze,E,o){var b=o("tLB3"),m=1/0,Y=17976931348623157e292;function F(i){if(!i)return i===0?i:0;if(i=b(i),i===m||i===-m){var Z=i<0?-1:1;return Z*Y}return i===i?i:0}ze.exports=F},ZK94:function(ze,E){ze.exports.RADIUS=6378137,ze.exports.FLATTENING=1/298.257223563,ze.exports.POLAR_RADIUS=63567523142e-4},ZaHm:function(ze,E,o){"use strict";o.r(E),o.d(E,"create",function(){return m}),o.d(E,"clone",function(){return Y}),o.d(E,"copy",function(){return F}),o.d(E,"fromValues",function(){return i}),o.d(E,"set",function(){return Z}),o.d(E,"identity",function(){return D}),o.d(E,"transpose",function(){return $}),o.d(E,"invert",function(){return te}),o.d(E,"adjoint",function(){return fe}),o.d(E,"determinant",function(){return K}),o.d(E,"multiply",function(){return Ge}),o.d(E,"translate",function(){return pe}),o.d(E,"scale",function(){return Ze}),o.d(E,"rotate",function(){return Pe}),o.d(E,"rotateX",function(){return mt}),o.d(E,"rotateY",function(){return De}),o.d(E,"rotateZ",function(){return At}),o.d(E,"fromTranslation",function(){return it}),o.d(E,"fromScaling",function(){return vt}),o.d(E,"fromRotation",function(){return Je}),o.d(E,"fromXRotation",function(){return _t}),o.d(E,"fromYRotation",function(){return wt}),o.d(E,"fromZRotation",function(){return ke}),o.d(E,"fromRotationTranslation",function(){return Re}),o.d(E,"fromQuat2",function(){return Ve}),o.d(E,"getTranslation",function(){return dt}),o.d(E,"getScaling",function(){return Me}),o.d(E,"getRotation",function(){return ht}),o.d(E,"fromRotationTranslationScale",function(){return Zt}),o.d(E,"fromRotationTranslationScaleOrigin",function(){return Qt}),o.d(E,"fromQuat",function(){return ur}),o.d(E,"frustum",function(){return oe}),o.d(E,"perspective",function(){return Q}),o.d(E,"perspectiveFromFieldOfView",function(){return H}),o.d(E,"ortho",function(){return Se}),o.d(E,"lookAt",function(){return be}),o.d(E,"targetTo",function(){return Te}),o.d(E,"str",function(){return me}),o.d(E,"frob",function(){return nt}),o.d(E,"add",function(){return Jt}),o.d(E,"subtract",function(){return Mt}),o.d(E,"multiplyScalar",function(){return ve}),o.d(E,"multiplyScalarAndAdd",function(){return ge}),o.d(E,"exactEquals",function(){return He}),o.d(E,"equals",function(){return ot}),o.d(E,"mul",function(){return we}),o.d(E,"sub",function(){return gt});var b=o("yU0y");function m(){var C=new b.a(16);return b.a!=Float32Array&&(C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=0,C[12]=0,C[13]=0,C[14]=0),C[0]=1,C[5]=1,C[10]=1,C[15]=1,C}function Y(C){var R=new b.a(16);return R[0]=C[0],R[1]=C[1],R[2]=C[2],R[3]=C[3],R[4]=C[4],R[5]=C[5],R[6]=C[6],R[7]=C[7],R[8]=C[8],R[9]=C[9],R[10]=C[10],R[11]=C[11],R[12]=C[12],R[13]=C[13],R[14]=C[14],R[15]=C[15],R}function F(C,R){return C[0]=R[0],C[1]=R[1],C[2]=R[2],C[3]=R[3],C[4]=R[4],C[5]=R[5],C[6]=R[6],C[7]=R[7],C[8]=R[8],C[9]=R[9],C[10]=R[10],C[11]=R[11],C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15],C}function i(C,R,q,ce,We,qe,Tt,at,Ut,J,Qe,ne,et,kt,dr,Ye){var xt=new b.a(16);return xt[0]=C,xt[1]=R,xt[2]=q,xt[3]=ce,xt[4]=We,xt[5]=qe,xt[6]=Tt,xt[7]=at,xt[8]=Ut,xt[9]=J,xt[10]=Qe,xt[11]=ne,xt[12]=et,xt[13]=kt,xt[14]=dr,xt[15]=Ye,xt}function Z(C,R,q,ce,We,qe,Tt,at,Ut,J,Qe,ne,et,kt,dr,Ye,xt){return C[0]=R,C[1]=q,C[2]=ce,C[3]=We,C[4]=qe,C[5]=Tt,C[6]=at,C[7]=Ut,C[8]=J,C[9]=Qe,C[10]=ne,C[11]=et,C[12]=kt,C[13]=dr,C[14]=Ye,C[15]=xt,C}function D(C){return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function $(C,R){if(C===R){var q=R[1],ce=R[2],We=R[3],qe=R[6],Tt=R[7],at=R[11];C[1]=R[4],C[2]=R[8],C[3]=R[12],C[4]=q,C[6]=R[9],C[7]=R[13],C[8]=ce,C[9]=qe,C[11]=R[14],C[12]=We,C[13]=Tt,C[14]=at}else C[0]=R[0],C[1]=R[4],C[2]=R[8],C[3]=R[12],C[4]=R[1],C[5]=R[5],C[6]=R[9],C[7]=R[13],C[8]=R[2],C[9]=R[6],C[10]=R[10],C[11]=R[14],C[12]=R[3],C[13]=R[7],C[14]=R[11],C[15]=R[15];return C}function te(C,R){var q=R[0],ce=R[1],We=R[2],qe=R[3],Tt=R[4],at=R[5],Ut=R[6],J=R[7],Qe=R[8],ne=R[9],et=R[10],kt=R[11],dr=R[12],Ye=R[13],xt=R[14],bt=R[15],Et=q*at-ce*Tt,Fe=q*Ut-We*Tt,pt=q*J-qe*Tt,yt=ce*Ut-We*at,Ht=ce*J-qe*at,hr=We*J-qe*Ut,Hr=Qe*Ye-ne*dr,gr=Qe*xt-et*dr,Bn=Qe*bt-kt*dr,zn=ne*xt-et*Ye,oa=ne*bt-kt*Ye,$n=et*bt-kt*xt,Yn=Et*$n-Fe*oa+pt*zn+yt*Bn-Ht*gr+hr*Hr;return Yn?(Yn=1/Yn,C[0]=(at*$n-Ut*oa+J*zn)*Yn,C[1]=(We*oa-ce*$n-qe*zn)*Yn,C[2]=(Ye*hr-xt*Ht+bt*yt)*Yn,C[3]=(et*Ht-ne*hr-kt*yt)*Yn,C[4]=(Ut*Bn-Tt*$n-J*gr)*Yn,C[5]=(q*$n-We*Bn+qe*gr)*Yn,C[6]=(xt*pt-dr*hr-bt*Fe)*Yn,C[7]=(Qe*hr-et*pt+kt*Fe)*Yn,C[8]=(Tt*oa-at*Bn+J*Hr)*Yn,C[9]=(ce*Bn-q*oa-qe*Hr)*Yn,C[10]=(dr*Ht-Ye*pt+bt*Et)*Yn,C[11]=(ne*pt-Qe*Ht-kt*Et)*Yn,C[12]=(at*gr-Tt*zn-Ut*Hr)*Yn,C[13]=(q*zn-ce*gr+We*Hr)*Yn,C[14]=(Ye*Fe-dr*yt-xt*Et)*Yn,C[15]=(Qe*yt-ne*Fe+et*Et)*Yn,C):null}function fe(C,R){var q=R[0],ce=R[1],We=R[2],qe=R[3],Tt=R[4],at=R[5],Ut=R[6],J=R[7],Qe=R[8],ne=R[9],et=R[10],kt=R[11],dr=R[12],Ye=R[13],xt=R[14],bt=R[15];return C[0]=at*(et*bt-kt*xt)-ne*(Ut*bt-J*xt)+Ye*(Ut*kt-J*et),C[1]=-(ce*(et*bt-kt*xt)-ne*(We*bt-qe*xt)+Ye*(We*kt-qe*et)),C[2]=ce*(Ut*bt-J*xt)-at*(We*bt-qe*xt)+Ye*(We*J-qe*Ut),C[3]=-(ce*(Ut*kt-J*et)-at*(We*kt-qe*et)+ne*(We*J-qe*Ut)),C[4]=-(Tt*(et*bt-kt*xt)-Qe*(Ut*bt-J*xt)+dr*(Ut*kt-J*et)),C[5]=q*(et*bt-kt*xt)-Qe*(We*bt-qe*xt)+dr*(We*kt-qe*et),C[6]=-(q*(Ut*bt-J*xt)-Tt*(We*bt-qe*xt)+dr*(We*J-qe*Ut)),C[7]=q*(Ut*kt-J*et)-Tt*(We*kt-qe*et)+Qe*(We*J-qe*Ut),C[8]=Tt*(ne*bt-kt*Ye)-Qe*(at*bt-J*Ye)+dr*(at*kt-J*ne),C[9]=-(q*(ne*bt-kt*Ye)-Qe*(ce*bt-qe*Ye)+dr*(ce*kt-qe*ne)),C[10]=q*(at*bt-J*Ye)-Tt*(ce*bt-qe*Ye)+dr*(ce*J-qe*at),C[11]=-(q*(at*kt-J*ne)-Tt*(ce*kt-qe*ne)+Qe*(ce*J-qe*at)),C[12]=-(Tt*(ne*xt-et*Ye)-Qe*(at*xt-Ut*Ye)+dr*(at*et-Ut*ne)),C[13]=q*(ne*xt-et*Ye)-Qe*(ce*xt-We*Ye)+dr*(ce*et-We*ne),C[14]=-(q*(at*xt-Ut*Ye)-Tt*(ce*xt-We*Ye)+dr*(ce*Ut-We*at)),C[15]=q*(at*et-Ut*ne)-Tt*(ce*et-We*ne)+Qe*(ce*Ut-We*at),C}function K(C){var R=C[0],q=C[1],ce=C[2],We=C[3],qe=C[4],Tt=C[5],at=C[6],Ut=C[7],J=C[8],Qe=C[9],ne=C[10],et=C[11],kt=C[12],dr=C[13],Ye=C[14],xt=C[15],bt=R*Tt-q*qe,Et=R*at-ce*qe,Fe=R*Ut-We*qe,pt=q*at-ce*Tt,yt=q*Ut-We*Tt,Ht=ce*Ut-We*at,hr=J*dr-Qe*kt,Hr=J*Ye-ne*kt,gr=J*xt-et*kt,Bn=Qe*Ye-ne*dr,zn=Qe*xt-et*dr,oa=ne*xt-et*Ye;return bt*oa-Et*zn+Fe*Bn+pt*gr-yt*Hr+Ht*hr}function Ge(C,R,q){var ce=R[0],We=R[1],qe=R[2],Tt=R[3],at=R[4],Ut=R[5],J=R[6],Qe=R[7],ne=R[8],et=R[9],kt=R[10],dr=R[11],Ye=R[12],xt=R[13],bt=R[14],Et=R[15],Fe=q[0],pt=q[1],yt=q[2],Ht=q[3];return C[0]=Fe*ce+pt*at+yt*ne+Ht*Ye,C[1]=Fe*We+pt*Ut+yt*et+Ht*xt,C[2]=Fe*qe+pt*J+yt*kt+Ht*bt,C[3]=Fe*Tt+pt*Qe+yt*dr+Ht*Et,Fe=q[4],pt=q[5],yt=q[6],Ht=q[7],C[4]=Fe*ce+pt*at+yt*ne+Ht*Ye,C[5]=Fe*We+pt*Ut+yt*et+Ht*xt,C[6]=Fe*qe+pt*J+yt*kt+Ht*bt,C[7]=Fe*Tt+pt*Qe+yt*dr+Ht*Et,Fe=q[8],pt=q[9],yt=q[10],Ht=q[11],C[8]=Fe*ce+pt*at+yt*ne+Ht*Ye,C[9]=Fe*We+pt*Ut+yt*et+Ht*xt,C[10]=Fe*qe+pt*J+yt*kt+Ht*bt,C[11]=Fe*Tt+pt*Qe+yt*dr+Ht*Et,Fe=q[12],pt=q[13],yt=q[14],Ht=q[15],C[12]=Fe*ce+pt*at+yt*ne+Ht*Ye,C[13]=Fe*We+pt*Ut+yt*et+Ht*xt,C[14]=Fe*qe+pt*J+yt*kt+Ht*bt,C[15]=Fe*Tt+pt*Qe+yt*dr+Ht*Et,C}function pe(C,R,q){var ce=q[0],We=q[1],qe=q[2],Tt,at,Ut,J,Qe,ne,et,kt,dr,Ye,xt,bt;return R===C?(C[12]=R[0]*ce+R[4]*We+R[8]*qe+R[12],C[13]=R[1]*ce+R[5]*We+R[9]*qe+R[13],C[14]=R[2]*ce+R[6]*We+R[10]*qe+R[14],C[15]=R[3]*ce+R[7]*We+R[11]*qe+R[15]):(Tt=R[0],at=R[1],Ut=R[2],J=R[3],Qe=R[4],ne=R[5],et=R[6],kt=R[7],dr=R[8],Ye=R[9],xt=R[10],bt=R[11],C[0]=Tt,C[1]=at,C[2]=Ut,C[3]=J,C[4]=Qe,C[5]=ne,C[6]=et,C[7]=kt,C[8]=dr,C[9]=Ye,C[10]=xt,C[11]=bt,C[12]=Tt*ce+Qe*We+dr*qe+R[12],C[13]=at*ce+ne*We+Ye*qe+R[13],C[14]=Ut*ce+et*We+xt*qe+R[14],C[15]=J*ce+kt*We+bt*qe+R[15]),C}function Ze(C,R,q){var ce=q[0],We=q[1],qe=q[2];return C[0]=R[0]*ce,C[1]=R[1]*ce,C[2]=R[2]*ce,C[3]=R[3]*ce,C[4]=R[4]*We,C[5]=R[5]*We,C[6]=R[6]*We,C[7]=R[7]*We,C[8]=R[8]*qe,C[9]=R[9]*qe,C[10]=R[10]*qe,C[11]=R[11]*qe,C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15],C}function Pe(C,R,q,ce){var We=ce[0],qe=ce[1],Tt=ce[2],at=Math.hypot(We,qe,Tt),Ut,J,Qe,ne,et,kt,dr,Ye,xt,bt,Et,Fe,pt,yt,Ht,hr,Hr,gr,Bn,zn,oa,$n,Yn,On;return at<b.b?null:(at=1/at,We*=at,qe*=at,Tt*=at,Ut=Math.sin(q),J=Math.cos(q),Qe=1-J,ne=R[0],et=R[1],kt=R[2],dr=R[3],Ye=R[4],xt=R[5],bt=R[6],Et=R[7],Fe=R[8],pt=R[9],yt=R[10],Ht=R[11],hr=We*We*Qe+J,Hr=qe*We*Qe+Tt*Ut,gr=Tt*We*Qe-qe*Ut,Bn=We*qe*Qe-Tt*Ut,zn=qe*qe*Qe+J,oa=Tt*qe*Qe+We*Ut,$n=We*Tt*Qe+qe*Ut,Yn=qe*Tt*Qe-We*Ut,On=Tt*Tt*Qe+J,C[0]=ne*hr+Ye*Hr+Fe*gr,C[1]=et*hr+xt*Hr+pt*gr,C[2]=kt*hr+bt*Hr+yt*gr,C[3]=dr*hr+Et*Hr+Ht*gr,C[4]=ne*Bn+Ye*zn+Fe*oa,C[5]=et*Bn+xt*zn+pt*oa,C[6]=kt*Bn+bt*zn+yt*oa,C[7]=dr*Bn+Et*zn+Ht*oa,C[8]=ne*$n+Ye*Yn+Fe*On,C[9]=et*$n+xt*Yn+pt*On,C[10]=kt*$n+bt*Yn+yt*On,C[11]=dr*$n+Et*Yn+Ht*On,R!==C&&(C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15]),C)}function mt(C,R,q){var ce=Math.sin(q),We=Math.cos(q),qe=R[4],Tt=R[5],at=R[6],Ut=R[7],J=R[8],Qe=R[9],ne=R[10],et=R[11];return R!==C&&(C[0]=R[0],C[1]=R[1],C[2]=R[2],C[3]=R[3],C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15]),C[4]=qe*We+J*ce,C[5]=Tt*We+Qe*ce,C[6]=at*We+ne*ce,C[7]=Ut*We+et*ce,C[8]=J*We-qe*ce,C[9]=Qe*We-Tt*ce,C[10]=ne*We-at*ce,C[11]=et*We-Ut*ce,C}function De(C,R,q){var ce=Math.sin(q),We=Math.cos(q),qe=R[0],Tt=R[1],at=R[2],Ut=R[3],J=R[8],Qe=R[9],ne=R[10],et=R[11];return R!==C&&(C[4]=R[4],C[5]=R[5],C[6]=R[6],C[7]=R[7],C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15]),C[0]=qe*We-J*ce,C[1]=Tt*We-Qe*ce,C[2]=at*We-ne*ce,C[3]=Ut*We-et*ce,C[8]=qe*ce+J*We,C[9]=Tt*ce+Qe*We,C[10]=at*ce+ne*We,C[11]=Ut*ce+et*We,C}function At(C,R,q){var ce=Math.sin(q),We=Math.cos(q),qe=R[0],Tt=R[1],at=R[2],Ut=R[3],J=R[4],Qe=R[5],ne=R[6],et=R[7];return R!==C&&(C[8]=R[8],C[9]=R[9],C[10]=R[10],C[11]=R[11],C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15]),C[0]=qe*We+J*ce,C[1]=Tt*We+Qe*ce,C[2]=at*We+ne*ce,C[3]=Ut*We+et*ce,C[4]=J*We-qe*ce,C[5]=Qe*We-Tt*ce,C[6]=ne*We-at*ce,C[7]=et*We-Ut*ce,C}function it(C,R){return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=R[0],C[13]=R[1],C[14]=R[2],C[15]=1,C}function vt(C,R){return C[0]=R[0],C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=R[1],C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=R[2],C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function Je(C,R,q){var ce=q[0],We=q[1],qe=q[2],Tt=Math.hypot(ce,We,qe),at,Ut,J;return Tt<b.b?null:(Tt=1/Tt,ce*=Tt,We*=Tt,qe*=Tt,at=Math.sin(R),Ut=Math.cos(R),J=1-Ut,C[0]=ce*ce*J+Ut,C[1]=We*ce*J+qe*at,C[2]=qe*ce*J-We*at,C[3]=0,C[4]=ce*We*J-qe*at,C[5]=We*We*J+Ut,C[6]=qe*We*J+ce*at,C[7]=0,C[8]=ce*qe*J+We*at,C[9]=We*qe*J-ce*at,C[10]=qe*qe*J+Ut,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C)}function _t(C,R){var q=Math.sin(R),ce=Math.cos(R);return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=ce,C[6]=q,C[7]=0,C[8]=0,C[9]=-q,C[10]=ce,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function wt(C,R){var q=Math.sin(R),ce=Math.cos(R);return C[0]=ce,C[1]=0,C[2]=-q,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=q,C[9]=0,C[10]=ce,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function ke(C,R){var q=Math.sin(R),ce=Math.cos(R);return C[0]=ce,C[1]=q,C[2]=0,C[3]=0,C[4]=-q,C[5]=ce,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function Re(C,R,q){var ce=R[0],We=R[1],qe=R[2],Tt=R[3],at=ce+ce,Ut=We+We,J=qe+qe,Qe=ce*at,ne=ce*Ut,et=ce*J,kt=We*Ut,dr=We*J,Ye=qe*J,xt=Tt*at,bt=Tt*Ut,Et=Tt*J;return C[0]=1-(kt+Ye),C[1]=ne+Et,C[2]=et-bt,C[3]=0,C[4]=ne-Et,C[5]=1-(Qe+Ye),C[6]=dr+xt,C[7]=0,C[8]=et+bt,C[9]=dr-xt,C[10]=1-(Qe+kt),C[11]=0,C[12]=q[0],C[13]=q[1],C[14]=q[2],C[15]=1,C}function Ve(C,R){var q=new b.a(3),ce=-R[0],We=-R[1],qe=-R[2],Tt=R[3],at=R[4],Ut=R[5],J=R[6],Qe=R[7],ne=ce*ce+We*We+qe*qe+Tt*Tt;return ne>0?(q[0]=(at*Tt+Qe*ce+Ut*qe-J*We)*2/ne,q[1]=(Ut*Tt+Qe*We+J*ce-at*qe)*2/ne,q[2]=(J*Tt+Qe*qe+at*We-Ut*ce)*2/ne):(q[0]=(at*Tt+Qe*ce+Ut*qe-J*We)*2,q[1]=(Ut*Tt+Qe*We+J*ce-at*qe)*2,q[2]=(J*Tt+Qe*qe+at*We-Ut*ce)*2),Re(C,R,q),C}function dt(C,R){return C[0]=R[12],C[1]=R[13],C[2]=R[14],C}function Me(C,R){var q=R[0],ce=R[1],We=R[2],qe=R[4],Tt=R[5],at=R[6],Ut=R[8],J=R[9],Qe=R[10];return C[0]=Math.hypot(q,ce,We),C[1]=Math.hypot(qe,Tt,at),C[2]=Math.hypot(Ut,J,Qe),C}function ht(C,R){var q=new b.a(3);Me(q,R);var ce=1/q[0],We=1/q[1],qe=1/q[2],Tt=R[0]*ce,at=R[1]*We,Ut=R[2]*qe,J=R[4]*ce,Qe=R[5]*We,ne=R[6]*qe,et=R[8]*ce,kt=R[9]*We,dr=R[10]*qe,Ye=Tt+Qe+dr,xt=0;return Ye>0?(xt=Math.sqrt(Ye+1)*2,C[3]=.25*xt,C[0]=(ne-kt)/xt,C[1]=(et-Ut)/xt,C[2]=(at-J)/xt):Tt>Qe&&Tt>dr?(xt=Math.sqrt(1+Tt-Qe-dr)*2,C[3]=(ne-kt)/xt,C[0]=.25*xt,C[1]=(at+J)/xt,C[2]=(et+Ut)/xt):Qe>dr?(xt=Math.sqrt(1+Qe-Tt-dr)*2,C[3]=(et-Ut)/xt,C[0]=(at+J)/xt,C[1]=.25*xt,C[2]=(ne+kt)/xt):(xt=Math.sqrt(1+dr-Tt-Qe)*2,C[3]=(at-J)/xt,C[0]=(et+Ut)/xt,C[1]=(ne+kt)/xt,C[2]=.25*xt),C}function Zt(C,R,q,ce){var We=R[0],qe=R[1],Tt=R[2],at=R[3],Ut=We+We,J=qe+qe,Qe=Tt+Tt,ne=We*Ut,et=We*J,kt=We*Qe,dr=qe*J,Ye=qe*Qe,xt=Tt*Qe,bt=at*Ut,Et=at*J,Fe=at*Qe,pt=ce[0],yt=ce[1],Ht=ce[2];return C[0]=(1-(dr+xt))*pt,C[1]=(et+Fe)*pt,C[2]=(kt-Et)*pt,C[3]=0,C[4]=(et-Fe)*yt,C[5]=(1-(ne+xt))*yt,C[6]=(Ye+bt)*yt,C[7]=0,C[8]=(kt+Et)*Ht,C[9]=(Ye-bt)*Ht,C[10]=(1-(ne+dr))*Ht,C[11]=0,C[12]=q[0],C[13]=q[1],C[14]=q[2],C[15]=1,C}function Qt(C,R,q,ce,We){var qe=R[0],Tt=R[1],at=R[2],Ut=R[3],J=qe+qe,Qe=Tt+Tt,ne=at+at,et=qe*J,kt=qe*Qe,dr=qe*ne,Ye=Tt*Qe,xt=Tt*ne,bt=at*ne,Et=Ut*J,Fe=Ut*Qe,pt=Ut*ne,yt=ce[0],Ht=ce[1],hr=ce[2],Hr=We[0],gr=We[1],Bn=We[2],zn=(1-(Ye+bt))*yt,oa=(kt+pt)*yt,$n=(dr-Fe)*yt,Yn=(kt-pt)*Ht,On=(1-(et+bt))*Ht,U=(xt+Et)*Ht,W=(dr+Fe)*hr,le=(xt-Et)*hr,xe=(1-(et+Ye))*hr;return C[0]=zn,C[1]=oa,C[2]=$n,C[3]=0,C[4]=Yn,C[5]=On,C[6]=U,C[7]=0,C[8]=W,C[9]=le,C[10]=xe,C[11]=0,C[12]=q[0]+Hr-(zn*Hr+Yn*gr+W*Bn),C[13]=q[1]+gr-(oa*Hr+On*gr+le*Bn),C[14]=q[2]+Bn-($n*Hr+U*gr+xe*Bn),C[15]=1,C}function ur(C,R){var q=R[0],ce=R[1],We=R[2],qe=R[3],Tt=q+q,at=ce+ce,Ut=We+We,J=q*Tt,Qe=ce*Tt,ne=ce*at,et=We*Tt,kt=We*at,dr=We*Ut,Ye=qe*Tt,xt=qe*at,bt=qe*Ut;return C[0]=1-ne-dr,C[1]=Qe+bt,C[2]=et-xt,C[3]=0,C[4]=Qe-bt,C[5]=1-J-dr,C[6]=kt+Ye,C[7]=0,C[8]=et+xt,C[9]=kt-Ye,C[10]=1-J-ne,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function oe(C,R,q,ce,We,qe,Tt){var at=1/(q-R),Ut=1/(We-ce),J=1/(qe-Tt);return C[0]=qe*2*at,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=qe*2*Ut,C[6]=0,C[7]=0,C[8]=(q+R)*at,C[9]=(We+ce)*Ut,C[10]=(Tt+qe)*J,C[11]=-1,C[12]=0,C[13]=0,C[14]=Tt*qe*2*J,C[15]=0,C}function Q(C,R,q,ce,We){var qe=1/Math.tan(R/2),Tt;return C[0]=qe/q,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=qe,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=-1,C[12]=0,C[13]=0,C[15]=0,We!=null&&We!==Infinity?(Tt=1/(ce-We),C[10]=(We+ce)*Tt,C[14]=2*We*ce*Tt):(C[10]=-1,C[14]=-2*ce),C}function H(C,R,q,ce){var We=Math.tan(R.upDegrees*Math.PI/180),qe=Math.tan(R.downDegrees*Math.PI/180),Tt=Math.tan(R.leftDegrees*Math.PI/180),at=Math.tan(R.rightDegrees*Math.PI/180),Ut=2/(Tt+at),J=2/(We+qe);return C[0]=Ut,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=J,C[6]=0,C[7]=0,C[8]=-((Tt-at)*Ut*.5),C[9]=(We-qe)*J*.5,C[10]=ce/(q-ce),C[11]=-1,C[12]=0,C[13]=0,C[14]=ce*q/(q-ce),C[15]=0,C}function Se(C,R,q,ce,We,qe,Tt){var at=1/(R-q),Ut=1/(ce-We),J=1/(qe-Tt);return C[0]=-2*at,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=-2*Ut,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=2*J,C[11]=0,C[12]=(R+q)*at,C[13]=(We+ce)*Ut,C[14]=(Tt+qe)*J,C[15]=1,C}function be(C,R,q,ce){var We,qe,Tt,at,Ut,J,Qe,ne,et,kt,dr=R[0],Ye=R[1],xt=R[2],bt=ce[0],Et=ce[1],Fe=ce[2],pt=q[0],yt=q[1],Ht=q[2];return Math.abs(dr-pt)<b.b&&Math.abs(Ye-yt)<b.b&&Math.abs(xt-Ht)<b.b?D(C):(Qe=dr-pt,ne=Ye-yt,et=xt-Ht,kt=1/Math.hypot(Qe,ne,et),Qe*=kt,ne*=kt,et*=kt,We=Et*et-Fe*ne,qe=Fe*Qe-bt*et,Tt=bt*ne-Et*Qe,kt=Math.hypot(We,qe,Tt),kt?(kt=1/kt,We*=kt,qe*=kt,Tt*=kt):(We=0,qe=0,Tt=0),at=ne*Tt-et*qe,Ut=et*We-Qe*Tt,J=Qe*qe-ne*We,kt=Math.hypot(at,Ut,J),kt?(kt=1/kt,at*=kt,Ut*=kt,J*=kt):(at=0,Ut=0,J=0),C[0]=We,C[1]=at,C[2]=Qe,C[3]=0,C[4]=qe,C[5]=Ut,C[6]=ne,C[7]=0,C[8]=Tt,C[9]=J,C[10]=et,C[11]=0,C[12]=-(We*dr+qe*Ye+Tt*xt),C[13]=-(at*dr+Ut*Ye+J*xt),C[14]=-(Qe*dr+ne*Ye+et*xt),C[15]=1,C)}function Te(C,R,q,ce){var We=R[0],qe=R[1],Tt=R[2],at=ce[0],Ut=ce[1],J=ce[2],Qe=We-q[0],ne=qe-q[1],et=Tt-q[2],kt=Qe*Qe+ne*ne+et*et;kt>0&&(kt=1/Math.sqrt(kt),Qe*=kt,ne*=kt,et*=kt);var dr=Ut*et-J*ne,Ye=J*Qe-at*et,xt=at*ne-Ut*Qe;return kt=dr*dr+Ye*Ye+xt*xt,kt>0&&(kt=1/Math.sqrt(kt),dr*=kt,Ye*=kt,xt*=kt),C[0]=dr,C[1]=Ye,C[2]=xt,C[3]=0,C[4]=ne*xt-et*Ye,C[5]=et*dr-Qe*xt,C[6]=Qe*Ye-ne*dr,C[7]=0,C[8]=Qe,C[9]=ne,C[10]=et,C[11]=0,C[12]=We,C[13]=qe,C[14]=Tt,C[15]=1,C}function me(C){return"mat4("+C[0]+", "+C[1]+", "+C[2]+", "+C[3]+", "+C[4]+", "+C[5]+", "+C[6]+", "+C[7]+", "+C[8]+", "+C[9]+", "+C[10]+", "+C[11]+", "+C[12]+", "+C[13]+", "+C[14]+", "+C[15]+")"}function nt(C){return Math.hypot(C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7],C[8],C[9],C[10],C[11],C[12],C[13],C[14],C[15])}function Jt(C,R,q){return C[0]=R[0]+q[0],C[1]=R[1]+q[1],C[2]=R[2]+q[2],C[3]=R[3]+q[3],C[4]=R[4]+q[4],C[5]=R[5]+q[5],C[6]=R[6]+q[6],C[7]=R[7]+q[7],C[8]=R[8]+q[8],C[9]=R[9]+q[9],C[10]=R[10]+q[10],C[11]=R[11]+q[11],C[12]=R[12]+q[12],C[13]=R[13]+q[13],C[14]=R[14]+q[14],C[15]=R[15]+q[15],C}function Mt(C,R,q){return C[0]=R[0]-q[0],C[1]=R[1]-q[1],C[2]=R[2]-q[2],C[3]=R[3]-q[3],C[4]=R[4]-q[4],C[5]=R[5]-q[5],C[6]=R[6]-q[6],C[7]=R[7]-q[7],C[8]=R[8]-q[8],C[9]=R[9]-q[9],C[10]=R[10]-q[10],C[11]=R[11]-q[11],C[12]=R[12]-q[12],C[13]=R[13]-q[13],C[14]=R[14]-q[14],C[15]=R[15]-q[15],C}function ve(C,R,q){return C[0]=R[0]*q,C[1]=R[1]*q,C[2]=R[2]*q,C[3]=R[3]*q,C[4]=R[4]*q,C[5]=R[5]*q,C[6]=R[6]*q,C[7]=R[7]*q,C[8]=R[8]*q,C[9]=R[9]*q,C[10]=R[10]*q,C[11]=R[11]*q,C[12]=R[12]*q,C[13]=R[13]*q,C[14]=R[14]*q,C[15]=R[15]*q,C}function ge(C,R,q,ce){return C[0]=R[0]+q[0]*ce,C[1]=R[1]+q[1]*ce,C[2]=R[2]+q[2]*ce,C[3]=R[3]+q[3]*ce,C[4]=R[4]+q[4]*ce,C[5]=R[5]+q[5]*ce,C[6]=R[6]+q[6]*ce,C[7]=R[7]+q[7]*ce,C[8]=R[8]+q[8]*ce,C[9]=R[9]+q[9]*ce,C[10]=R[10]+q[10]*ce,C[11]=R[11]+q[11]*ce,C[12]=R[12]+q[12]*ce,C[13]=R[13]+q[13]*ce,C[14]=R[14]+q[14]*ce,C[15]=R[15]+q[15]*ce,C}function He(C,R){return C[0]===R[0]&&C[1]===R[1]&&C[2]===R[2]&&C[3]===R[3]&&C[4]===R[4]&&C[5]===R[5]&&C[6]===R[6]&&C[7]===R[7]&&C[8]===R[8]&&C[9]===R[9]&&C[10]===R[10]&&C[11]===R[11]&&C[12]===R[12]&&C[13]===R[13]&&C[14]===R[14]&&C[15]===R[15]}function ot(C,R){var q=C[0],ce=C[1],We=C[2],qe=C[3],Tt=C[4],at=C[5],Ut=C[6],J=C[7],Qe=C[8],ne=C[9],et=C[10],kt=C[11],dr=C[12],Ye=C[13],xt=C[14],bt=C[15],Et=R[0],Fe=R[1],pt=R[2],yt=R[3],Ht=R[4],hr=R[5],Hr=R[6],gr=R[7],Bn=R[8],zn=R[9],oa=R[10],$n=R[11],Yn=R[12],On=R[13],U=R[14],W=R[15];return Math.abs(q-Et)<=b.b*Math.max(1,Math.abs(q),Math.abs(Et))&&Math.abs(ce-Fe)<=b.b*Math.max(1,Math.abs(ce),Math.abs(Fe))&&Math.abs(We-pt)<=b.b*Math.max(1,Math.abs(We),Math.abs(pt))&&Math.abs(qe-yt)<=b.b*Math.max(1,Math.abs(qe),Math.abs(yt))&&Math.abs(Tt-Ht)<=b.b*Math.max(1,Math.abs(Tt),Math.abs(Ht))&&Math.abs(at-hr)<=b.b*Math.max(1,Math.abs(at),Math.abs(hr))&&Math.abs(Ut-Hr)<=b.b*Math.max(1,Math.abs(Ut),Math.abs(Hr))&&Math.abs(J-gr)<=b.b*Math.max(1,Math.abs(J),Math.abs(gr))&&Math.abs(Qe-Bn)<=b.b*Math.max(1,Math.abs(Qe),Math.abs(Bn))&&Math.abs(ne-zn)<=b.b*Math.max(1,Math.abs(ne),Math.abs(zn))&&Math.abs(et-oa)<=b.b*Math.max(1,Math.abs(et),Math.abs(oa))&&Math.abs(kt-$n)<=b.b*Math.max(1,Math.abs(kt),Math.abs($n))&&Math.abs(dr-Yn)<=b.b*Math.max(1,Math.abs(dr),Math.abs(Yn))&&Math.abs(Ye-On)<=b.b*Math.max(1,Math.abs(Ye),Math.abs(On))&&Math.abs(xt-U)<=b.b*Math.max(1,Math.abs(xt),Math.abs(U))&&Math.abs(bt-W)<=b.b*Math.max(1,Math.abs(bt),Math.abs(W))}var we=Ge,gt=Mt},Ztfv:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("MON2"),m=o("xfSm");function Y(te,fe,K,Ge){var pe=m.TAGGED;i(pe,te,fe,Ge,K)}E.tagParameter=Y;function F(te,fe,K){var Ge=m.TAGGED_PROP;i(Ge,te.constructor,fe,K)}E.tagProperty=F;function i(te,fe,K,Ge,pe){var Ze={},Pe=typeof pe=="number",mt=pe!==void 0&&Pe?pe.toString():K;if(Pe&&K!==void 0)throw new Error(b.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(te,fe)&&(Ze=Reflect.getMetadata(te,fe));var De=Ze[mt];if(!Array.isArray(De))De=[];else for(var At=0,it=De;At<it.length;At++){var vt=it[At];if(vt.key===Ge.key)throw new Error(b.DUPLICATED_METADATA+" "+vt.key.toString())}De.push(Ge),Ze[mt]=De,Reflect.defineMetadata(te,Ze,fe)}function Z(te,fe){Reflect.decorate(te,fe)}function D(te,fe){return function(K,Ge){fe(K,Ge,te)}}function $(te,fe,K){typeof K=="number"?Z([D(K,te)],fe):typeof K=="string"?Reflect.decorate([te],fe,K):Z([te],fe)}E.decorate=$},ZxFD:function(ze,E,o){"use strict";o.r(E),o.d(E,"create",function(){return m}),o.d(E,"clone",function(){return Y}),o.d(E,"fromValues",function(){return F}),o.d(E,"copy",function(){return i}),o.d(E,"set",function(){return Z}),o.d(E,"add",function(){return D}),o.d(E,"subtract",function(){return $}),o.d(E,"multiply",function(){return te}),o.d(E,"divide",function(){return fe}),o.d(E,"ceil",function(){return K}),o.d(E,"floor",function(){return Ge}),o.d(E,"min",function(){return pe}),o.d(E,"max",function(){return Ze}),o.d(E,"round",function(){return Pe}),o.d(E,"scale",function(){return mt}),o.d(E,"scaleAndAdd",function(){return De}),o.d(E,"distance",function(){return At}),o.d(E,"squaredDistance",function(){return it}),o.d(E,"length",function(){return vt}),o.d(E,"squaredLength",function(){return Je}),o.d(E,"negate",function(){return _t}),o.d(E,"inverse",function(){return wt}),o.d(E,"normalize",function(){return ke}),o.d(E,"dot",function(){return Re}),o.d(E,"cross",function(){return Ve}),o.d(E,"lerp",function(){return dt}),o.d(E,"random",function(){return Me}),o.d(E,"transformMat2",function(){return ht}),o.d(E,"transformMat2d",function(){return Zt}),o.d(E,"transformMat3",function(){return Qt}),o.d(E,"transformMat4",function(){return ur}),o.d(E,"rotate",function(){return oe}),o.d(E,"angle",function(){return Q}),o.d(E,"zero",function(){return H}),o.d(E,"str",function(){return Se}),o.d(E,"exactEquals",function(){return be}),o.d(E,"equals",function(){return Te}),o.d(E,"len",function(){return me}),o.d(E,"sub",function(){return nt}),o.d(E,"mul",function(){return Jt}),o.d(E,"div",function(){return Mt}),o.d(E,"dist",function(){return ve}),o.d(E,"sqrDist",function(){return ge}),o.d(E,"sqrLen",function(){return He}),o.d(E,"forEach",function(){return ot});var b=o("yU0y");function m(){var we=new b.a(2);return b.a!=Float32Array&&(we[0]=0,we[1]=0),we}function Y(we){var gt=new b.a(2);return gt[0]=we[0],gt[1]=we[1],gt}function F(we,gt){var C=new b.a(2);return C[0]=we,C[1]=gt,C}function i(we,gt){return we[0]=gt[0],we[1]=gt[1],we}function Z(we,gt,C){return we[0]=gt,we[1]=C,we}function D(we,gt,C){return we[0]=gt[0]+C[0],we[1]=gt[1]+C[1],we}function $(we,gt,C){return we[0]=gt[0]-C[0],we[1]=gt[1]-C[1],we}function te(we,gt,C){return we[0]=gt[0]*C[0],we[1]=gt[1]*C[1],we}function fe(we,gt,C){return we[0]=gt[0]/C[0],we[1]=gt[1]/C[1],we}function K(we,gt){return we[0]=Math.ceil(gt[0]),we[1]=Math.ceil(gt[1]),we}function Ge(we,gt){return we[0]=Math.floor(gt[0]),we[1]=Math.floor(gt[1]),we}function pe(we,gt,C){return we[0]=Math.min(gt[0],C[0]),we[1]=Math.min(gt[1],C[1]),we}function Ze(we,gt,C){return we[0]=Math.max(gt[0],C[0]),we[1]=Math.max(gt[1],C[1]),we}function Pe(we,gt){return we[0]=Math.round(gt[0]),we[1]=Math.round(gt[1]),we}function mt(we,gt,C){return we[0]=gt[0]*C,we[1]=gt[1]*C,we}function De(we,gt,C,R){return we[0]=gt[0]+C[0]*R,we[1]=gt[1]+C[1]*R,we}function At(we,gt){var C=gt[0]-we[0],R=gt[1]-we[1];return Math.hypot(C,R)}function it(we,gt){var C=gt[0]-we[0],R=gt[1]-we[1];return C*C+R*R}function vt(we){var gt=we[0],C=we[1];return Math.hypot(gt,C)}function Je(we){var gt=we[0],C=we[1];return gt*gt+C*C}function _t(we,gt){return we[0]=-gt[0],we[1]=-gt[1],we}function wt(we,gt){return we[0]=1/gt[0],we[1]=1/gt[1],we}function ke(we,gt){var C=gt[0],R=gt[1],q=C*C+R*R;return q>0&&(q=1/Math.sqrt(q)),we[0]=gt[0]*q,we[1]=gt[1]*q,we}function Re(we,gt){return we[0]*gt[0]+we[1]*gt[1]}function Ve(we,gt,C){var R=gt[0]*C[1]-gt[1]*C[0];return we[0]=we[1]=0,we[2]=R,we}function dt(we,gt,C,R){var q=gt[0],ce=gt[1];return we[0]=q+R*(C[0]-q),we[1]=ce+R*(C[1]-ce),we}function Me(we,gt){gt=gt||1;var C=b.c()*2*Math.PI;return we[0]=Math.cos(C)*gt,we[1]=Math.sin(C)*gt,we}function ht(we,gt,C){var R=gt[0],q=gt[1];return we[0]=C[0]*R+C[2]*q,we[1]=C[1]*R+C[3]*q,we}function Zt(we,gt,C){var R=gt[0],q=gt[1];return we[0]=C[0]*R+C[2]*q+C[4],we[1]=C[1]*R+C[3]*q+C[5],we}function Qt(we,gt,C){var R=gt[0],q=gt[1];return we[0]=C[0]*R+C[3]*q+C[6],we[1]=C[1]*R+C[4]*q+C[7],we}function ur(we,gt,C){var R=gt[0],q=gt[1];return we[0]=C[0]*R+C[4]*q+C[12],we[1]=C[1]*R+C[5]*q+C[13],we}function oe(we,gt,C,R){var q=gt[0]-C[0],ce=gt[1]-C[1],We=Math.sin(R),qe=Math.cos(R);return we[0]=q*qe-ce*We+C[0],we[1]=q*We+ce*qe+C[1],we}function Q(we,gt){var C=we[0],R=we[1],q=gt[0],ce=gt[1],We=Math.sqrt(C*C+R*R)*Math.sqrt(q*q+ce*ce),qe=We&&(C*q+R*ce)/We;return Math.acos(Math.min(Math.max(qe,-1),1))}function H(we){return we[0]=0,we[1]=0,we}function Se(we){return"vec2("+we[0]+", "+we[1]+")"}function be(we,gt){return we[0]===gt[0]&&we[1]===gt[1]}function Te(we,gt){var C=we[0],R=we[1],q=gt[0],ce=gt[1];return Math.abs(C-q)<=b.b*Math.max(1,Math.abs(C),Math.abs(q))&&Math.abs(R-ce)<=b.b*Math.max(1,Math.abs(R),Math.abs(ce))}var me=vt,nt=$,Jt=te,Mt=fe,ve=At,ge=it,He=Je,ot=function(){var we=m();return function(gt,C,R,q,ce,We){var qe,Tt;for(C||(C=2),R||(R=0),q?Tt=Math.min(q*C+R,gt.length):Tt=gt.length,qe=R;qe<Tt;qe+=C)we[0]=gt[qe],we[1]=gt[qe+1],ce(we,we,We),gt[qe]=we[0],gt[qe+1]=we[1];return gt}}()},ZzCi:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("xfSm"),m=o("GXnB"),Y=o("Ztfv");function F(i){return function(Z,D,$){var te=new m.Metadata(b.NAMED_TAG,i);typeof $=="number"?Y.tagParameter(Z,D,$,te):Y.tagProperty(Z,D,te)}}E.named=F},a5Wf:function(ze,E,o){"use strict";o.r(E);var b=o("IzEo"),m=o("bx4M"),Y=o("14J3"),F=o("BMrR"),i=o("jCWc"),Z=o("kPKH"),D=o("1OyB"),$=o("vuIU"),te=o("Ji7U"),fe=o("LK+K"),K=o("aHsQ"),Ge=o("sGsY"),pe=o("nKUr"),Ze=o("9kvl"),Pe=o("q1tI"),mt=o.n(Pe),De=o("HTcj"),At=o("ZhIB"),it=o.n(At),vt=o("yP6+"),Je=o("VTBJ");function _t(O){var d=O.style;d.height="100%";var c=parseInt("".concat(getComputedStyle(O).height),10),p=parseInt("".concat(getComputedStyle(O).paddingTop),10)+parseInt("".concat(getComputedStyle(O).paddingBottom),10);return c-p}function wt(O){if(!O)return 0;var d=O,c=_t(d),p=d.parentNode;return p&&(c=_t(p)),c}function ke(){return function(O){var d=function(c){Object(te.a)(T,c);var p=Object(fe.a)(T);function T(){var j;Object(D.a)(this,T);for(var I=arguments.length,k=new Array(I),X=0;X<I;X++)k[X]=arguments[X];return j=p.call.apply(p,[this].concat(k)),j.state={computedHeight:0},j.root=null,j.handleRoot=function(ae){j.root=ae},j}return Object($.a)(T,[{key:"componentDidMount",value:function(){var I=this.props.height;if(!I&&this.root){var k=wt(this.root);this.setState({computedHeight:k}),k<1&&(k=wt(this.root),this.setState({computedHeight:k}))}}},{key:"render",value:function(){var I=this.props.height,k=this.state.computedHeight,X=I||k;return Object(pe.jsx)("div",{ref:this.handleRoot,"data-inspector-line":"70","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/autoHeight.tsx",children:X>0&&Object(pe.jsx)(O,Object(Je.a)(Object(Je.a)({},this.props),{},{height:X,"data-inspector-line":"71","data-inspector-column":"22","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/autoHeight.tsx"}))})}}]),T}(mt.a.Component);return d}}var Re=ke,Ve=vt.Guide.Arc,dt=vt.Guide.Html,Me=vt.Guide.Line,ht=function(d){switch(d){case"2":return"\u5DEE";case"4":return"\u4E2D";case"6":return"\u826F";case"8":return"\u4F18";default:return""}};vt.Shape.registerShape&&vt.Shape.registerShape("point","pointer",{drawShape:function(d,c){var p=d.points[0];p=this.parsePoint(p);var T=this.parsePoint({x:0,y:0});return c.addShape("line",{attrs:{x1:T.x,y1:T.y,x2:p.x,y2:p.y,stroke:d.color,lineWidth:2,lineCap:"round"}}),c.addShape("circle",{attrs:{x:T.x,y:T.y,r:6,stroke:d.color,lineWidth:3,fill:"#fff"}})}});var Zt=function(d){var c=d.title,p=d.height,T=p===void 0?1:p,j=d.percent,I=d.forceFit,k=I===void 0?!0:I,X=d.formatter,ae=X===void 0?ht:X,$e=d.color,Ie=$e===void 0?"#2F9CFF":$e,Oe=d.bgColor,ft=Oe===void 0?"#F0F2F5":Oe,Ne={value:{type:"linear",min:0,max:10,tickCount:6,nice:!0}},lt=[{value:j/10}],Ue=function(){return`
  <div style="width: 300px;text-align: center;font-size: 12px!important;">
    <div style="font-size: 14px; color: rgba(0,0,0,0.43);margin: 0;">`.concat(c,`</div>
    <div style="font-size: 24px;color: rgba(0,0,0,0.85);margin: 0;">
      `).concat((lt[0].value*10).toFixed(2),`%
    </div>
  </div>`)},It={fontSize:12,fill:"rgba(0, 0, 0, 0.65)",textAlign:"center"};return Object(pe.jsxs)(vt.Chart,{height:T,data:lt,scale:Ne,padding:[-16,0,16,0],forceFit:k,"data-inspector-line":"107","data-inspector-column":"4","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Gauge/index.tsx",children:[Object(pe.jsx)(vt.Coord,{type:"polar",startAngle:-1.25*Math.PI,endAngle:.25*Math.PI,radius:.8,"data-inspector-line":"108","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Gauge/index.tsx"}),Object(pe.jsx)(vt.Axis,{name:"1",line:void 0,"data-inspector-line":"109","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Gauge/index.tsx"}),Object(pe.jsx)(vt.Axis,{line:void 0,tickLine:void 0,subTickLine:void 0,name:"value",zIndex:2,label:{offset:-12,formatter:ae,textStyle:It},"data-inspector-line":"110","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Gauge/index.tsx"}),Object(pe.jsxs)(vt.Guide,{"data-inspector-line":"122","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Gauge/index.tsx",children:[Object(pe.jsx)(Me,{start:[3,.905],end:[3,.85],lineStyle:{stroke:Ie,lineDash:void 0,lineWidth:2},"data-inspector-line":"123","data-inspector-column":"8","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Gauge/index.tsx"}),Object(pe.jsx)(Me,{start:[5,.905],end:[5,.85],lineStyle:{stroke:Ie,lineDash:void 0,lineWidth:3},"data-inspector-line":"132","data-inspector-column":"8","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Gauge/index.tsx"}),Object(pe.jsx)(Me,{start:[7,.905],end:[7,.85],lineStyle:{stroke:Ie,lineDash:void 0,lineWidth:3},"data-inspector-line":"141","data-inspector-column":"8","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Gauge/index.tsx"}),Object(pe.jsx)(Ve,{start:[0,.965],end:[10,.965],style:{stroke:ft,lineWidth:10},"data-inspector-line":"150","data-inspector-column":"8","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Gauge/index.tsx"}),Object(pe.jsx)(Ve,{start:[0,.965],end:[lt[0].value,.965],style:{stroke:Ie,lineWidth:10},"data-inspector-line":"158","data-inspector-column":"8","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Gauge/index.tsx"}),Object(pe.jsx)(dt,{position:["50%","95%"],html:Ue(),"data-inspector-line":"166","data-inspector-column":"8","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Gauge/index.tsx"})]}),Object(pe.jsx)(vt.Geom,{line:!1,type:"point",position:"value*1",shape:"pointer",color:Ie,active:!1,"data-inspector-line":"168","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Gauge/index.tsx"})]})},Qt=Re()(Zt),ur={miniChart:"antd-pro-pages-dashboard-monitor-components-charts-index-miniChart",chartContent:"antd-pro-pages-dashboard-monitor-components-charts-index-chartContent",chartLoading:"antd-pro-pages-dashboard-monitor-components-charts-index-chartLoading"},oe=function(d){var c=d.height,p=c===void 0?1:c,T=d.data,j=T===void 0?[]:T,I=d.forceFit,k=I===void 0?!0:I,X=d.color,ae=X===void 0?"rgba(24, 144, 255, 0.2)":X,$e=d.borderColor,Ie=$e===void 0?"#1089ff":$e,Oe=d.scale,ft=Oe===void 0?{x:{},y:{}}:Oe,Ne=d.borderWidth,lt=Ne===void 0?2:Ne,Ue=d.line,It=d.xAxis,$t=d.yAxis,ar=d.animate,tr=ar===void 0?!0:ar,pr=[36,5,30,5],wr={x:Object(Je.a)({type:"cat",range:[0,1]},ft.x),y:Object(Je.a)({min:0},ft.y)},$r=["x*y",function(un,_n){return{name:un,value:_n}}],Cn=p+54;return Object(pe.jsx)("div",{className:ur.miniChart,style:{height:p},"data-inspector-line":"71","data-inspector-column":"4","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/MiniArea/index.tsx",children:Object(pe.jsx)("div",{className:ur.chartContent,"data-inspector-line":"72","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/MiniArea/index.tsx",children:p>0&&Object(pe.jsxs)(vt.Chart,{animate:tr,scale:wr,height:Cn,forceFit:k,data:j,padding:pr,"data-inspector-line":"74","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/MiniArea/index.tsx",children:[Object(pe.jsx)(vt.Axis,Object(Je.a)(Object(Je.a)({name:"x",label:null,line:null,tickLine:null,grid:null},It),{},{"data-inspector-line":"82","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/MiniArea/index.tsx"}),"axis-x"),Object(pe.jsx)(vt.Axis,Object(Je.a)(Object(Je.a)({name:"y",label:null,line:null,tickLine:null,grid:null},$t),{},{"data-inspector-line":"91","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/MiniArea/index.tsx"}),"axis-y"),Object(pe.jsx)(vt.Tooltip,{showTitle:!1,crosshairs:!1,"data-inspector-line":"100","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/MiniArea/index.tsx"}),Object(pe.jsx)(vt.Geom,{type:"area",position:"x*y",color:ae,tooltip:$r,shape:"smooth",style:{fillOpacity:1},"data-inspector-line":"101","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/MiniArea/index.tsx"}),Ue?Object(pe.jsx)(vt.Geom,{type:"line",position:"x*y",shape:"smooth",color:Ie,size:lt,tooltip:!1,"data-inspector-line":"112","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/MiniArea/index.tsx"}):Object(pe.jsx)("span",{style:{display:"none"},"data-inspector-line":"121","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/MiniArea/index.tsx"})]})})})},Q=Re()(oe),H=o("/zsF"),Se=o("PArb"),be=o("rePB"),Te=o("cQSq"),me=o.n(Te),nt=o("9/5/"),Jt=o.n(nt),Mt=o("Jssm"),ve=o.n(Mt),ge=o("TSYQ"),He=o.n(ge),ot={pie:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-pie",chart:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-chart",hasLegend:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-hasLegend",legend:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legend",dot:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-dot",line:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-line",legendTitle:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legendTitle",percent:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-percent",value:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-value",title:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-title",total:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-total",legendBlock:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legendBlock"},we=function(O){Object(te.a)(c,O);var d=Object(fe.a)(c);function c(){var p;Object(D.a)(this,c);for(var T=arguments.length,j=new Array(T),I=0;I<T;I++)j[I]=arguments[I];return p=d.call.apply(d,[this].concat(j)),p.state={legendData:[],legendBlock:!1},p.chart=void 0,p.root=void 0,p.requestRef=0,p.resize=Jt()(function(){var k=p.props.hasLegend,X=p.state.legendBlock;if(!k||!p.root){window.removeEventListener("resize",p.resize);return}p.root&&p.root.parentNode&&p.root.parentNode.clientWidth<=380?X||p.setState({legendBlock:!0}):X&&p.setState({legendBlock:!1})},300),p.getG2Instance=function(k){p.chart=k,requestAnimationFrame(function(){p.getLegendData(),p.resize()})},p.getLegendData=function(){if(!p.chart)return;var k=p.chart.getAllGeoms()[0];if(!k)return;var X=k.get("dataArray")||[],ae=X.map(function($e){var Ie=$e[0]._origin;return Ie.color=$e[0].color,Ie.checked=!0,Ie});p.setState({legendData:ae})},p.handleRoot=function(k){p.root=k},p.handleLegendClick=function(k,X){var ae=k;ae.checked=!ae.checked;var $e=p.state.legendData;$e[X]=ae;var Ie=$e.filter(function(Oe){return Oe.checked}).map(function(Oe){return Oe.x});p.chart&&p.chart.filter("x",function(Oe){return Ie.indexOf("".concat(Oe))>-1}),p.setState({legendData:$e})},p}return Object($.a)(c,[{key:"componentDidMount",value:function(){var T=this;window.addEventListener("resize",function(){T.requestRef=requestAnimationFrame(function(){return T.resize()})},{passive:!0})}},{key:"componentDidUpdate",value:function(T){var j=this.props.data;j!==T.data&&this.getLegendData()}},{key:"componentWillUnmount",value:function(){this.requestRef&&window.cancelAnimationFrame(this.requestRef),window.removeEventListener("resize",this.resize),this.resize&&this.resize.cancel()}},{key:"render",value:function(){var T,j=this,I=this.props,k=I.valueFormat,X=I.subTitle,ae=I.total,$e=I.hasLegend,Ie=$e===void 0?!1:$e,Oe=I.className,ft=I.style,Ne=I.height,lt=Ne===void 0?0:Ne,Ue=I.forceFit,It=Ue===void 0?!0:Ue,$t=I.percent,ar=I.color,tr=I.inner,pr=tr===void 0?.75:tr,wr=I.animate,$r=wr===void 0?!0:wr,Cn=I.colors,un=I.lineWidth,_n=un===void 0?1:un,Kn=this.state,ka=Kn.legendData,Ei=Kn.legendBlock,Pi=He()(ot.pie,Oe,(T={},Object(be.a)(T,ot.hasLegend,!!Ie),Object(be.a)(T,ot.legendBlock,Ei),T)),Du=this.props,ou=Du.data,Xl=Du.selected,Ds=Xl===void 0?!0:Xl,Ns=Du.tooltip,Yl=Ns===void 0?!0:Ns,dc=ou||[],yu=Ds,Mc=Yl,Co=Cn;dc=dc||[],yu=yu||!0,Mc=Mc||!0;var _a,Ol={x:{type:"cat",range:[0,1]},y:{min:0}};($t||$t===0)&&(yu=!1,Mc=!1,_a=function(Gf){return Gf==="\u5360\u6BD4"?ar||"rgba(24, 144, 255, 0.85)":"#F0F2F5"},dc=[{x:"\u5360\u6BD4",y:parseFloat("".concat($t))},{x:"\u53CD\u6BD4",y:100-parseFloat("".concat($t))}]);var nh=["x*percent",function(pc,Gf){return{name:pc,value:"".concat((Gf*100).toFixed(2),"%")}}],fh=[12,0,12,0],Nh=new Te.DataView;return Nh.source(dc).transform({type:"percent",field:"y",dimension:"x",as:"percent"}),Object(pe.jsxs)("div",{ref:this.handleRoot,className:Pi,style:ft,"data-inspector-line":"249","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx",children:[Object(pe.jsx)(ve.a,{maxFontSize:25,"data-inspector-line":"250","data-inspector-column":"8","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx",children:Object(pe.jsxs)("div",{className:ot.chart,"data-inspector-line":"251","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx",children:[Object(pe.jsxs)(vt.Chart,{scale:Ol,height:lt,forceFit:It,data:Nh,padding:fh,animate:$r,onGetG2Instance:this.getG2Instance,"data-inspector-line":"252","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx",children:[!!Mc&&Object(pe.jsx)(vt.Tooltip,{showTitle:!1,"data-inspector-line":"261","data-inspector-column":"28","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx"}),Object(pe.jsx)(vt.Coord,{type:"theta",innerRadius:pr,"data-inspector-line":"262","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx"}),Object(pe.jsx)(vt.Geom,{style:{lineWidth:_n,stroke:"#fff"},tooltip:Mc?nh:void 0,type:"intervalStack",position:"percent",color:["x",$t||$t===0?_a:Co],selected:yu,"data-inspector-line":"263","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx"})]}),(X||ae)&&Object(pe.jsxs)("div",{className:ot.total,"data-inspector-line":"274","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx",children:[X&&Object(pe.jsx)("h4",{className:"pie-sub-title","data-inspector-line":"275","data-inspector-column":"29","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx",children:X}),ae&&Object(pe.jsx)("div",{className:"pie-stat","data-inspector-line":"278","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx",children:typeof ae=="function"?ae():ae})]})]})}),Ie&&Object(pe.jsx)("ul",{className:ot.legend,"data-inspector-line":"286","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx",children:ka.map(function(pc,Gf){return Object(pe.jsxs)("li",{onClick:function(){return j.handleLegendClick(pc,Gf)},"data-inspector-line":"288","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx",children:[Object(pe.jsx)("span",{className:ot.dot,style:{backgroundColor:pc.checked?pc.color:"#aaa"},"data-inspector-line":"289","data-inspector-column":"16","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx"}),Object(pe.jsx)("span",{className:ot.legendTitle,"data-inspector-line":"295","data-inspector-column":"16","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx",children:pc.x}),Object(pe.jsx)(Se.a,{type:"vertical","data-inspector-line":"296","data-inspector-column":"16","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx"}),Object(pe.jsx)("span",{className:ot.percent,"data-inspector-line":"297","data-inspector-column":"16","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx",children:"".concat((Number.isNaN(pc.percent)?0:pc.percent*100).toFixed(2),"%")}),Object(pe.jsx)("span",{className:ot.value,"data-inspector-line":"300","data-inspector-column":"16","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx",children:k?k(pc.y):pc.y})]},pc.x)})})]})}}]),c}(Pe.Component),gt=Re()(we),C=o("ODXe"),R={tagCloud:"antd-pro-pages-dashboard-monitor-components-charts-tag-cloud-index-tagCloud"},q="https://gw.alipayobjects.com/zos/rmsportal/gWyeGLCdFFRavBGIDzWk.png",ce=function(O){Object(te.a)(c,O);var d=Object(fe.a)(c);function c(){var p;Object(D.a)(this,c);for(var T=arguments.length,j=new Array(T),I=0;I<T;I++)j[I]=arguments[I];return p=d.call.apply(d,[this].concat(j)),p.state={dv:null,height:0,width:0},p.requestRef=0,p.isUnmount=!1,p.root=void 0,p.imageMask=void 0,p.resize=function(){p.requestRef=requestAnimationFrame(function(){p.renderChart(p.props)})},p.saveRootRef=function(k){p.root=k},p.initTagCloud=function(){function k(X){return Object(Je.a)(Object(Je.a)({},X.style),{},{fillOpacity:X.opacity,fontSize:X.origin._origin.size,rotate:X.origin._origin.rotate,text:X.origin._origin.text,textAlign:"center",fontFamily:X.origin._origin.font,fill:X.color,textBaseline:"Alphabetic"})}vt.Shape.registerShape("point","cloud",{drawShape:function(ae,$e){var Ie=k(ae);return $e.addShape("text",{attrs:Object(Je.a)(Object(Je.a)({},Ie),{},{x:ae.x,y:ae.y})})}})},p.renderChart=Jt()(function(k){var X=k||p.props,ae=X.data,$e=X.height;if(ae.length<1||!p.root)return;var Ie=$e,Oe=p.root.offsetWidth,ft=function(){var lt=new me.a.View().source(ae),Ue=lt.range("value"),It=Object(C.a)(Ue,2),$t=It[0],ar=It[1];if(lt.transform({type:"tag-cloud",fields:["name","value"],imageMask:p.imageMask,font:"Verdana",size:[Oe,Ie],padding:0,timeInterval:5e3,rotate:function(){return 0},fontSize:function(pr){var wr=Math.pow((pr.value-$t)/(ar-$t),2);return wr*(17.5-5)+5}}),p.isUnmount)return;p.setState({dv:lt,width:Oe,height:Ie})};p.imageMask?ft():(p.imageMask=new Image,p.imageMask.crossOrigin="",p.imageMask.src=q,p.imageMask.onload=ft)},200),p}return Object($.a)(c,[{key:"componentDidMount",value:function(){var T=this;requestAnimationFrame(function(){T.initTagCloud(),T.renderChart(T.props)}),window.addEventListener("resize",this.resize,{passive:!0})}},{key:"componentDidUpdate",value:function(T){var j=this.props.data;T&&JSON.stringify(T.data)!==JSON.stringify(j)&&this.renderChart(this.props)}},{key:"componentWillUnmount",value:function(){this.isUnmount=!0,window.cancelAnimationFrame(this.requestRef),window.removeEventListener("resize",this.resize)}},{key:"render",value:function(){var T=this.props,j=T.className,I=T.height,k=this.state,X=k.dv,ae=k.width,$e=k.height;return Object(pe.jsx)("div",{className:He()(R.tagCloud,j),style:{width:"100%",height:I},ref:this.saveRootRef,"data-inspector-line":"174","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/TagCloud/index.tsx",children:X&&Object(pe.jsxs)(vt.Chart,{width:ae,height:$e,data:X,padding:0,scale:{x:{nice:!1},y:{nice:!1}},"data-inspector-line":"180","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/TagCloud/index.tsx",children:[Object(pe.jsx)(vt.Tooltip,{showTitle:!1,"data-inspector-line":"190","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/TagCloud/index.tsx"}),Object(pe.jsx)(vt.Coord,{reflect:"y","data-inspector-line":"191","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/TagCloud/index.tsx"}),Object(pe.jsx)(vt.Geom,{type:"point",position:"x*y",color:"text",shape:"cloud",tooltip:["text*value",function(Oe,ft){return{name:Oe,value:ft}}],"data-inspector-line":"192","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/TagCloud/index.tsx"})]})})}}]),c}(Pe.Component),We=Re()(ce),qe={waterWave:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-waterWave",text:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-text",waterWaveCanvasWrapper:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-waterWaveCanvasWrapper"},Tt=function(O){Object(te.a)(c,O);var d=Object(fe.a)(c);function c(){var p;Object(D.a)(this,c);for(var T=arguments.length,j=new Array(T),I=0;I<T;I++)j[I]=arguments[I];return p=d.call.apply(d,[this].concat(j)),p.state={radio:1},p.timer=0,p.root=null,p.node=null,p.resize=function(){if(p.root){var k=p.props.height,X=k===void 0?1:k,ae=p.root.parentNode,$e=ae.offsetWidth;p.setState({radio:$e<X?$e/X:1})}},p}return Object($.a)(c,[{key:"componentDidMount",value:function(){var T=this;this.renderChart(),this.resize(),window.addEventListener("resize",function(){requestAnimationFrame(function(){return T.resize()})},{passive:!0})}},{key:"componentDidUpdate",value:function(T){var j=this.props.percent;T.percent!==j&&this.renderChart("update")}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.timer),this.node&&(this.node.innerHTML=""),window.removeEventListener("resize",this.resize)}},{key:"renderChart",value:function(T){var j=this.props,I=j.percent,k=j.color,X=k===void 0?"#1890FF":k,ae=I/100,$e=this;if(cancelAnimationFrame(this.timer),!this.node||ae!==0&&!ae)return;var Ie=this.node,Oe=Ie.getContext("2d");if(!Oe)return;var ft=Ie.width,Ne=Ie.height,lt=ft/2,Ue=2,It=lt-Ue;Oe.beginPath(),Oe.lineWidth=Ue*2;for(var $t=ft-Ue,ar=$t/8,tr=.2,pr=tr,wr=Ue,$r=0,Cn=0,un=.005,_n=[],Kn=lt-Ue,ka=-(Math.PI/2),Ei=!0,Pi=ka;Pi<ka+2*Math.PI;Pi+=1/(8*Math.PI))_n.push([lt+Kn*Math.cos(Pi),lt+Kn*Math.sin(Pi)]);var Du=_n.shift();Oe.strokeStyle=X,Oe.moveTo(Du[0],Du[1]);function ou(){if(!Oe)return;Oe.beginPath(),Oe.save();for(var Ds=[],Ns=wr;Ns<=wr+$t;Ns+=20/$t){var Yl=$r+(wr+Ns)/ar,dc=Math.sin(Yl)*pr,yu=Ns,Mc=2*It*(1-Cn)+(lt-It)-ar*dc;Oe.lineTo(yu,Mc),Ds.push([yu,Mc])}var Co=Ds.shift();Oe.lineTo(wr+$t,Ne),Oe.lineTo(wr,Ne),Oe.lineTo(Co[0],Co[1]);var _a=Oe.createLinearGradient(0,0,0,Ne);_a.addColorStop(0,"#ffffff"),_a.addColorStop(1,X),Oe.fillStyle=_a,Oe.fill(),Oe.restore()}function Xl(){if(!Oe)return;if(Oe.clearRect(0,0,ft,Ne),Ei&&T!=="update")if(_n.length){var Ds=_n.shift();Oe.lineTo(Ds[0],Ds[1]),Oe.stroke()}else Ei=!1,Oe.lineTo(Du[0],Du[1]),Oe.stroke(),_n=[],Oe.globalCompositeOperation="destination-over",Oe.beginPath(),Oe.lineWidth=Ue,Oe.arc(lt,lt,Kn,0,2*Math.PI,!0),Oe.beginPath(),Oe.save(),Oe.arc(lt,lt,lt-3*Ue,0,2*Math.PI,!0),Oe.restore(),Oe.clip(),Oe.fillStyle=X;else{if(ae>=.85){if(pr>tr/4){var Ns=tr*.01;pr-=Ns}}else if(ae<=.1){if(pr<tr*1.5){var Yl=tr*.01;pr+=Yl}}else{if(pr<=tr){var dc=tr*.01;pr+=dc}if(pr>=tr){var yu=tr*.01;pr-=yu}}ae-Cn>0&&(Cn+=un),ae-Cn<0&&(Cn-=un),$r+=.07,ou()}$e.timer=requestAnimationFrame(Xl)}Xl()}},{key:"render",value:function(){var T=this,j=this.state.radio,I=this.props,k=I.percent,X=I.title,ae=I.height,$e=ae===void 0?1:ae;return Object(pe.jsxs)("div",{className:qe.waterWave,ref:function(Oe){return T.root=Oe},style:{transform:"scale(".concat(j,")")},"data-inspector-line":"214","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/WaterWave/index.tsx",children:[Object(pe.jsx)("div",{style:{width:$e,height:$e,overflow:"hidden"},"data-inspector-line":"219","data-inspector-column":"8","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/WaterWave/index.tsx",children:Object(pe.jsx)("canvas",{className:qe.waterWaveCanvasWrapper,ref:function(Oe){return T.node=Oe},width:$e*2,height:$e*2,"data-inspector-line":"220","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/WaterWave/index.tsx"})}),Object(pe.jsxs)("div",{className:qe.text,style:{width:$e},"data-inspector-line":"227","data-inspector-column":"8","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/WaterWave/index.tsx",children:[X&&Object(pe.jsx)("span",{"data-inspector-line":"228","data-inspector-column":"20","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/WaterWave/index.tsx",children:X}),Object(pe.jsxs)("h4",{"data-inspector-line":"229","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/WaterWave/index.tsx",children:[k,"%"]})]})]})}}]),c}(Pe.Component),at=Re()(Tt),Ut=o("o0o1"),J=o.n(Ut),Qe=o("HaE+"),ne=Object(Pe.createContext)({});function et(){return Object(Pe.useContext)(ne)}var kt=o("8ml+"),dr=o("lwsE"),Ye=o.n(dr),xt=o("W8MJ"),bt=o.n(xt),Et=o("7W2i"),Fe=o.n(Et),pt=o("a1gu"),yt=o.n(pt),Ht=o("Nsbk"),hr=o.n(Ht),Hr=o("lSNA"),gr=o.n(Hr),Bn=o("yG8O"),zn=o.n(Bn),oa=o("U+yc"),$n=o.n(oa),Yn=o("1ABj"),On=o("h1nZ"),U,W,le,xe,st,Ct;function Bt(O,d){var c=Object.keys(O);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(O);d&&(p=p.filter(function(T){return Object.getOwnPropertyDescriptor(O,T).enumerable})),c.push.apply(c,p)}return c}function Xe(O){for(var d=1;d<arguments.length;d++){var c=arguments[d]!=null?arguments[d]:{};d%2?Bt(Object(c),!0).forEach(function(p){gr()(O,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(c)):Bt(Object(c)).forEach(function(p){Object.defineProperty(O,p,Object.getOwnPropertyDescriptor(c,p))})}return O}var Lt=(U=Object(On.lazyInject)(On.TYPES.ILogService),W=Object(On.lazyInject)(On.TYPES.IGlobalConfigService),le=(Ct=function(){function O(d){Ye()(this,O),zn()(this,"logger",xe,this),zn()(this,"configService",st,this),this.config=void 0,this.config=d}return bt()(O,[{key:"setContainer",value:function(c,p){c.bind(On.TYPES.MapConfig).toConstantValue(Xe(Xe({},this.config),{},{id:p})),c.bind(On.TYPES.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),O}(),Ct),xe=$n()(le.prototype,"logger",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),st=$n()(le.prototype,"configService",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),le),lr=o("QILm"),zr=o.n(lr),Vr=o("yXPU"),cr=o.n(Vr),Ur=o("hi0z"),Mn=o.n(Ur),ln=o("Hel2"),er=o("IOcx"),tn=o("4cb6"),hn={dark:"amap://styles/2a09079c3daac9420ee53b67307a8006?isPublic=true",light:"amap://styles/1fd9f8ef9751298f11f5c56968312c70?isPublic=true",normal:"amap://styles/normal",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true"},xn=o("J4zp"),yn=o.n(xn),vn=Math.PI/180,Pn=function(){function O(){Ye()(this,O),this.projectionMatrix=er.b.create(),this.viewMatrix=er.b.create(),this.viewProjectionMatrix=er.b.create(),this.ViewProjectionMatrixUncentered=er.b.create(),this.viewUncenteredMatrix=er.b.create(),this.zoom=void 0,this.center=void 0}return bt()(O,[{key:"syncWithMapCamera",value:function(c){var p=c.zoom,T=p===void 0?1:p,j=c.pitch,I=j===void 0?0:j,k=c.bearing,X=k===void 0?0:k,ae=c.center,$e=ae===void 0?[0,0]:ae,Ie=c.offsetOrigin,Oe=Ie===void 0?[0,0]:Ie,ft=c.cameraHeight,Ne=ft===void 0?1:ft,lt=c.aspect,Ue=lt===void 0?1:lt,It=c.near,$t=It===void 0?.1:It,ar=c.far,tr=ar===void 0?1e3:ar,pr=c.fov,wr=pr===void 0?0:pr;this.zoom=T,this.center=$e;var $r=I*vn,Cn=(360-X)*vn;er.b.perspective(this.projectionMatrix,wr,Ue,$t,tr);var un=er.d.fromValues(Ne*Math.sin($r)*Math.sin(Cn),-Ne*Math.sin($r)*Math.cos(Cn),Ne*Math.cos($r)),_n=er.d.fromValues(-Math.cos($r)*Math.sin(Cn),Math.cos($r)*Math.cos(Cn),Math.sin($r));er.b.lookAt(this.viewMatrix,un,er.d.fromValues(0,0,0),_n),this.viewUncenteredMatrix=er.b.clone(this.viewMatrix),er.b.translate(this.viewMatrix,this.viewMatrix,er.d.fromValues(-Oe[0],Oe[1],0)),er.b.multiply(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),er.b.multiply(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 524288}},{key:"getCenter",value:function(){var c=yn()(this.center,2),p=c[0],T=c[1];return[p,T]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(c,p){var T=85.0511287798,j=Math.max(Math.min(T,c[1]),-T),I=256<<20,k=Math.PI/180,X=c[0]*k,ae=j*k;ae=Math.log(Math.tan(Math.PI/4+ae/2));var $e=.5/Math.PI,Ie=.5,Oe=-.5/Math.PI;return k=.5,X=I*($e*X+Ie)-215440491,ae=-(I*(Oe*ae+k)-106744817),[X,ae]}}]),O}(),Va,va,Ma,Ia,Wi,da,di,ga,ya,fa,Si,ns,Xi,Vo;function ju(O,d){var c=Object.keys(O);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(O);d&&(p=p.filter(function(T){return Object.getOwnPropertyDescriptor(O,T).enumerable})),c.push.apply(c,p)}return c}function Ga(O){for(var d=1;d<arguments.length;d++){var c=arguments[d]!=null?arguments[d]:{};d%2?ju(Object(c),!0).forEach(function(p){gr()(O,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(c)):ju(Object(c)).forEach(function(p){Object.defineProperty(O,p,Object.getOwnPropertyDescriptor(c,p))})}return O}o("BGjm")(`/* @antv/l7-maps */
.amap-logo{
 display: none !important;
}
`);var Ai=0;window.forceWebGL=!0;var Ko="15cd8a57710d40c9b7c0e3cc120f1200",oi="1.4.15",Yi="amap-script",wo=!1,Ha=[],oo=12,so=(Va=Object(tn.injectable)(),va=Object(tn.inject)(On.TYPES.IGlobalConfigService),Ma=Object(tn.inject)(On.TYPES.ILogService),Ia=Object(tn.inject)(On.TYPES.MapConfig),Wi=Object(tn.inject)(On.TYPES.ICoordinateSystemService),da=Object(tn.inject)(On.TYPES.IEventEmitter),Va(di=(ga=(Vo=function(){function O(){var d=this;Ye()(this,O),this.map=void 0,zn()(this,"configService",ya,this),zn()(this,"logger",fa,this),zn()(this,"config",Si,this),zn()(this,"coordinateSystemService",ns,this),zn()(this,"eventEmitter",Xi,this),this.markerContainer=void 0,this.$mapContainer=void 0,this.viewport=void 0,this.cameraChangedCallback=void 0,this.handleCameraChanged=function(c){var p=c.camera,T=p.fov,j=p.near,I=p.far,k=p.height,X=p.pitch,ae=p.rotation,$e=p.aspect,Ie=p.position,Oe=d.getCenter(),ft=Oe.lng,Ne=Oe.lat;d.cameraChangedCallback&&(d.viewport.syncWithMapCamera({aspect:$e,bearing:360-ae,far:I,fov:T,cameraHeight:k,near:j,pitch:X,zoom:d.map.getZoom()-1,center:[ft,Ne],offsetOrigin:[Ie.x,Ie.y]}),d.viewport.getZoom()>oo?d.coordinateSystemService.setCoordinateSystem(On.CoordinateSystem.P20_OFFSET):d.coordinateSystemService.setCoordinateSystem(On.CoordinateSystem.P20),d.cameraChangedCallback(d.viewport))}}return bt()(O,[{key:"addMarkerContainer",value:function(){var c=this.map.getContainer();if(c!==null){var p=c.getElementsByClassName("amap-maps")[0];this.markerContainer=ln.a.create("div","l7-marker-container",p)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(c,p){On.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.on(c,p):this.map.on(c,p)}},{key:"off",value:function(c,p){On.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.off(c,p):this.map.off(c,p)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var c;return(c=this.map.getContainer())===null||c===void 0?void 0:c.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var c=this.map.getSize();return[c.getWidth(),c.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(c){return this.map.setZoom(c)}},{key:"getCenter",value:function(){var c=this.map.getCenter();return{lng:c.getLng(),lat:c.getLat()}}},{key:"setCenter",value:function(c){this.map.setCenter(c)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var c=this.map.getBounds().toBounds(),p=c.getNorthEast(),T=c.getSouthWest(),j=this.getCenter(),I=j.lng>p.getLng()||j.lng<T.getLng()?180-p.getLng():p.getLng(),k=j.lng<T.getLng()?T.getLng()-180:T.getLng();return[[k,T.getLat()],[I,p.getLat()]]}},{key:"getMinZoom",value:function(){var c=this.map.get("zooms");return c[0]-1}},{key:"getMaxZoom",value:function(){var c=this.map.get("zooms");return c[1]-1}},{key:"setRotation",value:function(c){return this.map.setRotation(c)}},{key:"setPitch",value:function(c){return this.map.setPitch(c)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(c){this.map.panTo(c)}},{key:"panBy",value:function(c){this.map.panTo(c)}},{key:"fitBounds",value:function(c){this.map.setBounds(new AMap.Bounds([c[0][0],c[0][1],c[1][0],c[1][1]]))}},{key:"setZoomAndCenter",value:function(c,p){this.map.setZoomAndCenter(c,p)}},{key:"setMapStyle",value:function(c){this.map.setMapStyle(this.getMapStyle(c))}},{key:"setMapStatus",value:function(c){this.map.setStatus(c)}},{key:"pixelToLngLat",value:function(c){var p=this.map.pixelToLngLat(new AMap.Pixel(c[0],c[1]));return{lng:p.getLng(),lat:p.getLat()}}},{key:"lngLatToPixel",value:function(c){var p=this.map.lnglatToPixel(new AMap.LngLat(c[0],c[1]));return{x:p.getX(),y:p.getY()}}},{key:"containerToLngLat",value:function(c){var p=new AMap.Pixel(c[0],c[1]),T=this.map.containerToLngLat(p);return{lng:T==null?void 0:T.getLng(),lat:T==null?void 0:T.getLat()}}},{key:"lngLatToContainer",value:function(c){var p=new AMap.LngLat(c[0],c[1]),T=this.map.lngLatToContainer(p);return{x:T.getX(),y:T.getY()}}},{key:"lngLatToMercator",value:function(c,p){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(c,p,T){var j=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],I=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},k=this.viewport.projectFlat(c),X=er.b.create();return er.b.translate(X,X,er.d.fromValues(k[0],k[1],p)),er.b.scale(X,X,er.d.fromValues(j[0],j[1],j[2])),er.b.rotateX(X,X,T[0]),er.b.rotateY(X,X,T[1]),er.b.rotateZ(X,X,T[2]),X}},{key:"init",value:function(){var d=cr()(J.a.mark(function p(){var T=this,j,I,k,X,ae,$e,Ie,Oe,ft,Ne,lt,Ue,It,$t;return J.a.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return j=this.config,I=j.id,k=j.style,X=k===void 0?"light":k,ae=j.minZoom,$e=ae===void 0?0:ae,Ie=j.maxZoom,Oe=Ie===void 0?18:Ie,ft=j.token,Ne=ft===void 0?Ko:ft,lt=j.mapInstance,Ue=j.plugin,It=Ue===void 0?[]:Ue,$t=zr()(j,["id","style","minZoom","maxZoom","token","mapInstance","plugin"]),tr.next=3,new Promise(function(pr){var wr=function(){if(lt)T.map=lt,T.$mapContainer=T.map.getContainer(),setTimeout(function(){T.map.on("camerachange",T.handleCameraChanged),pr()},30);else{T.$mapContainer=T.creatAmapContainer(I);var Cn=new AMap.Map(T.$mapContainer,Ga({mapStyle:T.getMapStyle(X),zooms:[$e,Oe],viewMode:"3D"},$t));Cn.on("camerachange",T.handleCameraChanged),T.map=Cn,setTimeout(function(){pr()},10)}};!wo&&!lt?(Ne===Ko&&T.logger.warn(T.configService.getSceneWarninfo("MapToken")),wo=!0,It.push("Map3D"),Mn.a.load({key:Ne,version:oi,plugins:It}).then(function($r){wr(),Ha.length&&(Ha.forEach(function(Cn){return Cn()}),Ha=[])}).catch(function($r){throw new Error($r)})):wo&&window.AMap||lt?wr():Ha.push(wr)});case 3:this.viewport=new Pn;case 4:case"end":return tr.stop()}},p,this)}));function c(){return d.apply(this,arguments)}return c}()},{key:"exportMap",value:function(c){var p,T=(p=this.getContainer())===null||p===void 0?void 0:p.getElementsByClassName("amap-layer")[0],j=c==="jpg"?T==null?void 0:T.toDataURL("image/jpeg"):T==null?void 0:T.toDataURL("image/png");return j}},{key:"emit",value:function(c){for(var p,T=arguments.length,j=new Array(T>1?T-1:0),I=1;I<T;I++)j[I-1]=arguments[I];(p=this.eventEmitter).emit.apply(p,[c].concat(j))}},{key:"once",value:function(c){for(var p,T=arguments.length,j=new Array(T>1?T-1:0),I=1;I<T;I++)j[I-1]=arguments[I];(p=this.eventEmitter).once.apply(p,[c].concat(j))}},{key:"destroy",value:function(){this.map.destroy(),delete window.initAMap;var c=document.getElementById(Yi);c&&document.head.removeChild(c)}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(c){this.cameraChangedCallback=c}},{key:"getMapStyle",value:function(c){return hn[c]?hn[c]:c}},{key:"creatAmapContainer",value:function(c){var p=c;typeof c=="string"&&(p=document.getElementById(c));var T=document.createElement("div");return T.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,T.id="l7_amap_div"+Ai++,p.appendChild(T),T}}]),O}(),Vo),ya=$n()(ga.prototype,"configService",[va],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fa=$n()(ga.prototype,"logger",[Ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Si=$n()(ga.prototype,"config",[Ia],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ns=$n()(ga.prototype,"coordinateSystemService",[Wi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xi=$n()(ga.prototype,"eventEmitter",[da],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ga))||di);function Eu(O){var d=$o();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function $o(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}var Kl=function(O){Fe()(c,O);var d=Eu(c);function c(){return Ye()(this,c),d.apply(this,arguments)}return bt()(c,[{key:"getServiceConstructor",value:function(){return so}}]),c}(Lt);function ks(O,d){var c=Object.keys(O);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(O);d&&(p=p.filter(function(T){return Object.getOwnPropertyDescriptor(O,T).enumerable})),c.push.apply(c,p)}return c}function ho(O){for(var d=1;d<arguments.length;d++){var c=arguments[d]!=null?arguments[d]:{};d%2?ks(Object(c),!0).forEach(function(p){Vt(O,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(c)):ks(Object(c)).forEach(function(p){Object.defineProperty(O,p,Object.getOwnPropertyDescriptor(c,p))})}return O}function Vt(O,d,c){return d in O?Object.defineProperty(O,d,{value:c,enumerable:!0,configurable:!0,writable:!0}):O[d]=c,O}function Le(O,d){return Vn(O)||En(O,d)||mr(O,d)||Dt()}function Dt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mr(O,d){if(!O)return;if(typeof O=="string")return Qr(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Qr(O,d)}function Qr(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}function En(O,d){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(O)))return;var c=[],p=!0,T=!1,j=void 0;try{for(var I=O[Symbol.iterator](),k;!(p=(k=I.next()).done)&&!(c.push(k.value),d&&c.length===d);p=!0);}catch(X){T=!0,j=X}finally{try{!p&&I.return!=null&&I.return()}finally{if(T)throw j}}return c}function Vn(O){if(Array.isArray(O))return O}var Ci=mt.a.memo(function(O){var d=O.style,c=O.className,p=O.map,T=O.option,j=O.onSceneLoaded,I=Object(Pe.createRef)(),k=Object(Pe.useState)(),X=Le(k,2),ae=X[0],$e=X[1];return Object(Pe.useEffect)(function(){var Ie=new kt.Scene(ho(ho({id:I.current},T),{},{map:new Kl(p)}));return Ie.on("loaded",function(){$e(Ie),j&&j(Ie)}),function(){Ie.destroy()}},[]),Object(Pe.useEffect)(function(){ae&&p.style&&ae.setMapStyle(p.style)},[JSON.stringify(p.style)]),Object(Pe.useEffect)(function(){ae&&p.zoom&&ae.setZoom(p.zoom)},[p.zoom]),Object(Pe.useEffect)(function(){ae&&p.center&&ae.setCenter(p.center)},[JSON.stringify(p.center)]),Object(Pe.useEffect)(function(){ae&&p.pitch&&ae.setPitch(p.pitch)},[p.pitch]),Object(Pe.useEffect)(function(){ae&&p.rotation&&ae.setRotation(p.rotation)},[p.rotation]),mt.a.createElement(ne.Provider,{value:ae},Object(Pe.createElement)("div",{ref:I,style:d,className:c},ae&&O.children))}),po=Ci,mo=o("4ZJM"),Oo=o.n(mo),Fu=o("md7G"),Ml=o("foSv"),bs=o("JX7q"),vc=o("bl9R");function Tu(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Mo(O,d){var c=vc.transformMat4([],d,O);return vc.scale(c,c,1/c[3]),c}function zu(O,d){var c=O%d;return c<0?d+c:c}function Eo(O,d,c){return c*d+(1-c)*O}var Fi=o("ZaHm"),Ys=o("ZxFD"),Ks=o("n+fv");function js(O,d){if(!O)throw new Error(d||"viewport-mercator-project: assertion failed.")}var Ri=Math.PI,Vi=Ri/4,xs=Ri/180,vl=180/Ri,Qu=512,Rt=4003e4,fr=1.5;function Mr(O){return Math.pow(2,O)}function Wn(O){return Math.log2(O)}function Xa(O,d){var c=Object(C.a)(O,2),p=c[0],T=c[1];js(Number.isFinite(p)&&Number.isFinite(d)),js(Number.isFinite(T)&&T>=-90&&T<=90,"invalid latitude"),d*=Qu;var j=p*xs,I=T*xs,k=d*(j+Ri)/(2*Ri),X=d*(Ri-Math.log(Math.tan(Vi+I*.5)))/(2*Ri);return[k,X]}function vi(O,d){var c=Object(C.a)(O,2),p=c[0],T=c[1];d*=Qu;var j=p/d*(2*Ri)-Ri,I=2*(Math.atan(Math.exp(Ri-T/d*(2*Ri)))-Vi);return[j*vl,I*vl]}function Ki(O){var d=O.latitude;js(Number.isFinite(d));var c=Math.cos(d*xs);return Wn(Rt*c)-9}function Ya(O){var d=O.latitude,c=O.longitude,p=O.zoom,T=O.scale,j=O.highPrecision,I=j===void 0?!1:j;T=T!==void 0?T:Mr(p),js(Number.isFinite(d)&&Number.isFinite(c)&&Number.isFinite(T));var k={},X=Qu*T,ae=Math.cos(d*xs),$e=X/360,Ie=$e/ae,Oe=X/Rt/ae;if(k.pixelsPerMeter=[Oe,-Oe,Oe],k.metersPerPixel=[1/Oe,-1/Oe,1/Oe],k.pixelsPerDegree=[$e,-Ie,Oe],k.degreesPerPixel=[1/$e,-1/Ie,1/Oe],I){var ft=xs*Math.tan(d*xs)/ae,Ne=$e*ft/2,lt=X/Rt*ft,Ue=lt/Ie*Oe;k.pixelsPerDegree2=[0,-Ne,lt],k.pixelsPerMeter2=[Ue,0,Ue]}return k}function Ii(O,d){var c=Object(C.a)(O,3),p=c[0],T=c[1],j=c[2],I=Object(C.a)(d,3),k=I[0],X=I[1],ae=I[2],$e=1,Ie=Ya({longitude:p,latitude:T,scale:$e,highPrecision:!0}),Oe=Ie.pixelsPerMeter,ft=Ie.pixelsPerMeter2,Ne=Xa(O,$e);Ne[0]+=k*(Oe[0]+ft[0]*X),Ne[1]+=X*(Oe[1]+ft[1]*X);var lt=vi(Ne,$e),Ue=(j||0)+(ae||0);return Number.isFinite(j)||Number.isFinite(ae)?[lt[0],lt[1],Ue]:lt}function Go(O){var d=O.height,c=O.pitch,p=O.bearing,T=O.altitude,j=O.center,I=j===void 0?null:j,k=O.flipY,X=k===void 0?!1:k,ae=Tu();return Fi.translate(ae,ae,[0,0,-T]),Fi.scale(ae,ae,[1,1,1/d]),Fi.rotateX(ae,ae,-c*xs),Fi.rotateZ(ae,ae,p*xs),X&&Fi.scale(ae,ae,[1,-1,1]),I&&Fi.translate(ae,ae,Ks.negate([],I)),ae}function Cs(O){var d=O.width,c=O.height,p=O.altitude,T=p===void 0?fr:p,j=O.pitch,I=j===void 0?0:j,k=O.nearZMultiplier,X=k===void 0?1:k,ae=O.farZMultiplier,$e=ae===void 0?1:ae,Ie=I*xs,Oe=Math.atan(.5/T),ft=Math.sin(Oe)*T/Math.sin(Math.PI/2-Ie-Oe),Ne=Math.cos(Math.PI/2-Ie)*ft+T;return{fov:2*Math.atan(c/2/T),aspect:d/c,focalDistance:T,near:X,far:Ne*$e}}function pi(O){var d=O.width,c=O.height,p=O.pitch,T=O.altitude,j=O.nearZMultiplier,I=O.farZMultiplier,k=Cs({width:d,height:c,altitude:T,pitch:p,nearZMultiplier:j,farZMultiplier:I}),X=k.fov,ae=k.aspect,$e=k.near,Ie=k.far,Oe=Fi.perspective([],X,ae,$e,Ie);return Oe}function Pl(O,d){var c=Object(C.a)(O,3),p=c[0],T=c[1],j=c[2],I=j===void 0?0:j;return js(Number.isFinite(p)&&Number.isFinite(T)&&Number.isFinite(I)),Mo(d,[p,T,I,1])}function $s(O,d){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,p=Object(C.a)(O,3),T=p[0],j=p[1],I=p[2];if(js(Number.isFinite(T)&&Number.isFinite(j),"invalid pixel coordinate"),Number.isFinite(I)){var k=Mo(d,[T,j,I,1]);return k}var X=Mo(d,[T,j,0,1]),ae=Mo(d,[T,j,1,1]),$e=X[2],Ie=ae[2],Oe=$e===Ie?0:((c||0)-$e)/(Ie-$e);return Ys.lerp([],X,ae,Oe)}var Es=Tu(),gl=function(){function O(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=d.width,p=d.height,T=d.viewMatrix,j=T===void 0?Es:T,I=d.projectionMatrix,k=I===void 0?Es:I;Object(D.a)(this,O),this.width=c||1,this.height=p||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=j,this.projectionMatrix=k;var X=Tu();Fi.multiply(X,X,this.projectionMatrix),Fi.multiply(X,X,this.viewMatrix),this.viewProjectionMatrix=X;var ae=Tu();Fi.scale(ae,ae,[this.width/2,-this.height/2,1]),Fi.translate(ae,ae,[1,-1,0]),Fi.multiply(ae,ae,this.viewProjectionMatrix);var $e=Fi.invert(Tu(),ae);if(!$e)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=ae,this.pixelUnprojectionMatrix=$e,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return Object($.a)(O,[{key:"equals",value:function(c){return c instanceof O?c.width===this.width&&c.height===this.height&&Fi.equals(c.projectionMatrix,this.projectionMatrix)&&Fi.equals(c.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},T=p.topLeft,j=T===void 0?!0:T,I=this.projectPosition(c),k=Pl(I,this.pixelProjectionMatrix),X=Object(C.a)(k,2),ae=X[0],$e=X[1],Ie=j?$e:this.height-$e;return c.length===2?[ae,Ie]:[ae,Ie,k[2]]}},{key:"unproject",value:function(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},T=p.topLeft,j=T===void 0?!0:T,I=p.targetZ,k=Object(C.a)(c,3),X=k[0],ae=k[1],$e=k[2],Ie=j?ae:this.height-ae,Oe=I&&I*this.pixelsPerMeter,ft=$s([X,Ie,$e],this.pixelUnprojectionMatrix,Oe),Ne=this.unprojectPosition(ft),lt=Object(C.a)(Ne,3),Ue=lt[0],It=lt[1],$t=lt[2];return Number.isFinite($e)?[Ue,It,$t]:Number.isFinite(I)?[Ue,It,I]:[Ue,It]}},{key:"projectPosition",value:function(c){var p=this.projectFlat(c),T=Object(C.a)(p,2),j=T[0],I=T[1],k=(c[2]||0)*this.pixelsPerMeter;return[j,I,k]}},{key:"unprojectPosition",value:function(c){var p=this.unprojectFlat(c),T=Object(C.a)(p,2),j=T[0],I=T[1],k=(c[2]||0)/this.pixelsPerMeter;return[j,I,k]}},{key:"projectFlat",value:function(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return c}},{key:"unprojectFlat",value:function(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return c}}]),O}();function cu(O){var d=O.width,c=O.height,p=O.bounds,T=O.minExtent,j=T===void 0?0:T,I=O.maxZoom,k=I===void 0?24:I,X=O.padding,ae=X===void 0?0:X,$e=O.offset,Ie=$e===void 0?[0,0]:$e,Oe=Object(C.a)(p,2),ft=Object(C.a)(Oe[0],2),Ne=ft[0],lt=ft[1],Ue=Object(C.a)(Oe[1],2),It=Ue[0],$t=Ue[1];if(Number.isFinite(ae)){var ar=ae;ae={top:ar,bottom:ar,left:ar,right:ar}}else js(Number.isFinite(ae.top)&&Number.isFinite(ae.bottom)&&Number.isFinite(ae.left)&&Number.isFinite(ae.right));var tr=new _u({width:d,height:c,longitude:0,latitude:0,zoom:0}),pr=tr.project([Ne,$t]),wr=tr.project([It,lt]),$r=[Math.max(Math.abs(wr[0]-pr[0]),j),Math.max(Math.abs(wr[1]-pr[1]),j)],Cn=[d-ae.left-ae.right-Math.abs(Ie[0])*2,c-ae.top-ae.bottom-Math.abs(Ie[1])*2];js(Cn[0]>0&&Cn[1]>0);var un=Cn[0]/$r[0],_n=Cn[1]/$r[1],Kn=(ae.right-ae.left)/2/un,ka=(ae.bottom-ae.top)/2/_n,Ei=[(wr[0]+pr[0])/2+Kn,(wr[1]+pr[1])/2+ka],Pi=tr.unproject(Ei),Du=tr.zoom+Math.log2(Math.abs(Math.min(un,_n)));return{longitude:Pi[0],latitude:Pi[1],zoom:Math.min(Du,k)}}var _u=function(O){Object(te.a)(d,O);function d(){var c,p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},T=p.width,j=p.height,I=p.latitude,k=I===void 0?0:I,X=p.longitude,ae=X===void 0?0:X,$e=p.zoom,Ie=$e===void 0?0:$e,Oe=p.pitch,ft=Oe===void 0?0:Oe,Ne=p.bearing,lt=Ne===void 0?0:Ne,Ue=p.altitude,It=Ue===void 0?1.5:Ue,$t=p.nearZMultiplier,ar=p.farZMultiplier;Object(D.a)(this,d),T=T||1,j=j||1;var tr=Mr(Ie);It=Math.max(.75,It);var pr=Xa([ae,k],tr);pr[2]=0;var wr=pi({width:T,height:j,pitch:ft,bearing:lt,altitude:It,nearZMultiplier:$t||1/j,farZMultiplier:ar||1.01}),$r=Go({height:j,center:pr,pitch:ft,bearing:lt,altitude:It,flipY:!0});return c=Object(Fu.a)(this,Object(Ml.a)(d).call(this,{width:T,height:j,viewMatrix:$r,projectionMatrix:wr})),c.latitude=k,c.longitude=ae,c.zoom=Ie,c.pitch=ft,c.bearing=lt,c.altitude=It,c.scale=tr,c.center=pr,c.pixelsPerMeter=Ya(Object(bs.a)(Object(bs.a)(c))).pixelsPerMeter[2],Object.freeze(Object(bs.a)(Object(bs.a)(c))),c}return Object($.a)(d,[{key:"projectFlat",value:function(p){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Xa(p,T)}},{key:"unprojectFlat",value:function(p){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return vi(p,T)}},{key:"getMapCenterByLngLatPosition",value:function(p){var T=p.lngLat,j=p.pos,I=$s(j,this.pixelUnprojectionMatrix),k=Xa(T,this.scale),X=Ys.add([],k,Ys.negate([],I)),ae=Ys.add([],this.center,X);return vi(ae,this.scale)}},{key:"getLocationAtPoint",value:function(p){var T=p.lngLat,j=p.pos;return this.getMapCenterByLngLatPosition({lngLat:T,pos:j})}},{key:"fitBounds",value:function(p){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},j=this.width,I=this.height,k=cu(Object.assign({width:j,height:I,bounds:p},T)),X=k.longitude,ae=k.latitude,$e=k.zoom;return new d({width:j,height:I,longitude:X,latitude:ae,zoom:$e})}}]),d}(gl),fu=function(){function O(){Ye()(this,O),this.viewport=void 0}return bt()(O,[{key:"syncWithMapCamera",value:function(c){var p=c.center,T=c.zoom,j=c.pitch,I=c.bearing,k=c.viewportHeight,X=c.viewportWidth;this.viewport=new _u({width:X,height:k,longitude:p&&p[0],latitude:p&&p[1],zoom:T,pitch:j,bearing:I})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(c,p){return this.viewport.projectFlat(c,p)}}]),O}(),Uu={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},Js,Rc,pf,ci,Ic,gc,Qc,yl,qc,$i,Su,bl,as,Dc;function yc(O,d){var c=Object.keys(O);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(O);d&&(p=p.filter(function(T){return Object.getOwnPropertyDescriptor(O,T).enumerable})),c.push.apply(c,p)}return c}function Ll(O){for(var d=1;d<arguments.length;d++){var c=arguments[d]!=null?arguments[d]:{};d%2?yc(Object(c),!0).forEach(function(p){gr()(O,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(c)):yc(Object(c)).forEach(function(p){Object.defineProperty(O,p,Object.getOwnPropertyDescriptor(c,p))})}return O}o("BGjm")(`/* @antv/l7-maps */
.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:0;margin:10px;position:relative;background-color:#fff;border-radius:3px 12px 12px 3px}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 24px 2px 4px;visibility:visible;margin-top:6px}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 4px 2px 24px;border-radius:12px 3px 3px 12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact:after{content:"";cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-flex;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-flex-direction:column;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-flex-direction:column-reverse;-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-flex-direction:row-reverse;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=Oo.a;var qu={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},Nc=0,hu=12,Au="pk.eyJ1IjoibHp4dWUiLCJhIjoiYnhfTURyRSJ9.Ugm314vAKPHBzcPmY1p4KQ",ef=(Js=Object(tn.injectable)(),Rc=Object(tn.inject)(On.TYPES.MapConfig),pf=Object(tn.inject)(On.TYPES.IGlobalConfigService),ci=Object(tn.inject)(On.TYPES.ILogService),Ic=Object(tn.inject)(On.TYPES.ICoordinateSystemService),gc=Object(tn.inject)(On.TYPES.IEventEmitter),Js(Qc=(yl=(Dc=function(){function O(){var d=this;Ye()(this,O),this.map=void 0,zn()(this,"config",qc,this),zn()(this,"configService",$i,this),zn()(this,"logger",Su,this),zn()(this,"coordinateSystemService",bl,this),zn()(this,"eventEmitter",as,this),this.viewport=void 0,this.markerContainer=void 0,this.cameraChangedCallback=void 0,this.$mapContainer=void 0,this.handleCameraChanged=function(){var c=d.map.getCenter().wrap(),p=c.lat,T=c.lng;d.viewport.syncWithMapCamera({bearing:d.map.getBearing(),center:[T,p],viewportHeight:d.map.transform.height,pitch:d.map.getPitch(),viewportWidth:d.map.transform.width,zoom:d.map.getZoom(),cameraHeight:0}),d.viewport.getZoom()>hu?d.coordinateSystemService.setCoordinateSystem(On.CoordinateSystem.LNGLAT_OFFSET):d.coordinateSystemService.setCoordinateSystem(On.CoordinateSystem.LNGLAT),d.cameraChangedCallback(d.viewport)}}return bt()(O,[{key:"addMarkerContainer",value:function(){var c=this.map.getCanvasContainer();this.markerContainer=ln.a.create("div","l7-marker-container",c),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(c,p){On.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.on(c,p):this.map.on(qu[c]||c,p)}},{key:"off",value:function(c,p){this.map.off(qu[c]||c,p)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var c=this.map.transform;return[c.width,c.height]}},{key:"getType",value:function(){return"mapbox"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(c){return this.map.setZoom(c)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(c){this.map.setCenter(c)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(c){this.map.setBearing(c)}},{key:"zoomIn",value:function(c,p){this.map.zoomIn(c,p)}},{key:"zoomOut",value:function(c,p){this.map.zoomOut(c,p)}},{key:"setPitch",value:function(c){return this.map.setPitch(c)}},{key:"panTo",value:function(c){this.map.panTo(c)}},{key:"panBy",value:function(c){this.panTo(c)}},{key:"fitBounds",value:function(c,p){this.map.fitBounds(c,p)}},{key:"setMaxZoom",value:function(c){this.map.setMaxZoom(c)}},{key:"setMinZoom",value:function(c){this.map.setMinZoom(c)}},{key:"setMapStatus",value:function(c){c.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),c.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),c.dragEnable===!1&&this.map.dragPan.disable(),c.dragEnable===!0&&this.map.dragPan.enable(),c.rotateEnable===!1&&this.map.dragRotate.disable(),c.rotateEnable===!0&&this.map.dragRotate.enable(),c.keyboardEnable===!1&&this.map.keyboard.disable(),c.keyboardEnable===!0&&this.map.keyboard.enable(),c.zoomEnable===!1&&this.map.scrollZoom.disable(),c.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(c,p){this.map.flyTo({zoom:c,center:p})}},{key:"setMapStyle",value:function(c){this.map.setStyle(this.getMapStyle(c))}},{key:"pixelToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToPixel",value:function(c){return this.map.project(c)}},{key:"containerToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToContainer",value:function(c){return this.map.project(c)}},{key:"lngLatToMercator",value:function(c,p){var T=window.mapboxgl.MercatorCoordinate.fromLngLat(c,p),j=T.x,I=j===void 0?0:j,k=T.y,X=k===void 0?0:k,ae=T.z,$e=ae===void 0?0:ae;return{x:I,y:X,z:$e}}},{key:"getModelMatrix",value:function(c,p,T){var j=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],I=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},k=window.mapboxgl.MercatorCoordinate.fromLngLat(c,p),X=k.meterInMercatorCoordinateUnits(),ae=er.b.create();return er.b.translate(ae,ae,er.d.fromValues(k.x-I.x,k.y-I.y,k.z||0-I.z)),er.b.scale(ae,ae,er.d.fromValues(X*j[0],-X*j[1],X*j[2])),er.b.rotateX(ae,ae,T[0]),er.b.rotateY(ae,ae,T[1]),er.b.rotateZ(ae,ae,T[2]),ae}},{key:"init",value:function(){var d=cr()(J.a.mark(function p(){var T,j,I,k,X,ae,$e,Ie,Oe,ft,Ne,lt,Ue;return J.a.wrap(function($t){for(;;)switch($t.prev=$t.next){case 0:T=this.config,j=T.id,I=j===void 0?"map":j,k=T.attributionControl,X=k===void 0?!1:k,ae=T.style,$e=ae===void 0?"light":ae,Ie=T.token,Oe=Ie===void 0?Au:Ie,ft=T.rotation,Ne=ft===void 0?0:ft,lt=T.mapInstance,Ue=zr()(T,["id","attributionControl","style","token","rotation","mapInstance"]),this.viewport=new fu,!lt&&!window.mapboxgl&&this.logger.error(this.configService.getSceneWarninfo("SDK")),Oe===Au&&$e!=="blank"&&!window.mapboxgl.accessToken&&!lt&&this.logger.warn(this.configService.getSceneWarninfo("MapToken")),!lt&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=Oe),lt?(this.map=lt,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(I),this.map=new window.mapboxgl.Map(Ll({container:this.$mapContainer,style:this.getMapStyle($e),attributionControl:X,bearing:Ne},Ue))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return $t.stop()}},p,this)}));function c(){return d.apply(this,arguments)}return c}()},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(c){for(var p,T=arguments.length,j=new Array(T>1?T-1:0),I=1;I<T;I++)j[I-1]=arguments[I];(p=this.eventEmitter).emit.apply(p,[c].concat(j))}},{key:"once",value:function(c){for(var p,T=arguments.length,j=new Array(T>1?T-1:0),I=1;I<T;I++)j[I-1]=arguments[I];(p=this.eventEmitter).once.apply(p,[c].concat(j))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(c){var p=this.map.getCanvas(),T=c==="jpg"?p==null?void 0:p.toDataURL("image/jpeg"):p==null?void 0:p.toDataURL("image/png");return T}},{key:"onCameraChanged",value:function(c){this.cameraChangedCallback=c}},{key:"creatAmapContainer",value:function(c){var p=c;typeof c=="string"&&(p=document.getElementById(c));var T=document.createElement("div");return T.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,T.id="l7_mapbox_div"+Nc++,p.appendChild(T),T}},{key:"getMapStyle",value:function(c){return typeof c!="string"?c:Uu[c]?Uu[c]:c}}]),O}(),Dc),qc=$n()(yl.prototype,"config",[Rc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$i=$n()(yl.prototype,"configService",[pf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Su=$n()(yl.prototype,"logger",[ci],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bl=$n()(yl.prototype,"coordinateSystemService",[Ic],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),as=$n()(yl.prototype,"eventEmitter",[gc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yl))||Qc);function $l(O){var d=Ti();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function Ti(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}o("BGjm")(`/* @antv/l7-maps */
.mapboxgl-ctrl-logo {
 display: none !important;
}
`);var tf=function(O){Fe()(c,O);var d=$l(c);function c(){return Ye()(this,c),d.apply(this,arguments)}return bt()(c,[{key:"getServiceConstructor",value:function(){return ef}}]),c}(Lt);function mf(O,d){var c=Object.keys(O);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(O);d&&(p=p.filter(function(T){return Object.getOwnPropertyDescriptor(O,T).enumerable})),c.push.apply(c,p)}return c}function Jl(O){for(var d=1;d<arguments.length;d++){var c=arguments[d]!=null?arguments[d]:{};d%2?mf(Object(c),!0).forEach(function(p){kc(O,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(c)):mf(Object(c)).forEach(function(p){Object.defineProperty(O,p,Object.getOwnPropertyDescriptor(c,p))})}return O}function kc(O,d,c){return d in O?Object.defineProperty(O,d,{value:c,enumerable:!0,configurable:!0,writable:!0}):O[d]=c,O}function Ql(O,d){return ql(O)||Po(O,d)||Bu(O,d)||el()}function el(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bu(O,d){if(!O)return;if(typeof O=="string")return xl(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return xl(O,d)}function xl(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}function Po(O,d){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(O)))return;var c=[],p=!0,T=!1,j=void 0;try{for(var I=O[Symbol.iterator](),k;!(p=(k=I.next()).done)&&!(c.push(k.value),d&&c.length===d);p=!0);}catch(X){T=!0,j=X}finally{try{!p&&I.return!=null&&I.return()}finally{if(T)throw j}}return c}function ql(O){if(Array.isArray(O))return O}var Rl=mt.a.memo(function(O){var d=O.style,c=O.className,p=O.map,T=O.option,j=O.onSceneLoaded,I=Object(Pe.createRef)(),k=Object(Pe.useState)(),X=Ql(k,2),ae=X[0],$e=X[1];return Object(Pe.useEffect)(function(){var Ie=new kt.Scene(Jl(Jl({id:I.current},T),{},{map:new tf(p)}));return Ie.on("loaded",function(){$e(Ie),j&&j(Ie)}),function(){Ie.destroy()}},[]),Object(Pe.useEffect)(function(){ae&&p.style&&ae.setMapStyle(p.style)},[JSON.stringify(p.style)]),Object(Pe.useEffect)(function(){ae&&p.zoom&&ae.setZoom(p.zoom)},[p.zoom]),Object(Pe.useEffect)(function(){ae&&p.center&&ae.setCenter(p.center)},[JSON.stringify(p.center)]),Object(Pe.useEffect)(function(){ae&&p.pitch!==void 0&&ae.setPitch(p.pitch||0)},[p.pitch]),Object(Pe.useEffect)(function(){ae&&p.rotation&&ae.setRotation(p.rotation)},[p.rotation]),mt.a.createElement(ne.Provider,{value:ae},Object(Pe.createElement)("div",{ref:I,style:d,className:c},ae&&O.children))}),Il=Rl,jc=o("PJYZ"),El=o.n(jc),Qs=o("QkVN"),eo=o.n(Qs),vf=o("uhBA"),gf=o("cDf5"),Tl=o.n(gf),ec=o("zvhG"),tl=o.n(ec);function Dl(O,d){var c;if(typeof Symbol=="undefined"||O[Symbol.iterator]==null){if(Array.isArray(O)||(c=bc(O))||d&&O&&typeof O.length=="number"){c&&(O=c);var p=0,T=function(){};return{s:T,n:function(){return p>=O.length?{done:!0}:{done:!1,value:O[p++]}},e:function(ae){throw ae},f:T}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var j=!0,I=!1,k;return{s:function(){c=O[Symbol.iterator]()},n:function(){var ae=c.next();return j=ae.done,ae},e:function(ae){I=!0,k=ae},f:function(){try{!j&&c.return!=null&&c.return()}finally{if(I)throw k}}}}function bc(O,d){if(!O)return;if(typeof O=="string")return xc(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return xc(O,d)}function xc(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}var rl;function rf(O,d,c){var p=c-d,T=((O-d)%p+p)%p+d;return T===d?c:T}function nl(O,d,c){return Math.min(c,Math.max(d,O))}function qs(O,d,c){return O*(1-c)+d*c}function _l(O,d,c,p){var T=new tl.a(O,d,c,p);return function(j){return T.solve(j)}}var tc=_l(.25,.1,.25,1);function Fc(){return window.matchMedia?(rl==null&&(rl=window.matchMedia("(prefers-reduced-motion: reduce)")),rl.matches):!1}function nf(O,d){var c={},p=Dl(d),T;try{for(p.s();!(T=p.n()).done;){var j=T.value;j in O&&(c[j]=O[j])}}catch(I){p.e(I)}finally{p.f()}return c}var Fs=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now.bind(Date),yf=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,al=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame;function wi(O){var d=yf(O);return{cancel:function(){return al(d)}}}var il=function(){bt()(O,null,[{key:"convert",value:function(c){return c instanceof O?c:new O(c)}}]);function O(d,c){Ye()(this,O),this.ne=void 0,this.sw=void 0,d&&(c?this.setSouthWest(d).setNorthEast(c):d.length===4?this.setSouthWest([d[0],d[1]]).setNorthEast([d[2],d[3]]):this.setSouthWest(d[0]).setNorthEast(d[1]))}return bt()(O,[{key:"setNorthEast",value:function(c){return this.ne=c instanceof ui?new ui(c.lng,c.lat):ui.convert(c),this}},{key:"setSouthWest",value:function(c){return this.sw=c instanceof ui?new ui(c.lng,c.lat):ui.convert(c),this}},{key:"extend",value:function(c){var p=this.sw,T=this.ne,j,I;if(c instanceof ui)j=c,I=c;else if(c instanceof O){if(j=c.sw,I=c.ne,!j||!I)return this}else{if(Array.isArray(c))if(c.length===4||c.every(Array.isArray)){var k=c;return this.extend(O.convert(k))}else{var X=c;return this.extend(ui.convert(X))}return this}return!p&&!T?(this.sw=new ui(j.lng,j.lat),this.ne=new ui(I.lng,I.lat)):(p.lng=Math.min(j.lng,p.lng),p.lat=Math.min(j.lat,p.lat),T.lng=Math.max(I.lng,T.lng),T.lat=Math.max(I.lat,T.lat)),this}},{key:"getCenter",value:function(){return new ui((this.sw.lng+this.ne.lng)/2,(this.sw.lat+this.ne.lat)/2)}},{key:"getSouthWest",value:function(){return this.sw}},{key:"getNorthEast",value:function(){return this.ne}},{key:"getNorthWest",value:function(){return new ui(this.getWest(),this.getNorth())}},{key:"getSouthEast",value:function(){return new ui(this.getEast(),this.getSouth())}},{key:"getWest",value:function(){return this.sw.lng}},{key:"getSouth",value:function(){return this.sw.lat}},{key:"getEast",value:function(){return this.ne.lng}},{key:"getNorth",value:function(){return this.ne.lat}},{key:"toArray",value:function(){return[this.sw.toArray(),this.ne.toArray()]}},{key:"toString",value:function(){return"LngLatBounds(".concat(this.sw.toString(),", ").concat(this.ne.toString(),")")}},{key:"isEmpty",value:function(){return!(this.sw&&this.ne)}},{key:"contains",value:function(c){var p=ui.convert(c),T=p.lng,j=p.lat,I=this.sw.lat<=j&&j<=this.ne.lat,k=this.sw.lng<=T&&T<=this.ne.lng;return this.sw.lng>this.ne.lng&&(k=this.sw.lng>=T&&T>=this.ne.lng),I&&k}}]),O}(),Vu=63710088e-1,ui=function(){bt()(O,null,[{key:"convert",value:function(c){if(c instanceof O)return c;if(Array.isArray(c)&&(c.length===2||c.length===3))return new O(Number(c[0]),Number(c[1]));if(!Array.isArray(c)&&Tl()(c)==="object"&&c!==null){var p="lng"in c?c.lng:c.lon;return new O(Number(p),Number(c.lat))}throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}]);function O(d,c){if(Ye()(this,O),this.lng=void 0,this.lat=void 0,isNaN(d)||isNaN(c))throw new Error("Invalid LngLat object: (".concat(d,", ").concat(c,")"));if(this.lng=+d,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}return bt()(O,[{key:"wrap",value:function(){return new O(rf(this.lng,-180,180),this.lat)}},{key:"toArray",value:function(){return[this.lng,this.lat]}},{key:"toBounds",value:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,p=40075017,T=360*c/p,j=T/Math.cos(Math.PI/180*this.lat);return new il(new O(this.lng-j,this.lat-T),new O(this.lng+j,this.lat+T))}},{key:"toString",value:function(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}},{key:"distanceTo",value:function(c){var p=Math.PI/180,T=this.lat*p,j=c.lat*p,I=Math.sin(T)*Math.sin(j)+Math.cos(T)*Math.cos(j)*Math.cos((c.lng-this.lng)*p),k=Vu*Math.acos(Math.min(I,1));return k}}]),O}(),kn=function(){bt()(O,null,[{key:"convert",value:function(c){return c instanceof O?c:Array.isArray(c)?new O(c[0],c[1]):c}}]);function O(d,c){Ye()(this,O),this.x=void 0,this.y=void 0,this.x=d,this.y=c}return bt()(O,[{key:"clone",value:function(){return new O(this.x,this.y)}},{key:"_add",value:function(c){return this.x+=c.x,this.y+=c.y,this}},{key:"add",value:function(c){return this.clone()._add(c)}},{key:"_sub",value:function(c){return this.x-=c.x,this.y-=c.y,this}},{key:"sub",value:function(c){return this.clone()._sub(c)}},{key:"_multByPoint",value:function(c){return this.x*=c.x,this.y*=c.y,this}},{key:"multByPoint",value:function(c){return this.clone()._multByPoint(c)}},{key:"_divByPoint",value:function(c){return this.x/=c.x,this.y/=c.y,this}},{key:"divByPoint",value:function(c){return this.clone()._divByPoint(c)}},{key:"_mult",value:function(c){return this.x*=c,this.y*=c,this}},{key:"mult",value:function(c){return this.clone()._mult(c)}},{key:"_div",value:function(c){return this.x/=c,this.y/=c,this}},{key:"div",value:function(c){return this.clone()._div(c)}},{key:"_rotate",value:function(c){var p=Math.cos(c),T=Math.sin(c),j=p*this.x-T*this.y,I=T*this.x+p*this.y;return this.x=j,this.y=I,this}},{key:"rotate",value:function(c){return this.clone()._rotate(c)}},{key:"_rotateAround",value:function(c,p){var T=Math.cos(c),j=Math.sin(c),I=p.x+T*(this.x-p.x)-j*(this.y-p.y),k=p.y+j*(this.x-p.x)+T*(this.y-p.y);return this.x=I,this.y=k,this}},{key:"roateAround",value:function(c,p){return this.clone()._rotateAround(c,p)}},{key:"_matMult",value:function(c){var p=c[0]*this.x+c[1]*this.y,T=c[2]*this.x+c[3]*this.y;return this.x=p,this.y=T,this}},{key:"matMult",value:function(c){return this.clone()._matMult(c)}},{key:"_unit",value:function(){return this.div(this.mag()),this}},{key:"unit",value:function(){return this.clone()._unit()}},{key:"_perp",value:function(){var c=this.y;return this.y=this.x,this.x=-c,this}},{key:"perp",value:function(){return this.clone()._perp()}},{key:"_round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"round",value:function(){return this.clone()._round()}},{key:"mag",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"equals",value:function(c){return this.x===c.x&&this.y===c.y}},{key:"dist",value:function(c){return Math.sqrt(this.distSqr(c))}},{key:"distSqr",value:function(c){var p=c.x-this.x,T=c.y-this.y;return p*p+T*T}},{key:"angle",value:function(){return Math.atan2(this.y,this.x)}},{key:"angleTo",value:function(c){return Math.atan2(this.y-c.y,this.x-c.x)}},{key:"angleWith",value:function(c){return this.angleWithSep(c.x,c.y)}},{key:"angleWithSep",value:function(c,p){return Math.atan2(this.x*p-this.y*c,this.x*c+this.y*p)}}]),O}(),Oi=function(){function O(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,T=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(Ye()(this,O),this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,isNaN(d)||d<0||isNaN(c)||c<0||isNaN(p)||p<0||isNaN(T)||T<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=d,this.bottom=c,this.left=p,this.right=T}return bt()(O,[{key:"interpolate",value:function(c,p,T){return p.top!=null&&c.top!=null&&(this.top=qs(c.top,p.top,T)),p.bottom!=null&&c.bottom!=null&&(this.bottom=qs(c.bottom,p.bottom,T)),p.left!=null&&c.left!=null&&(this.left=qs(c.left,p.left,T)),p.right!=null&&c.right!=null&&(this.right=qs(c.right,p.right,T)),this}},{key:"getCenter",value:function(c,p){var T=nl((this.left+c-this.right)/2,0,c),j=nl((this.top+p-this.bottom)/2,0,p);return new kn(T,j)}},{key:"equals",value:function(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}},{key:"clone",value:function(){return new O(this.top,this.bottom,this.left,this.right)}},{key:"toJSON",value:function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}]),O}(),ws=2*Math.PI*Vu;function Nl(O){return ws*Math.cos(O*Math.PI/180)}function Gu(O){return(180+O)/360}function ol(O){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+O*Math.PI/360)))/360}function bf(O,d){return O/Nl(d)}function is(O){return O*360-180}function Sl(O){var d=180-O*360;return 360/Math.PI*Math.atan(Math.exp(d*Math.PI/180))-90}function sl(O,d){return O*Nl(Sl(d))}function ul(O){return 1/Math.cos(O*Math.PI/180)}var zi=function(){bt()(O,null,[{key:"fromLngLat",value:function(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,T=ui.convert(c);return new O(Gu(T.lng),ol(T.lat),bf(p,T.lat))}}]);function O(d,c){var p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;Ye()(this,O),this.x=void 0,this.y=void 0,this.z=void 0,this.x=+d,this.y=+c,this.z=+p}return bt()(O,[{key:"toLngLat",value:function(){return new ui(is(this.x),Sl(this.y))}},{key:"toAltitude",value:function(){return sl(this.z,this.y)}},{key:"meterInMercatorCoordinateUnits",value:function(){return 1/ws*ul(Sl(this.y))}}]),O}();function Ts(O,d){var c;if(typeof Symbol=="undefined"||O[Symbol.iterator]==null){if(Array.isArray(O)||(c=kl(O))||d&&O&&typeof O.length=="number"){c&&(O=c);var p=0,T=function(){};return{s:T,n:function(){return p>=O.length?{done:!0}:{done:!1,value:O[p++]}},e:function(ae){throw ae},f:T}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var j=!0,I=!1,k;return{s:function(){c=O[Symbol.iterator]()},n:function(){var ae=c.next();return j=ae.done,ae},e:function(ae){I=!0,k=ae},f:function(){try{!j&&c.return!=null&&c.return()}finally{if(I)throw k}}}}function kl(O,d){if(!O)return;if(typeof O=="string")return to(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return to(O,d)}function to(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}var In=8192,zs=function(){bt()(O,[{key:"minZoom",get:function(){return this._minZoom},set:function(c){if(this._minZoom===c)return;this._minZoom=c,this.zoom=Math.max(this.zoom,c)}},{key:"maxZoom",get:function(){return this._maxZoom},set:function(c){if(this._maxZoom===c)return;this._maxZoom=c,this.zoom=Math.min(this.zoom,c)}},{key:"minPitch",get:function(){return this._minPitch},set:function(c){if(this._minPitch===c)return;this._minPitch=c,this._pitch=Math.max(this._pitch,c)}},{key:"maxPitch",get:function(){return this._maxPitch},set:function(c){if(this._maxPitch===c)return;this._maxPitch=c,this._pitch=Math.min(this._pitch,c)}},{key:"renderWorldCopies",get:function(){return this._renderWorldCopies},set:function(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c}},{key:"worldSize",get:function(){return this.tileSize*this.scale}},{key:"centerOffset",get:function(){return this.centerPoint._sub(this.size._div(2))}},{key:"size",get:function(){return new kn(this.width,this.height)}},{key:"bearing",get:function(){return-this.angle/Math.PI*180},set:function(c){var p=-rf(c,-180,180)*Math.PI/180;if(this.angle===p)return;this.unmodified=!1,this.angle=p,this.calcMatrices(),this.rotationMatrix=er.a.create(),er.a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle)}},{key:"pitch",get:function(){return this._pitch/Math.PI*180},set:function(c){var p=nl(c,this._minPitch,this._maxPitch)/180*Math.PI;if(this._pitch===p)return;this.unmodified=!1,this._pitch=p,this.calcMatrices()}},{key:"fov",get:function(){return this._fov/Math.PI*180},set:function(c){if(c=Math.max(.01,Math.min(60,c)),this._fov===c)return;this.unmodified=!1,this._fov=c/180*Math.PI,this.calcMatrices()}},{key:"zoom",get:function(){return this._zoom},set:function(c){var p=Math.min(Math.max(c,this._minZoom),this._maxZoom);if(this._zoom===p)return;this.unmodified=!1,this._zoom=p,this.scale=this.zoomScale(p),this.tileZoom=Math.floor(p),this.zoomFraction=p-this.tileZoom,this.constrain(),this.calcMatrices()}},{key:"center",get:function(){return this._center},set:function(c){if(c.lat===this._center.lat&&c.lng===this._center.lng)return;this.unmodified=!1,this._center=c,this.constrain(),this.calcMatrices()}},{key:"padding",get:function(){return this.edgeInsets.toJSON()},set:function(c){if(this.edgeInsets.equals(c))return;this.unmodified=!1,this.edgeInsets.interpolate(this.edgeInsets,c,1),this.calcMatrices()}},{key:"centerPoint",get:function(){return this.edgeInsets.getCenter(this.width,this.height)}},{key:"point",get:function(){return this.project(this.center)}}]);function O(d,c,p,T,j){Ye()(this,O),this.tileSize=void 0,this.tileZoom=void 0,this.lngRange=void 0,this.latRange=void 0,this.maxValidLatitude=void 0,this.scale=void 0,this.width=void 0,this.height=void 0,this.angle=void 0,this.rotationMatrix=void 0,this.pixelsToGLUnits=void 0,this.cameraToCenterDistance=void 0,this.mercatorMatrix=void 0,this.projMatrix=void 0,this.invProjMatrix=void 0,this.alignedProjMatrix=void 0,this.pixelMatrix=void 0,this.pixelMatrixInverse=void 0,this.glCoordMatrix=void 0,this.labelPlaneMatrix=void 0,this._fov=void 0,this._pitch=void 0,this._zoom=void 0,this._renderWorldCopies=void 0,this._minZoom=void 0,this._maxZoom=void 0,this._minPitch=void 0,this._maxPitch=void 0,this._center=void 0,this.zoomFraction=void 0,this.unmodified=void 0,this.edgeInsets=void 0,this.constraining=void 0,this.posMatrixCache=void 0,this.alignedPosMatrixCache=void 0,this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=j===void 0?!0:j,this._minZoom=d||0,this._maxZoom=c||22,this._minPitch=p==null?0:p,this._maxPitch=T==null?60:T,this.setMaxBounds(),this.width=0,this.height=0,this._center=new ui(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this.unmodified=!0,this.edgeInsets=new Oi,this.posMatrixCache={},this.alignedPosMatrixCache={}}return bt()(O,[{key:"clone",value:function(){var c=new O(this._minZoom,this._maxZoom,this._minPitch,this._maxPitch,this._renderWorldCopies);return c.tileSize=this.tileSize,c.latRange=this.latRange,c.width=this.width,c.height=this.height,c.center=this._center,c.zoom=this.zoom,c.angle=this.angle,c.fov=this._fov,c.pitch=this._pitch,c.unmodified=this.unmodified,c.edgeInsets=this.edgeInsets.clone(),c.calcMatrices(),c}},{key:"isPaddingEqual",value:function(c){return this.edgeInsets.equals(c)}},{key:"interpolatePadding",value:function(c,p,T){this.unmodified=!1,this.edgeInsets.interpolate(c,p,T),this.constrain(),this.calcMatrices()}},{key:"coveringZoomLevel",value:function(c){var p=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,p)}},{key:"resize",value:function(c,p){this.width=c,this.height=p,this.pixelsToGLUnits=[2/c,-2/p],this.constrain(),this.calcMatrices()}},{key:"zoomScale",value:function(c){return Math.pow(2,c)}},{key:"scaleZoom",value:function(c){return Math.log(c)/Math.LN2}},{key:"project",value:function(c){var p=nl(c.lat,-this.maxValidLatitude,this.maxValidLatitude);return new kn(Gu(c.lng)*this.worldSize,ol(p)*this.worldSize)}},{key:"unproject",value:function(c){return new zi(c.x/this.worldSize,c.y/this.worldSize).toLngLat()}},{key:"setLocationAtPoint",value:function(c,p){var T=this.pointCoordinate(p),j=this.pointCoordinate(this.centerPoint),I=this.locationCoordinate(c),k=new zi(I.x-(T.x-j.x),I.y-(T.y-j.y));this.center=this.coordinateLocation(k),this._renderWorldCopies&&(this.center=this.center.wrap())}},{key:"pointCoordinate",value:function(c){var p=0,T=new Float32Array([c.x,c.y,0,1]),j=new Float32Array([c.x,c.y,1,1]);er.e.transformMat4(T,T,this.pixelMatrixInverse),er.e.transformMat4(j,j,this.pixelMatrixInverse);var I=T[3],k=j[3],X=T[0]/I,ae=j[0]/k,$e=T[1]/I,Ie=j[1]/k,Oe=T[2]/I,ft=j[2]/k,Ne=Oe===ft?0:(p-Oe)/(ft-Oe);return new zi(qs(X,ae,Ne)/this.worldSize,qs($e,Ie,Ne)/this.worldSize)}},{key:"getBounds",value:function(){return new il().extend(this.pointLocation(new kn(0,0))).extend(this.pointLocation(new kn(this.width,0))).extend(this.pointLocation(new kn(this.width,this.height))).extend(this.pointLocation(new kn(0,this.height)))}},{key:"getMaxBounds",value:function(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new il([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])}},{key:"setMaxBounds",value:function(c){c?(this.lngRange=[c.getWest(),c.getEast()],this.latRange=[c.getSouth(),c.getNorth()],this.constrain()):(this.lngRange=void 0,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}},{key:"customLayerMatrix",value:function(){return this.mercatorMatrix.slice()}},{key:"maxPitchScaleFactor",value:function(){if(!this.pixelMatrixInverse)return 1;var c=this.pointCoordinate(new kn(0,0)),p=new Float32Array([c.x*this.worldSize,c.y*this.worldSize,0,1]),T=er.e.transformMat4(p,p,this.pixelMatrix);return T[3]/this.cameraToCenterDistance}},{key:"getCameraPoint",value:function(){var c=this._pitch,p=Math.tan(c)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new kn(0,p))}},{key:"getCameraQueryGeometry",value:function(c){var p=this.getCameraPoint();if(c.length===1)return[c[0],p];var T=p.x,j=p.y,I=p.x,k=p.y,X=Ts(c),ae;try{for(X.s();!(ae=X.n()).done;){var $e=ae.value;T=Math.min(T,$e.x),j=Math.min(j,$e.y),I=Math.max(I,$e.x),k=Math.max(k,$e.y)}}catch(Ie){X.e(Ie)}finally{X.f()}return[new kn(T,j),new kn(I,j),new kn(I,k),new kn(T,k),new kn(T,j)]}},{key:"coordinatePoint",value:function(c){var p=er.e.fromValues(c.x*this.worldSize,c.y*this.worldSize,0,1);return er.e.transformMat4(p,p,this.pixelMatrix),new kn(p[0]/p[3],p[1]/p[3])}},{key:"locationPoint",value:function(c){return this.coordinatePoint(this.locationCoordinate(c))}},{key:"pointLocation",value:function(c){return this.coordinateLocation(this.pointCoordinate(c))}},{key:"locationCoordinate",value:function(c){return zi.fromLngLat(c)}},{key:"coordinateLocation",value:function(c){return c.toLngLat()}},{key:"getProjectionMatrix",value:function(){return this.projMatrix}},{key:"constrain",value:function(){if(!this.center||!this.width||!this.height||this.constraining)return;this.constraining=!0;var c=-90,p=90,T=-180,j=180,I,k,X,ae,$e=this.size,Ie=this.unmodified;if(this.latRange){var Oe=this.latRange;c=ol(Oe[1])*this.worldSize,p=ol(Oe[0])*this.worldSize,I=p-c<$e.y?$e.y/(p-c):0}if(this.lngRange){var ft=this.lngRange;T=Gu(ft[0])*this.worldSize,j=Gu(ft[1])*this.worldSize,k=j-T<$e.x?$e.x/(j-T):0}var Ne=this.point,lt=Math.max(k||0,I||0);if(lt){this.center=this.unproject(new kn(k?(j+T)/2:Ne.x,I?(p+c)/2:Ne.y)),this.zoom+=this.scaleZoom(lt),this.unmodified=Ie,this.constraining=!1;return}if(this.latRange){var Ue=Ne.y,It=$e.y/2;Ue-It<c&&(ae=c+It),Ue+It>p&&(ae=p-It)}if(this.lngRange){var $t=Ne.x,ar=$e.x/2;$t-ar<T&&(X=T+ar),$t+ar>j&&(X=j-ar)}(X!==void 0||ae!==void 0)&&(this.center=this.unproject(new kn(X!==void 0?X:Ne.x,ae!==void 0?ae:Ne.y))),this.unmodified=Ie,this.constraining=!1}},{key:"calcMatrices",value:function(){if(!this.height)return;var c=this._fov/2,p=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(c)*this.height;var T=Math.PI/2+this._pitch,j=this._fov*(.5+p.y/this.height),I=Math.sin(j)*this.cameraToCenterDistance/Math.sin(nl(Math.PI-T-j,.01,Math.PI-.01)),k=this.point,X=k.x,ae=k.y,$e=Math.cos(Math.PI/2-this._pitch)*I+this.cameraToCenterDistance,Ie=$e*1.01,Oe=this.height/50,ft=er.b.create();er.b.perspective(ft,this._fov,this.width/this.height,Oe,Ie),ft[8]=-p.x*2/this.width,ft[9]=p.y*2/this.height,er.b.scale(ft,ft,[1,-1,1]),er.b.translate(ft,ft,[0,0,-this.cameraToCenterDistance]),er.b.rotateX(ft,ft,this._pitch),er.b.rotateZ(ft,ft,this.angle),er.b.translate(ft,ft,[-X,-ae,0]),this.mercatorMatrix=er.b.scale(er.b.create(),ft,[this.worldSize,this.worldSize,this.worldSize]),er.b.scale(ft,ft,er.d.fromValues(1,1,bf(1,this.center.lat)*this.worldSize)),this.projMatrix=ft,this.invProjMatrix=er.b.invert(er.b.create(),this.projMatrix);var Ne=this.width%2/2,lt=this.height%2/2,Ue=Math.cos(this.angle),It=Math.sin(this.angle),$t=X-Math.round(X)+Ue*Ne+It*lt,ar=ae-Math.round(ae)+Ue*lt+It*Ne,tr=er.b.clone(ft);if(er.b.translate(tr,tr,[$t>.5?$t-1:$t,ar>.5?ar-1:ar,0]),this.alignedProjMatrix=tr,ft=er.b.create(),er.b.scale(ft,ft,[this.width/2,-this.height/2,1]),er.b.translate(ft,ft,[1,-1,0]),this.labelPlaneMatrix=ft,ft=er.b.create(),er.b.scale(ft,ft,[1,-1,1]),er.b.translate(ft,ft,[-1,-1,0]),er.b.scale(ft,ft,[2/this.width,2/this.height,1]),this.glCoordMatrix=ft,this.pixelMatrix=er.b.multiply(er.b.create(),this.labelPlaneMatrix,this.projMatrix),ft=er.b.invert(er.b.create(),this.pixelMatrix),!ft)throw new Error("failed to invert matrix");this.pixelMatrixInverse=ft,this.posMatrixCache={},this.alignedPosMatrixCache={}}}]),O}(),ti=function O(d){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ye()(this,O),this.type=void 0,eo()(this,c),this.type=d};function jl(O){var d=du();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function du(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}var Us=function(O){Fe()(c,O);var d=jl(c);function c(p){var T;Ye()(this,c),T=d.call(this),T.transform=void 0,T.options=void 0,T.moving=void 0,T.zooming=void 0,T.rotating=void 0,T.pitching=void 0,T.padding=void 0,T.bearingSnap=void 0,T.easeEndTimeoutID=void 0,T.easeStart=void 0,T.easeOptions=void 0,T.easeId=void 0,T.onEaseFrame=void 0,T.onEaseEnd=void 0,T.easeFrameId=void 0,T.renderFrameCallback=function(){var $e=Math.min((Fs()-T.easeStart)/T.easeOptions.duration,1);T.onEaseFrame(T.easeOptions.easing($e)),$e<1?T.easeFrameId=T.requestRenderFrame(T.renderFrameCallback):T.stop()},T.options=p;var j=p.minZoom,I=p.maxZoom,k=p.minPitch,X=p.maxPitch,ae=p.renderWorldCopies;return T.moving=!1,T.zooming=!1,T.bearingSnap=p.bearingSnap,T.transform=new zs(j,I,k,X,ae),T}return bt()(c,[{key:"requestRenderFrame",value:function(T){return 0}},{key:"cancelRenderFrame",value:function(T){return}},{key:"getCenter",value:function(){var T=this.transform.center,j=T.lng,I=T.lat;return new ui(j,I)}},{key:"getZoom",value:function(){return this.transform.zoom}},{key:"getPitch",value:function(){return this.transform.pitch}},{key:"setCenter",value:function(T,j){return this.jumpTo({center:T},j)}},{key:"setPitch",value:function(T,j){return this.jumpTo({pitch:T},j),this}},{key:"getBearing",value:function(){return this.transform.bearing}},{key:"panTo",value:function(T,j,I){return this.easeTo(eo()({center:T},j),I)}},{key:"zoomOut",value:function(T,j){return this.zoomTo(this.getZoom()-1,T,j),this}},{key:"setBearing",value:function(T,j){return this.jumpTo({bearing:T},j),this}},{key:"setZoom",value:function(T,j){return this.jumpTo({zoom:T},j),this}},{key:"zoomIn",value:function(T,j){return this.zoomTo(this.getZoom()+1,T,j),this}},{key:"zoomTo",value:function(T,j,I){return this.easeTo(eo()({zoom:T},j),I)}},{key:"getPadding",value:function(){return this.transform.padding}},{key:"setPadding",value:function(T,j){return this.jumpTo({padding:T},j),this}},{key:"rotateTo",value:function(T,j,I){return this.easeTo(eo()({bearing:T},j),I)}},{key:"resetNorth",value:function(T,j){return this.rotateTo(0,eo()({duration:1e3},T),j),this}},{key:"resetNorthPitch",value:function(T,j){return this.easeTo(eo()({bearing:0,pitch:0,duration:1e3},T),j),this}},{key:"fitBounds",value:function(T,j,I){return this.fitInternal(this.cameraForBounds(T,j),j,I)}},{key:"cameraForBounds",value:function(T,j){return T=il.convert(T),this.cameraForBoxAndBearing(T.getNorthWest(),T.getSouthEast(),0,j)}},{key:"snapToNorth",value:function(T,j){return Math.abs(this.getBearing())<this.bearingSnap?this.resetNorth(T,j):this}},{key:"jumpTo",value:function(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},j=arguments.length>1?arguments[1]:void 0;this.stop();var I=this.transform,k=!1,X=!1,ae=!1;return T.zoom&&I.zoom!==+T.zoom&&(k=!0,I.zoom=+T.zoom),T.center!==void 0&&(I.center=ui.convert(T.center)),T.bearing&&I.bearing!==+T.bearing&&(X=!0,I.bearing=+T.bearing),T.pitch&&I.pitch!==+T.pitch&&(ae=!0,I.pitch=+T.pitch),T.padding!=null&&!I.isPaddingEqual(T.padding)&&(I.padding=T.padding),this.emit("movestart",new ti("movestart",j)),this.emit("move",new ti("move",j)),k&&(this.emit("zoomstart",new ti("zoomstart",j)),this.emit("zoom",new ti("zoom",j)),this.emit("zoomend",new ti("zoomend",j))),X&&(this.emit("rotatestart",new ti("rotatestart",j)),this.emit("rotate",new ti("rotate",j)),this.emit("rotateend",new ti("rotateend",j))),ae&&(this.emit("pitchstart",new ti("pitchstart",j)),this.emit("pitch",new ti("pitch",j)),this.emit("pitchend",new ti("pitchend",j))),this.emit("moveend",new ti("moveend",j))}},{key:"easeTo",value:function(){var T=this,j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},I=arguments.length>1?arguments[1]:void 0;j=eo()({offset:[0,0],duration:500,easing:tc},j),(j.animate===!1||!j.essential&&Fc())&&(j.duration=0);var k=this.transform,X=this.getZoom(),ae=this.getBearing(),$e=this.getPitch(),Ie=this.getPadding(),Oe=j.zoom?+j.zoom:X,ft=j.bearing?this.normalizeBearing(j.bearing,ae):ae,Ne=j.pitch?+j.pitch:$e,lt=j.padding?j.padding:k.padding,Ue=kn.convert(j.offset),It=k.centerPoint.add(Ue),$t=k.pointLocation(It),ar=ui.convert(j.center||$t);this.normalizeCenter(ar);var tr=k.project($t),pr=k.project(ar).sub(tr),wr=k.zoomScale(Oe-X),$r,Cn;j.around&&($r=ui.convert(j.around),Cn=k.locationPoint($r));var un={moving:this.moving,zooming:this.zooming,rotating:this.rotating,pitching:this.pitching};return this.zooming=this.zooming||Oe!==X,this.rotating=this.rotating||ae!==ft,this.pitching=this.pitching||Ne!==$e,this.padding=!k.isPaddingEqual(lt),this.easeId=j.easeId,this.prepareEase(I,j.noMoveStart,un),clearTimeout(this.easeEndTimeoutID),this.ease(function(_n){if(T.zooming&&(k.zoom=qs(X,Oe,_n)),T.rotating&&(k.bearing=qs(ae,ft,_n)),T.pitching&&(k.pitch=qs($e,Ne,_n)),T.padding&&(k.interpolatePadding(Ie,lt,_n),It=k.centerPoint.add(Ue)),$r)k.setLocationAtPoint($r,Cn);else{var Kn=k.zoomScale(k.zoom-X),ka=Oe>X?Math.min(2,wr):Math.max(.5,wr),Ei=Math.pow(ka,1-_n),Pi=k.unproject(tr.add(pr.mult(_n*Ei)).mult(Kn));k.setLocationAtPoint(k.renderWorldCopies?Pi.wrap():Pi,It)}T.fireMoveEvents(I)},function(_n){T.afterEase(I,_n)},j),this}},{key:"flyTo",value:function(){var T=this,j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},I=arguments.length>1?arguments[1]:void 0;if(!j.essential&&Fc()){var k=nf(j,["center","zoom","bearing","pitch","around"]);return this.jumpTo(k,I)}this.stop(),j=eo()({offset:[0,0],speed:1.2,curve:1.42,easing:tc},j);var X=this.transform,ae=this.getZoom(),$e=this.getBearing(),Ie=this.getPitch(),Oe=this.getPadding(),ft=j.zoom?nl(+j.zoom,X.minZoom,X.maxZoom):ae,Ne=j.bearing?this.normalizeBearing(j.bearing,$e):$e,lt=j.pitch?+j.pitch:Ie,Ue="padding"in j?j.padding:X.padding,It=X.zoomScale(ft-ae),$t=kn.convert(j.offset),ar=X.centerPoint.add($t),tr=X.pointLocation(ar),pr=ui.convert(j.center||tr);this.normalizeCenter(pr);var wr=X.project(tr),$r=X.project(pr).sub(wr),Cn=j.curve,un=Math.max(X.width,X.height),_n=un/It,Kn=$r.mag();if("minZoom"in j){var ka=nl(Math.min(j.minZoom,ae,ft),X.minZoom,X.maxZoom),Ei=un/X.zoomScale(ka-ae);Cn=Math.sqrt(Ei/Kn*2)}var Pi=Cn*Cn;function Du(_a){var Ol=(_n*_n-un*un+(_a?-1:1)*Pi*Pi*Kn*Kn)/(2*(_a?_n:un)*Pi*Kn);return Math.log(Math.sqrt(Ol*Ol+1)-Ol)}function ou(_a){return(Math.exp(_a)-Math.exp(-_a))/2}function Xl(_a){return(Math.exp(_a)+Math.exp(-_a))/2}function Ds(_a){return ou(_a)/Xl(_a)}var Ns=Du(0),Yl=function(Ol){return Xl(Ns)/Xl(Ns+Cn*Ol)},dc=function(Ol){return un*((Xl(Ns)*Ds(Ns+Cn*Ol)-ou(Ns))/Pi)/Kn},yu=(Du(1)-Ns)/Cn;if(Math.abs(Kn)<1e-6||!isFinite(yu)){if(Math.abs(un-_n)<1e-6)return this.easeTo(j,I);var Mc=_n<un?-1:1;yu=Math.abs(Math.log(_n/un))/Cn,dc=function(){return 0},Yl=function(Ol){return Math.exp(Mc*Cn*Ol)}}if("duration"in j)j.duration=+j.duration;else{var Co="screenSpeed"in j?+j.screenSpeed/Cn:+j.speed;j.duration=1e3*yu/Co}return j.maxDuration&&j.duration>j.maxDuration&&(j.duration=0),this.zooming=!0,this.rotating=$e!==Ne,this.pitching=lt!==Ie,this.padding=!X.isPaddingEqual(Ue),this.prepareEase(I,!1),this.ease(function(_a){var Ol=_a*yu,nh=1/Yl(Ol);X.zoom=_a===1?ft:ae+X.scaleZoom(nh),T.rotating&&(X.bearing=qs($e,Ne,_a)),T.pitching&&(X.pitch=qs(Ie,lt,_a)),T.padding&&(X.interpolatePadding(Oe,Ue,_a),ar=X.centerPoint.add($t));var fh=_a===1?pr:X.unproject(wr.add($r.mult(dc(Ol))).mult(nh));X.setLocationAtPoint(X.renderWorldCopies?fh.wrap():fh,ar),T.fireMoveEvents(I)},function(){return T.afterEase(I)},j),this}},{key:"fitScreenCoordinates",value:function(T,j,I,k,X){return this.fitInternal(this.cameraForBoxAndBearing(this.transform.pointLocation(kn.convert(T)),this.transform.pointLocation(kn.convert(j)),I,k),k,X)}},{key:"stop",value:function(T,j){if(this.easeFrameId&&(this.cancelRenderFrame(this.easeFrameId),delete this.easeFrameId,delete this.onEaseFrame),this.onEaseEnd){var I=this.onEaseEnd;delete this.onEaseEnd,I.call(this,j)}return this}},{key:"normalizeBearing",value:function(T,j){T=rf(T,-180,180);var I=Math.abs(T-j);return Math.abs(T-360-j)<I&&(T-=360),Math.abs(T+360-j)<I&&(T+=360),T}},{key:"normalizeCenter",value:function(T){var j=this.transform;if(!j.renderWorldCopies||j.lngRange)return;var I=T.lng-j.center.lng;T.lng+=I>180?-360:I<-180?360:0}},{key:"fireMoveEvents",value:function(T){this.emit("move",new ti("move",T)),this.zooming&&this.emit("zoom",new ti("zoom",T)),this.rotating&&this.emit("rotate",new ti("rotate",T)),this.pitching&&this.emit("rotate",new ti("pitch",T))}},{key:"prepareEase",value:function(T){var j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.moving=!0,!j&&!I.moving&&this.emit("movestart",new ti("movestart",T)),this.zooming&&!I.zooming&&this.emit("zoomstart",new ti("zoomstart",T)),this.rotating&&!I.rotating&&this.emit("rotatestart",new ti("rotatestart",T)),this.pitching&&!I.pitching&&this.emit("pitchstart",new ti("pitchstart",T))}},{key:"afterEase",value:function(T,j){if(this.easeId&&j&&this.easeId===j)return;delete this.easeId;var I=this.zooming,k=this.rotating,X=this.pitching;this.moving=!1,this.zooming=!1,this.rotating=!1,this.pitching=!1,this.padding=!1,I&&this.emit("zoomend",new ti("zoomend",T)),k&&this.emit("rotateend",new ti("rotateend",T)),X&&this.emit("pitchend",new ti("pitchend",T)),this.emit("moveend",new ti("moveend",T))}},{key:"ease",value:function(T,j,I){I.animate===!1||I.duration===0?(T(1),j()):(this.easeStart=Fs(),this.easeOptions=I,this.onEaseFrame=T,this.onEaseEnd=j,this.easeFrameId=this.requestRenderFrame(this.renderFrameCallback))}},{key:"cameraForBoxAndBearing",value:function(T,j,I,k){var X={top:0,bottom:0,right:0,left:0};if(k=eo()({padding:X,offset:[0,0],maxZoom:this.transform.maxZoom},k),typeof k.padding=="number"){var ae=k.padding;k.padding={top:ae,bottom:ae,right:ae,left:ae}}k.padding=eo()(X,k.padding);var $e=this.transform,Ie=$e.padding,Oe=$e.project(ui.convert(T)),ft=$e.project(ui.convert(j)),Ne=Oe.rotate(-I*Math.PI/180),lt=ft.rotate(-I*Math.PI/180),Ue=new kn(Math.max(Ne.x,lt.x),Math.max(Ne.y,lt.y)),It=new kn(Math.min(Ne.x,lt.x),Math.min(Ne.y,lt.y)),$t=Ue.sub(It),ar=($e.width-(Ie.left+Ie.right+k.padding.left+k.padding.right))/$t.x,tr=($e.height-(Ie.top+Ie.bottom+k.padding.top+k.padding.bottom))/$t.y;if(tr<0||ar<0)return;var pr=Math.min($e.scaleZoom($e.scale*Math.min(ar,tr)),k.maxZoom),wr=kn.convert(k.offset),$r=(k.padding.left-k.padding.right)/2,Cn=(k.padding.top-k.padding.bottom)/2,un=new kn(wr.x+$r,wr.y+Cn),_n=un.mult($e.scale/$e.zoomScale(pr)),Kn=$e.unproject(Oe.add(ft).div(2).sub(_n));return{center:Kn,zoom:pr,bearing:I}}},{key:"fitInternal",value:function(T,j,I){return T?(j=eo()(T,j),delete j.padding,j.linear?this.easeTo(j,I):this.flyTo(j,I)):this}}]),c}(vf.EventEmitter);function ll(O,d){var c;if(typeof Symbol=="undefined"||O[Symbol.iterator]==null){if(Array.isArray(O)||(c=qr(O))||d&&O&&typeof O.length=="number"){c&&(O=c);var p=0,T=function(){};return{s:T,n:function(){return p>=O.length?{done:!0}:{done:!1,value:O[p++]}},e:function(ae){throw ae},f:T}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var j=!0,I=!1,k;return{s:function(){c=O[Symbol.iterator]()},n:function(){var ae=c.next();return j=ae.done,ae},e:function(ae){I=!0,k=ae},f:function(){try{!j&&c.return!=null&&c.return()}finally{if(I)throw k}}}}function qr(O,d){if(!O)return;if(typeof O=="string")return Ec(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Ec(O,d)}function Ec(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}var os={},ro=os;os.create=function(O,d,c){var p=window.document.createElement(O);return d!==void 0&&(p.className=d),c&&c.appendChild(p),p},os.createNS=function(O,d){var c=window.document.createElementNS(O,d);return c};var Jo=window.document&&window.document.documentElement.style;function Os(O){if(!Jo)return O[0];var d=ll(O),c;try{for(d.s();!(c=d.n()).done;){var p=c.value;if(p in Jo)return p}}catch(T){d.e(T)}finally{d.f()}return O[0]}var Fl=Os(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),zc;os.disableDrag=function(){Jo&&Fl&&(zc=Jo[Fl],Jo[Fl]="none")},os.enableDrag=function(){Jo&&Fl&&(Jo[Fl]=zc)};var Bs=Os(["transform","WebkitTransform"]);os.setTransform=function(O,d){O.style[Bs]=d};var Cu=!1;try{var zl=Object.defineProperty({},"passive",{get:function(){Cu=!0}});window.addEventListener("test",zl,zl),window.removeEventListener("test",zl,zl)}catch(O){Cu=!1}os.addEventListener=function(O,d,c){var p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in p&&Cu?O.addEventListener(d,c,p):O.addEventListener(d,c,p.capture)},os.removeEventListener=function(O,d,c){var p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in p&&Cu?O.removeEventListener(d,c,p):O.removeEventListener(d,c,p.capture)};var Ul=function O(d){d.preventDefault(),d.stopPropagation(),window.removeEventListener("click",O,!0)};os.suppressClick=function(){window.addEventListener("click",Ul,!0),window.setTimeout(function(){window.removeEventListener("click",Ul,!0)},0)},os.mousePos=function(O,d){var c=O.getBoundingClientRect();return new kn(d.clientX-c.left-O.clientLeft,d.clientY-c.top-O.clientTop)},os.touchPos=function(O,d){var c=O.getBoundingClientRect(),p=[],T=ll(d),j;try{for(T.s();!(j=T.n()).done;){var I=j.value;p.push(new kn(I.clientX-c.left-O.clientLeft,I.clientY-c.top-O.clientTop))}}catch(k){T.e(k)}finally{T.f()}return p},os.mouseButton=function(O){return typeof window.InstallTrigger!="undefined"&&O.button===2&&O.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:O.button},os.remove=function(O){O.parentNode&&O.parentNode.removeChild(O)};function af(O){var d=Uc();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function Uc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}var Lo=function(O){Fe()(c,O);var d=af(c);function c(p,T,j){var I,k=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};Ye()(this,c);var X=ro.mousePos(T.getCanvasContainer(),j),ae=T.unproject(X);return I=d.call(this,p,eo()({point:X,lngLat:ae,originalEvent:j},k)),I.type=void 0,I.target=void 0,I.originalEvent=void 0,I.point=void 0,I.lngLat=void 0,I.defaultPrevented=void 0,I.defaultPrevented=!1,I.target=T,I}return bt()(c,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),c}(ti);function ss(O){var d=Pa();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function Pa(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}var eu=function(O){Fe()(c,O);var d=ss(c);function c(p,T,j){var I;Ye()(this,c);var k=p==="touchend"?j.changedTouches:j.touches,X=ro.touchPos(T.getCanvasContainer(),k),ae=X.map(function(Oe){return T.unproject(Oe)}),$e=X.reduce(function(Oe,ft,Ne,lt){return Oe.add(ft.div(lt.length))},new kn(0,0)),Ie=T.unproject($e);return I=d.call(this,p,{points:X,point:$e,lngLats:ae,lngLat:Ie,originalEvent:j}),I.type=void 0,I.target=void 0,I.originalEvent=void 0,I.lngLat=void 0,I.point=void 0,I.points=void 0,I.lngLats=void 0,I.defaultPrevented=void 0,I.defaultPrevented=!1,I}return bt()(c,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),c}(ti);function Ro(O){var d=To();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function To(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}var Al=function(O){Fe()(c,O);var d=Ro(c);function c(p,T,j){var I;return Ye()(this,c),I=d.call(this,p,{originalEvent:j}),I.type=void 0,I.originalEvent=void 0,I.defaultPrevented=void 0,I.target=void 0,I.defaultPrevented=!1,I}return bt()(c,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),c}(ti),cl=function(){function O(d){Ye()(this,O),this.map=void 0,this.delayContextMenu=void 0,this.contextMenuEvent=void 0,this.map=d}return bt()(O,[{key:"reset",value:function(){this.delayContextMenu=!1,delete this.contextMenuEvent}},{key:"mousemove",value:function(c){this.map.emit(c.type,new Lo(c.type,this.map,c))}},{key:"mousedown",value:function(){this.delayContextMenu=!0}},{key:"mouseup",value:function(){this.delayContextMenu=!1,this.contextMenuEvent&&(this.map.emit("contextmenu",new Lo("contextmenu",this.map,this.contextMenuEvent)),delete this.contextMenuEvent)}},{key:"contextmenu",value:function(c){this.delayContextMenu?this.contextMenuEvent=c:this.map.emit(c.type,new Lo(c.type,this.map,c)),this.map.listeners("contextmenu")&&c.preventDefault()}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!0}},{key:"disable",value:function(){return!1}}]),O}(),pu=function(){function O(d,c){Ye()(this,O),this.map=void 0,this.el=void 0,this.container=void 0,this.enabled=void 0,this.active=void 0,this.startPos=void 0,this.lastPos=void 0,this.box=void 0,this.clickTolerance=void 0,this.map=d,this.el=d.getCanvasContainer(),this.container=d.getContainer(),this.clickTolerance=c.clickTolerance||1}return bt()(O,[{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active}},{key:"enable",value:function(){if(this.isEnabled())return;this.enabled=!0}},{key:"disable",value:function(){if(!this.isEnabled())return;this.enabled=!1}},{key:"mousedown",value:function(c,p){if(!this.isEnabled())return;if(!(c.shiftKey&&c.button===0))return;ro.disableDrag(),this.startPos=this.lastPos=p,this.active=!0}},{key:"mousemoveWindow",value:function(c,p){if(!this.active)return;var T=p;if(this.lastPos.equals(T)||!this.box&&T.dist(this.startPos)<this.clickTolerance)return;var j=this.startPos;this.lastPos=T,this.box||(this.box=ro.create("div","l7-boxzoom",this.container),this.container.classList.add("l7-crosshair"),this.fireEvent("boxzoomstart",c));var I=Math.min(j.x,T.x),k=Math.max(j.x,T.x),X=Math.min(j.y,T.y),ae=Math.max(j.y,T.y);ro.setTransform(this.box,"translate(".concat(I,"px,").concat(X,"px)")),this.box&&(this.box.style.width="".concat(k-I,"px"),this.box.style.height="".concat(ae-X,"px"))}},{key:"mouseupWindow",value:function(c,p){var T=this;if(!this.active)return;if(c.button!==0)return;var j=this.startPos,I=p;if(this.reset(),ro.suppressClick(),j.x===I.x&&j.y===I.y)this.fireEvent("boxzoomcancel",c);else return this.map.emit("boxzoomend",new ti("boxzoomend",{originalEvent:c})),{cameraAnimation:function(X){return X.fitScreenCoordinates(j,I,T.map.getBearing(),{linear:!0})}}}},{key:"keydown",value:function(c){if(!this.active)return;c.keyCode===27&&(this.reset(),this.fireEvent("boxzoomcancel",c))}},{key:"reset",value:function(){this.active=!1,this.container.classList.remove("l7-crosshair"),this.box&&(ro.remove(this.box),this.box=null),ro.enableDrag(),delete this.startPos,delete this.lastPos}},{key:"fireEvent",value:function(c,p){return this.map.emit(c,new ti(c,{originalEvent:p}))}}]),O}(),_s=pu,Tc=function(){function O(){Ye()(this,O),this.enabled=void 0,this.active=void 0,this.reset()}return bt()(O,[{key:"reset",value:function(){this.active=!1}},{key:"dblclick",value:function(c,p){return c.preventDefault(),{cameraAnimation:function(j){j.easeTo({duration:300,zoom:j.getZoom()+(c.shiftKey?-1:1),around:j.unproject(p)},{originalEvent:c})}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),O}();function Jn(O){var d=jn();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function jn(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}var _c=function(O){Fe()(c,O);var d=Jn(c);function c(){var p;Ye()(this,c);for(var T=arguments.length,j=new Array(T),I=0;I<T;I++)j[I]=arguments[I];return p=d.call.apply(d,[this].concat(j)),p.type="renderFrame",p.timeStamp=void 0,p}return c}(ti);function us(O,d){var c;if(typeof Symbol=="undefined"||O[Symbol.iterator]==null){if(Array.isArray(O)||(c=Io(O))||d&&O&&typeof O.length=="number"){c&&(O=c);var p=0,T=function(){};return{s:T,n:function(){return p>=O.length?{done:!0}:{done:!1,value:O[p++]}},e:function(ae){throw ae},f:T}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var j=!0,I=!1,k;return{s:function(){c=O[Symbol.iterator]()},n:function(){var ae=c.next();return j=ae.done,ae},e:function(ae){I=!0,k=ae},f:function(){try{!j&&c.return!=null&&c.return()}finally{if(I)throw k}}}}function Io(O,d){if(!O)return;if(typeof O=="string")return vo(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return vo(O,d)}function vo(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}var Ss={linearity:.3,easing:_l(0,0,.3,1)},wu=eo()({deceleration:2500,maxSpeed:1400},Ss),rc=eo()({deceleration:20,maxSpeed:1400},Ss),Ka=eo()({deceleration:1e3,maxSpeed:360},Ss),no=eo()({deceleration:1e3,maxSpeed:90},Ss),fl=function(){function O(d){Ye()(this,O),this.map=void 0,this.inertiaBuffer=void 0,this.map=d,this.clear()}return bt()(O,[{key:"clear",value:function(){this.inertiaBuffer=[]}},{key:"record",value:function(c){this.drainInertiaBuffer(),this.inertiaBuffer.push({time:Fs(),settings:c})}},{key:"drainInertiaBuffer",value:function(){for(var c=this.inertiaBuffer,p=Fs(),T=160;c.length>0&&p-c[0].time>T;)c.shift()}},{key:"onMoveEnd",value:function(c){if(this.drainInertiaBuffer(),this.inertiaBuffer.length<2)return;var p={zoom:0,bearing:0,pitch:0,pan:new kn(0,0),pinchAround:void 0,around:void 0},T=us(this.inertiaBuffer),j;try{for(T.s();!(j=T.n()).done;){var I=j.value.settings;p.zoom+=I.zoomDelta||0,p.bearing+=I.bearingDelta||0,p.pitch+=I.pitchDelta||0,I.panDelta&&p.pan._add(I.panDelta),I.around&&(p.around=I.around),I.pinchAround&&(p.pinchAround=I.pinchAround)}}catch(lt){T.e(lt)}finally{T.f()}var k=this.inertiaBuffer[this.inertiaBuffer.length-1],X=k.time-this.inertiaBuffer[0].time,ae={};if(p.pan.mag()){var $e=hl(p.pan.mag(),X,eo()({},wu,c||{}));ae.offset=p.pan.mult($e.amount/p.pan.mag()),ae.center=this.map.transform.center,mu(ae,$e)}if(p.zoom){var Ie=hl(p.zoom,X,rc);ae.zoom=this.map.transform.zoom+Ie.amount,mu(ae,Ie)}if(p.bearing){var Oe=hl(p.bearing,X,Ka);ae.bearing=this.map.transform.bearing+nl(Oe.amount,-179,179),mu(ae,Oe)}if(p.pitch){var ft=hl(p.pitch,X,no);ae.pitch=this.map.transform.pitch+ft.amount,mu(ae,ft)}if(ae.zoom||ae.bearing){var Ne=p.pinchAround===void 0?p.around:p.pinchAround;ae.around=Ne?this.map.unproject(Ne):this.map.getCenter()}return this.clear(),eo()(ae,{noMoveStart:!0})}}]),O}();function mu(O,d){(!O.duration||O.duration<d.duration)&&(O.duration=d.duration,O.easing=d.easing)}function hl(O,d,c){var p=c.maxSpeed,T=c.linearity,j=c.deceleration,I=nl(O*T/(d/1e3),-p,p),k=Math.abs(I)/(j*T);return{easing:c.easing,duration:k*1e3,amount:I*(k/2)}}var Ou={panStep:100,bearingStep:15,pitchStep:10},Ms=function(){function O(){Ye()(this,O),this.enabled=void 0,this.active=void 0,this.panStep=void 0,this.bearingStep=void 0,this.pitchStep=void 0;var d=Ou;this.panStep=d.panStep,this.bearingStep=d.bearingStep,this.pitchStep=d.pitchStep}return bt()(O,[{key:"reset",value:function(){this.active=!1}},{key:"keydown",value:function(c){var p=this;if(c.altKey||c.ctrlKey||c.metaKey)return;var T=0,j=0,I=0,k=0,X=0;switch(c.keyCode){case 61:case 107:case 171:case 187:T=1;break;case 189:case 109:case 173:T=-1;break;case 37:c.shiftKey?j=-1:(c.preventDefault(),k=-1);break;case 39:c.shiftKey?j=1:(c.preventDefault(),k=1);break;case 38:c.shiftKey?I=1:(c.preventDefault(),X=-1);break;case 40:c.shiftKey?I=-1:(c.preventDefault(),X=1);break;default:return}return{cameraAnimation:function($e){var Ie=$e.getZoom();$e.easeTo({duration:300,easeId:"keyboardHandler",easing:Bc,zoom:T?Math.round(Ie)+T*(c.shiftKey?2:1):Ie,bearing:$e.getBearing()+j*p.bearingStep,pitch:$e.getPitch()+I*p.pitchStep,offset:[-k*p.panStep,-X*p.panStep],center:$e.getCenter()},{originalEvent:c})}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),O}();function Bc(O){return O*(2-O)}var Vs=Ms,xf=function(){function O(d,c){Ye()(this,O),this.mousedownPos=void 0,this.clickTolerance=void 0,this.map=void 0,this.map=d,this.clickTolerance=c.clickTolerance}return bt()(O,[{key:"reset",value:function(){delete this.mousedownPos}},{key:"wheel",value:function(c){return this.firePreventable(new Al(c.type,this.map,c))}},{key:"mousedown",value:function(c,p){return this.mousedownPos=p,this.firePreventable(new Lo(c.type,this.map,c))}},{key:"mouseup",value:function(c){this.map.emit(c.type,new Lo(c.type,this.map,c))}},{key:"click",value:function(c,p){if(this.mousedownPos&&this.mousedownPos.dist(p)>=this.clickTolerance)return;this.map.emit(c.type,new Lo(c.type,this.map,c))}},{key:"dblclick",value:function(c){return this.firePreventable(new Lo(c.type,this.map,c))}},{key:"mouseover",value:function(c){this.map.emit(c.type,new Lo(c.type,this.map,c))}},{key:"mouseout",value:function(c){this.map.emit(c.type,new Lo(c.type,this.map,c))}},{key:"touchstart",value:function(c){return this.firePreventable(new eu(c.type,this.map,c))}},{key:"touchmove",value:function(c){this.map.emit(c.type,new eu(c.type,this.map,c))}},{key:"touchend",value:function(c){this.map.emit(c.type,new eu(c.type,this.map,c))}},{key:"touchcancel",value:function(c){this.map.emit(c.type,new eu(c.type,this.map,c))}},{key:"firePreventable",value:function(c){if(this.map.emit(c.type,c),c.defaultPrevented)return{}}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!1}},{key:"disable",value:function(){return!1}}]),O}(),Bl=o("iWIM"),Vl=o.n(Bl),Sc,ls=0,Hu=2,Vc=(Sc={},gr()(Sc,ls,1),gr()(Sc,Hu,2),Sc);function Cl(O,d){var c=Vc[d];return O.buttons===void 0||(O.buttons&c)!==c}var Zu=function(){function O(d){Ye()(this,O),this.enabled=void 0,this.active=void 0,this.lastPoint=void 0,this.eventButton=void 0,this.moved=void 0,this.clickTolerance=void 0,this.reset(),this.clickTolerance=d.clickTolerance||1}return bt()(O,[{key:"reset",value:function(){this.active=!1,this.moved=!1,delete this.lastPoint,delete this.eventButton}},{key:"mousedown",value:function(c,p){if(this.lastPoint)return;var T=ro.mouseButton(c);if(!this.correctButton(c,T))return;this.lastPoint=p,this.eventButton=T}},{key:"mousemoveWindow",value:function(c,p){var T=this.lastPoint;if(!T)return;if(c.preventDefault(),Cl(c,this.eventButton)){this.reset();return}return!this.moved&&p.dist(T)<this.clickTolerance?void 0:(this.moved=!0,this.lastPoint=p,this.move(T,p))}},{key:"mouseupWindow",value:function(c){if(!this.lastPoint)return;var p=ro.mouseButton(c);if(p!==this.eventButton)return;this.moved&&ro.suppressClick(),this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"correctButton",value:function(c,p){return!1}},{key:"move",value:function(c,p){return}}]),O}();function nc(O){var d=Wu();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function Wu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}var Ps=function(O){Fe()(c,O);var d=nc(c);function c(){return Ye()(this,c),d.apply(this,arguments)}return bt()(c,[{key:"mousedown",value:function(T,j){Vl()(hr()(c.prototype),"mousedown",this).call(this,T,j),this.lastPoint&&(this.active=!0)}},{key:"move",value:function(T,j){return{around:j,panDelta:j.sub(T)}}},{key:"correctButton",value:function(T,j){return j===ls&&!T.ctrlKey}}]),c}(Zu);function of(O){var d=ac();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function ac(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}var ic=function(O){Fe()(c,O);var d=of(c);function c(){return Ye()(this,c),d.apply(this,arguments)}return bt()(c,[{key:"correctButton",value:function(T,j){return j===ls&&T.ctrlKey||j===Hu}},{key:"move",value:function(T,j){var I=-.5,k=(j.y-T.y)*I;if(k)return this.active=!0,{pitchDelta:k}}},{key:"contextmenu",value:function(T){T.preventDefault()}}]),c}(Zu);function oc(O){var d=s();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function s(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}var a=function(O){Fe()(c,O);var d=oc(c);function c(){return Ye()(this,c),d.apply(this,arguments)}return bt()(c,[{key:"contextmenu",value:function(T){T.preventDefault()}},{key:"correctButton",value:function(T,j){return j===ls&&T.ctrlKey||j===Hu}},{key:"move",value:function(T,j){var I=.8,k=(j.x-T.x)*I;if(k)return this.active=!0,{bearingDelta:k}}}]),c}(Zu),n=4.000244140625,l=1/100,g=1/450,w=2,L=function(){function O(d,c){var p=this;Ye()(this,O),this.map=void 0,this.el=void 0,this.enabled=void 0,this.active=void 0,this.zooming=void 0,this.aroundCenter=void 0,this.around=void 0,this.aroundPoint=void 0,this.type=void 0,this.lastValue=void 0,this.timeout=void 0,this.finishTimeout=void 0,this.lastWheelEvent=void 0,this.lastWheelEventTime=void 0,this.startZoom=void 0,this.targetZoom=void 0,this.delta=void 0,this.easing=void 0,this.prevEase=void 0,this.frameId=void 0,this.handler=void 0,this.defaultZoomRate=void 0,this.wheelZoomRate=void 0,this.onScrollFrame=function(){if(!p.frameId)return;if(p.frameId=null,!p.isActive())return;var T=p.map.transform;if(p.delta!==0){var j=p.type==="wheel"&&Math.abs(p.delta)>n?p.wheelZoomRate:p.defaultZoomRate,I=w/(1+Math.exp(-Math.abs(p.delta*j)));p.delta<0&&I!==0&&(I=1/I);var k=typeof p.targetZoom=="number"?T.zoomScale(p.targetZoom):T.scale;p.targetZoom=Math.min(T.maxZoom,Math.max(T.minZoom,T.scaleZoom(k*I))),p.type==="wheel"&&(p.startZoom=T.zoom,p.easing=p.smoothOutEasing(200)),p.delta=0}var X=typeof p.targetZoom=="number"?p.targetZoom:T.zoom,ae=p.startZoom,$e=p.easing,Ie=!1,Oe;if(p.type==="wheel"&&ae&&$e){var ft=Math.min((Fs()-p.lastWheelEventTime)/200,1),Ne=$e(ft);Oe=qs(ae,X,Ne),ft<1?p.frameId||(p.frameId=!0):Ie=!0}else Oe=X,Ie=!0;return p.active=!0,Ie&&(p.active=!1,p.finishTimeout=setTimeout(function(){p.zooming=!1,p.handler.triggerRenderFrame(),delete p.targetZoom,delete p.finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Ie,zoomDelta:Oe-T.zoom,around:p.aroundPoint,originalEvent:p.lastWheelEvent}},this.map=d,this.el=d.getCanvasContainer(),this.handler=c,this.delta=0,this.defaultZoomRate=l,this.wheelZoomRate=g}return bt()(O,[{key:"setZoomRate",value:function(c){this.defaultZoomRate=c}},{key:"setWheelZoomRate",value:function(c){this.wheelZoomRate=c}},{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active||this.finishTimeout!==void 0}},{key:"isZooming",value:function(){return!!this.zooming}},{key:"enable",value:function(c){if(this.isEnabled())return;this.enabled=!0,this.aroundCenter=c&&c.around==="center"}},{key:"disable",value:function(){if(!this.isEnabled())return;this.enabled=!1}},{key:"wheel",value:function(c){if(!this.isEnabled())return;var p=c.deltaMode===window.WheelEvent.DOM_DELTA_LINE?c.deltaY*40:c.deltaY,T=Fs(),j=T-(this.lastWheelEventTime||0);this.lastWheelEventTime=T,p!==0&&p%n===0?this.type="wheel":p!==0&&Math.abs(p)<4?this.type="trackpad":j>400?(this.type=null,this.lastValue=p,this.timeout=setTimeout(this.onTimeout,40,c)):this.type||(this.type=Math.abs(j*p)<200?"trackpad":"wheel",this.timeout&&(clearTimeout(this.timeout),this.timeout=null,p+=this.lastValue)),c.shiftKey&&p&&(p=p/4),this.type&&(this.lastWheelEvent=c,this.delta-=p,this.active||this.start(c)),c.preventDefault()}},{key:"renderFrame",value:function(){return this.onScrollFrame()}},{key:"reset",value:function(){this.active=!1}},{key:"onTimeout",value:function(c){this.type="wheel",this.delta-=this.lastValue,this.active||this.start(c)}},{key:"start",value:function(c){if(!this.delta)return;this.frameId&&(this.frameId=null),this.active=!0,this.isZooming()||(this.zooming=!0),this.finishTimeout&&(clearTimeout(this.finishTimeout),delete this.finishTimeout);var p=ro.mousePos(this.el,c);this.around=ui.convert(this.aroundCenter?this.map.getCenter():this.map.unproject(p)),this.aroundPoint=this.map.transform.locationPoint(this.around),this.frameId||(this.frameId=!0,this.handler.triggerRenderFrame())}},{key:"smoothOutEasing",value:function(c){var p=tc;if(this.prevEase){var T=this.prevEase,j=(Fs()-T.start)/T.duration,I=T.easing(j+.01)-T.easing(j),k=.27/Math.sqrt(I*I+1e-4)*.01,X=Math.sqrt(.27*.27-k*k);p=_l(k,X,.25,1)}return this.prevEase={start:Fs(),duration:c,easing:p},p}}]),O}(),z=L,ue=function(){function O(d,c){Ye()(this,O),this.clickZoom=void 0,this.tapZoom=void 0,this.clickZoom=d,this.tapZoom=c}return bt()(O,[{key:"enable",value:function(){this.clickZoom.enable(),this.tapZoom.enable()}},{key:"disable",value:function(){this.clickZoom.disable(),this.tapZoom.disable()}},{key:"isEnabled",value:function(){return this.clickZoom.isEnabled()&&this.tapZoom.isEnabled()}},{key:"isActive",value:function(){return this.clickZoom.isActive()||this.tapZoom.isActive()}}]),O}(),Ee=function(){function O(d,c,p){Ye()(this,O),this.inertiaOptions=void 0,this.el=void 0,this.mousePan=void 0,this.touchPan=void 0,this.el=d,this.mousePan=c,this.touchPan=p}return bt()(O,[{key:"enable",value:function(c){this.inertiaOptions=c||{},this.mousePan.enable(),this.touchPan.enable(),this.el.classList.add("l7-touch-drag-pan")}},{key:"disable",value:function(){this.mousePan.disable(),this.touchPan.disable(),this.el.classList.remove("l7-touch-drag-pan")}},{key:"isEnabled",value:function(){return this.mousePan.isEnabled()&&this.touchPan.isEnabled()}},{key:"isActive",value:function(){return this.mousePan.isActive()||this.touchPan.isActive()}}]),O}(),Ke=function(){function O(d,c,p){Ye()(this,O),this.mouseRotate=void 0,this.mousePitch=void 0,this.pitchWithRotate=void 0,this.pitchWithRotate=d.pitchWithRotate,this.mouseRotate=c,this.mousePitch=p}return bt()(O,[{key:"enable",value:function(){this.mouseRotate.enable(),this.pitchWithRotate&&this.mousePitch.enable()}},{key:"disable",value:function(){this.mouseRotate.disable(),this.mousePitch.disable()}},{key:"isEnabled",value:function(){return this.mouseRotate.isEnabled()&&(!this.pitchWithRotate||this.mousePitch.isEnabled())}},{key:"isActive",value:function(){return this.mouseRotate.isActive()||this.mousePitch.isActive()}}]),O}(),tt=function(){function O(d,c,p,T){Ye()(this,O),this.el=void 0,this.touchZoom=void 0,this.touchRotate=void 0,this.tapDragZoom=void 0,this.rotationDisabled=void 0,this.enabled=void 0,this.el=d,this.touchZoom=c,this.touchRotate=p,this.tapDragZoom=T,this.rotationDisabled=!1,this.enabled=!0}return bt()(O,[{key:"enable",value:function(c){this.touchZoom.enable(c),this.rotationDisabled||this.touchRotate.enable(c),this.tapDragZoom.enable(),this.el.classList.add("l7-touch-zoom-rotate")}},{key:"disable",value:function(){this.touchZoom.disable(),this.touchRotate.disable(),this.tapDragZoom.disable(),this.el.classList.remove("l7-touch-zoom-rotate")}},{key:"isEnabled",value:function(){return this.touchZoom.isEnabled()&&(this.rotationDisabled||this.touchRotate.isEnabled())&&this.tapDragZoom.isEnabled()}},{key:"isActive",value:function(){return this.touchZoom.isActive()||this.touchRotate.isActive()||this.tapDragZoom.isActive()}},{key:"disableRotation",value:function(){this.rotationDisabled=!0,this.touchRotate.disable()}},{key:"enableRotation",value:function(){this.rotationDisabled=!1,this.touchZoom.isEnabled()&&this.touchRotate.enable()}}]),O}();function rt(O,d){for(var c={},p=0;p<O.length;p++)c[O[p].identifier]=d[p];return c}function Ft(O,d){var c;if(typeof Symbol=="undefined"||O[Symbol.iterator]==null){if(Array.isArray(O)||(c=Nt(O))||d&&O&&typeof O.length=="number"){c&&(O=c);var p=0,T=function(){};return{s:T,n:function(){return p>=O.length?{done:!0}:{done:!1,value:O[p++]}},e:function(ae){throw ae},f:T}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var j=!0,I=!1,k;return{s:function(){c=O[Symbol.iterator]()},n:function(){var ae=c.next();return j=ae.done,ae},e:function(ae){I=!0,k=ae},f:function(){try{!j&&c.return!=null&&c.return()}finally{if(I)throw k}}}}function Nt(O,d){if(!O)return;if(typeof O=="string")return Kt(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Kt(O,d)}function Kt(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}function jt(O){var d=new kn(0,0),c=Ft(O),p;try{for(c.s();!(p=c.n()).done;){var T=p.value;d._add(T)}}catch(j){c.e(j)}finally{c.f()}return d.div(O.length)}var Gt=500,nr=500,rr=30,Lr=function(){function O(d){Ye()(this,O),this.numTouches=void 0,this.centroid=void 0,this.startTime=void 0,this.aborted=void 0,this.touches=void 0,this.reset(),this.numTouches=d.numTouches}return bt()(O,[{key:"reset",value:function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}},{key:"touchstart",value:function(c,p,T){if((this.centroid||T.length>this.numTouches)&&(this.aborted=!0),this.aborted)return;this.startTime===void 0&&(this.startTime=c.timeStamp),T.length===this.numTouches&&(this.centroid=jt(p),this.touches=rt(T,p))}},{key:"touchmove",value:function(c,p,T){if(this.aborted||!this.centroid)return;var j=rt(T,p);for(var I in this.touches)if(this.touches[I]){var k=this.touches[I],X=j[I];(!X||X.dist(k)>rr)&&(this.aborted=!0)}}},{key:"touchend",value:function(c,p,T){if((!this.centroid||c.timeStamp-this.startTime>nr)&&(this.aborted=!0),T.length===0){var j=!this.aborted&&this.centroid;if(this.reset(),j)return j}}}]),O}(),vr=function(){function O(d){Ye()(this,O),this.singleTap=void 0,this.numTaps=void 0,this.lastTime=void 0,this.lastTap=void 0,this.count=void 0,this.singleTap=new Lr(d),this.numTaps=d.numTaps,this.reset()}return bt()(O,[{key:"reset",value:function(){this.lastTime=Infinity,delete this.lastTap,this.count=0,this.singleTap.reset()}},{key:"touchstart",value:function(c,p,T){this.singleTap.touchstart(c,p,T)}},{key:"touchmove",value:function(c,p,T){this.singleTap.touchmove(c,p,T)}},{key:"touchend",value:function(c,p,T){var j=this.singleTap.touchend(c,p,T);if(j){var I=c.timeStamp-this.lastTime<Gt,k=!this.lastTap||this.lastTap.dist(j)<rr;if((!I||!k)&&this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=j,this.count===this.numTaps)return this.reset(),j}}}]),O}(),Sr=function(){function O(){Ye()(this,O),this.enabled=void 0,this.active=void 0,this.swipePoint=void 0,this.swipeTouch=void 0,this.tapTime=void 0,this.tap=void 0,this.tap=new vr({numTouches:1,numTaps:1}),this.reset()}return bt()(O,[{key:"reset",value:function(){this.active=!1,delete this.swipePoint,delete this.swipeTouch,delete this.tapTime,this.tap.reset()}},{key:"touchstart",value:function(c,p,T){if(this.swipePoint)return;this.tapTime&&c.timeStamp-this.tapTime>Gt&&this.reset(),this.tapTime?T.length>0&&(this.swipePoint=p[0],this.swipeTouch=T[0].identifier):this.tap.touchstart(c,p,T)}},{key:"touchmove",value:function(c,p,T){if(!this.tapTime)this.tap.touchmove(c,p,T);else if(this.swipePoint){if(T[0].identifier!==this.swipeTouch)return;var j=p[0],I=j.y-this.swipePoint.y;return this.swipePoint=j,c.preventDefault(),this.active=!0,{zoomDelta:I/128}}}},{key:"touchend",value:function(c,p,T){if(this.tapTime)this.swipePoint&&(T.length===0&&this.reset());else{var j=this.tap.touchend(c,p,T);j&&(this.tapTime=c.timeStamp)}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),O}(),Ar=function(){function O(){Ye()(this,O),this.enabled=void 0,this.active=void 0,this.zoomIn=void 0,this.zoomOut=void 0,this.zoomIn=new vr({numTouches:1,numTaps:2}),this.zoomOut=new vr({numTouches:2,numTaps:1}),this.reset()}return bt()(O,[{key:"reset",value:function(){this.active=!1,this.zoomIn.reset(),this.zoomOut.reset()}},{key:"touchstart",value:function(c,p,T){this.zoomIn.touchstart(c,p,T),this.zoomOut.touchstart(c,p,T)}},{key:"touchmove",value:function(c,p,T){this.zoomIn.touchmove(c,p,T),this.zoomOut.touchmove(c,p,T)}},{key:"touchend",value:function(c,p,T){var j=this,I=this.zoomIn.touchend(c,p,T),k=this.zoomOut.touchend(c,p,T);if(I)return this.active=!0,c.preventDefault(),setTimeout(function(){return j.reset()},0),{cameraAnimation:function(ae){return ae.easeTo({duration:300,zoom:ae.getZoom()+1,around:ae.unproject(I)},{originalEvent:c})}};if(k)return this.active=!0,c.preventDefault(),setTimeout(function(){return j.reset()},0),{cameraAnimation:function(ae){return ae.easeTo({duration:300,zoom:ae.getZoom()-1,around:ae.unproject(k)},{originalEvent:c})}}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),O}(),rn=function(){function O(d){Ye()(this,O),this.enabled=void 0,this.active=void 0,this.touches=void 0,this.minTouches=void 0,this.clickTolerance=void 0,this.sum=void 0,this.minTouches=1,this.clickTolerance=d.clickTolerance||1,this.reset()}return bt()(O,[{key:"reset",value:function(){this.active=!1,this.touches={},this.sum=new kn(0,0)}},{key:"touchstart",value:function(c,p,T){return this.calculateTransform(c,p,T)}},{key:"touchmove",value:function(c,p,T){return this.active?(c.preventDefault(),this.calculateTransform(c,p,T)):void 0}},{key:"touchend",value:function(c,p,T){this.calculateTransform(c,p,T),this.active&&T.length<this.minTouches&&this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"calculateTransform",value:function(c,p,T){T.length>0&&(this.active=!0);var j=rt(T,p),I=new kn(0,0),k=new kn(0,0),X=0;for(var ae in j)if(j[ae]){var $e=j[ae],Ie=this.touches[ae];Ie&&(I._add($e),k._add($e.sub(Ie)),X++,j[ae]=$e)}if(this.touches=j,X<this.minTouches||!k.mag())return;var Oe=k.div(X);if(this.sum._add(Oe),this.sum.mag()<this.clickTolerance)return;var ft=I.div(X);return{around:ft,panDelta:Oe}}}]),O}(),Xr=function(){function O(){Ye()(this,O),this.enabled=void 0,this.active=void 0,this.firstTwoTouches=void 0,this.vector=void 0,this.startVector=void 0,this.aroundCenter=void 0,this.reset()}return bt()(O,[{key:"reset",value:function(){this.active=!1,delete this.firstTwoTouches}},{key:"start",value:function(c){return}},{key:"move",value:function(c,p,T){return}},{key:"touchstart",value:function(c,p,T){if(this.firstTwoTouches||T.length<2)return;this.firstTwoTouches=[T[0].identifier,T[1].identifier],this.start([p[0],p[1]])}},{key:"touchmove",value:function(c,p,T){if(!this.firstTwoTouches)return;c.preventDefault();var j=yn()(this.firstTwoTouches,2),I=j[0],k=j[1],X=mn(T,p,I),ae=mn(T,p,k);if(!X||!ae)return;var $e=this.aroundCenter?null:X.add(ae).div(2);return this.move([X,ae],$e,c)}},{key:"touchend",value:function(c,p,T){if(!this.firstTwoTouches)return;var j=yn()(this.firstTwoTouches,2),I=j[0],k=j[1],X=mn(T,p,I),ae=mn(T,p,k);if(X&&ae)return;this.active&&ro.suppressClick(),this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(c){this.enabled=!0,this.aroundCenter=!!c&&c.around==="center"}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),O}();function mn(O,d,c){for(var p=0;p<O.length;p++)if(O[p].identifier===c)return d[p]}function Ln(O){var d=qn();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function qn(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}function sa(O){return Math.abs(O.y)>Math.abs(O.x)}var Sa=100,Za=function(O){Fe()(c,O);var d=Ln(c);function c(){var p;Ye()(this,c);for(var T=arguments.length,j=new Array(T),I=0;I<T;I++)j[I]=arguments[I];return p=d.call.apply(d,[this].concat(j)),p.valid=void 0,p.firstMove=void 0,p.lastPoints=void 0,p}return bt()(c,[{key:"reset",value:function(){Vl()(hr()(c.prototype),"reset",this).call(this),this.valid=void 0,delete this.firstMove,delete this.lastPoints}},{key:"start",value:function(T){this.lastPoints=T,sa(T[0].sub(T[1]))&&(this.valid=!1)}},{key:"move",value:function(T,j,I){var k=T[0].sub(this.lastPoints[0]),X=T[1].sub(this.lastPoints[1]);if(this.valid=this.gestureBeginsVertically(k,X,I.timeStamp),!this.valid)return;this.lastPoints=T,this.active=!0;var ae=(k.y+X.y)/2,$e=-.5;return{pitchDelta:ae*$e}}},{key:"gestureBeginsVertically",value:function(T,j,I){if(this.valid!==void 0)return this.valid;var k=2,X=T.mag()>=k,ae=j.mag()>=k;if(!X&&!ae)return;if(!X||!ae)return this.firstMove===void 0&&(this.firstMove=I),I-this.firstMove<Sa?void 0:!1;var $e=T.y>0===j.y>0;return sa(T)&&sa(j)&&$e}}]),c}(Xr);function Sn(O){var d=ua();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function ua(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}var ba=25;function Zn(O,d){return O.angleWith(d)*180/Math.PI}var Aa=function(O){Fe()(c,O);var d=Sn(c);function c(){var p;Ye()(this,c);for(var T=arguments.length,j=new Array(T),I=0;I<T;I++)j[I]=arguments[I];return p=d.call.apply(d,[this].concat(j)),p.minDiameter=void 0,p}return bt()(c,[{key:"reset",value:function(){Vl()(hr()(c.prototype),"reset",this).call(this),delete this.minDiameter,delete this.startVector,delete this.vector}},{key:"start",value:function(T){this.startVector=this.vector=T[0].sub(T[1]),this.minDiameter=T[0].dist(T[1])}},{key:"move",value:function(T,j){var I=this.vector;return this.vector=T[0].sub(T[1]),!this.active&&this.isBelowThreshold(this.vector)?void 0:(this.active=!0,{bearingDelta:Zn(this.vector,I),pinchAround:j})}},{key:"isBelowThreshold",value:function(T){this.minDiameter=Math.min(this.minDiameter,T.mag());var j=Math.PI*this.minDiameter,I=ba/j*360,k=Zn(T,this.startVector);return Math.abs(k)<I}}]),c}(Xr);function na(O){var d=La();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function La(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}var za=.1;function Gi(O,d){return Math.log(O/d)/Math.LN2}var _i=function(O){Fe()(c,O);var d=na(c);function c(){var p;Ye()(this,c);for(var T=arguments.length,j=new Array(T),I=0;I<T;I++)j[I]=arguments[I];return p=d.call.apply(d,[this].concat(j)),p.distance=void 0,p.startDistance=void 0,p}return bt()(c,[{key:"reset",value:function(){Vl()(hr()(c.prototype),"reset",this).call(this),delete this.distance,delete this.startDistance}},{key:"start",value:function(T){this.startDistance=this.distance=T[0].dist(T[1])}},{key:"move",value:function(T,j){var I=this.distance;return this.distance=T[0].dist(T[1]),!this.active&&Math.abs(Gi(this.distance,this.startDistance))<za?void 0:(this.active=!0,{zoomDelta:Gi(this.distance,I),pinchAround:j})}}]),c}(Xr);function Di(O,d){var c;if(typeof Symbol=="undefined"||O[Symbol.iterator]==null){if(Array.isArray(O)||(c=gi(O))||d&&O&&typeof O.length=="number"){c&&(O=c);var p=0,T=function(){};return{s:T,n:function(){return p>=O.length?{done:!0}:{done:!1,value:O[p++]}},e:function(ae){throw ae},f:T}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var j=!0,I=!1,k;return{s:function(){c=O[Symbol.iterator]()},n:function(){var ae=c.next();return j=ae.done,ae},e:function(ae){I=!0,k=ae},f:function(){try{!j&&c.return!=null&&c.return()}finally{if(I)throw k}}}}function gi(O,d){if(!O)return;if(typeof O=="string")return Ui(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Ui(O,d)}function Ui(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}var Qo=function(d){return d.zoom||d.drag||d.pitch||d.rotate};function qo(O){return O.panDelta&&O.panDelta.mag()||O.zoomDelta||O.bearingDelta||O.pitchDelta}var vu=function(){function O(d,c){var p=this;Ye()(this,O),this.map=void 0,this.el=void 0,this.handlers=void 0,this.eventsInProgress=void 0,this.frameId=void 0,this.inertia=void 0,this.bearingSnap=void 0,this.handlersById=void 0,this.updatingCamera=void 0,this.changes=void 0,this.previousActiveHandlers=void 0,this.bearingChanged=void 0,this.listeners=void 0,this.handleWindowEvent=function(Ie){p.handleEvent(Ie,"".concat(Ie.type,"Window"))},this.handleEvent=function(Ie,Oe){if(Ie.type==="blur"){p.stop();return}p.updatingCamera=!0;var ft=Ie.type==="renderFrame"?void 0:Ie,Ne={needsRenderFrame:!1},lt={},Ue={},It=Ie.touches?p.getMapTouches(Ie.touches):void 0,$t=It?ro.touchPos(p.el,It):ro.mousePos(p.el,Ie),ar=Di(p.handlers),tr;try{for(ar.s();!(tr=ar.n()).done;){var pr=tr.value,wr=pr.handlerName,$r=pr.handler,Cn=pr.allowed;if(!$r.isEnabled())continue;var un=void 0;if(p.blockedByActive(Ue,Cn,wr))$r.reset();else{var _n=Oe||Ie.type;$r&&$r[_n]&&(un=$r[_n](Ie,$t,It),p.mergeIHandlerResult(Ne,lt,un,wr,ft),un&&un.needsRenderFrame&&p.triggerRenderFrame())}(un||$r.isActive())&&(Ue[wr]=$r)}}catch(Pi){ar.e(Pi)}finally{ar.f()}var Kn={};for(var ka in p.previousActiveHandlers)Ue[ka]||(Kn[ka]=ft);p.previousActiveHandlers=Ue,(Object.keys(Kn).length||qo(Ne))&&(p.changes.push([Ne,lt,Kn]),p.triggerRenderFrame()),(Object.keys(Ue).length||qo(Ne))&&p.map.stop(!0),p.updatingCamera=!1;var Ei=Ne.cameraAnimation;Ei&&(p.inertia.clear(),p.fireEvents({},{}),p.changes=[],Ei(p.map))},this.map=d,this.el=this.map.getCanvasContainer(),this.handlers=[],this.handlersById={},this.changes=[],this.inertia=new fl(d),this.bearingSnap=c.bearingSnap,this.previousActiveHandlers={},this.eventsInProgress={},this.addDefaultHandlers(c);var T=this.el;this.listeners=[[T,"touchstart",{passive:!1}],[T,"touchmove",{passive:!1}],[T,"touchend",void 0],[T,"touchcancel",void 0],[T,"mousedown",void 0],[T,"mousemove",void 0],[T,"mouseup",void 0],[window.document,"mousemove",{capture:!0}],[window.document,"mouseup",void 0],[T,"mouseover",void 0],[T,"mouseout",void 0],[T,"dblclick",void 0],[T,"click",void 0],[T,"keydown",{capture:!1}],[T,"keyup",void 0],[T,"wheel",{passive:!1}],[T,"contextmenu",void 0],[window,"blur",void 0]];var j=Di(this.listeners),I;try{for(j.s();!(I=j.n()).done;){var k=yn()(I.value,3),X=k[0],ae=k[1],$e=k[2];ro.addEventListener(X,ae,X===window.document?this.handleWindowEvent:this.handleEvent,$e)}}catch(Ie){j.e(Ie)}finally{j.f()}}return bt()(O,[{key:"destroy",value:function(){var c=Di(this.listeners),p;try{for(c.s();!(p=c.n()).done;){var T=yn()(p.value,3),j=T[0],I=T[1],k=T[2];ro.removeEventListener(j,I,j===window.document?this.handleWindowEvent:this.handleEvent,k)}}catch(X){c.e(X)}finally{c.f()}}},{key:"stop",value:function(){if(this.updatingCamera)return;var c=Di(this.handlers),p;try{for(c.s();!(p=c.n()).done;){var T=p.value.handler;T.reset()}}catch(j){c.e(j)}finally{c.f()}this.inertia.clear(),this.fireEvents({},{}),this.changes=[]}},{key:"isActive",value:function(){var c=Di(this.handlers),p;try{for(c.s();!(p=c.n()).done;){var T=p.value.handler;if(T.isActive())return!0}}catch(j){c.e(j)}finally{c.f()}return!1}},{key:"isZooming",value:function(){return!!this.eventsInProgress.zoom||this.map.scrollZoom.isZooming()}},{key:"isRotating",value:function(){return!!this.eventsInProgress.rotate}},{key:"isMoving",value:function(){return Boolean(Qo(this.eventsInProgress))||this.isZooming()}},{key:"mergeIHandlerResult",value:function(c,p,T,j,I){if(!T)return;eo()(c,T);var k={handlerName:j,originalEvent:T.originalEvent||I};T.zoomDelta!==void 0&&(p.zoom=k),T.panDelta!==void 0&&(p.drag=k),T.pitchDelta!==void 0&&(p.pitch=k),T.bearingDelta!==void 0&&(p.rotate=k)}},{key:"triggerRenderFrame",value:function(){var c=this;this.frameId===void 0&&(this.frameId=this.map.requestRenderFrame(function(p){delete c.frameId,c.handleEvent(new _c("renderFrame",{timeStamp:p})),c.applyChanges()}))}},{key:"addDefaultHandlers",value:function(c){var p=this.map,T=p.getCanvasContainer();this.add("mapEvent",new xf(p,c));var j=p.boxZoom=new _s(p,c);this.add("boxZoom",j);var I=new Ar,k=new Tc;p.doubleClickZoom=new ue(k,I),this.add("tapZoom",I),this.add("clickZoom",k);var X=new Sr;this.add("tapDragZoom",X);var ae=p.touchPitch=new Za;this.add("touchPitch",ae);var $e=new ic(c),Ie=new a(c);p.dragRotate=new Ke(c,$e,Ie),this.add("mouseRotate",$e,["mousePitch"]),this.add("mousePitch",Ie,["mouseRotate"]);var Oe=new Ps(c),ft=new rn(c);p.dragPan=new Ee(T,Oe,ft),this.add("mousePan",Oe),this.add("touchPan",ft,["touchZoom","touchRotate"]);var Ne=new Aa,lt=new _i;p.touchZoomRotate=new tt(T,lt,Ne,X),this.add("touchRotate",Ne,["touchPan","touchZoom"]),this.add("touchZoom",lt,["touchPan","touchRotate"]);var Ue=p.scrollZoom=new z(p,this);this.add("scrollZoom",Ue,["mousePan"]);var It=p.keyboard=new Vs;this.add("keyboard",It),this.add("blockableMapEvent",new cl(p));for(var $t=0,ar=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];$t<ar.length;$t++){var tr=ar[$t];c.interactive&&c[tr]&&p[tr].enable(c[tr])}}},{key:"add",value:function(c,p,T){this.handlers.push({handlerName:c,handler:p,allowed:T}),this.handlersById[c]=p}},{key:"blockedByActive",value:function(c,p,T){for(var j in c){if(j===T)continue;if(!p||p.indexOf(j)<0)return!0}return!1}},{key:"getMapTouches",value:function(c){var p=[],T=Di(c),j;try{for(T.s();!(j=T.n()).done;){var I=j.value,k=I.target;this.el.contains(k)&&p.push(I)}}catch(X){T.e(X)}finally{T.f()}return p}},{key:"applyChanges",value:function(){var c={},p={},T={},j=Di(this.changes),I;try{for(j.s();!(I=j.n()).done;){var k=yn()(I.value,3),X=k[0],ae=k[1],$e=k[2];X.panDelta&&(c.panDelta=(c.panDelta||new kn(0,0))._add(X.panDelta)),X.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+X.zoomDelta),X.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+X.bearingDelta),X.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+X.pitchDelta),X.around!==void 0&&(c.around=X.around),X.pinchAround!==void 0&&(c.pinchAround=X.pinchAround),X.noInertia&&(c.noInertia=X.noInertia),eo()(p,ae),eo()(T,$e)}}catch(Ie){j.e(Ie)}finally{j.f()}this.updateMapTransform(c,p,T),this.changes=[]}},{key:"updateMapTransform",value:function(c,p,T){var j=this.map,I=j.transform;if(!qo(c))return this.fireEvents(p,T);var k=c.panDelta,X=c.zoomDelta,ae=c.bearingDelta,$e=c.pitchDelta,Ie=c.pinchAround,Oe=c.around;Ie!==void 0&&(Oe=Ie),j.stop(!0),Oe=Oe||j.transform.centerPoint;var ft=I.pointLocation(k?Oe.sub(k):Oe);ae&&(I.bearing+=ae),$e&&(I.pitch+=$e),X&&(I.zoom+=X),I.setLocationAtPoint(ft,Oe),this.map.update(),c.noInertia||this.inertia.record(c),this.fireEvents(p,T)}},{key:"fireEvents",value:function(c,p){var T=this,j=Qo(this.eventsInProgress),I=Qo(c),k={};for(var X in c)if(c[X]){var ae=c[X].originalEvent;this.eventsInProgress[X]||(k["".concat(X,"start")]=ae),this.eventsInProgress[X]=c[X]}!j&&I&&this.fireEvent("movestart",I.originalEvent);for(var $e in k)k[$e]&&this.fireEvent($e,k[$e]);c.rotate&&(this.bearingChanged=!0),I&&this.fireEvent("move",I.originalEvent);for(var Ie in c)if(c[Ie]){var Oe=c[Ie].originalEvent;this.fireEvent(Ie,Oe)}var ft={},Ne;for(var lt in this.eventsInProgress)if(this.eventsInProgress[lt]){var Ue=this.eventsInProgress[lt],It=Ue.handlerName,$t=Ue.originalEvent;this.handlersById[It].isActive()||(delete this.eventsInProgress[lt],Ne=p[It]||$t,ft["".concat(lt,"end")]=Ne)}for(var ar in ft)ft[ar]&&this.fireEvent(ar,ft[ar]);var tr=Qo(this.eventsInProgress);if((j||I)&&!tr){this.updatingCamera=!0;var pr=this.inertia.onMoveEnd(this.map.dragPan.inertiaOptions),wr=function(Cn){return Cn!==0&&-T.bearingSnap<Cn&&Cn<T.bearingSnap};pr?(wr(pr.bearing||this.map.getBearing())&&(pr.bearing=0),this.map.easeTo(pr,{originalEvent:Ne})):(this.map.emit("moveend",new ti("moveend",{originalEvent:Ne})),wr(this.map.getBearing())&&this.map.resetNorth()),this.bearingChanged=!1,this.updatingCamera=!1}}},{key:"fireEvent",value:function(c,p){this.map.emit(c,new ti(c,p?{originalEvent:p}:{}))}}]),O}(),Mu=vu,cs=o("DzJC"),Gs=o.n(cs),Pu=function(){function O(d){var c=this;Ye()(this,O),this.map=void 0,this.updateHash=void 0,this.hashName=void 0,this.onHashChange=function(){var p=c.getCurrentHash();if(p.length>=3&&!p.some(function(j){return isNaN(+j)})){var T=c.map.dragRotate.isEnabled()&&c.map.touchZoomRotate.isEnabled()?+(p[3]||0):c.map.getBearing();return c.map.jumpTo({center:[+p[2],+p[1]],zoom:+p[0],bearing:T,pitch:+(p[4]||0)}),!0}return!1},this.getCurrentHash=function(){var p=window.location.hash.replace("#","");if(c.hashName){var T;return p.split("&").map(function(j){return j.split("=")}).forEach(function(j){j[0]===c.hashName&&(T=j)}),(T&&T[1]||"").split("/")}return p.split("/")},this.updateHashUnthrottled=function(){var p=c.getHashString();try{window.history.replaceState(window.history.state,"",p)}catch(T){}},this.hashName=d&&encodeURIComponent(d),this.updateHash=Gs()(this.updateHashUnthrottled,30*1e3/100)}return bt()(O,[{key:"addTo",value:function(c){return this.map=c,window.addEventListener("hashchange",this.onHashChange,!1),this.map.on("moveend",this.updateHash),this}},{key:"remove",value:function(){return window.removeEventListener("hashchange",this.onHashChange,!1),this.map.off("moveend",this.updateHash),delete this.map,this}},{key:"getHashString",value:function(c){var p=this.map.getCenter(),T=Math.round(this.map.getZoom()*100)/100,j=Math.ceil((T*Math.LN2+Math.log(512/360/.5))/Math.LN10),I=Math.pow(10,j),k=Math.round(p.lng*I)/I,X=Math.round(p.lat*I)/I,ae=this.map.getBearing(),$e=this.map.getPitch(),Ie="";if(c?Ie+="/".concat(k,"/").concat(X,"/").concat(T):Ie+="".concat(T,"/").concat(X,"/").concat(k),(ae||$e)&&(Ie+="/".concat(Math.round(ae*10)/10)),$e&&(Ie+="/".concat(Math.round($e))),this.hashName){var Oe=this.hashName,ft=!1,Ne=window.location.hash.slice(1).split("&").map(function(lt){var Ue=lt.split("=")[0];return Ue===Oe?(ft=!0,"".concat(Ue,"=").concat(Ie)):lt}).filter(function(lt){return lt});return ft||Ne.push("".concat(Oe,"=").concat(Ie)),"#".concat(Ne.join("&"))}return"#".concat(Ie)}}]),O}(),sc=Pu,tu=null,Xu=[],uc=30,ru=1e3/uc,Lu=window.performance,fs={create:"create",load:"load",fullLoad:"fullLoad"},ao={mark:function(d){Lu.mark(d)},frame:function(d){var c=d;if(tu!=null){var p=c-tu;Xu.push(p)}tu=c},clearMetrics:function(){tu=null,Xu=[],Lu.clearMeasures("loadTime"),Lu.clearMeasures("fullLoadTime");for(var d in fs)Lu.clearMarks(fs[d])},getPerformanceMetrics:function(){var d=Lu.measure("loadTime",fs.create,fs.load).duration,c=Lu.measure("fullLoadTime",fs.create,fs.fullLoad).duration,p=Xu.length,T=Xu.reduce(function(X,ae){return X+ae},0)/p/1e3,j=1/T,I=Xu.filter(function(X){return X>ru}).reduce(function(X,ae){return X+(ae-ru)/ru},0),k=I/(p+I)*100;return{loadTime:d,fullLoadTime:c,fps:j,percentDroppedFrames:k}}};function Yu(O,d){var c;if(typeof Symbol=="undefined"||O[Symbol.iterator]==null){if(Array.isArray(O)||(c=Gl(O))||d&&O&&typeof O.length=="number"){c&&(O=c);var p=0,T=function(){};return{s:T,n:function(){return p>=O.length?{done:!0}:{done:!1,value:O[p++]}},e:function(ae){throw ae},f:T}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var j=!0,I=!1,k;return{s:function(){c=O[Symbol.iterator]()},n:function(){var ae=c.next();return j=ae.done,ae},e:function(ae){I=!0,k=ae},f:function(){try{!j&&c.return!=null&&c.return()}finally{if(I)throw k}}}}function Gl(O,d){if(!O)return;if(typeof O=="string")return hs(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return hs(O,d)}function hs(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}var Do=function(){function O(){Ye()(this,O),this.queue=void 0,this.id=void 0,this.cleared=void 0,this.currentlyRunning=void 0,this.queue=[],this.id=0,this.cleared=!1,this.currentlyRunning=!1}return bt()(O,[{key:"add",value:function(c){var p=++this.id,T=this.queue;return T.push({callback:c,id:p,cancelled:!1}),p}},{key:"remove",value:function(c){var p=this.currentlyRunning,T=p?this.queue.concat(p):this.queue,j=Yu(T),I;try{for(j.s();!(I=j.n()).done;){var k=I.value;if(k.id===c){k.cancelled=!0;return}}}catch(X){j.e(X)}finally{j.f()}}},{key:"run",value:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,p=this.currentlyRunning=this.queue;this.queue=[];var T=Yu(p),j;try{for(T.s();!(j=T.n()).done;){var I=j.value;if(I.cancelled)continue;if(I.callback(c),this.cleared)break}}catch(k){T.e(k)}finally{T.f()}this.cleared=!1,this.currentlyRunning=!1}},{key:"clear",value:function(){this.currentlyRunning&&(this.cleared=!0),this.queue=[]}}]),O}(),No=Do;function Ho(O){var d=_o();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function _o(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}o("BGjm")(`/* @antv/l7-map */
.l7-map {
  font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  overflow: hidden;
  position: relative;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

.l7-canvas {
  position: absolute;
  left: 0;
  top: 0;
}

.l7-map:-webkit-full-screen {
  width: 100%;
  height: 100%;
}

.l7-canary {
  background-color: salmon;
}

.l7-canvas-container.l7-interactive,
.l7-ctrl-group button.l7-ctrl-compass {
  cursor: -webkit-grab;
  cursor: grab;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.l7-canvas-container.l7-interactive.l7-track-pointer {
  cursor: pointer;
}

.l7-canvas-container.l7-interactive:active,
.l7-ctrl-group button.l7-ctrl-compass:active {
  cursor: -webkit-grabbing;
  cursor: grabbing;
}

.l7-canvas-container.l7-touch-zoom-rotate,
.l7-canvas-container.l7-touch-zoom-rotate .l7-canvas {
  -ms-touch-action: pan-x pan-y;
      touch-action: pan-x pan-y;
}

.l7-canvas-container.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: pinch-zoom;
      touch-action: pinch-zoom;
}

.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: none;
      touch-action: none;
}

.l7-ctrl-top-left,
.l7-ctrl-top-right,
.l7-ctrl-bottom-left,
.l7-ctrl-bottom-right { position: absolute; pointer-events: none; z-index: 2; }
.l7-ctrl-top-left     { top: 0; left: 0; }
.l7-ctrl-top-right    { top: 0; right: 0; }
.l7-ctrl-bottom-left  { bottom: 0; left: 0; }
.l7-ctrl-bottom-right { right: 0; bottom: 0; }

.l7-ctrl {
  clear: both;
  pointer-events: auto;

  /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
  -webkit-transform: translate(0, 0);
          transform: translate(0, 0);
}
.l7-ctrl-top-left .l7-ctrl     { margin: 10px 0 0 10px; float: left; }
.l7-ctrl-top-right .l7-ctrl    { margin: 10px 10px 0 0; float: right; }
.l7-ctrl-bottom-left .l7-ctrl  { margin: 0 0 10px 10px; float: left; }
.l7-ctrl-bottom-right .l7-ctrl { margin: 0 10px 10px 0; float: right; }


.l7-crosshair,
.l7-crosshair .l7-interactive,
.l7-crosshair .l7-interactive:active {
    cursor: crosshair;
}

.l7-boxzoom {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    background: #fff;
    border: 2px dotted #202020;
    opacity: 0.5;
    z-index: 10;
}
`);var uo=-2,Ls=22,nu=0,Hl=60,Gc={hash:!1,zoom:-1,center:[112,32],pitch:0,bearing:0,interactive:!0,minZoom:uo,maxZoom:Ls,minPitch:nu,maxPitch:Hl,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,trackResize:!0,renderWorldCopies:!0},dl=function(O){Fe()(c,O);var d=Ho(c);function c(p){var T;Ye()(this,c),T=d.call(this,eo()({},Gc,p)),T.doubleClickZoom=void 0,T.dragRotate=void 0,T.dragPan=void 0,T.touchZoomRotate=void 0,T.scrollZoom=void 0,T.keyboard=void 0,T.touchPitch=void 0,T.boxZoom=void 0,T.handlers=void 0,T.container=void 0,T.canvas=void 0,T.canvasContainer=void 0,T.renderTaskQueue=new No,T.frame=void 0,T.trackResize=!0,T.hash=void 0,T.onWindowOnline=function(){T.update()},T.onWindowResize=function(I){T.trackResize&&T.resize({originalEvent:I}).update()},T.initContainer(),T.resize(),T.handlers=new Mu(El()(T),T.options),typeof window!="undefined"&&(window.addEventListener("online",T.onWindowOnline,!1),window.addEventListener("resize",T.onWindowResize,!1),window.addEventListener("orientationchange",T.onWindowResize,!1));var j=typeof p.hash=="string"&&p.hash||void 0;return p.hash&&(T.hash=new sc(j).addTo(El()(T))),(!T.hash||!T.hash.onHashChange())&&(T.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch}),p.bounds&&(T.resize(),T.fitBounds(p.bounds,eo()({},p.fitBoundsOptions,{duration:0})))),T}return bt()(c,[{key:"resize",value:function(T){var j=this.containerDimensions(),I=j[0],k=j[1];this.transform.resize(I,k);var X=!this.moving;return X&&(this.stop(),this.emit("movestart",new Event("movestart",T)),this.emit("move",new Event("move",T))),this.emit("resize",new Event("resize",T)),X&&this.emit("moveend",new Event("moveend",T)),this}},{key:"getContainer",value:function(){return this.container}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getCanvasContainer",value:function(){return this.canvasContainer}},{key:"project",value:function(T){return this.transform.locationPoint(ui.convert(T))}},{key:"unproject",value:function(T){return this.transform.pointLocation(kn.convert(T))}},{key:"getBounds",value:function(){return this.transform.getBounds()}},{key:"getMaxBounds",value:function(){return this.transform.getMaxBounds()}},{key:"setMaxBounds",value:function(T){this.transform.setMaxBounds(il.convert(T))}},{key:"setStyle",value:function(T){return}},{key:"setMinZoom",value:function(T){if(T=T==null?uo:T,T>=uo&&T<=this.transform.maxZoom)return this.transform.minZoom=T,this.getZoom()<T&&this.setZoom(T),this;throw new Error("minZoom must be between ".concat(uo," and the current maxZoom, inclusive"))}},{key:"getMinZoom",value:function(){return this.transform.minZoom}},{key:"setMaxZoom",value:function(T){if(T=T==null?Ls:T,T>=this.transform.minZoom)return this.transform.maxZoom=T,this.getZoom()>T&&this.setZoom(T),this;throw new Error("maxZoom must be greater than the current minZoom")}},{key:"getMaxZoom",value:function(){return this.transform.maxZoom}},{key:"setMinPitch",value:function(T){if(T=T==null?nu:T,T<nu)throw new Error("minPitch must be greater than or equal to ".concat(nu));if(T>=nu&&T<=this.transform.maxPitch)return this.transform.minPitch=T,this.getPitch()<T&&this.setPitch(T),this;throw new Error("minPitch must be between ".concat(nu," and the current maxPitch, inclusive"))}},{key:"getMinPitch",value:function(){return this.transform.minPitch}},{key:"setMaxPitch",value:function(T){if(T=T==null?Hl:T,T>Hl)throw new Error("maxPitch must be less than or equal to ".concat(Hl));if(T>=this.transform.minPitch)return this.transform.maxPitch=T,this.getPitch()>T&&this.setPitch(T),this;throw new Error("maxPitch must be greater than the current minPitch")}},{key:"getMaxPitch",value:function(){return this.transform.maxPitch}},{key:"getRenderWorldCopies",value:function(){return this.transform.renderWorldCopies}},{key:"setRenderWorldCopies",value:function(T){this.transform.renderWorldCopies=!!T}},{key:"remove",value:function(){this.frame&&(this.frame.cancel(),this.frame=null),this.renderTaskQueue.clear()}},{key:"requestRenderFrame",value:function(T){return this.update(),this.renderTaskQueue.add(T)}},{key:"cancelRenderFrame",value:function(T){return this.renderTaskQueue.remove(T)}},{key:"triggerRepaint",value:function(){var T=this;this.frame||(this.frame=wi(function(j){ao.frame(j),T.frame=null,T.update(j)}))}},{key:"update",value:function(T){var j=this;this.frame||(this.frame=wi(function(I){ao.frame(I),j.frame=null,j.renderTaskQueue.run(T)}))}},{key:"initContainer",value:function(){if(typeof this.options.container=="string"){if(this.container=window.document.getElementById(this.options.container),!this.container)throw new Error("Container '".concat(this.options.container,"' not found."))}else if(this.options.container instanceof HTMLElement)this.container=this.options.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");var T=this.container;T.classList.add("l7-map");var j=this.canvasContainer=ln.a.create("div","l7-canvas-container",T);this.options.interactive&&j.classList.add("l7-interactive")}},{key:"containerDimensions",value:function(){var T=0,j=0;return this.container&&(T=this.container.clientWidth||400,j=this.container.clientHeight||300),[T,j]}},{key:"resizeCanvas",value:function(T,j){var I=window.devicePixelRatio||1;this.canvas.width=I*T,this.canvas.height=I*j,this.canvas.style.width="".concat(T,"px"),this.canvas.style.height="".concat(j,"px")}}]),c}(Us),lc=function(){function O(){Ye()(this,O),this.viewport=void 0}return bt()(O,[{key:"syncWithMapCamera",value:function(c){var p=c.center,T=c.zoom,j=c.pitch,I=c.bearing,k=c.viewportHeight,X=c.viewportWidth;this.viewport=new _u({width:X,height:k,longitude:p&&p[0],latitude:p&&p[1],zoom:T,pitch:j,bearing:I})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(c,p){return this.viewport.projectFlat(c,p)}}]),O}(),pl={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},Rs,go,Ac,ds,sf,Cf,wf,Cc,Ku,Ef,uf,Of,Ru,cc;function Df(O,d){var c=Object.keys(O);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(O);d&&(p=p.filter(function(T){return Object.getOwnPropertyDescriptor(O,T).enumerable})),c.push.apply(c,p)}return c}function Hc(O){for(var d=1;d<arguments.length;d++){var c=arguments[d]!=null?arguments[d]:{};d%2?Df(Object(c),!0).forEach(function(p){gr()(O,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(c)):Df(Object(c)).forEach(function(p){Object.defineProperty(O,p,Object.getOwnPropertyDescriptor(c,p))})}return O}var wc={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},Qf=12,qf=(Rs=Object(tn.injectable)(),go=Object(tn.inject)(On.TYPES.MapConfig),Ac=Object(tn.inject)(On.TYPES.IGlobalConfigService),ds=Object(tn.inject)(On.TYPES.ILogService),sf=Object(tn.inject)(On.TYPES.ICoordinateSystemService),Cf=Object(tn.inject)(On.TYPES.IEventEmitter),Rs(wf=(Cc=(cc=function(){function O(){var d=this;Ye()(this,O),this.map=void 0,zn()(this,"config",Ku,this),zn()(this,"configService",Ef,this),zn()(this,"logger",uf,this),zn()(this,"coordinateSystemService",Of,this),zn()(this,"eventEmitter",Ru,this),this.viewport=void 0,this.markerContainer=void 0,this.cameraChangedCallback=void 0,this.$mapContainer=void 0,this.handleCameraChanged=function(){var c=d.map.getCenter(),p=c.lat,T=c.lng;d.viewport.syncWithMapCamera({bearing:d.map.getBearing(),center:[T,p],viewportHeight:d.map.transform.height,pitch:d.map.getPitch(),viewportWidth:d.map.transform.width,zoom:d.map.getZoom(),cameraHeight:0}),d.viewport.getZoom()>Qf?d.coordinateSystemService.setCoordinateSystem(On.CoordinateSystem.LNGLAT_OFFSET):d.coordinateSystemService.setCoordinateSystem(On.CoordinateSystem.LNGLAT),d.cameraChangedCallback(d.viewport)}}return bt()(O,[{key:"addMarkerContainer",value:function(){var c=this.map.getCanvasContainer();this.markerContainer=ln.a.create("div","l7-marker-container",c),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(c,p){On.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.on(c,p):this.map.on(wc[c]||c,p)}},{key:"off",value:function(c,p){this.map.off(wc[c]||c,p)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var c=this.map.transform;return[c.width,c.height]}},{key:"getType",value:function(){return"default"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(c){return this.map.setZoom(c)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(c){this.map.setCenter(c)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(c){this.map.setBearing(c)}},{key:"zoomIn",value:function(c,p){this.map.zoomIn(c,p)}},{key:"zoomOut",value:function(c,p){this.map.zoomOut(c,p)}},{key:"setPitch",value:function(c){return this.map.setPitch(c)}},{key:"panTo",value:function(c){this.map.panTo(c)}},{key:"panBy",value:function(c){this.panTo(c)}},{key:"fitBounds",value:function(c,p){this.map.fitBounds(c,p)}},{key:"setMaxZoom",value:function(c){this.map.setMaxZoom(c)}},{key:"setMinZoom",value:function(c){this.map.setMinZoom(c)}},{key:"setMapStatus",value:function(c){c.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),c.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),c.dragEnable===!1&&this.map.dragPan.disable(),c.dragEnable===!0&&this.map.dragPan.enable(),c.rotateEnable===!1&&this.map.dragRotate.disable(),c.dragEnable===!0&&this.map.dragRotate.enable(),c.keyboardEnable===!1&&this.map.keyboard.disable(),c.keyboardEnable===!0&&this.map.keyboard.enable(),c.zoomEnable===!1&&this.map.scrollZoom.disable(),c.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(c,p){this.map.flyTo({zoom:c,center:p})}},{key:"setMapStyle",value:function(c){this.map.setStyle(this.getMapStyle(c))}},{key:"pixelToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToPixel",value:function(c){return this.map.project(c)}},{key:"containerToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToContainer",value:function(c){return this.map.project(c)}},{key:"lngLatToMercator",value:function(c,p){throw new Error("not implement")}},{key:"getModelMatrix",value:function(c,p,T){var j=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],I=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0};throw new Error("not implement")}},{key:"init",value:function(){var d=cr()(J.a.mark(function p(){var T,j,I,k,X,ae,$e,Ie,Oe,ft,Ne;return J.a.wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:T=this.config,j=T.id,I=j===void 0?"map":j,k=T.attributionControl,X=k===void 0?!1:k,ae=T.style,$e=ae===void 0?"light":ae,Ie=T.rotation,Oe=Ie===void 0?0:Ie,ft=T.mapInstance,Ne=zr()(T,["id","attributionControl","style","rotation","mapInstance"]),this.viewport=new lc,ft?(this.map=ft,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(I),this.map=new dl(Hc({container:this.$mapContainer,style:this.getMapStyle($e),bearing:Oe},Ne))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 6:case"end":return Ue.stop()}},p,this)}));function c(){return d.apply(this,arguments)}return c}()},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(c){for(var p,T=arguments.length,j=new Array(T>1?T-1:0),I=1;I<T;I++)j[I-1]=arguments[I];(p=this.eventEmitter).emit.apply(p,[c].concat(j))}},{key:"once",value:function(c){for(var p,T=arguments.length,j=new Array(T>1?T-1:0),I=1;I<T;I++)j[I-1]=arguments[I];(p=this.eventEmitter).once.apply(p,[c].concat(j))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(c){var p=this.map.getCanvas(),T=c==="jpg"?p==null?void 0:p.toDataURL("image/jpeg"):p==null?void 0:p.toDataURL("image/png");return T}},{key:"onCameraChanged",value:function(c){this.cameraChangedCallback=c}},{key:"creatAmapContainer",value:function(c){var p=c;return typeof c=="string"&&(p=document.getElementById(c)),p}},{key:"getMapStyle",value:function(c){return typeof c!="string"?c:pl[c]?pl[c]:c}}]),O}(),cc),Ku=$n()(Cc.prototype,"config",[go],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ef=$n()(Cc.prototype,"configService",[Ac],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uf=$n()(Cc.prototype,"logger",[ds],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Of=$n()(Cc.prototype,"coordinateSystemService",[sf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ru=$n()(Cc.prototype,"eventEmitter",[Cf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cc))||wf);function eh(O){var d=th();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function th(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}var Mf=function(O){Fe()(c,O);var d=eh(c);function c(){return Ye()(this,c),d.apply(this,arguments)}return bt()(c,[{key:"getServiceConstructor",value:function(){return qf}}]),c}(Lt);function rh(O,d){var c=Object.keys(O);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(O);d&&(p=p.filter(function(T){return Object.getOwnPropertyDescriptor(O,T).enumerable})),c.push.apply(c,p)}return c}function Zl(O){for(var d=1;d<arguments.length;d++){var c=arguments[d]!=null?arguments[d]:{};d%2?rh(Object(c),!0).forEach(function(p){lf(O,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(c)):rh(Object(c)).forEach(function(p){Object.defineProperty(O,p,Object.getOwnPropertyDescriptor(c,p))})}return O}function lf(O,d,c){return d in O?Object.defineProperty(O,d,{value:c,enumerable:!0,configurable:!0,writable:!0}):O[d]=c,O}function io(O,d){return wl(O)||au(O,d)||Tf(O,d)||fc()}function fc(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tf(O,d){if(!O)return;if(typeof O=="string")return Oc(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Oc(O,d)}function Oc(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}function au(O,d){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(O)))return;var c=[],p=!0,T=!1,j=void 0;try{for(var I=O[Symbol.iterator](),k;!(p=(k=I.next()).done)&&!(c.push(k.value),d&&c.length===d);p=!0);}catch(X){T=!0,j=X}finally{try{!p&&I.return!=null&&I.return()}finally{if(T)throw j}}return c}function wl(O){if(Array.isArray(O))return O}var _f=mt.a.memo(function(O){var d=O.style,c=O.className,p=O.map,T=O.option,j=O.onSceneLoaded,I=Object(Pe.createRef)(),k=Object(Pe.useState)(),X=io(k,2),ae=X[0],$e=X[1];return Object(Pe.useEffect)(function(){var Ie=new kt.Scene(Zl(Zl({id:I.current},T),{},{map:new Mf(p)}));return Ie.on("loaded",function(){$e(Ie),j&&j(Ie)}),function(){Ie.destroy()}},[]),Object(Pe.useEffect)(function(){ae&&p.style&&ae.setMapStyle(p.style)},[JSON.stringify(p.style)]),Object(Pe.useEffect)(function(){ae&&p.zoom&&ae.setZoom(p.zoom)},[p.zoom]),Object(Pe.useEffect)(function(){ae&&p.center&&ae.setCenter(p.center)},[JSON.stringify(p.center)]),Object(Pe.useEffect)(function(){ae&&p.pitch&&ae.setPitch(p.pitch)},[p.pitch]),Object(Pe.useEffect)(function(){ae&&p.rotation&&ae.setRotation(p.rotation)},[p.rotation]),mt.a.createElement(ne.Provider,{value:ae},Object(Pe.createElement)("div",{ref:I,style:d,className:c},ae&&O.children))}),Nf=_f;function Zc(O,d){return se(O)||re(O,d)||Wc(O,d)||cf()}function cf(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wc(O,d){if(!O)return;if(typeof O=="string")return ml(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return ml(O,d)}function ml(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}function re(O,d){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(O)))return;var c=[],p=!0,T=!1,j=void 0;try{for(var I=O[Symbol.iterator](),k;!(p=(k=I.next()).done)&&!(c.push(k.value),d&&c.length===d);p=!0);}catch(X){T=!0,j=X}finally{try{!p&&I.return!=null&&I.return()}finally{if(T)throw j}}return c}function se(O){if(Array.isArray(O))return O}var N=mt.a.memo(function(O){var d=O.style,c=O.className,p=O.map,T=Object(Pe.createRef)(),j=Object(Pe.useState)(),I=Zc(j,2),k=I[0],X=I[1];return Object(Pe.useEffect)(function(){var ae=new kt.Scene({id:T.current,map:p});return ae.on("loaded",function(){X(ae)}),function(){ae.destroy()}},[]),mt.a.createElement(ne.Provider,{value:k},Object(Pe.createElement)("div",{ref:T,style:d,className:c},k&&O.children))});function G(O,d){return or(O)||sr(O,d)||ct(O,d)||Ae()}function Ae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ct(O,d){if(!O)return;if(typeof O=="string")return Xt(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Xt(O,d)}function Xt(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}function sr(O,d){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(O)))return;var c=[],p=!0,T=!1,j=void 0;try{for(var I=O[Symbol.iterator](),k;!(p=(k=I.next()).done)&&!(c.push(k.value),d&&c.length===d);p=!0);}catch(X){T=!0,j=X}finally{try{!p&&I.return!=null&&I.return()}finally{if(T)throw j}}return c}function or(O){if(Array.isArray(O))return O}var Ir=mt.a.memo(function(d){var c=et(),p=Object(Pe.useState)(),T=G(p,2),j=T[1],I=d.type,k=d.position;return Object(Pe.useEffect)(function(){var X;switch(I){case"scale":X=new kt.Scale({position:k||"bottomright"});break;case"zoom":X=new kt.Zoom({position:k||"topright"});break;case"logo":X=new kt.Logo({position:k||"bottomleft"})}return j(X),c.addControl(X),function(){c.removeControl(X)}},[I,k]),null}),an=o("i8i4"),Gn=Pe.useEffect,ea=Pe.useState;function la(O){var d=O.className,c=O.style,p=O.children,T=O.position,j=et(),I=document.createElement("div");return Gn(function(){var k=new kt.Control({position:T});return k.onAdd=function(){if(d&&(I.className=d),c){var X=Object.keys(c).map(function(ae){return"".concat(ae,":").concat(c[ae])}).join(";");I.style.cssText=X}return I},j.addControl(k),function(){j.removeControl(k)}},[]),Object(an.createPortal)(p,I)}var qa=Object(Pe.createContext)({});function Fa(){return Object(Pe.useContext)(qa)}var yi=Pe.useEffect,Ja=Pe.memo(function(d){var c=d.layer,p=d.active;return yi(function(){c.active(p.option)},[JSON.stringify(p)]),null}),Bi=Pe.useEffect,So=Pe.memo(function(d){var c=d.layer,p=d.animate;return Bi(function(){c.animate(p)},[JSON.stringify(p)]),null}),yo=Pe.useEffect,Hi=Pe.memo(function(d){var c=d.layer,p=d.color;return yo(function(){p.field?c.color(p.field,p.values):c.color(p.values)},[p.field,p.scale,JSON.stringify(p.values),JSON.stringify(p.options)]),null}),ko=Pe.useEffect,Qa=Pe.memo(function(d){var c=d.layer,p=d.filter;return ko(function(){p.field&&c.filter(p.field,p.values)},[p.field,p.values,JSON.stringify(p.values),JSON.stringify(p.options)]),null}),lo=Pe.useEffect,iu=Pe.memo(function(d){var c=d.layer,p=d.scale;return lo(function(){c.scale(p.values)},[p.values]),null}),bi=Pe.useEffect,Ni=Pe.memo(function(d){var c=d.layer,p=d.select;return bi(function(){c.select(p.option)},[JSON.stringify(p)]),null}),xa=Pe.useEffect,Ao=Pe.memo(function(d){var c=d.layer,p=d.shape;return xa(function(){p.field?c.shape(p.field,p.values):c.shape(p.values)},[p.field,JSON.stringify(p.values),JSON.stringify(p.options)]),null}),hc=Pe.useEffect,kf=Pe.memo(function(d){var c=d.layer,p=d.size;return hc(function(){p.field?c.size(p.field,p.values):c.size(p.values)},[p.field,p.scale,JSON.stringify(p.values),JSON.stringify(p.options)]),null});function uh(O,d){if(O==null)return{};var c=jf(O,d),p,T;if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(O);for(T=0;T<j.length;T++){if(p=j[T],d.indexOf(p)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(O,p))continue;c[p]=O[p]}}return c}function jf(O,d){if(O==null)return{};var c={},p=Object.keys(O),T,j;for(j=0;j<p.length;j++){if(T=p[j],d.indexOf(T)>=0)continue;c[T]=O[T]}return c}var Iu=Pe.useEffect,Ff=Pe.memo(function(d){var c=d.layer,p=d.source,T=p.data,j=uh(p,["data"]);return Iu(function(){c.inited?c.setData(T,j):c.source(T,j),j.autoFit&&c.fitBounds(j&&j.fitBoundsOptions)},[T,JSON.stringify(j)]),null}),ff=Pe.useEffect,zf=Pe.memo(function(d){var c=d.layer,p=d.style;return ff(function(){c.style(p)},Object.keys(p).map(function(T){return p[T]})),null});function Th(O,d){return ch(O)||Bf(O,d)||Sf(O,d)||lh()}function lh(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sf(O,d){if(!O)return;if(typeof O=="string")return Uf(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Uf(O,d)}function Uf(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}function Bf(O,d){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(O)))return;var c=[],p=!0,T=!1,j=void 0;try{for(var I=O[Symbol.iterator](),k;!(p=(k=I.next()).done)&&!(c.push(k.value),d&&c.length===d);p=!0);}catch(X){T=!0,j=X}finally{try{!p&&I.return!=null&&I.return()}finally{if(T)throw j}}return c}function ch(O){if(Array.isArray(O))return O}var Vf=Pe.useEffect,Pf=Pe.useState;function Wl(O,d){var c=d.source,p=d.color,T=d.shape,j=d.style,I=d.size,k=d.scale,X=d.active,ae=d.select,$e=d.filter,Ie=d.animate,Oe=d.options,ft=d.onLayerLoaded,Ne=et(),lt=Pf(),Ue=Th(lt,2),It=Ue[0],$t=Ue[1];if(!It){var ar;switch(O){case"polygonLayer":ar=new kt.PolygonLayer(Oe);break;case"lineLayer":ar=new kt.LineLayer(Oe);break;case"pointLayer":ar=new kt.PointLayer(Oe);break;case"heatmapLayer":ar=new kt.HeatmapLayer(Oe);break;case"rasterLayer":ar=new kt.RasterLayer(Oe);break;case"imageLayer":ar=new kt.ImageLayer(Oe);break;case"citybuildingLayer":ar=new kt.CityBuildingLayer(Oe);break;default:ar=new kt.PolygonLayer(Oe)}ar.on("inited",function(){ft&&ft(ar,Ne)}),$t(ar)}return Vf(function(){if(It!==void 0)return Ne.addLayer(It),function(){Ne.removeLayer(It)}},[]),Vf(function(){It&&Ne.render()}),Vf(function(){It&&It.inited&&Oe&&It.updateLayerConfig(Oe)},[Oe==null?void 0:Oe.minZoom,Oe==null?void 0:Oe.maxZoom,Oe==null?void 0:Oe.visible]),Vf(function(){It&&It.inited&&Oe&&Oe.zIndex&&It.setIndex(Oe.zIndex)},[Oe==null?void 0:Oe.zIndex]),Vf(function(){It&&It.inited&&Oe&&Oe.blend&&It.setBlend(Oe.blend)},[Oe==null?void 0:Oe.blend]),It!=null?Pe.createElement(qa.Provider,{value:It},Pe.createElement(Ff,{layer:It,source:c}),k&&Pe.createElement(iu,{layer:It,scale:k}),p&&Pe.createElement(Hi,{layer:It,color:p}),I&&Pe.createElement(kf,{layer:It,size:I}),T&&Pe.createElement(Ao,{layer:It,shape:T}),j&&Pe.createElement(zf,{layer:It,style:j}),X&&Pe.createElement(Ja,{layer:It,active:X}),ae&&Pe.createElement(Ni,{layer:It,select:ae}),$e&&Pe.createElement(Qa,{layer:It,filter:$e}),Ie&&Pe.createElement(So,{layer:It,animate:Ie}),d.children):null}var Dh=Pe.memo(function(d){return Wl("polygonLayer",d)}),ye=Pe.memo(function(d){return Wl("lineLayer",d)}),je=Pe.memo(function(d){return Wl("pointLayer",d)}),Ot=Pe.memo(function(d){return Wl("heatmapLayer",d)}),xr=Pe.memo(function(d){return Wl("rasterLayer",d)}),Pr=Pe.memo(function(d){return Wl("imageLayer",d)}),Cr=Pe.memo(function(d){return Wl("citybuildingLayer",d)}),Er=Pe.useEffect,Zr=Pe.memo(function(O){var d=O.type,c=O.handler,p=Fa();return Er(function(){return p.off(d,c),p.on(d,c),function(){p.off(d,c)}},[d,c]),null}),on={color:"color"},en=Pe.memo(function(O){var d=O.className,c=O.style,p=O.title,T=[{title:"1",color:"rgb(239,243,255)"},{title:"10",color:"rgb(198,219,239)"},{title:"30",color:"rgb(158,202,225)"},{title:"50",color:"rgb(107,174,214)"},{title:"60",color:"rgb(49,130,189)"},{title:"100",color:"rgb(8,81,156)"}];return Pe.createElement("div",null,Pe.createElement("div",null,T.map(function(j,I){return Pe.createElement("div",{key:I.toString(),style:{background:j.color,height:"100%",display:"inline-block",cursor:"pointer",width:""+(100-T.length)/T.length+"%",marginRight:"1%",padding:5}})})),Pe.createElement("div",null,T.map(function(j,I){return Pe.createElement("div",{key:I.toString()+"122",style:{background:"#fff",height:"100%",display:"inline-block",textAlign:"left",cursor:"pointer",width:""+(100-T.length)/T.length+"%",marginRight:"1%"}},j.title)})))});function Yr(O){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Yr=function(c){return typeof c}:Yr=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},Yr(O)}function cn(O,d){var c=Object.keys(O);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(O);d&&(p=p.filter(function(T){return Object.getOwnPropertyDescriptor(O,T).enumerable})),c.push.apply(c,p)}return c}function Tn(O){for(var d=1;d<arguments.length;d++){var c=arguments[d]!=null?arguments[d]:{};d%2?cn(Object(c),!0).forEach(function(p){dn(O,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(c)):cn(Object(c)).forEach(function(p){Object.defineProperty(O,p,Object.getOwnPropertyDescriptor(c,p))})}return O}function dn(O,d,c){return d in O?Object.defineProperty(O,d,{value:c,enumerable:!0,configurable:!0,writable:!0}):O[d]=c,O}function nn(O,d){if(!(O instanceof d))throw new TypeError("Cannot call a class as a function")}function Tr(O,d){for(var c=0;c<d.length;c++){var p=d[c];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(O,p.key,p)}}function br(O,d,c){return d&&Tr(O.prototype,d),c&&Tr(O,c),O}function Wr(O,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function");O.prototype=Object.create(d&&d.prototype,{constructor:{value:O,writable:!0,configurable:!0}}),d&&wn(O,d)}function wn(O,d){return wn=Object.setPrototypeOf||function(p,T){return p.__proto__=T,p},wn(O,d)}function Rr(O){var d=Br();return function(){var p=Fr(O),T;if(d){var j=Fr(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return ta(this,T)}}function ta(O,d){return d&&(Yr(d)==="object"||typeof d=="function")?d:Jr(O)}function Jr(O){if(O===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return O}function Br(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}function Fr(O){return Fr=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)},Fr(O)}var Kr=function(O){Wr(c,O);var d=Rr(c);function c(p){var T;return nn(this,c),T=d.call(this,p),T.el=document.createElement("div"),T}return br(c,[{key:"componentDidMount",value:function(){var T=this.props,j=T.lnglat,I=T.children,k=T.option,X=new kt.Popup(Tn(Tn({},k),{},{stopPropagation:!1}));j&&X.setLnglat(j),I&&X.setDOMContent(this.el),this.popup=X,this.scene.addPopup(X)}},{key:"componentDidUpdate",value:function(T){var j,I,k,X,ae,$e,Ie=Array.isArray(T.lnglat)?T.lnglat:[T==null||((j=T.lnglat)===null||j===void 0)?void 0:j.lng,T==null||((I=T.lnglat)===null||I===void 0)?void 0:I.lat],Oe=Array.isArray(this.props.lnglat)?this.props.lnglat:[(k=this.props)===null||k===void 0||((X=k.lnglat)===null||X===void 0)?void 0:X.lng,(ae=this.props)===null||ae===void 0||(($e=ae.lnglat)===null||$e===void 0)?void 0:$e.lat],ft=Ie.toString()!==Oe.toString();ft&&(this.popup.remove(),this.popup=new kt.Popup(Tn(Tn({},this.props.option),{},{stopPropagation:!1})),this.popup.setLnglat(this.props.lnglat),this.popup.setDOMContent(this.el),this.scene.addPopup(this.popup))}},{key:"componentWillUnmount",value:function(){this.popup.remove()}},{key:"render",value:function(){var T=this;return Pe.createElement(ne.Consumer,{},function(j){return j&&(T.scene=j),Object(an.createPortal)(T.props.children,T.el)})}}]),c}(Pe.PureComponent);function Hn(O){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Hn=function(c){return typeof c}:Hn=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},Hn(O)}function aa(O,d){if(!(O instanceof d))throw new TypeError("Cannot call a class as a function")}function sn(O,d){for(var c=0;c<d.length;c++){var p=d[c];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(O,p.key,p)}}function Gr(O,d,c){return d&&sn(O.prototype,d),c&&sn(O,c),O}function jr(O,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function");O.prototype=Object.create(d&&d.prototype,{constructor:{value:O,writable:!0,configurable:!0}}),d&&ha(O,d)}function ha(O,d){return ha=Object.setPrototypeOf||function(p,T){return p.__proto__=T,p},ha(O,d)}function pa(O){var d=Oa();return function(){var p=Da(O),T;if(d){var j=Da(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return Un(this,T)}}function Un(O,d){return d&&(Hn(d)==="object"||typeof d=="function")?d:Ua(O)}function Ua(O){if(O===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return O}function Oa(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}function Da(O){return Da=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)},Da(O)}var fi=function(O){jr(c,O);var d=pa(c);function c(p){var T;return aa(this,c),T=d.call(this,p),T.el=document.createElement("div"),T}return Gr(c,[{key:"componentDidMount",value:function(){var T=this.props,j=T.lnglat,I=T.children,k=T.option,X=T.onMarkerLoaded,ae=new kt.Marker(k);j&&ae.setLnglat(j),I&&ae.setElement(this.el),this.marker=ae,X&&X(ae),this.scene.addMarker(ae)}},{key:"componentDidUpdate",value:function(T){var j,I=(T==null?void 0:T.lnglat.toString())!==((j=this.props)===null||j===void 0?void 0:j.lnglat.toString());I&&this.marker.setLnglat(this.props.lnglat)}},{key:"componentWillUnmount",value:function(){this.marker&&this.marker.remove()}},{key:"render",value:function(){var T=this;return Pe.createElement(ne.Consumer,{},function(j){return j&&(T.scene=j),Object(an.createPortal)(T.props.children,T.el)})}}]),c}(Pe.PureComponent),jo=Pe.useEffect,ps=Pe.memo(function(O){var d=O.type,c=O.handler,p=et();return jo(function(){return p.on(d,c),function(){p.off(d,c)}},[d]),null}),ei=ps,co=Pe.useEffect,Mi=Pe.memo(function(d){var c=d.name,p=d.url,T=et();return co(function(){T.addImage(c,p)},[c,p]),null}),ms=o("tbuW"),Zo=["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],Wo=function(O){Object(te.a)(c,O);var d=Object(fe.a)(c);function c(){var p;Object(D.a)(this,c);for(var T=arguments.length,j=new Array(T),I=0;I<T;I++)j[I]=arguments[I];return p=d.call.apply(d,[this].concat(j)),p.state={data:null,grid:null,loading:!1},p}return Object($.a)(c,[{key:"componentDidMount",value:function(){var p=Object(Qe.a)(J.a.mark(function j(){var I,k,X,ae;return J.a.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return Ie.next=2,Promise.all([fetch("https://gw.alipayobjects.com/os/bmw-prod/c5dba875-b6ea-4e88-b778-66a862906c93.json").then(function(Oe){return Oe.json()}),fetch("https://gw.alipayobjects.com/os/bmw-prod/8990e8b4-c58e-419b-afb9-8ea3daff2dd1.json").then(function(Oe){return Oe.json()})]);case 2:I=Ie.sent,k=Object(C.a)(I,2),X=k[0],ae=k[1],this.setState({data:X,grid:ae,loading:!0});case 7:case"end":return Ie.stop()}},j,this)}));function T(){return p.apply(this,arguments)}return T}()},{key:"render",value:function(){var T=this.state,j=T.data,I=T.grid,k=T.loading;return k===!1?Object(pe.jsx)(ms.a,{"data-inspector-line":"32","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Map/index.tsx"}):Object(pe.jsxs)(Il,{map:{center:[110.19382669582967,50.258134],pitch:0,style:"blank",zoom:1},style:{position:"relative",width:"100%",height:"452px"},"data-inspector-line":"34","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Map/index.tsx",children:[I&&Object(pe.jsx)(Ot,{source:{data:I,transforms:[{type:"hexagon",size:8e5,field:"capacity",method:"sum"}]},color:{values:"#ddd"},shape:{values:"hexagon"},style:{coverage:.7,opacity:.8},"data-inspector-line":"48","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Map/index.tsx"},"1"),j&&[Object(pe.jsx)(je,{options:{autoFit:!0},source:{data:j},scale:{values:{color:{field:"cum_conf",type:"quantile"},size:{field:"cum_conf",type:"log"}}},color:{field:"cum_conf",values:Zo},shape:{values:"circle"},active:{option:{color:"#0c2c84"}},size:{field:"cum_conf",values:[0,30]},style:{opacity:.8},"data-inspector-line":"74","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Map/index.tsx"},"2"),Object(pe.jsx)(je,{source:{data:j},color:{values:"#fff"},shape:{field:"Short_Name_ZH",values:"text"},filter:{field:"cum_conf",values:function(ae){return ae>2e3}},size:{values:12},style:{opacity:1,strokeOpacity:1,strokeWidth:0},"data-inspector-line":"114","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Map/index.tsx"},"5")]]})}}]),c}(Pe.Component),es={Pie:gt,WaterWave:at,Gauge:Qt,MiniArea:Q,TagCloud:We,Map:Wo},Is=o("KQm4"),Zi={activeChart:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChart",activeChartGrid:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChartGrid",activeChartLegend:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChartLegend",dashedLine:"antd-pro-pages-dashboard-monitor-components-active-chart-index-dashedLine",line:"antd-pro-pages-dashboard-monitor-components-active-chart-index-line"};function ia(O){return O*1<10?"0".concat(O):O}function Hs(){for(var O=[],d=0;d<24;d+=1)O.push({x:"".concat(ia(d),":00"),y:Math.floor(Math.random()*200)+d*50});return O}var xi=function(O){Object(te.a)(c,O);var d=Object(fe.a)(c);function c(){var p;Object(D.a)(this,c);for(var T=arguments.length,j=new Array(T),I=0;I<T;I++)j[I]=arguments[I];return p=d.call.apply(d,[this].concat(j)),p.state={activeData:Hs()},p.timer=void 0,p.requestRef=void 0,p.loopData=function(){p.requestRef=requestAnimationFrame(function(){p.timer=window.setTimeout(function(){p.setState({activeData:Hs()},function(){p.loopData()})},1e3)})},p}return Object($.a)(c,[{key:"componentDidMount",value:function(){this.loopData()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer),this.requestRef&&cancelAnimationFrame(this.requestRef)}},{key:"render",value:function(){var T=this.state.activeData,j=T===void 0?[]:T;return Object(pe.jsxs)("div",{className:Zi.activeChart,"data-inspector-line":"61","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx",children:[Object(pe.jsx)(Ge.a,{title:"\u76EE\u6807\u8BC4\u4F30",value:"\u6709\u671B\u8FBE\u5230\u9884\u671F","data-inspector-line":"62","data-inspector-column":"8","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx"}),Object(pe.jsx)("div",{style:{marginTop:32},"data-inspector-line":"63","data-inspector-column":"8","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx",children:Object(pe.jsx)(Q,{animate:!1,line:!0,borderWidth:2,height:84,scale:{y:{tickCount:3}},yAxis:{tickLine:void 0,label:void 0,title:void 0,line:void 0},data:j,"data-inspector-line":"64","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx"})}),j&&Object(pe.jsxs)("div",{"data-inspector-line":"84","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx",children:[Object(pe.jsxs)("div",{className:Zi.activeChartGrid,"data-inspector-line":"85","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx",children:[Object(pe.jsxs)("p",{"data-inspector-line":"86","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx",children:[Object(Is.a)(j).sort()[j.length-1].y+200," \u4EBF\u5143"]}),Object(pe.jsxs)("p",{"data-inspector-line":"87","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx",children:[Object(Is.a)(j).sort()[Math.floor(j.length/2)].y," \u4EBF\u5143"]})]}),Object(pe.jsx)("div",{className:Zi.dashedLine,"data-inspector-line":"89","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx",children:Object(pe.jsx)("div",{className:Zi.line,"data-inspector-line":"90","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx"})}),Object(pe.jsx)("div",{className:Zi.dashedLine,"data-inspector-line":"92","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx",children:Object(pe.jsx)("div",{className:Zi.line,"data-inspector-line":"93","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx"})})]}),j&&Object(pe.jsxs)("div",{className:Zi.activeChartLegend,"data-inspector-line":"98","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx",children:[Object(pe.jsx)("span",{"data-inspector-line":"99","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx",children:"00:00"}),Object(pe.jsx)("span",{"data-inspector-line":"100","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx",children:j[Math.floor(j.length/2)].x}),Object(pe.jsx)("span",{"data-inspector-line":"101","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx",children:j[j.length-1].x})]})]})}}]),c}(Pe.Component),An={mapChart:"antd-pro-pages-dashboard-monitor-style-mapChart",pieCard:"antd-pro-pages-dashboard-monitor-style-pieCard"},Ra=Ge.a.Countdown,Ba=Date.now()+1e3*60*60*24*2+1e3*30,Xo=function(O){Object(te.a)(c,O);var d=Object(fe.a)(c);function c(){return Object(D.a)(this,c),d.apply(this,arguments)}return Object($.a)(c,[{key:"componentDidMount",value:function(){var T=this.props.dispatch;T({type:"dashboardAndmonitor/fetchTags"})}},{key:"render",value:function(){var T=this.props,j=T.dashboardAndmonitor,I=T.loading,k=j.tags;return Object(pe.jsx)(De.a,{"data-inspector-line":"34","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsxs)(mt.a.Fragment,{children:[Object(pe.jsxs)(F.a,{gutter:24,"data-inspector-line":"36","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:[Object(pe.jsx)(Z.a,{xl:18,lg:24,md:24,sm:24,xs:24,style:{marginBottom:24},"data-inspector-line":"37","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsxs)(m.a,{title:Object(pe.jsx)(Ze.a,{id:"dashboardandmonitor.monitor.trading-activity",defaultMessage:"Real-Time Trading Activity","data-inspector-line":"40","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),bordered:!1,"data-inspector-line":"38","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:[Object(pe.jsxs)(F.a,{"data-inspector-line":"47","data-inspector-column":"16","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:[Object(pe.jsx)(Z.a,{md:6,sm:12,xs:24,"data-inspector-line":"48","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(Ge.a,{title:Object(pe.jsx)(Ze.a,{id:"dashboardandmonitor.monitor.total-transactions",defaultMessage:"Total transactions today","data-inspector-line":"51","data-inspector-column":"24","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),suffix:"\u5143",value:it()(124543233).format("0,0"),"data-inspector-line":"49","data-inspector-column":"20","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"})}),Object(pe.jsx)(Z.a,{md:6,sm:12,xs:24,"data-inspector-line":"60","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(Ge.a,{title:Object(pe.jsx)(Ze.a,{id:"dashboardandmonitor.monitor.sales-target",defaultMessage:"Sales target completion rate","data-inspector-line":"63","data-inspector-column":"24","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),value:"92%","data-inspector-line":"61","data-inspector-column":"20","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"})}),Object(pe.jsx)(Z.a,{md:6,sm:12,xs:24,"data-inspector-line":"71","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(Ra,{title:Object(pe.jsx)(Ze.a,{id:"dashboardandmonitor.monitor.remaining-time",defaultMessage:"Remaining time of activity","data-inspector-line":"74","data-inspector-column":"24","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),value:Ba,format:"HH:mm:ss:SSS","data-inspector-line":"72","data-inspector-column":"20","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"})}),Object(pe.jsx)(Z.a,{md:6,sm:12,xs:24,"data-inspector-line":"83","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(Ge.a,{title:Object(pe.jsx)(Ze.a,{id:"dashboardandmonitor.monitor.total-transactions-per-second",defaultMessage:"Total transactions per second","data-inspector-line":"86","data-inspector-column":"24","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),suffix:"\u5143",value:it()(234).format("0,0"),"data-inspector-line":"84","data-inspector-column":"20","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"})})]}),Object(pe.jsx)("div",{className:An.mapChart,"data-inspector-line":"96","data-inspector-column":"16","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(Wo,{"data-inspector-line":"97","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"})})]})}),Object(pe.jsxs)(Z.a,{xl:6,lg:24,md:24,sm:24,xs:24,"data-inspector-line":"101","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:[Object(pe.jsx)(m.a,{title:Object(pe.jsx)(Ze.a,{id:"dashboardandmonitor.monitor.activity-forecast",defaultMessage:"Activity forecast","data-inspector-line":"104","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),style:{marginBottom:24},bordered:!1,"data-inspector-line":"102","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(xi,{"data-inspector-line":"112","data-inspector-column":"16","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"})}),Object(pe.jsx)(m.a,{title:Object(pe.jsx)(Ze.a,{id:"dashboardandmonitor.monitor.efficiency",defaultMessage:"Efficiency","data-inspector-line":"116","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),style:{marginBottom:24},bodyStyle:{textAlign:"center"},bordered:!1,"data-inspector-line":"114","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(Qt,{title:Object(Ze.d)({id:"dashboardandmonitor.monitor.ratio",defaultMessage:"Ratio"}),height:180,percent:87,"data-inspector-line":"125","data-inspector-column":"16","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"})})]})]}),Object(pe.jsxs)(F.a,{gutter:24,"data-inspector-line":"136","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:[Object(pe.jsx)(Z.a,{xl:12,lg:24,sm:24,xs:24,style:{marginBottom:24},"data-inspector-line":"137","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(m.a,{title:Object(pe.jsx)(Ze.a,{id:"dashboardandmonitor.monitor.proportion-per-category",defaultMessage:"Proportion Per Category","data-inspector-line":"140","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),bordered:!1,className:An.pieCard,"data-inspector-line":"138","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsxs)(F.a,{style:{padding:"16px 0"},"data-inspector-line":"148","data-inspector-column":"16","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:[Object(pe.jsx)(Z.a,{span:8,"data-inspector-line":"149","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(gt,{animate:!1,percent:28,title:Object(pe.jsx)(Ze.a,{id:"dashboardandmonitor.monitor.fast-food",defaultMessage:"Fast food","data-inspector-line":"154","data-inspector-column":"24","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),total:"28%",height:128,lineWidth:2,"data-inspector-line":"150","data-inspector-column":"20","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"})}),Object(pe.jsx)(Z.a,{span:8,"data-inspector-line":"164","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(gt,{animate:!1,color:"#5DDECF",percent:22,title:Object(pe.jsx)(Ze.a,{id:"dashboardandmonitor.monitor.western-food",defaultMessage:"Western food","data-inspector-line":"170","data-inspector-column":"24","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),total:"22%",height:128,lineWidth:2,"data-inspector-line":"165","data-inspector-column":"20","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"})}),Object(pe.jsx)(Z.a,{span:8,"data-inspector-line":"180","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(gt,{animate:!1,color:"#2FC25B",percent:32,title:Object(pe.jsx)(Ze.a,{id:"dashboardandmonitor.monitor.hot-pot",defaultMessage:"Hot pot","data-inspector-line":"186","data-inspector-column":"24","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),total:"32%",height:128,lineWidth:2,"data-inspector-line":"181","data-inspector-column":"20","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"})})]})})}),Object(pe.jsx)(Z.a,{xl:6,lg:12,sm:24,xs:24,style:{marginBottom:24},"data-inspector-line":"199","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(m.a,{title:Object(pe.jsx)(Ze.a,{id:"dashboardandmonitor.monitor.popular-searches",defaultMessage:"Popular Searches","data-inspector-line":"202","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),loading:I,bordered:!1,bodyStyle:{overflow:"hidden"},"data-inspector-line":"200","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(We,{data:k||[],height:161,"data-inspector-line":"211","data-inspector-column":"16","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"})})}),Object(pe.jsx)(Z.a,{xl:6,lg:12,sm:24,xs:24,style:{marginBottom:24},"data-inspector-line":"214","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(m.a,{title:Object(pe.jsx)(Ze.a,{id:"dashboardandmonitor.monitor.resource-surplus",defaultMessage:"Resource Surplus","data-inspector-line":"217","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),bodyStyle:{textAlign:"center",fontSize:0},bordered:!1,"data-inspector-line":"215","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(at,{height:161,title:Object(pe.jsx)(Ze.a,{id:"dashboardandmonitor.monitor.fund-surplus",defaultMessage:"Fund Surplus","data-inspector-line":"228","data-inspector-column":"20","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),percent:34,"data-inspector-line":"225","data-inspector-column":"16","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"})})})]})]})})}}]),c}(Pe.Component),gu=E.default=Object(Ze.c)(function(O){var d=O.dashboardAndmonitor,c=O.loading;return{dashboardAndmonitor:d,loading:c.models.dashboardAndmonitor}})(Xo)},aF1E:function(ze,E,o){"use strict";o.d(E,"a",function(){return i});var b=o("lSNA"),m=o.n(b);function Y(Z,D){var $=Object.keys(Z);if(Object.getOwnPropertySymbols){var te=Object.getOwnPropertySymbols(Z);D&&(te=te.filter(function(fe){return Object.getOwnPropertyDescriptor(Z,fe).enumerable})),$.push.apply($,te)}return $}function F(Z){for(var D=1;D<arguments.length;D++){var $=arguments[D]!=null?arguments[D]:{};D%2?Y(Object($),!0).forEach(function(te){m()(Z,te,$[te])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Z,Object.getOwnPropertyDescriptors($)):Y(Object($)).forEach(function(te){Object.defineProperty(Z,te,Object.getOwnPropertyDescriptor($,te))})}return Z}function i(Z,D){var $=D.sourceField,te=D.targetField,fe=D.data,K={};return fe.forEach(function(Ge){K[Ge[$]]=Ge}),Z.dataArray=Z.dataArray.map(function(Ge){var pe=Ge[te];return F(F({},Ge),K[pe])}),Z}},aHsQ:function(ze,E,o){"use strict";var b=o("cIOH"),m={"ant-statistic":"ant-statistic","ant-statistic-title":"ant-statistic-title","ant-statistic-content":"ant-statistic-content","ant-statistic-content-value":"ant-statistic-content-value","ant-statistic-content-value-decimal":"ant-statistic-content-value-decimal","ant-statistic-content-prefix":"ant-statistic-content-prefix","ant-statistic-content-suffix":"ant-statistic-content-suffix","ant-statistic-rtl":"ant-statistic-rtl"},Y=o("cWXX")},aPG5:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("MON2"),m=o("FV85"),Y=o("qK8v"),F=o("ujMp"),i=o("cSJO"),Z=function(fe,K,Ge){try{return Ge()}catch(pe){throw Y.isStackOverflowExeption(pe)?new Error(b.CIRCULAR_DEPENDENCY_IN_FACTORY(fe,K.toString())):pe}},D=function te(fe){return function(K){K.parentContext.setCurrentRequest(K);var Ge=K.bindings,pe=K.childRequests,Ze=K.target&&K.target.isArray(),Pe=!K.parentRequest||!K.parentRequest.target||!K.target||!K.parentRequest.target.matchesArray(K.target.serviceIdentifier);if(Ze&&Pe)return pe.map(function(Je){var _t=te(fe);return _t(Je)});var mt=null;if(K.target.isOptional()&&Ge.length===0)return;var De=Ge[0],At=De.scope===m.BindingScopeEnum.Singleton,it=De.scope===m.BindingScopeEnum.Request;if(At&&De.activated)return De.cache;if(it&&fe!==null&&fe.has(De.id))return fe.get(De.id);if(De.type===m.BindingTypeEnum.ConstantValue)mt=De.cache;else if(De.type===m.BindingTypeEnum.Function)mt=De.cache;else if(De.type===m.BindingTypeEnum.Constructor)mt=De.implementationType;else if(De.type===m.BindingTypeEnum.DynamicValue&&De.dynamicValue!==null)mt=Z("toDynamicValue",De.serviceIdentifier,function(){return De.dynamicValue(K.parentContext)});else if(De.type===m.BindingTypeEnum.Factory&&De.factory!==null)mt=Z("toFactory",De.serviceIdentifier,function(){return De.factory(K.parentContext)});else if(De.type===m.BindingTypeEnum.Provider&&De.provider!==null)mt=Z("toProvider",De.serviceIdentifier,function(){return De.provider(K.parentContext)});else if(De.type===m.BindingTypeEnum.Instance&&De.implementationType!==null)mt=i.resolveInstance(De.implementationType,pe,te(fe));else{var vt=F.getServiceIdentifierAsString(K.serviceIdentifier);throw new Error(b.INVALID_BINDING_TYPE+" "+vt)}return typeof De.onActivation=="function"&&(mt=De.onActivation(K.parentContext,mt)),At&&(De.cache=mt,De.activated=!0),it&&fe!==null&&!fe.has(De.id)&&fe.set(De.id,mt),mt}};function $(te){var fe=D(te.plan.rootRequest.requestScope);return fe(te.plan.rootRequest)}E.resolve=$},asDA:function(ze,E){function o(b,m,Y,F){var i=-1,Z=b==null?0:b.length;for(F&&Z&&(Y=b[++i]);++i<Z;)Y=m(Y,b[i],i,b);return Y}ze.exports=o},b2z7:function(ze,E){var o=/\w*$/;function b(m){var Y=new m.constructor(m.source,o.exec(m));return Y.lastIndex=m.lastIndex,Y}ze.exports=b},bB6j:function(ze,E,o){"use strict";o.d(E,"a",function(){return b});var b={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),ILogService:Symbol.for("ILogService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")}},bPkA:function(ze,E,o){"use strict";o.d(E,"a",function(){return b});var b;(function(m){m.Normal="normal",m.PostProcessing="post-processing"})(b||(b={}))},bTtR:function(ze,E){},bYl4:function(ze,E){},bahg:function(ze,E){function o(b){return b.split("")}ze.exports=o},bl9R:function(ze,E,o){"use strict";o.r(E),o.d(E,"create",function(){return m}),o.d(E,"clone",function(){return Y}),o.d(E,"fromValues",function(){return F}),o.d(E,"copy",function(){return i}),o.d(E,"set",function(){return Z}),o.d(E,"add",function(){return D}),o.d(E,"subtract",function(){return $}),o.d(E,"multiply",function(){return te}),o.d(E,"divide",function(){return fe}),o.d(E,"ceil",function(){return K}),o.d(E,"floor",function(){return Ge}),o.d(E,"min",function(){return pe}),o.d(E,"max",function(){return Ze}),o.d(E,"round",function(){return Pe}),o.d(E,"scale",function(){return mt}),o.d(E,"scaleAndAdd",function(){return De}),o.d(E,"distance",function(){return At}),o.d(E,"squaredDistance",function(){return it}),o.d(E,"length",function(){return vt}),o.d(E,"squaredLength",function(){return Je}),o.d(E,"negate",function(){return _t}),o.d(E,"inverse",function(){return wt}),o.d(E,"normalize",function(){return ke}),o.d(E,"dot",function(){return Re}),o.d(E,"cross",function(){return Ve}),o.d(E,"lerp",function(){return dt}),o.d(E,"random",function(){return Me}),o.d(E,"transformMat4",function(){return ht}),o.d(E,"transformQuat",function(){return Zt}),o.d(E,"zero",function(){return Qt}),o.d(E,"str",function(){return ur}),o.d(E,"exactEquals",function(){return oe}),o.d(E,"equals",function(){return Q}),o.d(E,"sub",function(){return H}),o.d(E,"mul",function(){return Se}),o.d(E,"div",function(){return be}),o.d(E,"dist",function(){return Te}),o.d(E,"sqrDist",function(){return me}),o.d(E,"len",function(){return nt}),o.d(E,"sqrLen",function(){return Jt}),o.d(E,"forEach",function(){return Mt});var b=o("yU0y");function m(){var ve=new b.a(4);return b.a!=Float32Array&&(ve[0]=0,ve[1]=0,ve[2]=0,ve[3]=0),ve}function Y(ve){var ge=new b.a(4);return ge[0]=ve[0],ge[1]=ve[1],ge[2]=ve[2],ge[3]=ve[3],ge}function F(ve,ge,He,ot){var we=new b.a(4);return we[0]=ve,we[1]=ge,we[2]=He,we[3]=ot,we}function i(ve,ge){return ve[0]=ge[0],ve[1]=ge[1],ve[2]=ge[2],ve[3]=ge[3],ve}function Z(ve,ge,He,ot,we){return ve[0]=ge,ve[1]=He,ve[2]=ot,ve[3]=we,ve}function D(ve,ge,He){return ve[0]=ge[0]+He[0],ve[1]=ge[1]+He[1],ve[2]=ge[2]+He[2],ve[3]=ge[3]+He[3],ve}function $(ve,ge,He){return ve[0]=ge[0]-He[0],ve[1]=ge[1]-He[1],ve[2]=ge[2]-He[2],ve[3]=ge[3]-He[3],ve}function te(ve,ge,He){return ve[0]=ge[0]*He[0],ve[1]=ge[1]*He[1],ve[2]=ge[2]*He[2],ve[3]=ge[3]*He[3],ve}function fe(ve,ge,He){return ve[0]=ge[0]/He[0],ve[1]=ge[1]/He[1],ve[2]=ge[2]/He[2],ve[3]=ge[3]/He[3],ve}function K(ve,ge){return ve[0]=Math.ceil(ge[0]),ve[1]=Math.ceil(ge[1]),ve[2]=Math.ceil(ge[2]),ve[3]=Math.ceil(ge[3]),ve}function Ge(ve,ge){return ve[0]=Math.floor(ge[0]),ve[1]=Math.floor(ge[1]),ve[2]=Math.floor(ge[2]),ve[3]=Math.floor(ge[3]),ve}function pe(ve,ge,He){return ve[0]=Math.min(ge[0],He[0]),ve[1]=Math.min(ge[1],He[1]),ve[2]=Math.min(ge[2],He[2]),ve[3]=Math.min(ge[3],He[3]),ve}function Ze(ve,ge,He){return ve[0]=Math.max(ge[0],He[0]),ve[1]=Math.max(ge[1],He[1]),ve[2]=Math.max(ge[2],He[2]),ve[3]=Math.max(ge[3],He[3]),ve}function Pe(ve,ge){return ve[0]=Math.round(ge[0]),ve[1]=Math.round(ge[1]),ve[2]=Math.round(ge[2]),ve[3]=Math.round(ge[3]),ve}function mt(ve,ge,He){return ve[0]=ge[0]*He,ve[1]=ge[1]*He,ve[2]=ge[2]*He,ve[3]=ge[3]*He,ve}function De(ve,ge,He,ot){return ve[0]=ge[0]+He[0]*ot,ve[1]=ge[1]+He[1]*ot,ve[2]=ge[2]+He[2]*ot,ve[3]=ge[3]+He[3]*ot,ve}function At(ve,ge){var He=ge[0]-ve[0],ot=ge[1]-ve[1],we=ge[2]-ve[2],gt=ge[3]-ve[3];return Math.hypot(He,ot,we,gt)}function it(ve,ge){var He=ge[0]-ve[0],ot=ge[1]-ve[1],we=ge[2]-ve[2],gt=ge[3]-ve[3];return He*He+ot*ot+we*we+gt*gt}function vt(ve){var ge=ve[0],He=ve[1],ot=ve[2],we=ve[3];return Math.hypot(ge,He,ot,we)}function Je(ve){var ge=ve[0],He=ve[1],ot=ve[2],we=ve[3];return ge*ge+He*He+ot*ot+we*we}function _t(ve,ge){return ve[0]=-ge[0],ve[1]=-ge[1],ve[2]=-ge[2],ve[3]=-ge[3],ve}function wt(ve,ge){return ve[0]=1/ge[0],ve[1]=1/ge[1],ve[2]=1/ge[2],ve[3]=1/ge[3],ve}function ke(ve,ge){var He=ge[0],ot=ge[1],we=ge[2],gt=ge[3],C=He*He+ot*ot+we*we+gt*gt;return C>0&&(C=1/Math.sqrt(C)),ve[0]=He*C,ve[1]=ot*C,ve[2]=we*C,ve[3]=gt*C,ve}function Re(ve,ge){return ve[0]*ge[0]+ve[1]*ge[1]+ve[2]*ge[2]+ve[3]*ge[3]}function Ve(ve,ge,He,ot){var we=He[0]*ot[1]-He[1]*ot[0],gt=He[0]*ot[2]-He[2]*ot[0],C=He[0]*ot[3]-He[3]*ot[0],R=He[1]*ot[2]-He[2]*ot[1],q=He[1]*ot[3]-He[3]*ot[1],ce=He[2]*ot[3]-He[3]*ot[2],We=ge[0],qe=ge[1],Tt=ge[2],at=ge[3];return ve[0]=qe*ce-Tt*q+at*R,ve[1]=-(We*ce)+Tt*C-at*gt,ve[2]=We*q-qe*C+at*we,ve[3]=-(We*R)+qe*gt-Tt*we,ve}function dt(ve,ge,He,ot){var we=ge[0],gt=ge[1],C=ge[2],R=ge[3];return ve[0]=we+ot*(He[0]-we),ve[1]=gt+ot*(He[1]-gt),ve[2]=C+ot*(He[2]-C),ve[3]=R+ot*(He[3]-R),ve}function Me(ve,ge){ge=ge||1;var He,ot,we,gt,C,R;do He=b.c()*2-1,ot=b.c()*2-1,C=He*He+ot*ot;while(C>=1);do we=b.c()*2-1,gt=b.c()*2-1,R=we*we+gt*gt;while(R>=1);var q=Math.sqrt((1-C)/R);return ve[0]=ge*He,ve[1]=ge*ot,ve[2]=ge*we*q,ve[3]=ge*gt*q,ve}function ht(ve,ge,He){var ot=ge[0],we=ge[1],gt=ge[2],C=ge[3];return ve[0]=He[0]*ot+He[4]*we+He[8]*gt+He[12]*C,ve[1]=He[1]*ot+He[5]*we+He[9]*gt+He[13]*C,ve[2]=He[2]*ot+He[6]*we+He[10]*gt+He[14]*C,ve[3]=He[3]*ot+He[7]*we+He[11]*gt+He[15]*C,ve}function Zt(ve,ge,He){var ot=ge[0],we=ge[1],gt=ge[2],C=He[0],R=He[1],q=He[2],ce=He[3],We=ce*ot+R*gt-q*we,qe=ce*we+q*ot-C*gt,Tt=ce*gt+C*we-R*ot,at=-C*ot-R*we-q*gt;return ve[0]=We*ce+at*-C+qe*-q-Tt*-R,ve[1]=qe*ce+at*-R+Tt*-C-We*-q,ve[2]=Tt*ce+at*-q+We*-R-qe*-C,ve[3]=ge[3],ve}function Qt(ve){return ve[0]=0,ve[1]=0,ve[2]=0,ve[3]=0,ve}function ur(ve){return"vec4("+ve[0]+", "+ve[1]+", "+ve[2]+", "+ve[3]+")"}function oe(ve,ge){return ve[0]===ge[0]&&ve[1]===ge[1]&&ve[2]===ge[2]&&ve[3]===ge[3]}function Q(ve,ge){var He=ve[0],ot=ve[1],we=ve[2],gt=ve[3],C=ge[0],R=ge[1],q=ge[2],ce=ge[3];return Math.abs(He-C)<=b.b*Math.max(1,Math.abs(He),Math.abs(C))&&Math.abs(ot-R)<=b.b*Math.max(1,Math.abs(ot),Math.abs(R))&&Math.abs(we-q)<=b.b*Math.max(1,Math.abs(we),Math.abs(q))&&Math.abs(gt-ce)<=b.b*Math.max(1,Math.abs(gt),Math.abs(ce))}var H=$,Se=te,be=fe,Te=At,me=it,nt=vt,Jt=Je,Mt=function(){var ve=m();return function(ge,He,ot,we,gt,C){var R,q;for(He||(He=4),ot||(ot=0),we?q=Math.min(we*He+ot,ge.length):q=ge.length,R=ot;R<q;R+=He)ve[0]=ge[R],ve[1]=ge[R+1],ve[2]=ge[R+2],ve[3]=ge[R+3],gt(ve,ve,C),ge[R]=ve[0],ge[R+1]=ve[1],ge[R+2]=ve[2],ge[R+3]=ve[3];return ge}}()},bzyH:function(ze,E){},cSJO:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("MON2"),m=o("FV85"),Y=o("xfSm");function F($,te,fe){var K=te.filter(function(pe){return pe.target!==null&&pe.target.type===m.TargetTypeEnum.ClassProperty}),Ge=K.map(fe);return K.forEach(function(pe,Ze){var Pe="";Pe=pe.target.name.value();var mt=Ge[Ze];$[Pe]=mt}),$}function i($,te){return new($.bind.apply($,[void 0].concat(te)))}function Z($,te){if(Reflect.hasMetadata(Y.POST_CONSTRUCT,$)){var fe=Reflect.getMetadata(Y.POST_CONSTRUCT,$);try{te[fe.value]()}catch(K){throw new Error(b.POST_CONSTRUCT_ERROR($.name,K.message))}}}function D($,te,fe){var K=null;if(te.length>0){var Ge=te.filter(function(Ze){return Ze.target!==null&&Ze.target.type===m.TargetTypeEnum.ConstructorArgument}),pe=Ge.map(fe);K=i($,pe),K=F(K,te,fe)}else K=new $;return Z($,K),K}E.resolveInstance=D},cWXX:function(ze,E,o){"use strict";var b=o("cIOH"),m={"ant-skeleton":"ant-skeleton","ant-skeleton-header":"ant-skeleton-header","ant-skeleton-avatar":"ant-skeleton-avatar","ant-skeleton-avatar-circle":"ant-skeleton-avatar-circle","ant-skeleton-avatar-lg":"ant-skeleton-avatar-lg","ant-skeleton-avatar-sm":"ant-skeleton-avatar-sm","ant-skeleton-content":"ant-skeleton-content","ant-skeleton-title":"ant-skeleton-title","ant-skeleton-paragraph":"ant-skeleton-paragraph","ant-skeleton-with-avatar":"ant-skeleton-with-avatar","ant-skeleton-round":"ant-skeleton-round","ant-skeleton-active":"ant-skeleton-active","ant-skeleton-loading":"ant-skeleton-loading","ant-skeleton-button":"ant-skeleton-button","ant-skeleton-input":"ant-skeleton-input","ant-skeleton-image":"ant-skeleton-image","ant-skeleton-element":"ant-skeleton-element","ant-skeleton-button-circle":"ant-skeleton-button-circle","ant-skeleton-button-round":"ant-skeleton-button-round","ant-skeleton-button-lg":"ant-skeleton-button-lg","ant-skeleton-button-sm":"ant-skeleton-button-sm","ant-skeleton-input-lg":"ant-skeleton-input-lg","ant-skeleton-input-sm":"ant-skeleton-input-sm","ant-skeleton-image-circle":"ant-skeleton-image-circle","ant-skeleton-image-path":"ant-skeleton-image-path","ant-skeleton-image-svg":"ant-skeleton-image-svg","ant-skeleton-rtl":"ant-skeleton-rtl","ant-skeleton-loading-rtl":"ant-skeleton-loading-rtl"}},cWyK:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("/rf6");function m(it,vt,Je){if(it===null)return;for(var _t,wt,ke,Re,Ve,dt,Me,ht=0,Zt=0,Qt,ur=it.type,oe=ur==="FeatureCollection",Q=ur==="Feature",H=oe?it.features.length:1,Se=0;Se<H;Se++){Me=oe?it.features[Se].geometry:Q?it.geometry:it,Qt=Me?Me.type==="GeometryCollection":!1,Ve=Qt?Me.geometries.length:1;for(var be=0;be<Ve;be++){var Te=0,me=0;if(Re=Qt?Me.geometries[be]:Me,Re===null)continue;dt=Re.coordinates;var nt=Re.type;ht=Je&&(nt==="Polygon"||nt==="MultiPolygon")?1:0;switch(nt){case null:break;case"Point":if(vt(dt,Zt,Se,Te,me)===!1)return!1;Zt++,Te++;break;case"LineString":case"MultiPoint":for(_t=0;_t<dt.length;_t++){if(vt(dt[_t],Zt,Se,Te,me)===!1)return!1;Zt++,nt==="MultiPoint"&&Te++}nt==="LineString"&&Te++;break;case"Polygon":case"MultiLineString":for(_t=0;_t<dt.length;_t++){for(wt=0;wt<dt[_t].length-ht;wt++){if(vt(dt[_t][wt],Zt,Se,Te,me)===!1)return!1;Zt++}nt==="MultiLineString"&&Te++,nt==="Polygon"&&me++}nt==="Polygon"&&Te++;break;case"MultiPolygon":for(_t=0;_t<dt.length;_t++){for(me=0,wt=0;wt<dt[_t].length;wt++){for(ke=0;ke<dt[_t][wt].length-ht;ke++){if(vt(dt[_t][wt][ke],Zt,Se,Te,me)===!1)return!1;Zt++}me++}Te++}break;case"GeometryCollection":for(_t=0;_t<Re.geometries.length;_t++)if(m(Re.geometries[_t],vt,Je)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}function Y(it,vt,Je,_t){var wt=Je;return m(it,function(ke,Re,Ve,dt,Me){Re===0&&Je===void 0?wt=ke:wt=vt(wt,ke,Re,Ve,dt,Me)},_t),wt}function F(it,vt){var Je;switch(it.type){case"FeatureCollection":for(Je=0;Je<it.features.length&&!(vt(it.features[Je].properties,Je)===!1);Je++);break;case"Feature":vt(it.properties,0);break}}function i(it,vt,Je){var _t=Je;return F(it,function(wt,ke){ke===0&&Je===void 0?_t=wt:_t=vt(_t,wt,ke)}),_t}function Z(it,vt){if(it.type==="Feature")vt(it,0);else if(it.type==="FeatureCollection")for(var Je=0;Je<it.features.length&&!(vt(it.features[Je],Je)===!1);Je++);}function D(it,vt,Je){var _t=Je;return Z(it,function(wt,ke){ke===0&&Je===void 0?_t=wt:_t=vt(_t,wt,ke)}),_t}function $(it){var vt=[];return m(it,function(Je){vt.push(Je)}),vt}function te(it,vt){var Je,_t,wt,ke,Re,Ve,dt,Me,ht,Zt,Qt=0,ur=it.type==="FeatureCollection",oe=it.type==="Feature",Q=ur?it.features.length:1;for(Je=0;Je<Q;Je++){for(Ve=ur?it.features[Je].geometry:oe?it.geometry:it,Me=ur?it.features[Je].properties:oe?it.properties:{},ht=ur?it.features[Je].bbox:oe?it.bbox:void 0,Zt=ur?it.features[Je].id:oe?it.id:void 0,dt=Ve?Ve.type==="GeometryCollection":!1,Re=dt?Ve.geometries.length:1,wt=0;wt<Re;wt++){if(ke=dt?Ve.geometries[wt]:Ve,ke===null){if(vt(null,Qt,Me,ht,Zt)===!1)return!1;continue}switch(ke.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(vt(ke,Qt,Me,ht,Zt)===!1)return!1;break}case"GeometryCollection":{for(_t=0;_t<ke.geometries.length;_t++)if(vt(ke.geometries[_t],Qt,Me,ht,Zt)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}Qt++}}function fe(it,vt,Je){var _t=Je;return te(it,function(wt,ke,Re,Ve,dt){ke===0&&Je===void 0?_t=wt:_t=vt(_t,wt,ke,Re,Ve,dt)}),_t}function K(it,vt){te(it,function(Je,_t,wt,ke,Re){var Ve=Je===null?null:Je.type;switch(Ve){case null:case"Point":case"LineString":case"Polygon":return vt(b.feature(Je,wt,{bbox:ke,id:Re}),_t,0)===!1?!1:void 0}var dt;switch(Ve){case"MultiPoint":dt="Point";break;case"MultiLineString":dt="LineString";break;case"MultiPolygon":dt="Polygon";break}for(var Me=0;Me<Je.coordinates.length;Me++){var ht=Je.coordinates[Me],Zt={type:dt,coordinates:ht};if(vt(b.feature(Zt,wt),_t,Me)===!1)return!1}})}function Ge(it,vt,Je){var _t=Je;return K(it,function(wt,ke,Re){ke===0&&Re===0&&Je===void 0?_t=wt:_t=vt(_t,wt,ke,Re)}),_t}function pe(it,vt){K(it,function(Je,_t,wt){var ke=0;if(!Je.geometry)return;var Re=Je.geometry.type;if(Re==="Point"||Re==="MultiPoint")return;var Ve,dt=0,Me=0,ht=0;if(m(Je,function(Zt,Qt,ur,oe,Q){if(Ve===void 0||_t>dt||oe>Me||Q>ht){Ve=Zt,dt=_t,Me=oe,ht=Q,ke=0;return}var H=b.lineString([Ve,Zt],Je.properties);if(vt(H,_t,wt,Q,ke)===!1)return!1;ke++,Ve=Zt})===!1)return!1})}function Ze(it,vt,Je){var _t=Je,wt=!1;return pe(it,function(ke,Re,Ve,dt,Me){wt===!1&&Je===void 0?_t=ke:_t=vt(_t,ke,Re,Ve,dt,Me),wt=!0}),_t}function Pe(it,vt){if(!it)throw new Error("geojson is required");K(it,function(Je,_t,wt){if(Je.geometry===null)return;var ke=Je.geometry.type,Re=Je.geometry.coordinates;switch(ke){case"LineString":if(vt(Je,_t,wt,0,0)===!1)return!1;break;case"Polygon":for(var Ve=0;Ve<Re.length;Ve++)if(vt(b.lineString(Re[Ve],Je.properties),_t,wt,Ve)===!1)return!1;break}})}function mt(it,vt,Je){var _t=Je;return Pe(it,function(wt,ke,Re,Ve){ke===0&&Je===void 0?_t=wt:_t=vt(_t,wt,ke,Re,Ve)}),_t}function De(it,vt){if(vt=vt||{},!b.isObject(vt))throw new Error("options is invalid");var Je=vt.featureIndex||0,_t=vt.multiFeatureIndex||0,wt=vt.geometryIndex||0,ke=vt.segmentIndex||0,Re=vt.properties,Ve;switch(it.type){case"FeatureCollection":Je<0&&(Je=it.features.length+Je),Re=Re||it.features[Je].properties,Ve=it.features[Je].geometry;break;case"Feature":Re=Re||it.properties,Ve=it.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Ve=it;break;default:throw new Error("geojson is invalid")}if(Ve===null)return null;var dt=Ve.coordinates;switch(Ve.type){case"Point":case"MultiPoint":return null;case"LineString":return ke<0&&(ke=dt.length+ke-1),b.lineString([dt[ke],dt[ke+1]],Re,vt);case"Polygon":return wt<0&&(wt=dt.length+wt),ke<0&&(ke=dt[wt].length+ke-1),b.lineString([dt[wt][ke],dt[wt][ke+1]],Re,vt);case"MultiLineString":return _t<0&&(_t=dt.length+_t),ke<0&&(ke=dt[_t].length+ke-1),b.lineString([dt[_t][ke],dt[_t][ke+1]],Re,vt);case"MultiPolygon":return _t<0&&(_t=dt.length+_t),wt<0&&(wt=dt[_t].length+wt),ke<0&&(ke=dt[_t][wt].length-ke-1),b.lineString([dt[_t][wt][ke],dt[_t][wt][ke+1]],Re,vt)}throw new Error("geojson is invalid")}function At(it,vt){if(vt=vt||{},!b.isObject(vt))throw new Error("options is invalid");var Je=vt.featureIndex||0,_t=vt.multiFeatureIndex||0,wt=vt.geometryIndex||0,ke=vt.coordIndex||0,Re=vt.properties,Ve;switch(it.type){case"FeatureCollection":Je<0&&(Je=it.features.length+Je),Re=Re||it.features[Je].properties,Ve=it.features[Je].geometry;break;case"Feature":Re=Re||it.properties,Ve=it.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Ve=it;break;default:throw new Error("geojson is invalid")}if(Ve===null)return null;var dt=Ve.coordinates;switch(Ve.type){case"Point":return b.point(dt,Re,vt);case"MultiPoint":return _t<0&&(_t=dt.length+_t),b.point(dt[_t],Re,vt);case"LineString":return ke<0&&(ke=dt.length+ke),b.point(dt[ke],Re,vt);case"Polygon":return wt<0&&(wt=dt.length+wt),ke<0&&(ke=dt[wt].length+ke),b.point(dt[wt][ke],Re,vt);case"MultiLineString":return _t<0&&(_t=dt.length+_t),ke<0&&(ke=dt[_t].length+ke),b.point(dt[_t][ke],Re,vt);case"MultiPolygon":return _t<0&&(_t=dt.length+_t),wt<0&&(wt=dt[_t].length+wt),ke<0&&(ke=dt[_t][wt].length-ke),b.point(dt[_t][wt][ke],Re,vt)}throw new Error("geojson is invalid")}E.coordEach=m,E.coordReduce=Y,E.propEach=F,E.propReduce=i,E.featureEach=Z,E.featureReduce=D,E.coordAll=$,E.geomEach=te,E.geomReduce=fe,E.flattenEach=K,E.flattenReduce=Ge,E.segmentEach=pe,E.segmentReduce=Ze,E.lineEach=Pe,E.lineReduce=mt,E.findSegment=De,E.findPoint=At},cZ5Q:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("MON2"),m=o("xfSm");function Y(){return function(F){if(Reflect.hasOwnMetadata(m.PARAM_TYPES,F))throw new Error(b.DUPLICATED_INJECTABLE_DECORATOR);var i=Reflect.getMetadata(m.DESIGN_PARAM_TYPES,F)||[];return Reflect.defineMetadata(m.PARAM_TYPES,i,F),F}}E.injectable=Y},cZlC:function(ze,E,o){"use strict";o.d(E,"b",function(){return b}),o.d(E,"c",function(){return m}),o.d(E,"a",function(){return Y});var b;(function(F){F.LINEAR="linear",F.POWER="power",F.LOG="log",F.IDENTITY="identity",F.TIME="time",F.QUANTILE="quantile",F.QUANTIZE="quantize",F.THRESHOLD="threshold",F.CAT="cat"})(b||(b={}));var m;(function(F){F.CONSTANT="constant",F.VARIABLE="variable"})(m||(m={}));var Y;(function(F){F[F.Attribute=0]="Attribute",F[F.InstancedAttribute=1]="InstancedAttribute",F[F.Uniform=2]="Uniform"})(Y||(Y={}))},"cq/+":function(ze,E,o){var b=o("mc0g"),m=b();ze.exports=m},cvCv:function(ze,E){function o(b){return function(){return b}}ze.exports=o},d9O0:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=0;function m(){return b++}E.id=m},dQpi:function(ze,E,o){var b=o("yGk4"),m=o("vN+2"),Y=o("rEGp"),F=1/0,i=b&&1/Y(new b([,-0]))[1]==F?function(Z){return new b(Z)}:m;ze.exports=i},dTAl:function(ze,E,o){var b=o("GoyQ"),m=Object.create,Y=function(){function F(){}return function(i){if(!b(i))return{};if(m)return m(i);F.prototype=i;var Z=new F;return F.prototype=void 0,Z}}();ze.exports=Y},dVn5:function(ze,E){var o=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function b(m){return m.match(o)||[]}ze.exports=b},dX1H:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("xfSm"),m=o("d9O0"),Y=o("GXnB"),F=o("zxMA"),i=function(){function Z(D,$,te,fe){this.id=m.id(),this.type=D,this.serviceIdentifier=te,this.name=new F.QueryableString($||""),this.metadata=new Array;var K=null;typeof fe=="string"?K=new Y.Metadata(b.NAMED_TAG,fe):fe instanceof Y.Metadata&&(K=fe),K!==null&&this.metadata.push(K)}return Z.prototype.hasTag=function(D){for(var $=0,te=this.metadata;$<te.length;$++){var fe=te[$];if(fe.key===D)return!0}return!1},Z.prototype.isArray=function(){return this.hasTag(b.MULTI_INJECT_TAG)},Z.prototype.matchesArray=function(D){return this.matchesTag(b.MULTI_INJECT_TAG)(D)},Z.prototype.isNamed=function(){return this.hasTag(b.NAMED_TAG)},Z.prototype.isTagged=function(){return this.metadata.some(function(D){return D.key!==b.INJECT_TAG&&D.key!==b.MULTI_INJECT_TAG&&D.key!==b.NAME_TAG&&D.key!==b.UNMANAGED_TAG&&D.key!==b.NAMED_TAG})},Z.prototype.isOptional=function(){return this.matchesTag(b.OPTIONAL_TAG)(!0)},Z.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(D){return D.key===b.NAMED_TAG})[0]:null},Z.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(D){return D.key!==b.INJECT_TAG&&D.key!==b.MULTI_INJECT_TAG&&D.key!==b.NAME_TAG&&D.key!==b.UNMANAGED_TAG&&D.key!==b.NAMED_TAG}):null},Z.prototype.matchesNamedTag=function(D){return this.matchesTag(b.NAMED_TAG)(D)},Z.prototype.matchesTag=function(D){var $=this;return function(te){for(var fe=0,K=$.metadata;fe<K.length;fe++){var Ge=K[fe];if(Ge.key===D&&Ge.value===te)return!0}return!1}},Z}();E.Target=i},doU7:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};E.BindingCount=b},dt0z:function(ze,E,o){var b=o("zoYe");function m(Y){return Y==null?"":b(Y)}ze.exports=m},dxzI:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("d9O0"),m=function(){function F(i){this.id=b.id(),this.registry=i}return F}();E.ContainerModule=m;var Y=function(){function F(i){this.id=b.id(),this.registry=i}return F}();E.AsyncContainerModule=Y},eUgh:function(ze,E){function o(b,m){for(var Y=-1,F=b==null?0:b.length,i=Array(F);++Y<F;)i[Y]=m(b[Y],Y,b);return i}ze.exports=o},"eg+a":function(ze,E,o){"use strict";o.d(E,"a",function(){return b});var b=["loaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"]},fX6N:function(ze,E,o){"use strict";o.d(E,"d",function(){return _f}),o.d(E,"b",function(){return Wc}),o.d(E,"a",function(){return ml});var b=o("mNvP"),m=o("uhBA"),Y=o.n(m),F=o("4cb6"),i=o("APxj"),Z=o.n(i),D=o("bB6j"),$=o("lSNA"),te=o.n($),fe=o("lwsE"),K=o.n(fe),Ge=o("W8MJ"),pe=o.n(Ge),Ze=o("Hel2"),Pe=o("rxlC"),mt=o.n(Pe);function De(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function At(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?De(Object(N),!0).forEach(function(G){te()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):De(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}function it(re,se){var N;if(typeof Symbol=="undefined"||re[Symbol.iterator]==null){if(Array.isArray(re)||(N=vt(re))||se&&re&&typeof re.length=="number"){N&&(re=N);var G=0,Ae=function(){};return{s:Ae,n:function(){return G>=re.length?{done:!0}:{done:!1,value:re[G++]}},e:function(Ir){throw Ir},f:Ae}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ct=!0,Xt=!1,sr;return{s:function(){N=re[Symbol.iterator]()},n:function(){var Ir=N.next();return ct=Ir.done,Ir},e:function(Ir){Xt=!0,sr=Ir},f:function(){try{!ct&&N.return!=null&&N.return()}finally{if(Xt)throw sr}}}}function vt(re,se){if(!re)return;if(typeof re=="string")return Je(re,se);var N=Object.prototype.toString.call(re).slice(8,-1);if(N==="Object"&&re.constructor&&(N=re.constructor.name),N==="Map"||N==="Set")return Array.from(re);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return Je(re,se)}function Je(re,se){(se==null||se>re.length)&&(se=re.length);for(var N=0,G=new Array(se);N<se;N++)G[N]=re[N];return G}var _t=30;function wt(re){var se=re.characterSet,N=re.getFontWidth,G=re.fontHeight,Ae=re.buffer,ct=re.maxCanvasWidth,Xt=re.mapping,sr=Xt===void 0?{}:Xt,or=re.xOffset,Ir=or===void 0?0:or,an=re.yOffset,Gn=an===void 0?0:an,ea=0,la=Ir;Array.from(se).forEach(function(Fa,yi){if(!sr[Fa]){var Ja=N(Fa,yi);la+_t>ct&&(la=0,ea++),sr[Fa]={x:la,y:Gn+ea*_t,width:_t,height:_t,advance:Ja},la+=_t}});var qa=G+Ae*2;return{mapping:sr,xOffset:la,yOffset:Gn+ea*qa,canvasHeight:Ve(Gn+(ea+1)*qa)}}function ke(re,se,N){var G=0,Ae=0,ct=0,Xt=[],sr={},or=it(re),Ir;try{for(or.s();!(Ir=or.n()).done;){var an=Ir.value;if(!sr[an.id]){var Gn=an.height,ea=an.width;G+ea+se>N&&(Re(sr,Xt,Ae),G=0,Ae=ct+Ae+se,ct=0,Xt=[]),Xt.push({icon:an,xOffset:G}),G=G+ea+se,ct=Math.max(ct,Gn)}}}catch(qa){or.e(qa)}finally{or.f()}Xt.length>0&&Re(sr,Xt,Ae);var la=Ve(ct+Ae+se);return{mapping:sr,canvasHeight:la}}function Re(re,se,N){var G=it(se),Ae;try{for(G.s();!(Ae=G.n()).done;){var ct=Ae.value,Xt=ct.icon,sr=ct.xOffset;re[Xt.id]=At(At({},Xt),{},{x:sr,y:N,image:Xt.image})}}catch(or){G.e(or)}finally{G.f()}}function Ve(re){return Math.pow(2,Math.ceil(Math.log2(re)))}var dt,Me,ht;function Zt(re,se){var N;if(typeof Symbol=="undefined"||re[Symbol.iterator]==null){if(Array.isArray(re)||(N=Qt(re))||se&&re&&typeof re.length=="number"){N&&(re=N);var G=0,Ae=function(){};return{s:Ae,n:function(){return G>=re.length?{done:!0}:{done:!1,value:re[G++]}},e:function(Ir){throw Ir},f:Ae}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ct=!0,Xt=!1,sr;return{s:function(){N=re[Symbol.iterator]()},n:function(){var Ir=N.next();return ct=Ir.done,Ir},e:function(Ir){Xt=!0,sr=Ir},f:function(){try{!ct&&N.return!=null&&N.return()}finally{if(Xt)throw sr}}}}function Qt(re,se){if(!re)return;if(typeof re=="string")return ur(re,se);var N=Object.prototype.toString.call(re).slice(8,-1);if(N==="Object"&&re.constructor&&(N=re.constructor.name),N==="Map"||N==="Set")return Array.from(re);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return ur(re,se)}function ur(re,se){(se==null||se>re.length)&&(se=re.length);for(var N=0,G=new Array(se);N<se;N++)G[N]=re[N];return G}function oe(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function Q(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?oe(Object(N),!0).forEach(function(G){te()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):oe(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}var H=we(),Se="sans-serif",be="normal",Te=24,me=3,nt=.25,Jt=8,Mt=1024,ve=1,ge=1,He=3,ot=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function we(){for(var re=[],se=32;se<128;se++)re.push(String.fromCharCode(se));return re}function gt(re,se,N,G){re.font="".concat(G," ").concat(N,"px ").concat(se),re.fillStyle="black",re.textBaseline="middle"}function C(re,se){for(var N=0;N<re.length;N++)se.data[4*N+3]=re[N]}var R=(dt=Object(F.injectable)(),dt(Me=(ht=function(){function re(){K()(this,re),this.fontAtlas=void 0,this.iconFontGlyphs={},this.fontOptions=void 0,this.key=void 0,this.cache=new Ze.b(He)}return pe()(re,[{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:Se,fontWeight:be,characterSet:H,fontSize:Te,buffer:me,sdf:!0,cutoff:nt,radius:Jt},this.key=""}},{key:"addIconGlyphs",value:function(N){var G=this;N.forEach(function(Ae){G.iconFontGlyphs[Ae.name]=Ae.unicode})}},{key:"getGlyph",value:function(N){return this.iconFontGlyphs[N]?String.fromCharCode(parseInt(this.iconFontGlyphs[N],16)):""}},{key:"setFontOptions",value:function(N){this.fontOptions=Q(Q({},this.fontOptions),N),this.key=this.getKey();var G=this.getNewChars(this.key,this.fontOptions.characterSet),Ae=this.cache.get(this.key);if(Ae&&G.length===0)return;var ct=this.generateFontAtlas(this.key,G,Ae);this.fontAtlas=ct,this.cache.set(this.key,ct)}},{key:"destroy",value:function(){this.cache.clear()}},{key:"generateFontAtlas",value:function(N,G,Ae){var ct=this.fontOptions,Xt=ct.fontFamily,sr=ct.fontWeight,or=ct.fontSize,Ir=ct.buffer,an=ct.sdf,Gn=ct.radius,ea=ct.cutoff,la=Ae&&Ae.data;la||(la=document.createElement("canvas"),la.width=Mt);var qa=la.getContext("2d");gt(qa,Xt,or,sr);var Fa=wt(Q({getFontWidth:function(hc){return qa.measureText(hc).width},fontHeight:or*ge,buffer:Ir,characterSet:G,maxCanvasWidth:Mt},Ae&&{mapping:Ae.mapping,xOffset:Ae.xOffset,yOffset:Ae.yOffset})),yi=Fa.mapping,Ja=Fa.canvasHeight,Bi=Fa.xOffset,So=Fa.yOffset;if(la.height!==Ja){var yo=qa.getImageData(0,0,la.width,la.height);la.height=Ja,qa.putImageData(yo,0,0)}if(gt(qa,Xt,or,sr),an){var Hi=new mt.a(or,Ir,Gn,ea,Xt,sr),ko=qa.getImageData(0,0,Hi.size,Hi.size),Qa=Zt(G),lo;try{for(Qa.s();!(lo=Qa.n()).done;){var iu=lo.value;C(Hi.draw(iu),ko),qa.putImageData(ko,yi[iu].x,yi[iu].y)}}catch(Ao){Qa.e(Ao)}finally{Qa.f()}}else{var bi=Zt(G),Ni;try{for(bi.s();!(Ni=bi.n()).done;){var xa=Ni.value;qa.fillText(xa,yi[xa].x,yi[xa].y+or*ve)}}catch(Ao){bi.e(Ao)}finally{bi.f()}}return{xOffset:Bi,yOffset:So,mapping:yi,data:la,width:la.width,height:la.height}}},{key:"getKey",value:function(){var N=this.fontOptions,G=N.fontFamily,Ae=N.fontWeight,ct=N.fontSize,Xt=N.buffer,sr=N.sdf,or=N.radius,Ir=N.cutoff;return sr?"".concat(G," ").concat(Ae," ").concat(ct," ").concat(Xt," ").concat(or," ").concat(Ir):"".concat(G," ").concat(Ae," ").concat(ct," ").concat(Xt)}},{key:"getNewChars",value:function(N,G){var Ae=this.cache.get(N);if(!Ae)return G;var ct=[],Xt=Ae.mapping,sr=new Set(Object.keys(Xt)),or=new Set(G);return or.forEach(function(Ir){sr.has(Ir)||ct.push(Ir)}),ct}},{key:"scale",get:function(){return ge}},{key:"canvas",get:function(){var N=this.cache.get(this.key);return N&&N.data}},{key:"mapping",get:function(){var N=this.cache.get(this.key);return N&&N.mapping}}]),re}(),ht))||Me),q=o("7W2i"),ce=o.n(q),We=o("a1gu"),qe=o.n(We),Tt=o("Nsbk"),at=o.n(Tt),Ut,J,Qe;function ne(re){var se=et();return function(){var G=at()(re),Ae;if(se){var ct=at()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function et(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var kt=3,dr=1024,Ye=64,xt=(Ut=Object(F.injectable)(),Ut(J=(Qe=function(re){ce()(N,re);var se=ne(N);function N(){var G;K()(this,N);for(var Ae=arguments.length,ct=new Array(Ae),Xt=0;Xt<Ae;Xt++)ct[Xt]=arguments[Xt];return G=se.call.apply(se,[this].concat(ct)),G.canvasHeight=void 0,G.texture=void 0,G.canvas=void 0,G.iconData=void 0,G.iconMap=void 0,G.ctx=void 0,G}return pe()(N,[{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(Ae,ct){var Xt=this,sr=new Image;if(this.hasImage(Ae))throw new Error("Image Id already exists");this.iconData.push({id:Ae,width:Ye,height:Ye}),this.updateIconMap(),this.loadImage(ct).then(function(or){sr=or;var Ir=Xt.iconData.find(function(an){return an.id===Ae});Ir&&(Ir.image=sr),Xt.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(Ae){return this.iconMap.hasOwnProperty(Ae)}},{key:"removeImage",value:function(Ae){this.hasImage(Ae)&&(this.iconData=this.iconData.filter(function(ct){return ct.id!==Ae}),delete this.iconMap[Ae],this.update())}},{key:"destroy",value:function(){this.iconData=[],this.iconMap={}}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var Ae=this;this.canvas.width=dr,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(ct){var Xt=Ae.iconMap[ct],sr=Xt.x,or=Xt.y,Ir=Xt.image;Ir&&Ae.ctx.drawImage(Ir,sr,or,Ye,Ye)})}},{key:"updateIconMap",value:function(){var Ae=ke(this.iconData,kt,dr),ct=Ae.mapping,Xt=Ae.canvasHeight;this.iconMap=ct,this.canvasHeight=Xt}},{key:"loadImage",value:function(Ae){return new Promise(function(ct,Xt){if(Ae instanceof HTMLImageElement){ct(Ae);return}var sr=new Image;sr.crossOrigin="anonymous",sr.onload=function(){ct(sr)},sr.onerror=function(){Xt(new Error("Could not load image at "+Ae))},sr.src=Ae instanceof File?URL.createObjectURL(Ae):Ae})}}]),N}(m.EventEmitter),Qe))||J),bt=o("J4zp"),Et=o.n(bt),Fe=o("IOcx"),pt,yt,Ht,hr=(pt=Object(F.injectable)(),pt(yt=(Ht=function(){function re(){K()(this,re),this.viewport=void 0,this.overridedViewProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0,this.jitteredProjectionMatrix=void 0,this.viewMatrixInverse=void 0,this.cameraPosition=void 0}return pe()(re,[{key:"init",value:function(){}},{key:"update",value:function(N){this.viewport=N,this.viewMatrixInverse=Fe.b.invert(Fe.b.create(),this.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var N=this.viewport.getCenter(),G=Et()(N,2),Ae=G[0],ct=G[1];return[Ae,ct]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(N,G){return this.viewport.projectFlat(N,G)}},{key:"setViewProjectionMatrix",value:function(N){this.overridedViewProjectionMatrix=N}},{key:"jitterProjectionMatrix",value:function(N,G){var Ae=Fe.b.fromTranslation(Fe.b.create(),[N,G,0]);this.jitteredProjectionMatrix=Fe.b.multiply(Fe.b.create(),Ae,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=Fe.b.multiply(Fe.b.create(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),re}(),Ht))||yt),Hr,gr,Bn;function zn(re,se){var N;if(typeof Symbol=="undefined"||re[Symbol.iterator]==null){if(Array.isArray(re)||(N=oa(re))||se&&re&&typeof re.length=="number"){N&&(re=N);var G=0,Ae=function(){};return{s:Ae,n:function(){return G>=re.length?{done:!0}:{done:!1,value:re[G++]}},e:function(Ir){throw Ir},f:Ae}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ct=!0,Xt=!1,sr;return{s:function(){N=re[Symbol.iterator]()},n:function(){var Ir=N.next();return ct=Ir.done,Ir},e:function(Ir){Xt=!0,sr=Ir},f:function(){try{!ct&&N.return!=null&&N.return()}finally{if(Xt)throw sr}}}}function oa(re,se){if(!re)return;if(typeof re=="string")return $n(re,se);var N=Object.prototype.toString.call(re).slice(8,-1);if(N==="Object"&&re.constructor&&(N=re.constructor.name),N==="Map"||N==="Set")return Array.from(re);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return $n(re,se)}function $n(re,se){(se==null||se>re.length)&&(se=re.length);for(var N=0,G=new Array(se);N<se;N++)G[N]=re[N];return G}var Yn=(Hr=Object(F.injectable)(),Hr(gr=(Bn=function(){function re(){K()(this,re),this.container=void 0,this.controlCorners=void 0,this.controlContainer=void 0,this.scene=void 0,this.mapsService=void 0,this.controls=[],this.unAddControls=[]}return pe()(re,[{key:"init",value:function(N,G){this.container=N.container,this.scene=G,this.mapsService=G.get(D.a.IMapService),this.initControlPos()}},{key:"addControl",value:function(N,G){var Ae=G.get(D.a.IMapService);Ae.map?(N.addTo(this.scene),this.controls.push(N)):this.unAddControls.push(N)}},{key:"getControlByName",value:function(N){return this.controls.find(function(G){return G.controlOption.name===N})}},{key:"removeControl",value:function(N){var G=this.controls.indexOf(N);return G>-1&&this.controls.splice(G,1),N.remove(),this}},{key:"addControls",value:function(){var N=this;this.unAddControls.forEach(function(G){G.addTo(N.scene),N.controls.push(G)}),this.unAddControls=[]}},{key:"destroy",value:function(){var N=zn(this.controls),G;try{for(N.s();!(G=N.n()).done;){var Ae=G.value;Ae.remove()}}catch(ct){N.e(ct)}finally{N.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var N=this.controlCorners={},G="l7-",Ae=this.controlContainer=Ze.a.create("div",G+"control-container",this.container);function ct(Xt,sr){var or=G+Xt+" "+G+sr;N[Xt+sr]=Ze.a.create("div",or,Ae)}ct("top","left"),ct("top","right"),ct("bottom","left"),ct("bottom","right")}},{key:"clearControlPos",value:function(){for(var N in this.controlCorners)this.controlCorners[N]&&Ze.a.remove(this.controlCorners[N]);this.controlContainer&&Ze.a.remove(this.controlContainer),delete this.controlCorners,delete this.controlContainer}}]),re}(),Bn))||gr),On,U,W,le=(On=Object(F.injectable)(),On(U=(W=function(){function re(){K()(this,re),this.container=void 0,this.scene=void 0,this.mapsService=void 0,this.markers=[],this.markerLayers=[],this.unAddMarkers=[],this.unAddMarkerLayers=[]}return pe()(re,[{key:"addMarkerLayer",value:function(N){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(N),N.addTo(this.scene)):this.unAddMarkerLayers.push(N)}},{key:"removeMarkerLayer",value:function(N){N.destroy(),this.markerLayers.indexOf(N);var G=this.markerLayers.indexOf(N);G>-1&&this.markerLayers.splice(G,1)}},{key:"addMarker",value:function(N){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(N),N.addTo(this.scene)):this.unAddMarkers.push(N)}},{key:"addMarkers",value:function(){var N=this;this.unAddMarkers.forEach(function(G){G.addTo(N.scene),N.markers.push(G)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var N=this;this.unAddMarkerLayers.forEach(function(G){N.markerLayers.push(G),G.addTo(N.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(N){N.remove(),this.markers.indexOf(N);var G=this.markers.indexOf(N);G>-1&&this.markers.splice(G,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(N){this.scene=N,this.mapsService=N.get(D.a.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(N){N.remove()}),this.markers=[],this.markerLayers.forEach(function(N){N.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(N){N.destroy()}}]),re}(),W))||U),xe,st,Ct,Bt=(xe=Object(F.injectable)(),xe(st=(Ct=function(){function re(){K()(this,re),this.scene=void 0,this.popup=void 0,this.mapsService=void 0,this.unAddPopup=void 0}return pe()(re,[{key:"removePopup",value:function(N){N.remove()}},{key:"destroy",value:function(){this.popup.remove()}},{key:"addPopup",value:function(N){this.popup&&this.popup.remove(),this.mapsService.map&&this.mapsService.getMarkerContainer()?(N.addTo(this.scene),this.popup=N):this.unAddPopup=N}},{key:"initPopup",value:function(){this.unAddPopup&&(this.addPopup(this.unAddPopup),this.unAddPopup=null)}},{key:"init",value:function(N){this.scene=N,this.mapsService=N.get(D.a.IMapService)}}]),re}(),Ct))||st),Xe=o("QkVN"),Lt=o.n(Xe),lr={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo\u6D4B\u8BD5\u5730\u56FEtoken\uFF0C\u5982\u679C\u751F\u4EA7\u73AF\u5883\u4E2D\u4F7F\u7528\u53BB\u5BF9\u5E94\u5730\u56FE\u8BF7\u6CE8\u518CToken",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},zr=lr,Vr,cr,Ur;function Mn(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function ln(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?Mn(Object(N),!0).forEach(function(G){te()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):Mn(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}var er={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},tn={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",selectColor:"blue",enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15}},hn=(Vr=Object(F.injectable)(),Vr(cr=(Ur=function(){function re(){K()(this,re),this.sceneConfigCache={},this.layerConfigCache={}}return pe()(re,[{key:"getSceneConfig",value:function(N){return this.sceneConfigCache[N]}},{key:"getSceneWarninfo",value:function(N){return zr[N]}},{key:"setSceneConfig",value:function(N,G){this.sceneConfigCache[N]=ln(ln({},er),G)}},{key:"getLayerConfig",value:function(N){return this.layerConfigCache[N]}},{key:"setLayerConfig",value:function(N,G,Ae){this.layerConfigCache[G]=ln({},Lt()({},this.sceneConfigCache[N],tn,Ae))}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),re}(),Ur))||cr),xn=o("yG8O"),yn=o.n(xn),vn=o("U+yc"),Pn=o.n(vn),Va=o("1ABj"),va=Math.PI/180,Ma=512,Ia=4003e4;function Wi(re){var se=re.latitude,N=se===void 0?0:se,G=re.zoom,Ae=G===void 0?0:G,ct=re.scale,Xt=re.highPrecision,sr=Xt===void 0?!1:Xt,or=re.flipY,Ir=or===void 0?!1:or;ct=ct!==void 0?ct:Math.pow(2,Ae);var an={},Gn=Ma*ct,ea=Math.cos(N*va),la=Gn/360,qa=la/ea,Fa=Gn/Ia/ea;if(an.pixelsPerMeter=[Fa,-Fa,Fa],an.metersPerPixel=[1/Fa,-1/Fa,1/Fa],an.pixelsPerDegree=[la,-qa,Fa],an.degreesPerPixel=[1/la,-1/qa,1/Fa],sr){var yi=va*Math.tan(N*va)/ea,Ja=la*yi/2,Bi=Gn/Ia*yi,So=Bi/qa*Fa;an.pixelsPerDegree2=[0,-Ja,Bi],an.pixelsPerMeter2=[So,0,So],Ir&&(an.pixelsPerDegree2[1]=-an.pixelsPerDegree2[1],an.pixelsPerMeter2[1]=-an.pixelsPerMeter2[1])}return Ir&&(an.pixelsPerMeter[1]=-an.pixelsPerMeter[1],an.metersPerPixel[1]=-an.metersPerPixel[1],an.pixelsPerDegree[1]=-an.pixelsPerDegree[1],an.degreesPerPixel[1]=-an.degreesPerPixel[1]),an}var da=o("HthE"),di,ga,ya,fa,Si,ns,Xi=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Vo=(di=Object(F.injectable)(),ga=Object(F.inject)(D.a.ICameraService),di(ya=(fa=(ns=function(){function re(){K()(this,re),this.needRefresh=!0,yn()(this,"cameraService",Si,this),this.coordinateSystem=void 0,this.viewportCenter=void 0,this.viewportCenterProjection=void 0,this.pixelsPerDegree=void 0,this.pixelsPerDegree2=void 0,this.pixelsPerMeter=void 0}return pe()(re,[{key:"refresh",value:function(){var N=this.cameraService.getZoom(),G=this.cameraService.getZoomScale(),Ae=this.cameraService.getCenter(),ct=Wi({latitude:Ae[1],zoom:N}),Xt=ct.pixelsPerMeter,sr=ct.pixelsPerDegree;this.viewportCenter=Ae,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=Xt,this.pixelsPerDegree=sr,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===da.a.LNGLAT||this.coordinateSystem===da.a.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===da.a.LNGLAT_OFFSET?this.calculateLnglatOffset(Ae,N):this.coordinateSystem===da.a.P20_OFFSET&&this.calculateLnglatOffset(Ae,N,G,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(N){this.coordinateSystem=N}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(N,G,Ae,ct){var Xt=Wi({latitude:N[1],zoom:G,scale:Ae,flipY:ct,highPrecision:!0}),sr=Xt.pixelsPerMeter,or=Xt.pixelsPerDegree,Ir=Xt.pixelsPerDegree2,an=this.cameraService.getViewMatrix(),Gn=this.cameraService.getProjectionMatrix(),ea=Fe.b.multiply([],Gn,an),la=this.cameraService.projectFlat([Math.fround(N[0]),Math.fround(N[1])],Math.pow(2,G));this.viewportCenterProjection=Fe.e.transformMat4([],[la[0],la[1],0,1],ea),an=this.cameraService.getViewMatrixUncentered()||an,ea=Fe.b.multiply([],Gn,an),ea=Fe.b.multiply([],ea,Xi),this.cameraService.setViewProjectionMatrix(ea),this.pixelsPerMeter=sr,this.pixelsPerDegree=or,this.pixelsPerDegree2=Ir}}]),re}(),ns),Si=Pn()(fa.prototype,"cameraService",[ga],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fa))||ya),ju=o("PJYZ"),Ga=o.n(ju),Ai=o("yLV6"),Ko=o.n(Ai),oi=o("V1cb"),Yi,wo,Ha,oo,so,Eu,$o,Kl;function ks(re){var se=ho();return function(){var G=at()(re),Ae;if(se){var ct=at()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function ho(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var Vt={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancle"},Le=(Yi=Object(F.injectable)(),wo=Object(F.inject)(D.a.IMapService),Ha=Object(F.inject)(D.a.ILogService),Yi(oo=(so=(Kl=function(re){ce()(N,re);var se=ks(N);function N(){var G;K()(this,N);for(var Ae=arguments.length,ct=new Array(Ae),Xt=0;Xt<Ae;Xt++)ct[Xt]=arguments[Xt];return G=se.call.apply(se,[this].concat(ct)),yn()(G,"mapService",Eu,Ga()(G)),yn()(G,"logger",$o,Ga()(G)),G.hammertime=void 0,G.lastClickTime=0,G.lastClickXY=[-1,-1],G.clickTimer=void 0,G.$containter=void 0,G.onDrag=function(sr){var or=G.interactionEvent(sr);or.type=Vt[or.type],G.emit(oi.a.Drag,or)},G.onHammer=function(sr){sr.srcEvent.stopPropagation();var or=G.interactionEvent(sr);G.emit(oi.a.Hover,or)},G.onTouch=function(sr){var or=sr.touches[0];G.onHover({x:or.pageX,y:or.pageY,type:"touch"})},G.onHover=function(sr){var or=sr.clientX,Ir=sr.clientY,an=or,Gn=Ir,ea=sr.type,la=G.mapService.getMapContainer();if(la){var qa=la.getBoundingClientRect(),Fa=qa.top,yi=qa.left;an=an-yi-la.clientLeft,Gn=Gn-Fa-la.clientTop}var Ja=G.mapService.containerToLngLat([an,Gn]);if(ea==="click"){if("ontouchstart"in document.documentElement===!0)return;G.isDoubleTap(an,Gn,Ja);return}if(ea==="touch"){G.isDoubleTap(an,Gn,Ja);return}ea!=="click"&&ea!=="dblclick"&&G.emit(oi.a.Hover,{x:an,y:Gn,lngLat:Ja,type:ea,target:sr})},G}return pe()(N,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(oi.a.Hover)}},{key:"triggerHover",value:function(Ae){var ct=Ae.x,Xt=Ae.y;this.emit(oi.a.Hover,{x:ct,y:Xt})}},{key:"triggerSelect",value:function(Ae){this.emit(oi.a.Select,{featureId:Ae})}},{key:"triggerActive",value:function(Ae){this.emit(oi.a.Active,{featureId:Ae})}},{key:"addEventListenerOnMap",value:function(){var Ae=this.mapService.getMapContainer();if(Ae){var ct=new Ko.a.Manager(Ae);ct.add(new Ko.a.Tap({event:"dblclick",taps:2})),ct.add(new Ko.a.Tap({event:"click"})),ct.add(new Ko.a.Pan({threshold:0,pointers:0})),ct.add(new Ko.a.Press({})),ct.on("dblclick click",this.onHammer),ct.on("panstart panmove panend pancancel",this.onDrag),Ae.addEventListener("mousemove",this.onHover),Ae.addEventListener("mousedown",this.onHover),Ae.addEventListener("mouseup",this.onHover),Ae.addEventListener("contextmenu",this.onHover),this.hammertime=ct,this.logger.debug("add event listeners on canvas")}}},{key:"removeEventListenerOnMap",value:function(){var Ae=this.mapService.getMapContainer();Ae&&(Ae.removeEventListener("mousemove",this.onHover),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),Ae.removeEventListener("mousedown",this.onHover),Ae.removeEventListener("mouseup",this.onHover),Ae.removeEventListener("contextmenu",this.onHover))}},{key:"interactionEvent",value:function(Ae){var ct=Ae.type,Xt=Ae.pointerType,sr,or;Xt==="touch"?(or=Math.floor(Ae.pointers[0].clientY),sr=Math.floor(Ae.pointers[0].clientX)):(or=Math.floor(Ae.srcEvent.y),sr=Math.floor(Ae.srcEvent.x));var Ir=this.mapService.getMapContainer();if(Ir){var an=Ir.getBoundingClientRect(),Gn=an.top,ea=an.left;sr-=ea,or-=Gn}var la=this.mapService.containerToLngLat([sr,or]);return{x:sr,y:or,lngLat:la,type:ct,target:Ae.srcEvent}}},{key:"isDoubleTap",value:function(Ae,ct,Xt){var sr=this,or=new Date().getTime(),Ir="click";or-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-Ae)<10&&Math.abs(this.lastClickXY[1]-ct)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),Ir="dblclick",this.emit(oi.a.Hover,{x:Ae,y:ct,lngLat:Xt,type:Ir})):(this.lastClickTime=or,this.lastClickXY=[Ae,ct],this.clickTimer=setTimeout(function(){Ir="click",sr.emit(oi.a.Hover,{x:Ae,y:ct,lngLat:Xt,type:Ir})},400))}}]),N}(Y.a),Kl),Eu=Pn()(so.prototype,"mapService",[wo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$o=Pn()(so.prototype,"logger",[Ha],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),so))||oo),Dt=o("o0o1"),mr=o.n(Dt),Qr=o("yXPU"),En=o.n(Qr),Vn=o("o+pz"),Ci,po,mo,Oo,Fu,Ml,bs,vc,Tu,Mo,zu,Eo;function Fi(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function Ys(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?Fi(Object(N),!0).forEach(function(G){te()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):Fi(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}var Ks=(Ci=Object(F.injectable)(),po=Object(F.inject)(D.a.IRendererService),mo=Object(F.inject)(D.a.IGlobalConfigService),Oo=Object(F.inject)(D.a.IInteractionService),Fu=Object(F.inject)(D.a.ILayerService),Ci(Ml=(bs=(Eo=function(){function re(){var se=this;K()(this,re),yn()(this,"rendererService",vc,this),yn()(this,"configService",Tu,this),yn()(this,"interactionService",Mo,this),yn()(this,"layerService",zu,this),this.pickingFBO=void 0,this.width=0,this.height=0,this.alreadyInPicking=!1,this.pickBufferScale=1,this.pickFromPickingFBO=function(N,G){var Ae,ct=G.x,Xt=G.y,sr=G.lngLat,or=G.type,Ir=G.target,an=!1,Gn=se.rendererService,ea=Gn.getViewportSize,la=Gn.readPixels,qa=Gn.getContainer,Fa=qa().getBoundingClientRect(),yi=Fa.width,Ja=Fa.height;yi*=window.devicePixelRatio,Ja*=window.devicePixelRatio;var Bi=N.getLayerConfig(),So=Bi.enableHighlight,yo=Bi.enableSelect,Hi=ct*window.devicePixelRatio,ko=Xt*window.devicePixelRatio;if(Hi>yi-1*window.devicePixelRatio||Hi<0||ko>Ja-1*window.devicePixelRatio||ko<0)return!1;var Qa;if(Qa=la({x:Math.floor(Hi/se.pickBufferScale),y:Math.floor((Ja-(Xt+1)*window.devicePixelRatio)/se.pickBufferScale),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:se.pickingFBO}),Qa[0]!==0||Qa[1]!==0||Qa[2]!==0){var lo=Object(Ze.k)(Qa),iu=N.getSource().getFeatureById(lo);lo!==N.getCurrentPickId()&&or==="mousemove"&&(or="mouseenter");var bi={x:ct,y:Xt,type:or,lngLat:sr,featureId:lo,feature:iu,target:Ir};iu&&(an=!0,N.setCurrentPickId(lo),se.triggerHoverOnLayer(N,bi))}else{var Ni={x:ct,y:Xt,lngLat:sr,type:N.getCurrentPickId()!==null&&or==="mousemove"?"mouseout":"un"+or,featureId:null,target:Ir,feature:null};se.triggerHoverOnLayer(N,Ys(Ys({},Ni),{},{type:"unpick"})),se.triggerHoverOnLayer(N,Ni),N.setCurrentPickId(null)}if(So&&se.highlightPickedFeature(N,Qa),yo&&or==="click"&&((Ae=Qa)===null||Ae===void 0?void 0:Ae.toString())!==[0,0,0,0].toString()){var xa=Object(Ze.k)(Qa);N.getCurrentSelectedId()===null||xa!==N.getCurrentSelectedId()?(se.selectFeature(N,Qa),N.setCurrentSelectedId(xa)):(se.selectFeature(N,new Uint8Array([0,0,0,0])),N.setCurrentSelectedId(null))}return an}}return pe()(re,[{key:"init",value:function(N){var G=this.rendererService,Ae=G.createTexture2D,ct=G.createFramebuffer,Xt=G.getViewportSize,sr=G.getContainer,or=sr().getBoundingClientRect(),Ir=or.width,an=or.height;Ir*=window.devicePixelRatio,an*=window.devicePixelRatio,this.pickBufferScale=this.configService.getSceneConfig(N).pickBufferScale||1,this.pickingFBO=ct({color:Ae({width:Math.round(Ir/this.pickBufferScale),height:Math.round(an/this.pickBufferScale),wrapS:Vn.a.CLAMP_TO_EDGE,wrapT:Vn.a.CLAMP_TO_EDGE})}),this.interactionService.on(oi.a.Hover,this.pickingAllLayer.bind(this))}},{key:"pickingAllLayer",value:function(){var se=En()(mr.a.mark(function G(Ae){return mr.a.wrap(function(Xt){for(;;)switch(Xt.prev=Xt.next){case 0:if(!(this.alreadyInPicking||this.layerService.alreadyInRendering)){Xt.next=2;break}return Xt.abrupt("return");case 2:return this.alreadyInPicking=!0,Xt.next=5,this.pickingLayers(Ae);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return Xt.stop()}},G,this)}));function N(G){return se.apply(this,arguments)}return N}()},{key:"pickingLayers",value:function(){var se=En()(mr.a.mark(function G(Ae){var ct=this,Xt,sr,or,Ir,an,Gn,ea,la;return mr.a.wrap(function(Fa){for(;;)switch(Fa.prev=Fa.next){case 0:Xt=this.rendererService,sr=Xt.getViewportSize,or=Xt.useFramebuffer,Ir=Xt.clear,an=Xt.getContainer,Gn=an().getBoundingClientRect(),ea=Gn.width,la=Gn.height,ea*=window.devicePixelRatio,la*=window.devicePixelRatio,(this.width!==ea||this.height!==la)&&(this.pickingFBO.resize({width:Math.round(ea/this.pickBufferScale),height:Math.round(la/this.pickBufferScale)}),this.width=ea,this.height=la),or(this.pickingFBO,function(){var yi=ct.layerService.getLayers();yi.filter(function(Ja){return Ja.needPick(Ae.type)}).reverse().some(function(Ja){Ir({framebuffer:ct.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),Ja.hooks.beforePickingEncode.call(),Ja.renderModels(),Ja.hooks.afterPickingEncode.call();var Bi=ct.pickFromPickingFBO(Ja,Ae);return Bi&&!Ja.getLayerConfig().enablePropagation})});case 6:case"end":return Fa.stop()}},G,this)}));function N(G){return se.apply(this,arguments)}return N}()},{key:"triggerHoverOnLayer",value:function(N,G){N.emit(G.type,G)}},{key:"highlightPickedFeature",value:function(N,G){var Ae=Et()(G,3),ct=Ae[0],Xt=Ae[1],sr=Ae[2];N.hooks.beforeHighlight.call([ct,Xt,sr])}},{key:"selectFeature",value:function(N,G){var Ae=Et()(G,3),ct=Ae[0],Xt=Ae[1],sr=Ae[2];N.hooks.beforeSelect.call([ct,Xt,sr])}}]),re}(),Eo),vc=Pn()(bs.prototype,"rendererService",[po],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tu=Pn()(bs.prototype,"configService",[mo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mo=Pn()(bs.prototype,"interactionService",[Oo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zu=Pn()(bs.prototype,"layerService",[Fu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bs))||Ml),js=function(){function re(){var se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;K()(this,re),this.autoStart=void 0,this.startTime=0,this.oldTime=0,this.running=!1,this.elapsedTime=0,this.autoStart=se}return pe()(re,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var N=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var G=(typeof performance=="undefined"?Date:performance).now();N=(G-this.oldTime)/1e3,this.oldTime=G,this.elapsedTime+=N}return N}}]),re}(),Ri,Vi,xs,vl,Qu,Rt,fr,Mr,Wn=(Ri=Object(F.injectable)(),Vi=Object(F.inject)(D.a.IRendererService),xs=Object(F.inject)(D.a.IGlobalConfigService),Ri(vl=(Qu=(Mr=function(){function re(){K()(this,re),this.clock=new js,this.alreadyInRendering=!1,this.layers=[],this.layerRenderID=void 0,this.sceneInited=!1,this.animateInstanceCount=0,yn()(this,"renderService",Rt,this),yn()(this,"configService",fr,this)}return pe()(re,[{key:"add",value:function(N){this.sceneInited&&N.init(),this.layers.push(N)}},{key:"initLayers",value:function(){this.sceneInited=!0,this.layers.forEach(function(N){N.inited||N.init()})}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(N){return this.layers.find(function(G){return G.id===N})}},{key:"getLayerByName",value:function(N){return this.layers.find(function(G){return G.name===N})}},{key:"remove",value:function(N){var G=this.layers.indexOf(N);G>-1&&this.layers.splice(G,1),N.emit("remove",null),N.destroy(),this.renderLayers()}},{key:"removeAllLayers",value:function(){this.destroy()}},{key:"renderLayers",value:function(){if(this.alreadyInRendering)return;this.alreadyInRendering=!0,this.clear(),this.updateRenderOrder(),this.layers.filter(function(N){return N.inited}).filter(function(N){return N.isVisible()}).forEach(function(N){N.hooks.beforeRenderData.call(),N.hooks.beforeRender.call(),N.render(),N.hooks.afterRender.call()}),this.alreadyInRendering=!1}},{key:"updateRenderOrder",value:function(){this.layers.sort(function(N,G){return N.zIndex-G.zIndex})}},{key:"destroy",value:function(){this.layers.forEach(function(N){return N.destroy()}),this.layers=[],this.renderLayers()}},{key:"startAnimate",value:function(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}},{key:"clear",value:function(){this.renderService.clear({color:[0,0,0,0],depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){cancelAnimationFrame(this.layerRenderID)}}]),re}(),Mr),Rt=Pn()(Qu.prototype,"renderService",[Vi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fr=Pn()(Qu.prototype,"configService",[xs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qu))||vl),Xa=o("QILm"),vi=o.n(Xa),Ki=o("RIqP"),Ya=o.n(Ki),Ii=o("J2iB"),Go=o.n(Ii),Cs=function(){function re(se){var N=this;K()(this,re),this.name=void 0,this.type=void 0,this.scale=void 0,this.descriptor=void 0,this.featureBufferLayout=[],this.needRescale=!1,this.needRemapping=!1,this.needRegenerateVertices=!1,this.featureRange={startIndex:0,endIndex:Infinity},this.vertexAttribute=void 0,this.defaultCallback=function(G){if(G.length===0){var Ae;return((Ae=N.scale)===null||Ae===void 0?void 0:Ae.defaultValues)||[]}return G.map(function(ct,Xt){var sr,or=(sr=N.scale)===null||sr===void 0?void 0:sr.scalers[Xt].func,Ir=or(ct);return Ir})},this.setProps(se)}return pe()(re,[{key:"setProps",value:function(N){Object.assign(this,N)}},{key:"mapping",value:function(N){var G;if((G=this.scale)===null||G===void 0?void 0:G.callback){var Ae,ct=(Ae=this.scale)===null||Ae===void 0?void 0:Ae.callback.apply(Ae,Ya()(N));if(!Go()(ct))return[ct]}return this.defaultCallback(N)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),re}(),pi,Pl,$s,Es,gl,cu,_u;function fu(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function Uu(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?fu(Object(N),!0).forEach(function(G){te()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):fu(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}function Js(re){return new Promise(function(se){return setTimeout(se,re)})}var Rc=(pi={},te()(pi,Vn.a.FLOAT,4),te()(pi,Vn.a.UNSIGNED_BYTE,1),te()(pi,Vn.a.UNSIGNED_SHORT,2),pi),pf=(Pl=Object(F.injectable)(),$s=Object(F.inject)(D.a.IRendererService),Pl(Es=(gl=(_u=function(){function re(){K()(this,re),this.attributesAndIndices=void 0,yn()(this,"rendererService",cu,this),this.attributes=[],this.triangulation=void 0,this.featureLayout={sizePerElement:0,elements:[]}}return pe()(re,[{key:"registerStyleAttribute",value:function(N){var G=this.getLayerStyleAttribute(N.name||"");return G?G.setProps(N):(G=new Cs(N),this.attributes.push(G)),G}},{key:"updateStyleAttribute",value:function(N,G,Ae){var ct=this.getLayerStyleAttribute(N);ct||(ct=this.registerStyleAttribute(Uu(Uu({},G),{},{name:N})));var Xt=G.scale;Xt&&ct&&(ct.scale=Xt,ct.needRescale=!0,ct.needRemapping=!0,ct.needRegenerateVertices=!0,Ae&&Ae.featureRange&&(ct.featureRange=Ae.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(N){return this.attributes.find(function(G){return G.name===N})}},{key:"getLayerAttributeScale",value:function(N){var G,Ae=this.getLayerStyleAttribute(N),ct=Ae==null||((G=Ae.scale)===null||G===void 0)?void 0:G.scalers;return ct&&ct[0]?ct[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(N,G){var Ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,ct=arguments.length>3?arguments[3]:void 0,Xt=this.attributes.find(function(yo){return yo.name===N});if(Xt&&Xt.descriptor){var sr=Xt.descriptor,or=sr.update,Ir=sr.buffer,an=sr.size,Gn=an===void 0?0:an,ea=Rc[Ir.type||Vn.a.FLOAT];if(or){var la=this.featureLayout,qa=la.elements,Fa=la.sizePerElement,yi=qa.slice(Ae,ct);if(!yi.length)return;var Ja=yi[0].offset,Bi=Ja*Gn*ea,So=yi.map(function(yo,Hi){for(var ko=yo.featureIdx,Qa=yo.vertices,lo=yo.normals,iu=Qa.length/Fa,bi=[],Ni=0;Ni<iu;Ni++){var xa=lo?lo.slice(Ni*3,Ni*3+3):[];bi.push.apply(bi,Ya()(or(G[ko],ko,Qa.slice(Ni*Fa,Ni*Fa+Fa),Hi,xa)))}return bi}).reduce(function(yo,Hi){return yo.push.apply(yo,Ya()(Hi)),yo},[]);Xt.vertexAttribute.updateBuffer({data:So,offset:Bi})}}}},{key:"createAttributesAndIndices",value:function(N,G){var Ae=this;this.featureLayout={sizePerElement:0,elements:[]},G&&(this.triangulation=G);var ct=this.attributes.map(function(Ja){return Ja.resetDescriptor(),Ja.descriptor}),Xt=0,sr=[],or=[],Ir=[],an=3;N.forEach(function(Ja,Bi){var So=Ae.triangulation(Ja),yo=So.indices,Hi=So.vertices,ko=So.normals,Qa=So.size;yo.forEach(function(Ni){or.push(Ni+Xt)}),an=Qa;var lo=Hi.length/Qa;Ae.featureLayout.sizePerElement=an,Ae.featureLayout.elements.push({featureIdx:Bi,vertices:Hi,normals:ko,offset:Xt}),Xt+=lo;for(var iu=function(xa){var Ao=(ko==null?void 0:ko.slice(xa*3,xa*3+3))||[],hc=Hi.slice(xa*Qa,xa*Qa+Qa);ct.forEach(function(kf,uh){if(kf&&kf.update){var jf;(jf=kf.buffer.data).push.apply(jf,Ya()(kf.update(Ja,Bi,hc,xa,Ao)))}})},bi=0;bi<lo;bi++)iu(bi)});var Gn=this.rendererService,ea=Gn.createAttribute,la=Gn.createBuffer,qa=Gn.createElements,Fa={};ct.forEach(function(Ja,Bi){if(Ja){var So=Ja.buffer,yo=Ja.update,Hi=Ja.name,ko=vi()(Ja,["buffer","update","name"]),Qa=ea(Uu({buffer:la(So)},ko));Fa[Ja.name||""]=Qa,Ae.attributes[Bi].vertexAttribute=Qa}});var yi=qa({data:or,type:Vn.a.UNSIGNED_INT,count:or.length});return this.attributesAndIndices={attributes:Fa,elements:yi},this.attributesAndIndices}},{key:"clearAllAttributes",value:function(){var N;this.attributes.forEach(function(G){G.vertexAttribute&&G.vertexAttribute.destroy()}),(N=this.attributesAndIndices)===null||N===void 0||N.elements.destroy(),this.attributes=[]}}]),re}(),_u),cu=Pn()(gl.prototype,"rendererService",[$s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gl))||Es),ci=o("U8pU"),Ic=o("KQm4"),gc=o("rePB"),Qc=o("1OyB"),yl=o("vuIU"),qc=o("5ku3"),$i=typeof __VERSION__!="undefined"?__VERSION__:"untranspiled source",Su=Object(qc.a)();function bl(re){try{var se=window[re],N="__storage_test__";return se.setItem(N,N),se.removeItem(N),se}catch(G){return null}}var as=function(){function re(se,N){var G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";Object(Qc.a)(this,re),this.storage=bl(G),this.id=se,this.config={},Object.assign(this.config,N),this._loadConfiguration()}return Object(yl.a)(re,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(N){return this.config={},this.updateConfiguration(N)}},{key:"updateConfiguration",value:function(N){if(Object.assign(this.config,N),this.storage){var G=JSON.stringify(this.config);this.storage.setItem(this.id,G)}return this}},{key:"_loadConfiguration",value:function(){var N={};if(this.storage){var G=this.storage.getItem(this.id);N=G?JSON.parse(G):{}}return Object.assign(this.config,N),this}}]),re}();function Dc(re){var se;return re<10?se="".concat(re.toFixed(2),"ms"):re<100?se="".concat(re.toFixed(1),"ms"):re<1e3?se="".concat(re.toFixed(0),"ms"):se="".concat((re/1e3).toFixed(2),"s"),se}function yc(re){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,N=Math.max(se-re.length,0);return"".concat(" ".repeat(N)).concat(re)}function Ll(re){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,N=Math.max(se-re.length,0);return"".concat(re).concat(" ".repeat(N))}function qu(re){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},N=1e-16,G=se.isInteger,Ae=G===void 0?!1:G;if(Array.isArray(re)||ArrayBuffer.isView(re))return Nc(re,se);if(!Number.isFinite(re))return String(re);if(Math.abs(re)<N)return Ae?"0":"0.";if(Ae)return re.toFixed(0);if(Math.abs(re)>100&&Math.abs(re)<1e4)return re.toFixed(0);var ct=re.toPrecision(2),Xt=ct.indexOf(".0");return Xt===ct.length-2?ct.slice(0,-1):ct}function Nc(re,se){for(var N=se.maxElts,G=N===void 0?16:N,Ae=se.size,ct=Ae===void 0?1:Ae,Xt="[",sr=0;sr<re.length&&sr<G;++sr)sr>0&&(Xt+=",".concat(sr%ct===0?" ":"")),Xt+=qu(re[sr],se);var or=re.length>G?"...":"]";return"".concat(Xt).concat(or)}function hu(re,se,N){var G=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600,Ae=re.src.replace(/\(/g,"%28").replace(/\)/g,"%29");re.width>G&&(N=Math.min(N,G/re.width));var ct=re.width*N,Xt=re.height*N,sr=["font-size:1px;","padding:".concat(Math.floor(Xt/2),"px ").concat(Math.floor(ct/2),"px;"),"line-height:".concat(Xt,"px;"),"background:url(".concat(Ae,");"),"background-size:".concat(ct,"px ").concat(Xt,"px;"),"color:transparent;"].join("");return["".concat(se," %c+"),sr]}var Au={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function ef(re){return typeof re=="string"?Au[re.toUpperCase()]||Au.WHITE:re}function $l(re,se,N){return!Su&&typeof re=="string"&&(se&&(se=ef(se),re="[".concat(se,"m").concat(re,"[39m")),N&&(se=ef(N),re="[".concat(N+10,"m").concat(re,"[49m"))),re}function Ti(re){if(typeof Symbol=="undefined"||re[Symbol.iterator]==null){if(Array.isArray(re)||(re=tf(re))){var se=0,N=function(){};return{s:N,n:function(){return se>=re.length?{done:!0}:{done:!1,value:re[se++]}},e:function(or){throw or},f:N}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var G,Ae=!0,ct=!1,Xt;return{s:function(){G=re[Symbol.iterator]()},n:function(){var or=G.next();return Ae=or.done,or},e:function(or){ct=!0,Xt=or},f:function(){try{!Ae&&G.return!=null&&G.return()}finally{if(ct)throw Xt}}}}function tf(re,se){if(!re)return;if(typeof re=="string")return mf(re,se);var N=Object.prototype.toString.call(re).slice(8,-1);if(N==="Object"&&re.constructor&&(N=re.constructor.name),N==="Map"||N==="Set")return Array.from(N);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return mf(re,se)}function mf(re,se){(se==null||se>re.length)&&(se=re.length);for(var N=0,G=new Array(se);N<se;N++)G[N]=re[N];return G}function Jl(re){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"],N=Object.getPrototypeOf(re),G=Object.getOwnPropertyNames(N),Ae=Ti(G),ct;try{var Xt=function(){var or=ct.value;typeof re[or]=="function"&&(se.find(function(Ir){return or===Ir})||(re[or]=re[or].bind(re)))};for(Ae.s();!(ct=Ae.n()).done;)Xt()}catch(sr){Ae.e(sr)}finally{Ae.f()}}function kc(re,se){if(!re)throw new Error(se||"Assertion failed")}var Ql=o("K9nA");function el(){var re;if(Su&&Ql.b.performance)re=Ql.b.performance.now();else if(Ql.a.hrtime){var se=Ql.a.hrtime();re=se[0]*1e3+se[1]/1e6}else re=Date.now();return re}var Bu={debug:Su&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},xl={enabled:!0,level:0};function Po(){}var ql={},Rl={once:!0};function Il(re){for(var se in re)for(var N in re[se])return N||"untitled";return"empty"}var jc=function(){function re(){var se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},N=se.id;Object(Qc.a)(this,re),this.id=N,this.VERSION=$i,this._startTs=el(),this._deltaTs=el(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new as("__probe-".concat(this.id,"__"),xl),this.userData={},this.timeStamp("".concat(this.id," started")),Jl(this),Object.seal(this)}return Object(yl.a)(re,[{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getLevel",value:function(){return this._storage.config.level}},{key:"getTotal",value:function(){return Number((el()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((el()-this._deltaTs).toPrecision(10))}},{key:"getPriority",value:function(){return this.level}},{key:"enable",value:function(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.updateConfiguration({enabled:N}),this}},{key:"setLevel",value:function(N){return this._storage.updateConfiguration({level:N}),this}},{key:"assert",value:function(N,G){kc(N,G)}},{key:"warn",value:function(N){return this._getLogFunction(0,N,Bu.warn,arguments,Rl)}},{key:"error",value:function(N){return this._getLogFunction(0,N,Bu.error,arguments)}},{key:"deprecated",value:function(N,G){return this.warn("`".concat(N,"` is deprecated and will be removed in a later version. Use `").concat(G,"` instead"))}},{key:"removed",value:function(N,G){return this.error("`".concat(N,"` has been removed. Use `").concat(G,"` instead"))}},{key:"probe",value:function(N,G){return this._getLogFunction(N,G,Bu.log,arguments,{time:!0,once:!0})}},{key:"log",value:function(N,G){return this._getLogFunction(N,G,Bu.debug,arguments)}},{key:"info",value:function(N,G){return this._getLogFunction(N,G,console.info,arguments)}},{key:"once",value:function(N,G){return this._getLogFunction(N,G,Bu.debug||Bu.info,arguments,Rl)}},{key:"table",value:function(N,G,Ae){return G?this._getLogFunction(N,G,console.table||Po,Ae&&[Ae],{tag:Il(G)}):Po}},{key:"image",value:function(N){var G=N.logLevel,Ae=N.priority,ct=N.image,Xt=N.message,sr=Xt===void 0?"":Xt,or=N.scale,Ir=or===void 0?1:or;return this._shouldLog(G||Ae)?Su?gf({image:ct,message:sr,scale:Ir}):vf({image:ct,message:sr,scale:Ir}):Po}},{key:"settings",value:function(){console.table?console.table(this._storage.config):console.log(this._storage.config)}},{key:"get",value:function(N){return this._storage.config[N]}},{key:"set",value:function(N,G){this._storage.updateConfiguration(Object(gc.a)({},N,G))}},{key:"time",value:function(N,G){return this._getLogFunction(N,G,console.time?console.time:console.info)}},{key:"timeEnd",value:function(N,G){return this._getLogFunction(N,G,console.timeEnd?console.timeEnd:console.info)}},{key:"timeStamp",value:function(N,G){return this._getLogFunction(N,G,console.timeStamp||Po)}},{key:"group",value:function(N,G){var Ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};Ae=Qs({logLevel:N,message:G,opts:Ae});var ct=Ae,Xt=ct.collapsed;return Ae.method=(Xt?console.groupCollapsed:console.group)||console.info,this._getLogFunction(Ae)}},{key:"groupCollapsed",value:function(N,G){var Ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(N,G,Object.assign({},Ae,{collapsed:!0}))}},{key:"groupEnd",value:function(N){return this._getLogFunction(N,"",console.groupEnd||Po)}},{key:"withGroup",value:function(N,G,Ae){this.group(N,G)();try{Ae()}finally{this.groupEnd(N)()}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(N){return this.isEnabled()&&this.getLevel()>=El(N)}},{key:"_getLogFunction",value:function(N,G,Ae){var ct=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],Xt=arguments.length>4?arguments[4]:void 0;if(this._shouldLog(N)){var sr;Xt=Qs({logLevel:N,message:G,args:ct,opts:Xt}),Ae=Ae||Xt.method,kc(Ae),Xt.total=this.getTotal(),Xt.delta=this.getDelta(),this._deltaTs=el();var or=Xt.tag||Xt.message;if(Xt.once)if(!ql[or])ql[or]=el();else return Po;return G=eo(this.id,Xt.message,Xt),(sr=Ae).bind.apply(sr,[console,G].concat(Object(Ic.a)(Xt.args)))}return Po}},{key:"level",set:function(N){this.setLevel(N)},get:function(){return this.getLevel()}},{key:"priority",set:function(N){this.level=N},get:function(){return this.level}}]),re}();jc.VERSION=$i;function El(re){if(!re)return 0;var se;switch(Object(ci.a)(re)){case"number":se=re;break;case"object":se=re.logLevel||re.priority||0;break;default:return 0}return kc(Number.isFinite(se)&&se>=0),se}function Qs(re){var se=re.logLevel,N=re.message;re.logLevel=El(se);for(var G=re.args?Array.from(re.args):[];G.length&&G.shift()!==N;);re.args=G;switch(Object(ci.a)(se)){case"string":case"function":N!==void 0&&G.unshift(N),re.message=se;break;case"object":Object.assign(re,se);break;default:}typeof re.message=="function"&&(re.message=re.message());var Ae=Object(ci.a)(re.message);return kc(Ae==="string"||Ae==="object"),Object.assign(re,re.opts)}function eo(re,se,N){if(typeof se=="string"){var G=N.time?yc(Dc(N.total)):"";se=N.time?"".concat(re,": ").concat(G,"  ").concat(se):"".concat(re,": ").concat(se),se=$l(se,N.color,N.background)}return se}function vf(re){var se=re.image,N=re.message,G=N===void 0?"":N,Ae=re.scale,ct=Ae===void 0?1:Ae,Xt=null;try{Xt=o(2)}catch(sr){}return Xt?function(){return Xt(se,{fit:"box",width:"".concat(Math.round(80*ct),"%")}).then(function(sr){return console.log(sr)})}:Po}function gf(re){var se=re.image,N=re.message,G=N===void 0?"":N,Ae=re.scale,ct=Ae===void 0?1:Ae;if(typeof se=="string"){var Xt=new Image;return Xt.onload=function(){var an,Gn=hu(Xt,G,ct);(an=console).log.apply(an,Object(Ic.a)(Gn))},Xt.src=se,Po}var sr=se.nodeName||"";if(sr.toLowerCase()==="img"){var or;return(or=console).log.apply(or,Object(Ic.a)(hu(se,G,ct))),Po}if(sr.toLowerCase()==="canvas"){var Ir=new Image;return Ir.onload=function(){var an;return(an=console).log.apply(an,Object(Ic.a)(hu(Ir,G,ct)))},Ir.src=se.toDataURL(),Po}return Po}var Tl,ec,tl=new jc({id:"L7"}).enable(!1);tl.priority=5;var Dl=(Tl=Object(F.injectable)(),Tl(ec=function(){function re(){K()(this,re)}return pe()(re,[{key:"error",value:function(N){tl.error(N)()}},{key:"warn",value:function(N){tl.probe(1,N)()}},{key:"info",value:function(N){tl.info(3,N)()}},{key:"debug",value:function(N){tl.probe(4,N)()}}]),re}())||ec),bc=o("xp6e"),xc=o("iegG"),rl=o.n(xc),rf=window.document.documentElement.style,nl=0;function qs(re){var se=re;if(typeof re=="string"&&(se=document.getElementById(re)),se){var N=document.createElement("div");return N.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,N.id="l7-scene-".concat(nl++),N.classList.add("l7-scene"),se.appendChild(N),N}return null}var _l,tc,Fc,nf,Fs,yf,al,wi,il,Vu,ui,kn,Oi,ws,Nl,Gu,ol,bf,is,Sl,sl,ul,zi,Ts,kl,to,In,zs,ti,jl,du,Us,ll,qr,Ec,os;function ro(re){var se=Jo();return function(){var G=at()(re),Ae;if(se){var ct=at()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function Jo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var Os=(_l=Object(F.injectable)(),tc=Object(F.inject)(D.a.SceneID),Fc=Object(F.inject)(D.a.IIconService),nf=Object(F.inject)(D.a.IFontService),Fs=Object(F.inject)(D.a.IControlService),yf=Object(F.inject)(D.a.ILogService),al=Object(F.inject)(D.a.IGlobalConfigService),wi=Object(F.inject)(D.a.IMapService),il=Object(F.inject)(D.a.ICoordinateSystemService),Vu=Object(F.inject)(D.a.IRendererService),ui=Object(F.inject)(D.a.ILayerService),kn=Object(F.inject)(D.a.ICameraService),Oi=Object(F.inject)(D.a.IInteractionService),ws=Object(F.inject)(D.a.IPickingService),Nl=Object(F.inject)(D.a.IShaderModuleService),Gu=Object(F.inject)(D.a.IMarkerService),ol=Object(F.inject)(D.a.IPopupService),_l(bf=(is=(os=function(re){ce()(N,re);var se=ro(N);function N(){var G;return K()(this,N),G=se.call(this),G.destroyed=!1,G.loaded=!1,yn()(G,"id",Sl,Ga()(G)),yn()(G,"iconService",sl,Ga()(G)),yn()(G,"fontService",ul,Ga()(G)),yn()(G,"controlService",zi,Ga()(G)),yn()(G,"logger",Ts,Ga()(G)),yn()(G,"configService",kl,Ga()(G)),yn()(G,"map",to,Ga()(G)),yn()(G,"coordinateSystemService",In,Ga()(G)),yn()(G,"rendererService",zs,Ga()(G)),yn()(G,"layerService",ti,Ga()(G)),yn()(G,"cameraService",jl,Ga()(G)),yn()(G,"interactionService",du,Ga()(G)),yn()(G,"pickingService",Us,Ga()(G)),yn()(G,"shaderModuleService",ll,Ga()(G)),yn()(G,"markerService",qr,Ga()(G)),yn()(G,"popupService",Ec,Ga()(G)),G.inited=!1,G.initPromise=void 0,G.rendering=!1,G.$container=void 0,G.canvas=void 0,G.markerContainer=void 0,G.hooks=void 0,G.handleWindowResized=function(){G.emit("resize"),G.$container&&(G.initContainer(),Ze.a.triggerResize(),G.coordinateSystemService.needRefresh=!0,G.render())},G.handleMapCameraChanged=function(Ae){G.cameraService.update(Ae),G.render()},G.hooks={init:new bc.a},G}return pe()(N,[{key:"init",value:function(Ae){var ct=this;this.configService.setSceneConfig(this.id,Ae),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.fontService.init(),this.hooks.init.tapPromise("initMap",En()(mr.a.mark(function Xt(){return mr.a.wrap(function(or){for(;;)switch(or.prev=or.next){case 0:return or.next=2,new Promise(function(Ir){ct.map.onCameraChanged(function(an){ct.cameraService.init(),ct.cameraService.update(an),Ir()}),ct.map.init()});case 2:ct.map.onCameraChanged(ct.handleMapCameraChanged),ct.map.addMarkerContainer(),ct.markerService.addMarkers(),ct.markerService.addMarkerLayers(),ct.popupService.initPopup(),ct.interactionService.init(),ct.interactionService.on(oi.a.Drag,ct.addSceneEvent.bind(ct)),ct.logger.debug("map ".concat(ct.id," loaded"));case 10:case"end":return or.stop()}},Xt)}))),this.hooks.init.tapPromise("initRenderer",En()(mr.a.mark(function Xt(){var sr;return mr.a.wrap(function(Ir){for(;;)switch(Ir.prev=Ir.next){case 0:if(sr=qs(ct.configService.getSceneConfig(ct.id).id||""),ct.$container=sr,!sr){Ir.next=11;break}return ct.canvas=Ze.a.create("canvas","",sr),ct.setCanvas(),Ir.next=7,ct.rendererService.init(ct.canvas,ct.configService.getSceneConfig(ct.id));case 7:rl()(ct.$container,ct.handleWindowResized),window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)").addListener(ct.handleWindowResized),Ir.next=12;break;case 11:ct.logger.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 12:ct.pickingService.init(ct.id),ct.logger.debug("scene ".concat(ct.id," renderer loaded"));case 14:case"end":return Ir.stop()}},Xt)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(Ae){this.logger.debug("add layer ".concat(Ae.name," to scene ").concat(this.id)),this.layerService.add(Ae),this.render()}},{key:"render",value:function(){var G=En()(mr.a.mark(function ct(){return mr.a.wrap(function(sr){for(;;)switch(sr.prev=sr.next){case 0:if(!(this.rendering||this.destroyed)){sr.next=2;break}return sr.abrupt("return");case 2:if(this.rendering=!0,this.inited){sr.next=13;break}return sr.next=6,this.initPromise;case 6:this.destroyed&&this.destroy(),this.logger.info(" render inited"),this.layerService.initLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0;case 13:this.layerService.renderLayers(),this.logger.debug("scene ".concat(this.id," render")),this.rendering=!1;case 16:case"end":return sr.stop()}},ct,this)}));function Ae(){return G.apply(this,arguments)}return Ae}()},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(Ae){var ct,Xt=(ct=this.$container)===null||ct===void 0?void 0:ct.getElementsByTagName("canvas")[0];this.render();var sr=Ae==="jpg"?Xt==null?void 0:Xt.toDataURL("image/jpeg"):Xt==null?void 0:Xt.toDataURL("image/png");return sr}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"addMarkerContainer",value:function(){var Ae=this.$container.parentElement;Ae!==null&&(this.markerContainer=Ze.a.create("div","l7-marker-container",Ae))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){if(!this.inited){this.destroyed=!0;return}this.emit("destroy"),this.layerService.destroy(),this.rendererService.destroy(),this.map.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.removeAllListeners(),this.inited=!1,Object(xc.unbind)(this.$container,this.handleWindowResized),window.matchMedia("screen and (min-resolution: 2dppx)").removeListener(this.handleWindowResized)}},{key:"initContainer",value:function(){var Ae,ct,Xt=window.devicePixelRatio,sr=((Ae=this.$container)===null||Ae===void 0?void 0:Ae.clientWidth)||400,or=((ct=this.$container)===null||ct===void 0?void 0:ct.clientHeight)||300,Ir=this.canvas;Ir&&(Ir.width=sr*Xt,Ir.height=or*Xt,Ir.style.width="".concat(sr,"px"),Ir.style.height="".concat(or,"px")),this.rendererService.viewport({x:0,y:0,width:Xt*sr,height:Xt*or})}},{key:"setCanvas",value:function(){var Ae,ct,Xt=window.devicePixelRatio,sr=((Ae=this.$container)===null||Ae===void 0?void 0:Ae.clientWidth)||400,or=((ct=this.$container)===null||ct===void 0?void 0:ct.clientHeight)||300,Ir=this.canvas;Ir.width=sr*Xt,Ir.height=or*Xt,Ir.style.width="".concat(sr,"px"),Ir.style.height="".concat(or,"px")}},{key:"addSceneEvent",value:function(Ae){this.emit(Ae.type,Ae)}}]),N}(m.EventEmitter),os),Sl=Pn()(is.prototype,"id",[tc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sl=Pn()(is.prototype,"iconService",[Fc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ul=Pn()(is.prototype,"fontService",[nf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zi=Pn()(is.prototype,"controlService",[Fs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ts=Pn()(is.prototype,"logger",[yf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kl=Pn()(is.prototype,"configService",[al],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),to=Pn()(is.prototype,"map",[wi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),In=Pn()(is.prototype,"coordinateSystemService",[il],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zs=Pn()(is.prototype,"rendererService",[Vu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ti=Pn()(is.prototype,"layerService",[ui],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jl=Pn()(is.prototype,"cameraService",[kn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),du=Pn()(is.prototype,"interactionService",[Oi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Us=Pn()(is.prototype,"pickingService",[ws],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ll=Pn()(is.prototype,"shaderModuleService",[Nl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qr=Pn()(is.prototype,"markerService",[Gu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ec=Pn()(is.prototype,"popupService",[ol],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),is))||bf),Fl=o("7tbW"),zc=o.n(Fl);function Bs(re){var se=0;switch(re){case"vec2":case"ivec2":se=2;break;case"vec3":case"ivec3":se=3;break;case"vec4":case"ivec4":case"mat2":se=4;break;case"mat3":se=9;break;case"mat4":se=16;break;default:}return se}var Cu=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function zl(re){var se={};return re=re.replace(Cu,function(N,G,Ae){var ct=Ae.split(":"),Xt=ct[0].trim(),sr="";ct.length>1&&(sr=ct[1].trim());switch(G){case"bool":sr=sr==="true";break;case"float":case"int":sr=Number(sr);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":sr?sr=sr.replace("[","").replace("]","").split(",").reduce(function(or,Ir){return or.push(Number(Ir.trim())),or},[]):sr=new Array(Bs(G)).fill(0);break;default:}return se[Xt]=sr,"uniform ".concat(G," ").concat(Xt,`;
`)}),{content:re,uniforms:se}}var Ul,af,Uc;function Lo(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function ss(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?Lo(Object(N),!0).forEach(function(G){te()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):Lo(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}var Pa="#define PI 3.14159265359",eu=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,Ro=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,To=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}

// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {
//   vec3 lightDir = normalize(light.position - fragPos);
//   // diffuse shading
//   float diff = max(dot(normal, lightDir), 0.0);
//   // specular shading
//   vec3 reflectDir = reflect(-lightDir, normal);
//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);
//   // attenuation
//   float distance = length(light.position - fragPos);
//   float attenuation = 1.0 / (light.constant + light.linear * distance +
//           light.quadratic * (distance * distance));

//   vec3 ambient = light.ambient * u_Ambient;
//   vec3 diffuse = light.diffuse * diff * u_Diffuse;
//   vec3 specular = light.specular * spec * u_Specular;

//   float spotEffect = dot(normalize(light.direction), -lightDir);
//   float spotCosCutoff = cos(light.angle / 180.0 * PI);
//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);
//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);
//   if (spotEffect > spotCosCutoff) {
//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);
//   } else {
//     spotEffect = 0.0;
//   }

//   return ambient + attenuation * (spotEffect * diffuse + specular);
// }

vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {
  //   if (i >= u_NumOfSpotLights) {
  //     break;
  //   }
  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);
  // }
  return weight;
}
`,Al=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color) {
  bool selected = bool(v_PickingResult.a);

  if (selected) {
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(resultRGB, color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  return filterPickingColor(filterHighlightColor(color));
}
`,cl=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  // compares only in highlight stage
  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}
`,pu=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}
`,_s=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)

#define COORDINATE_SYSTEM_LNGLAT 1.0
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0
#define COORDINATE_SYSTEM_P20_OFFSET 6.0
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

uniform mat4 u_ViewMatrix;
uniform mat4 u_ProjectionMatrix;
uniform mat4 u_ViewProjectionMatrix;
uniform float u_Zoom : 1;
uniform float u_ZoomScale : 1;

uniform float u_CoordinateSystem;
uniform vec2 u_ViewportCenter;
uniform vec4 u_ViewportCenterProjection;
uniform vec3 u_PixelsPerDegree;
uniform vec3 u_PixelsPerDegree2;
uniform vec3 u_PixelsPerMeter;

uniform vec2 u_ViewportSize;
uniform float u_DevicePixelRatio;
uniform float u_FocalDistance;
uniform vec3 u_CameraPosition;

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }
  return vector;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  return pixel;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  return pixel * -1.;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }
  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}

`,Tc=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,Jn=/precision\s+(high|low|medium)p\s+float/,jn=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,_c=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,us=(Ul=Object(F.injectable)(),Ul(af=(Uc=function(){function re(){K()(this,re),this.moduleCache={},this.rawContentCache={}}return pe()(re,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:Pa,fs:Pa}),this.registerModule("decode",{vs:eu,fs:""}),this.registerModule("projection",{vs:_s,fs:""}),this.registerModule("project",{vs:pu,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:Tc}),this.registerModule("lighting",{vs:To,fs:""}),this.registerModule("light",{vs:Ro,fs:""}),this.registerModule("picking",{vs:cl,fs:Al})}},{key:"registerModule",value:function(N,G){if(this.rawContentCache[N])return;var Ae=G.vs,ct=G.fs,Xt=G.uniforms,sr=zl(Ae),or=sr.content,Ir=sr.uniforms,an=zl(ct),Gn=an.content,ea=an.uniforms;this.rawContentCache[N]={fs:Gn,uniforms:ss(ss(ss({},Ir),ea),Xt),vs:or}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(N){var G=this;if(this.moduleCache[N])return this.moduleCache[N];var Ae=this.rawContentCache[N].vs,ct=this.rawContentCache[N].fs,Xt=this.processModule(Ae,[],"vs"),sr=Xt.content,or=Xt.includeList,Ir=this.processModule(ct,[],"fs"),an=Ir.content,Gn=Ir.includeList,ea=an,la=zc()(or.concat(Gn).concat(N)).reduce(function(qa,Fa){return ss(ss({},qa),G.rawContentCache[Fa].uniforms)},{});return Jn.test(an)||(ea=jn+an),this.moduleCache[N]={fs:ea.trim(),uniforms:la,vs:sr.trim()},this.moduleCache[N]}},{key:"processModule",value:function(N,G,Ae){var ct=this,Xt=N.replace(_c,function(sr,or){var Ir=or.split(" "),an=Ir[0].replace(/"/g,"");if(G.indexOf(an)>-1)return"";var Gn=ct.rawContentCache[an][Ae];G.push(an);var ea=ct.processModule(Gn,G,Ae),la=ea.content;return la});return{content:Xt,includeList:G}}}]),re}(),Uc))||af),Io=o("iWIM"),vo=o.n(Io),Ss=o("bPkA"),wu,rc,Ka,no,fl,mu,hl=(wu=Object(F.injectable)(),rc=Object(F.inject)(D.a.IShaderModuleService),wu(Ka=(no=(mu=function(){function re(){K()(this,re),yn()(this,"shaderModuleService",fl,this),this.rendererService=void 0,this.cameraService=void 0,this.mapService=void 0,this.interactionService=void 0,this.layerService=void 0,this.config=void 0}return pe()(re,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return Ss.a.Normal}},{key:"init",value:function(N,G){this.config=G,this.rendererService=N.getContainer().get(D.a.IRendererService),this.cameraService=N.getContainer().get(D.a.ICameraService),this.mapService=N.getContainer().get(D.a.IMapService),this.interactionService=N.getContainer().get(D.a.IInteractionService),this.layerService=N.getContainer().get(D.a.ILayerService)}},{key:"render",value:function(N){}}]),re}(),mu),fl=Pn()(no.prototype,"shaderModuleService",[rc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),no))||Ka),Ou,Ms;function Bc(re){var se=Vs();return function(){var G=at()(re),Ae;if(se){var ct=at()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function Vs(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var xf=(Ou=Object(F.injectable)(),Ou(Ms=function(re){ce()(N,re);var se=Bc(N);function N(){return K()(this,N),se.apply(this,arguments)}return pe()(N,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(Ae,ct){vo()(at()(N.prototype),"init",this).call(this,Ae,ct)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),N}(hl))||Ms),Bl,Vl,Sc,ls,Hu,Vc;function Cl(re,se){var N;if(typeof Symbol=="undefined"||re[Symbol.iterator]==null){if(Array.isArray(re)||(N=Zu(re))||se&&re&&typeof re.length=="number"){N&&(re=N);var G=0,Ae=function(){};return{s:Ae,n:function(){return G>=re.length?{done:!0}:{done:!1,value:re[G++]}},e:function(Ir){throw Ir},f:Ae}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ct=!0,Xt=!1,sr;return{s:function(){N=re[Symbol.iterator]()},n:function(){var Ir=N.next();return ct=Ir.done,Ir},e:function(Ir){Xt=!0,sr=Ir},f:function(){try{!ct&&N.return!=null&&N.return()}finally{if(Xt)throw sr}}}}function Zu(re,se){if(!re)return;if(typeof re=="string")return nc(re,se);var N=Object.prototype.toString.call(re).slice(8,-1);if(N==="Object"&&re.constructor&&(N=re.constructor.name),N==="Map"||N==="Set")return Array.from(re);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return nc(re,se)}function nc(re,se){(se==null||se>re.length)&&(se=re.length);for(var N=0,G=new Array(se);N<se;N++)G[N]=re[N];return G}var Wu=(Bl=Object(F.injectable)(),Vl=Object(F.inject)(D.a.IPostProcessor),Bl(Sc=(ls=(Vc=function(){function re(){K()(this,re),this.passes=[],yn()(this,"postProcessor",Hu,this),this.layer=void 0,this.renderFlag=void 0,this.width=0,this.height=0}return pe()(re,[{key:"setLayer",value:function(N){this.layer=N}},{key:"setRenderFlag",value:function(N){this.renderFlag=N}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var se=En()(mr.a.mark(function G(){var Ae,ct,Xt;return mr.a.wrap(function(or){for(;;)switch(or.prev=or.next){case 0:Ae=Cl(this.passes),or.prev=1,Ae.s();case 3:if((ct=Ae.n()).done){or.next=9;break}return Xt=ct.value,or.next=7,Xt.render(this.layer);case 7:or.next=3;break;case 9:or.next=14;break;case 11:or.prev=11,or.t0=or.catch(1),Ae.e(or.t0);case 14:return or.prev=14,Ae.f(),or.finish(14);case 17:this.layer.renderModels();case 18:case"end":return or.stop()}},G,this,[[1,11,14,17]])}));function N(){return se.apply(this,arguments)}return N}()},{key:"resize",value:function(N,G){(this.width!==N||this.height!==G)&&(this.width=N,this.height=G)}},{key:"add",value:function(N,G){N.getType()===Ss.a.PostProcessing?this.postProcessor.add(N,this.layer,G):(N.init(this.layer,G),this.passes.push(N))}},{key:"insert",value:function(N,G,Ae){N.init(this.layer,G),this.passes.splice(Ae,0,N)}},{key:"destroy",value:function(){this.passes.length=0}}]),re}(),Vc),Hu=Pn()(ls.prototype,"postProcessor",[Vl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ls))||Sc),Ps,of,ac,ic,oc,s;function a(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function n(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?a(Object(N),!0).forEach(function(G){te()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):a(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}function l(re){var se=g();return function(){var G=at()(re),Ae;if(se){var ct=at()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function g(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var w=(Ps=Object(F.injectable)(),of=Object(F.inject)(D.a.ILogService),Ps(ac=(ic=(s=function(re){ce()(N,re);var se=l(N);function N(){var G;K()(this,N);for(var Ae=arguments.length,ct=new Array(Ae),Xt=0;Xt<Ae;Xt++)ct[Xt]=arguments[Xt];return G=se.call.apply(se,[this].concat(ct)),yn()(G,"logger",oc,Ga()(G)),G.pickingFBO=void 0,G.layer=void 0,G.width=0,G.height=0,G.alreadyInRendering=!1,G.pickFromPickingFBO=function(sr){var or=sr.x,Ir=sr.y,an=sr.lngLat,Gn=sr.type;if(!G.layer.isVisible()||!G.layer.needPick(Gn))return;var ea=G.rendererService,la=ea.getViewportSize,qa=ea.readPixels,Fa=ea.useFramebuffer,yi=la(),Ja=yi.width,Bi=yi.height,So=G.layer.getLayerConfig(),yo=So.enableHighlight,Hi=So.enableSelect,ko=or*window.devicePixelRatio,Qa=Ir*window.devicePixelRatio;if(ko>Ja||ko<0||Qa>Bi||Qa<0)return;var lo;Fa(G.pickingFBO,function(){var iu;if(lo=qa({x:Math.round(ko),y:Math.round(Bi-(Ir+1)*window.devicePixelRatio),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:G.pickingFBO}),lo[0]!==0||lo[1]!==0||lo[2]!==0){G.logger.debug("picked");var bi=Object(Ze.k)(lo),Ni=G.layer.getSource().getFeatureById(bi),xa={x:or,y:Ir,type:Gn,lngLat:an,featureId:bi,feature:Ni};Ni&&(G.layer.setCurrentPickId(bi),G.triggerHoverOnLayer(xa))}else{var Ao={x:or,y:Ir,lngLat:an,type:G.layer.getCurrentPickId()===null?"un"+Gn:"mouseout",featureId:null,feature:null};G.triggerHoverOnLayer(n(n({},Ao),{},{type:"unpick"})),G.triggerHoverOnLayer(Ao),G.layer.setCurrentPickId(null)}yo&&G.highlightPickedFeature(lo),Hi&&Gn==="click"&&((iu=lo)===null||iu===void 0?void 0:iu.toString())!==[0,0,0,0].toString()&&G.selectFeature(lo)})},G}return pe()(N,[{key:"getType",value:function(){return Ss.a.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(Ae,ct){vo()(at()(N.prototype),"init",this).call(this,Ae,ct),this.layer=Ae;var Xt=this.rendererService,sr=Xt.createTexture2D,or=Xt.createFramebuffer,Ir=Xt.getViewportSize,an=Ir(),Gn=an.width,ea=an.height;this.pickingFBO=or({color:sr({width:Gn,height:ea,wrapS:Vn.a.CLAMP_TO_EDGE,wrapT:Vn.a.CLAMP_TO_EDGE})}),this.interactionService.on(oi.a.Hover,this.pickFromPickingFBO),this.interactionService.on(oi.a.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(oi.a.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(Ae){var ct=this;if(this.alreadyInRendering)return;var Xt=this.rendererService,sr=Xt.getViewportSize,or=Xt.useFramebuffer,Ir=Xt.clear,an=sr(),Gn=an.width,ea=an.height;this.alreadyInRendering=!0,(this.width!==Gn||this.height!==ea)&&(this.pickingFBO.resize({width:Gn,height:ea}),this.width=Gn,this.height=ea),or(this.pickingFBO,function(){Ir({framebuffer:ct.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var la=ct.layer.multiPassRenderer.getRenderFlag();ct.layer.multiPassRenderer.setRenderFlag(!1),Ae.hooks.beforePickingEncode.call(),Ae.render(),Ae.hooks.afterPickingEncode.call(),ct.layer.multiPassRenderer.setRenderFlag(la),ct.alreadyInRendering=!1})}},{key:"triggerHoverOnLayer",value:function(Ae){this.layer.emit(Ae.type,Ae)}},{key:"highlightPickedFeature",value:function(Ae){var ct=Et()(Ae,3),Xt=ct[0],sr=ct[1],or=ct[2];this.layer.hooks.beforeHighlight.call([Xt,sr,or]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(Ae){var ct=Et()(Ae,3),Xt=ct[0],sr=ct[1],or=ct[2];this.layer.hooks.beforeSelect.call([Xt,sr,or]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(Ae){var ct=Ae.featureId,Xt=Object(Ze.l)(ct);this.selectFeature(new Uint8Array(Xt))}},{key:"highlightFeatureHandle",value:function(Ae){var ct=Ae.featureId,Xt=Object(Ze.l)(ct);this.highlightPickedFeature(new Uint8Array(Xt))}}]),N}(hl),s),oc=Pn()(ic.prototype,"logger",[of],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ic))||ac),L=o("+em5"),z,ue;function Ee(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function Ke(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?Ee(Object(N),!0).forEach(function(G){te()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):Ee(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}function tt(re){var se=rt();return function(){var G=at()(re),Ae;if(se){var ct=at()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function rt(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var Ft=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Nt=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Kt=(z=Object(F.injectable)(),z(ue=function(re){ce()(N,re);var se=tt(N);function N(){return K()(this,N),se.apply(this,arguments)}return pe()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Nt,fs:Ft});var Ae=this.shaderModuleService.getModule("blur-pass"),ct=Ae.vs,Xt=Ae.fs,sr=Ae.uniforms,or=this.rendererService.getViewportSize(),Ir=or.width,an=or.height;return{vs:ct,fs:Xt,uniforms:Ke(Ke({},sr),{},{u_ViewportSize:[Ir,an]})}}},{key:"convertOptionsToUniforms",value:function(Ae){var ct={};return Go()(Ae.blurRadius)||(ct.u_BlurDir=[Ae.blurRadius,0]),ct}}]),N}(L.a))||ue),jt,Gt;function nr(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function rr(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?nr(Object(N),!0).forEach(function(G){te()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):nr(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}function Lr(re){var se=vr();return function(){var G=at()(re),Ae;if(se){var ct=at()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function vr(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var Sr=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Ar=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,rn=(jt=Object(F.injectable)(),jt(Gt=function(re){ce()(N,re);var se=Lr(N);function N(){return K()(this,N),se.apply(this,arguments)}return pe()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Ar,fs:Sr});var Ae=this.shaderModuleService.getModule("blur-pass"),ct=Ae.vs,Xt=Ae.fs,sr=Ae.uniforms,or=this.rendererService.getViewportSize(),Ir=or.width,an=or.height;return{vs:ct,fs:Xt,uniforms:rr(rr({},sr),{},{u_ViewportSize:[Ir,an]})}}},{key:"convertOptionsToUniforms",value:function(Ae){var ct={};return Go()(Ae.blurRadius)||(ct.u_BlurDir=[0,Ae.blurRadius]),ct}}]),N}(L.a))||Gt),Xr,mn;function Ln(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function qn(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?Ln(Object(N),!0).forEach(function(G){te()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):Ln(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}function sa(re){var se=Sa();return function(){var G=at()(re),Ae;if(se){var ct=at()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function Sa(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var Za=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,Sn=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,ua=(Xr=Object(F.injectable)(),Xr(mn=function(re){ce()(N,re);var se=sa(N);function N(){return K()(this,N),se.apply(this,arguments)}return pe()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:Sn,fs:Za});var Ae=this.shaderModuleService.getModule("colorhalftone-pass"),ct=Ae.vs,Xt=Ae.fs,sr=Ae.uniforms,or=this.rendererService.getViewportSize(),Ir=or.width,an=or.height;return{vs:ct,fs:Xt,uniforms:qn(qn({},sr),{},{u_ViewportSize:[Ir,an]})}}}]),N}(L.a))||mn),ba,Zn;function Aa(re){var se=na();return function(){var G=at()(re),Ae;if(se){var ct=at()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function na(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var La=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,za=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Gi=(ba=Object(F.injectable)(),ba(Zn=function(re){ce()(N,re);var se=Aa(N);function N(){return K()(this,N),se.apply(this,arguments)}return pe()(N,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:za,fs:La}),this.shaderModuleService.getModule("copy-pass")}}]),N}(L.a))||Zn),_i,Di;function gi(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function Ui(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?gi(Object(N),!0).forEach(function(G){te()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):gi(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}function Qo(re){var se=qo();return function(){var G=at()(re),Ae;if(se){var ct=at()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function qo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var vu=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,Mu=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,cs=(_i=Object(F.injectable)(),_i(Di=function(re){ce()(N,re);var se=Qo(N);function N(){return K()(this,N),se.apply(this,arguments)}return pe()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:Mu,fs:vu});var Ae=this.shaderModuleService.getModule("hexagonalpixelate-pass"),ct=Ae.vs,Xt=Ae.fs,sr=Ae.uniforms,or=this.rendererService.getViewportSize(),Ir=or.width,an=or.height;return{vs:ct,fs:Xt,uniforms:Ui(Ui({},sr),{},{u_ViewportSize:[Ir,an]})}}}]),N}(L.a))||Di),Gs,Pu;function sc(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function tu(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?sc(Object(N),!0).forEach(function(G){te()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):sc(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}function Xu(re){var se=uc();return function(){var G=at()(re),Ae;if(se){var ct=at()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function uc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var ru=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,Lu=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,fs=(Gs=Object(F.injectable)(),Gs(Pu=function(re){ce()(N,re);var se=Xu(N);function N(){return K()(this,N),se.apply(this,arguments)}return pe()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:Lu,fs:ru});var Ae=this.shaderModuleService.getModule("ink-pass"),ct=Ae.vs,Xt=Ae.fs,sr=Ae.uniforms,or=this.rendererService.getViewportSize(),Ir=or.width,an=or.height;return{vs:ct,fs:Xt,uniforms:tu(tu({},sr),{},{u_ViewportSize:[Ir,an]})}}}]),N}(L.a))||Pu),ao,Yu;function Gl(re){var se=hs();return function(){var G=at()(re),Ae;if(se){var ct=at()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function hs(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var Do=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,No=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Ho=(ao=Object(F.injectable)(),ao(Yu=function(re){ce()(N,re);var se=Gl(N);function N(){return K()(this,N),se.apply(this,arguments)}return pe()(N,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:No,fs:Do}),this.shaderModuleService.getModule("noise-pass")}}]),N}(L.a))||Yu),_o,uo;function Ls(re){var se=nu();return function(){var G=at()(re),Ae;if(se){var ct=at()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function nu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var Hl=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Gc=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,dl=(_o=Object(F.injectable)(),_o(uo=function(re){ce()(N,re);var se=Ls(N);function N(){return K()(this,N),se.apply(this,arguments)}return pe()(N,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:Hl,fs:Gc}),this.shaderModuleService.getModule("sepia-pass")}}]),N}(L.a))||uo),lc,pl,Rs,go,Ac,ds,sf,Cf=(lc=Object(F.injectable)(),pl=Object(F.inject)(D.a.IRendererService),Rs=Object(F.postConstruct)(),lc(go=(Ac=(sf=function(){function re(){K()(this,re),yn()(this,"rendererService",ds,this),this.passes=[],this.readFBO=void 0,this.writeFBO=void 0}return pe()(re,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"render",value:function(){var se=En()(mr.a.mark(function G(Ae){var ct,Xt;return mr.a.wrap(function(or){for(;;)switch(or.prev=or.next){case 0:ct=0;case 1:if(!(ct<this.passes.length)){or.next=10;break}return Xt=this.passes[ct],Xt.setRenderToScreen(this.isLastEnabledPass(ct)),or.next=6,Xt.render(Ae);case 6:ct!==this.passes.length-1&&this.swap();case 7:ct++,or.next=1;break;case 10:case"end":return or.stop()}},G,this)}));function N(G){return se.apply(this,arguments)}return N}()},{key:"resize",value:function(N,G){this.readFBO.resize({width:N,height:G}),this.writeFBO.resize({width:N,height:G})}},{key:"add",value:function(N,G,Ae){N.init(G,Ae),this.passes.push(N)}},{key:"insert",value:function(N,G,Ae,ct){N.init(Ae,ct),this.passes.splice(G,0,N)}},{key:"getPostProcessingPassByName",value:function(N){return this.passes.find(function(G){return G.getName()===N})}},{key:"init",value:function(){}},{key:"isLastEnabledPass",value:function(N){for(var G=N+1;G<this.passes.length;G++)if(this.passes[G].isEnabled())return!1;return!0}},{key:"swap",value:function(){var N=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=N}}]),re}(),sf),ds=Pn()(Ac.prototype,"rendererService",[pl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pn()(Ac.prototype,"init",[Rs],Object.getOwnPropertyDescriptor(Ac.prototype,"init"),Ac.prototype),Ac))||go),wf,Cc;function Ku(re){var se=Ef();return function(){var G=at()(re),Ae;if(se){var ct=at()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function Ef(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var uf=(wf=Object(F.injectable)(),wf(Cc=function(re){ce()(N,re);var se=Ku(N);function N(){return K()(this,N),se.apply(this,arguments)}return pe()(N,[{key:"getType",value:function(){return Ss.a.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(Ae,ct){vo()(at()(N.prototype),"init",this).call(this,Ae,ct)}},{key:"render",value:function(Ae){var ct=this.rendererService,Xt=ct.useFramebuffer,sr=ct.clear;Xt(null,function(){sr({color:[0,0,0,0],depth:1,stencil:0}),Ae.multiPassRenderer.setRenderFlag(!1),Ae.render(),Ae.multiPassRenderer.setRenderFlag(!0)})}}]),N}(hl))||Cc),Of,Ru,cc,Df,Hc,wc,Qf,qf;function eh(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function th(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?eh(Object(N),!0).forEach(function(G){te()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):eh(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}function Mf(re){var se=rh();return function(){var G=at()(re),Ae;if(se){var ct=at()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function rh(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var Zl=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,lf=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,io=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function fc(re,se){for(var N=0,G=1/se,Ae=re;Ae>0;)N=N+G*(Ae%se),Ae=Math.floor(Ae/se),G=G/se;return N}var Tf=1,Oc=(Of=Object(F.injectable)(),Ru=Object(F.inject)(D.a.IShaderModuleService),cc=Object(F.inject)(D.a.ILogService),Of(Df=(Hc=(qf=function(re){ce()(N,re);var se=Mf(N);function N(){var G;K()(this,N);for(var Ae=arguments.length,ct=new Array(Ae),Xt=0;Xt<Ae;Xt++)ct[Xt]=arguments[Xt];return G=se.call.apply(se,[this].concat(ct)),yn()(G,"shaderModuleService",wc,Ga()(G)),yn()(G,"logger",Qf,Ga()(G)),G.haltonSequence=[],G.accumulatingId=0,G.frame=0,G.timer=void 0,G.sampleRenderTarget=void 0,G.prevRenderTarget=void 0,G.outputRenderTarget=void 0,G.copyRenderTarget=void 0,G.blendModel=void 0,G.outputModel=void 0,G.copyModel=void 0,G}return pe()(N,[{key:"getType",value:function(){return Ss.a.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(Ae,ct){vo()(at()(N.prototype),"init",this).call(this,Ae,ct);var Xt=this.rendererService,sr=Xt.createFramebuffer,or=Xt.createTexture2D;this.sampleRenderTarget=sr({color:or({width:1,height:1,wrapS:Vn.a.CLAMP_TO_EDGE,wrapT:Vn.a.CLAMP_TO_EDGE})}),this.prevRenderTarget=sr({color:or({width:1,height:1,wrapS:Vn.a.CLAMP_TO_EDGE,wrapT:Vn.a.CLAMP_TO_EDGE})}),this.outputRenderTarget=sr({color:or({width:1,height:1,wrapS:Vn.a.CLAMP_TO_EDGE,wrapT:Vn.a.CLAMP_TO_EDGE})}),this.copyRenderTarget=sr({color:or({width:1,height:1,wrapS:Vn.a.CLAMP_TO_EDGE,wrapT:Vn.a.CLAMP_TO_EDGE})});for(var Ir=0;Ir<30;Ir++)this.haltonSequence.push([fc(Ir,2),fc(Ir,3)]);this.blendModel=this.createTriangleModel("blend-pass",Zl),this.outputModel=this.createTriangleModel("copy-pass",lf,{blend:{enable:!0,func:{srcRGB:Vn.a.ONE,dstRGB:Vn.a.ONE_MINUS_SRC_ALPHA,srcAlpha:Vn.a.ONE,dstAlpha:Vn.a.ONE_MINUS_SRC_ALPHA},equation:{rgb:Vn.a.FUNC_ADD,alpha:Vn.a.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",lf)}},{key:"render",value:function(Ae){var ct=this,Xt=this.rendererService,sr=Xt.clear,or=Xt.getViewportSize,Ir=Xt.useFramebuffer,an=or(),Gn=an.width,ea=an.height;this.sampleRenderTarget.resize({width:Gn,height:ea}),this.prevRenderTarget.resize({width:Gn,height:ea}),this.outputRenderTarget.resize({width:Gn,height:ea}),this.copyRenderTarget.resize({width:Gn,height:ea}),this.resetFrame(),this.stopAccumulating();var la=Ae.multiPassRenderer.getPostProcessor().getReadFBO();Ir(la,function(){sr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:la}),Ae.multiPassRenderer.setRenderFlag(!1),Ae.render(),Ae.multiPassRenderer.setRenderFlag(!0)});var qa=function Fa(yi){if(!ct.accumulatingId||yi!==ct.accumulatingId)return;ct.isFinished()||(ct.doRender(Ae),requestAnimationFrame(function(){Fa(yi)}))};this.accumulatingId=Tf++,this.timer=window.setTimeout(function(){qa(ct.accumulatingId)},50)}},{key:"doRender",value:function(Ae){var ct=this;this.logger.debug("accumulatingId: ".concat(this.accumulatingId));var Xt=this.rendererService,sr=Xt.clear,or=Xt.getViewportSize,Ir=Xt.useFramebuffer,an=or(),Gn=an.width,ea=an.height,la=Ae.getLayerConfig(),qa=la.jitterScale,Fa=qa===void 0?1:qa,yi=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((yi[0]*2-1)/Gn*Fa,(yi[1]*2-1)/ea*Fa),Ae.multiPassRenderer.setRenderFlag(!1),Ae.hooks.beforeRender.call(),Ir(this.sampleRenderTarget,function(){sr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:ct.sampleRenderTarget}),Ae.render()}),Ae.hooks.afterRender.call(),Ae.multiPassRenderer.setRenderFlag(!0);var Ja=Ae.getLayerConfig();Ir(this.outputRenderTarget,function(){ct.blendModel.draw({uniforms:{u_opacity:Ja.opacity||1,u_MixRatio:ct.frame===0?1:.9,u_Diffuse1:ct.sampleRenderTarget,u_Diffuse2:ct.frame===0?Ae.multiPassRenderer.getPostProcessor().getReadFBO():ct.prevRenderTarget}})}),this.frame===0&&sr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(Ir(this.copyRenderTarget,function(){ct.outputModel.draw({uniforms:{u_Texture:ct.outputRenderTarget}})}),Ir(Ae.multiPassRenderer.getPostProcessor().getReadFBO(),function(){ct.copyModel.draw({uniforms:{u_Texture:ct.copyRenderTarget}})}),Ae.multiPassRenderer.getPostProcessor().render(Ae));var Bi=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=Bi,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,window.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(Ae,ct,Xt){this.shaderModuleService.registerModule(Ae,{vs:io,fs:ct});var sr=this.shaderModuleService.getModule(Ae),or=sr.vs,Ir=sr.fs,an=sr.uniforms,Gn=this.rendererService,ea=Gn.createAttribute,la=Gn.createBuffer,qa=Gn.createModel;return qa(th({vs:or,fs:Ir,attributes:{a_Position:ea({buffer:la({data:[-4,-4,4,-4,0,4],type:Vn.a.FLOAT}),size:2})},uniforms:th({},an),depth:{enable:!1},count:3},Xt))}}]),N}(hl),qf),wc=Pn()(Hc.prototype,"shaderModuleService",[Ru],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qf=Pn()(Hc.prototype,"logger",[cc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hc))||Df),au=new F.Container;au.bind(D.a.IGlobalConfigService).to(hn).inSingletonScope(),au.bind(D.a.IShaderModuleService).to(us).inSingletonScope(),au.bind(D.a.ILogService).to(Dl).inSingletonScope(),Object(F.decorate)(Object(F.injectable)(),m.EventEmitter),au.bind(D.a.IEventEmitter).to(m.EventEmitter);var wl=Z()(au,!1),_f=function(se){var N=wl.lazyInject(se);return function(G,Ae,ct){N.call(this,G,Ae),ct&&(ct.initializer=function(){return G[Ae]})}},Nf=function(se){var N=wl.lazyMultiInject(se);return function(G,Ae,ct){N.call(this,G,Ae),ct&&(ct.initializer=function(){return G[Ae]})}},Zc=E.c=au,cf=0;function Wc(){var re=new F.Container;return re.parent=au,re.bind(D.a.SceneID).toConstantValue("".concat(cf++)),re.bind(D.a.ILayerService).to(Wn).inSingletonScope(),re.bind(D.a.ISceneService).to(Os).inSingletonScope(),re.bind(D.a.ICameraService).to(hr).inSingletonScope(),re.bind(D.a.ICoordinateSystemService).to(Vo).inSingletonScope(),re.bind(D.a.IInteractionService).to(Le).inSingletonScope(),re.bind(D.a.IPickingService).to(Ks).inSingletonScope(),re.bind(D.a.IControlService).to(Yn).inSingletonScope(),re.bind(D.a.IMarkerService).to(le).inSingletonScope(),re.bind(D.a.IIconService).to(xt).inSingletonScope(),re.bind(D.a.IFontService).to(R).inSingletonScope(),re.bind(D.a.IPopupService).to(Bt).inSingletonScope(),re.bind(D.a.INormalPass).to(xf).whenTargetNamed("clear"),re.bind(D.a.INormalPass).to(w).whenTargetNamed("pixelPicking"),re.bind(D.a.INormalPass).to(uf).whenTargetNamed("render"),re.bind(D.a.INormalPass).to(Oc).whenTargetNamed("taa"),re.bind(D.a.IFactoryNormalPass).toFactory(function(se){return function(N){return se.container.getNamed(D.a.INormalPass,N)}}),re.bind(D.a.IPostProcessingPass).to(Gi).whenTargetNamed("copy"),re.bind(D.a.IPostProcessingPass).to(Kt).whenTargetNamed("blurH"),re.bind(D.a.IPostProcessingPass).to(rn).whenTargetNamed("blurV"),re.bind(D.a.IPostProcessingPass).to(Ho).whenTargetNamed("noise"),re.bind(D.a.IPostProcessingPass).to(dl).whenTargetNamed("sepia"),re.bind(D.a.IPostProcessingPass).to(ua).whenTargetNamed("colorHalftone"),re.bind(D.a.IPostProcessingPass).to(cs).whenTargetNamed("hexagonalPixelate"),re.bind(D.a.IPostProcessingPass).to(fs).whenTargetNamed("ink"),re.bind(D.a.IFactoryPostProcessingPass).toFactory(function(se){return function(N){var G=se.container.getNamed(D.a.IPostProcessingPass,N);return G.setName(N),G}}),re}function ml(re){var se=new F.Container;return se.parent=re,se.bind(D.a.IStyleAttributeService).to(pf).inSingletonScope(),se.bind(D.a.IMultiPassRenderer).to(Wu).inSingletonScope(),se.bind(D.a.IPostProcessor).to(Cf).inSingletonScope(),se}},fbrv:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("Yk9n"),m=o("MON2"),Y=o("FV85"),F=o("xfSm"),i=o("ujMp");E.getFunctionName=i.getFunctionName;var Z=o("dX1H");function D(Ze,Pe){var mt=i.getFunctionName(Pe),De=$(Ze,mt,Pe,!1);return De}E.getDependencies=D;function $(Ze,Pe,mt,De){var At=Ze.getConstructorMetadata(mt),it=At.compilerGeneratedMetadata;if(it===void 0){var vt=m.MISSING_INJECTABLE_ANNOTATION+" "+Pe+".";throw new Error(vt)}var Je=At.userGeneratedMetadata,_t=Object.keys(Je),wt=mt.length===0&&_t.length>0,ke=wt?_t.length:mt.length,Re=fe(De,Pe,it,Je,ke),Ve=K(Ze,mt),dt=Re.concat(Ve);return dt}function te(Ze,Pe,mt,De,At){var it=At[Ze.toString()]||[],vt=pe(it),Je=vt.unmanaged!==!0,_t=De[Ze],wt=vt.inject||vt.multiInject;if(_t=wt||_t,_t instanceof b.LazyServiceIdentifer&&(_t=_t.unwrap()),Je){var ke=_t===Object,Re=_t===Function,Ve=_t===void 0,dt=ke||Re||Ve;if(!Pe&&dt){var Me=m.MISSING_INJECT_ANNOTATION+" argument "+Ze+" in class "+mt+".";throw new Error(Me)}var ht=new Z.Target(Y.TargetTypeEnum.ConstructorArgument,vt.targetName,_t);return ht.metadata=it,ht}return null}function fe(Ze,Pe,mt,De,At){for(var it=[],vt=0;vt<At;vt++){var Je=vt,_t=te(Je,Ze,Pe,mt,De);_t!==null&&it.push(_t)}return it}function K(Ze,Pe){for(var mt=Ze.getPropertiesMetadata(Pe),De=[],At=Object.keys(mt),it=0,vt=At;it<vt.length;it++){var Je=vt[it],_t=mt[Je],wt=pe(mt[Je]),ke=wt.targetName||Je,Re=wt.inject||wt.multiInject,Ve=new Z.Target(Y.TargetTypeEnum.ClassProperty,ke,Re);Ve.metadata=_t,De.push(Ve)}var dt=Object.getPrototypeOf(Pe.prototype).constructor;if(dt!==Object){var Me=K(Ze,dt);De=De.concat(Me)}return De}function Ge(Ze,Pe){var mt=Object.getPrototypeOf(Pe.prototype).constructor;if(mt!==Object){var De=i.getFunctionName(mt),At=$(Ze,De,mt,!0),it=At.map(function(_t){return _t.metadata.filter(function(wt){return wt.key===F.UNMANAGED_TAG})}),vt=[].concat.apply([],it).length,Je=At.length-vt;return Je>0?Je:Ge(Ze,mt)}else return 0}E.getBaseClassDependencyCount=Ge;function pe(Ze){var Pe={};return Ze.forEach(function(mt){Pe[mt.key.toString()]=mt.value}),{inject:Pe[F.INJECT_TAG],multiInject:Pe[F.MULTI_INJECT_TAG],targetName:Pe[F.NAME_TAG],unmanaged:Pe[F.UNMANAGED_TAG]}}},fbvF:function(ze,E,o){(function(b,m){ze.exports=m()})(this,function(){"use strict";var b=function(je){return je instanceof Uint8Array||je instanceof Uint16Array||je instanceof Uint32Array||je instanceof Int8Array||je instanceof Int16Array||je instanceof Int32Array||je instanceof Float32Array||je instanceof Float64Array||je instanceof Uint8ClampedArray},m=function(je,Ot){for(var xr=Object.keys(Ot),Pr=0;Pr<xr.length;++Pr)je[xr[Pr]]=Ot[xr[Pr]];return je},Y=`
`;function F(ye){return typeof atob!="undefined"?atob(ye):"base64:"+ye}function i(ye){var je=new Error("(regl) "+ye);throw console.error(je),je}function Z(ye,je){ye||i(je)}function D(ye){return ye?": "+ye:""}function $(ye,je,Ot){ye in je||i("unknown parameter ("+ye+")"+D(Ot)+". possible values: "+Object.keys(je).join())}function te(ye,je){b(ye)||i("invalid parameter type"+D(je)+". must be a typed array")}function fe(ye,je){switch(je){case"number":return typeof ye=="number";case"object":return typeof ye=="object";case"string":return typeof ye=="string";case"boolean":return typeof ye=="boolean";case"function":return typeof ye=="function";case"undefined":return typeof ye=="undefined";case"symbol":return typeof ye=="symbol"}}function K(ye,je,Ot){fe(ye,je)||i("invalid parameter type"+D(Ot)+". expected "+je+", got "+typeof ye)}function Ge(ye,je){ye>=0&&(ye|0)===ye||i("invalid parameter type, ("+ye+")"+D(je)+". must be a nonnegative integer")}function pe(ye,je,Ot){je.indexOf(ye)<0&&i("invalid value"+D(Ot)+". must be one of: "+je)}var Ze=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function Pe(ye){Object.keys(ye).forEach(function(je){Ze.indexOf(je)<0&&i('invalid regl constructor argument "'+je+'". must be one of '+Ze)})}function mt(ye,je){for(ye=ye+"";ye.length<je;)ye=" "+ye;return ye}function De(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function At(ye,je){this.number=ye,this.line=je,this.errors=[]}function it(ye,je,Ot){this.file=ye,this.line=je,this.message=Ot}function vt(){var ye=new Error,je=(ye.stack||ye).toString(),Ot=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(je);if(Ot)return Ot[1];var xr=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(je);return xr?xr[1]:"unknown"}function Je(){var ye=new Error,je=(ye.stack||ye).toString(),Ot=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(je);if(Ot)return Ot[1];var xr=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(je);return xr?xr[1]:"unknown"}function _t(ye,je){var Ot=ye.split(`
`),xr=1,Pr=0,Cr={unknown:new De,0:new De};Cr.unknown.name=Cr[0].name=je||vt(),Cr.unknown.lines.push(new At(0,""));for(var Er=0;Er<Ot.length;++Er){var Zr=Ot[Er],on=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Zr);if(on)switch(on[1]){case"line":var en=/(\d+)(\s+\d+)?/.exec(on[2]);en&&(xr=en[1]|0,en[2]&&(Pr=en[2]|0,Pr in Cr||(Cr[Pr]=new De)));break;case"define":var Yr=/SHADER_NAME(_B64)?\s+(.*)$/.exec(on[2]);Yr&&(Cr[Pr].name=Yr[1]?F(Yr[2]):Yr[2]);break}Cr[Pr].lines.push(new At(xr++,Zr))}return Object.keys(Cr).forEach(function(cn){var Tn=Cr[cn];Tn.lines.forEach(function(dn){Tn.index[dn.number]=dn})}),Cr}function wt(ye){var je=[];return ye.split(`
`).forEach(function(Ot){if(Ot.length<5)return;var xr=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(Ot);xr?je.push(new it(xr[1]|0,xr[2]|0,xr[3].trim())):Ot.length>0&&je.push(new it("unknown",0,Ot))}),je}function ke(ye,je){je.forEach(function(Ot){var xr=ye[Ot.file];if(xr){var Pr=xr.index[Ot.line];if(Pr){Pr.errors.push(Ot),xr.hasErrors=!0;return}}ye.unknown.hasErrors=!0,ye.unknown.lines[0].errors.push(Ot)})}function Re(ye,je,Ot,xr,Pr){if(!ye.getShaderParameter(je,ye.COMPILE_STATUS)){var Cr=ye.getShaderInfoLog(je),Er=xr===ye.FRAGMENT_SHADER?"fragment":"vertex";ur(Ot,"string",Er+" shader source must be a string",Pr);var Zr=_t(Ot,Pr),on=wt(Cr);ke(Zr,on),Object.keys(Zr).forEach(function(en){var Yr=Zr[en];if(!Yr.hasErrors)return;var cn=[""],Tn=[""];function dn(nn,Tr){cn.push(nn),Tn.push(Tr||"")}dn("file number "+en+": "+Yr.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Yr.lines.forEach(function(nn){if(nn.errors.length>0){dn(mt(nn.number,4)+"|  ","background-color:yellow; font-weight:bold"),dn(nn.line+Y,"color:red; background-color:yellow; font-weight:bold");var Tr=0;nn.errors.forEach(function(br){var Wr=br.message,wn=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Wr);if(wn){var Rr=wn[1];Wr=wn[2];switch(Rr){case"assign":Rr="=";break}Tr=Math.max(nn.line.indexOf(Rr,Tr),0)}else Tr=0;dn(mt("| ",6)),dn(mt("^^^",Tr+3)+Y,"font-weight:bold"),dn(mt("| ",6)),dn(Wr+Y,"font-weight:bold")}),dn(mt("| ",6)+Y)}else dn(mt(nn.number,4)+"|  "),dn(nn.line+Y,"color:red")}),typeof document!="undefined"&&!window.chrome?(Tn[0]=cn.join("%c"),console.log.apply(console,Tn)):console.log(cn.join(""))}),Z.raise("Error compiling "+Er+" shader, "+Zr[0].name)}}function Ve(ye,je,Ot,xr,Pr){if(!ye.getProgramParameter(je,ye.LINK_STATUS)){var Cr=ye.getProgramInfoLog(je),Er=_t(Ot,Pr),Zr=_t(xr,Pr),on='Error linking program with vertex shader, "'+Zr[0].name+'", and fragment shader "'+Er[0].name+'"';typeof document!="undefined"?console.log("%c"+on+Y+"%c"+Cr,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(on+Y+Cr),Z.raise(on)}}function dt(ye){ye._commandRef=vt()}function Me(ye,je,Ot,xr){dt(ye);function Pr(on){return on?xr.id(on):0}ye._fragId=Pr(ye.static.frag),ye._vertId=Pr(ye.static.vert);function Cr(on,en){Object.keys(en).forEach(function(Yr){on[xr.id(Yr)]=!0})}var Er=ye._uniformSet={};Cr(Er,je.static),Cr(Er,je.dynamic);var Zr=ye._attributeSet={};Cr(Zr,Ot.static),Cr(Zr,Ot.dynamic),ye._hasCount="count"in ye.static||"count"in ye.dynamic||"elements"in ye.static||"elements"in ye.dynamic}function ht(ye,je){var Ot=Je();i(ye+" in command "+(je||vt())+(Ot==="unknown"?"":" called from "+Ot))}function Zt(ye,je,Ot){ye||ht(je,Ot||vt())}function Qt(ye,je,Ot,xr){ye in je||ht("unknown parameter ("+ye+")"+D(Ot)+". possible values: "+Object.keys(je).join(),xr||vt())}function ur(ye,je,Ot,xr){fe(ye,je)||ht("invalid parameter type"+D(Ot)+". expected "+je+", got "+typeof ye,xr||vt())}function oe(ye){ye()}function Q(ye,je,Ot){ye.texture?pe(ye.texture._texture.internalformat,je,"unsupported texture format for attachment"):pe(ye.renderbuffer._renderbuffer.format,Ot,"unsupported renderbuffer format for attachment")}var H=33071,Se=9728,be=9984,Te=9985,me=9986,nt=9987,Jt=5120,Mt=5121,ve=5122,ge=5123,He=5124,ot=5125,we=5126,gt=32819,C=32820,R=33635,q=34042,ce=36193,We={};We[Jt]=We[Mt]=1,We[ve]=We[ge]=We[ce]=We[R]=We[gt]=We[C]=2,We[He]=We[ot]=We[we]=We[q]=4;function qe(ye,je){return ye===C||ye===gt||ye===R?2:ye===q?4:We[ye]*je}function Tt(ye){return!(ye&ye-1)&&!!ye}function at(ye,je,Ot){var xr,Pr=je.width,Cr=je.height,Er=je.channels;Z(Pr>0&&Pr<=Ot.maxTextureSize&&Cr>0&&Cr<=Ot.maxTextureSize,"invalid texture shape"),(ye.wrapS!==H||ye.wrapT!==H)&&Z(Tt(Pr)&&Tt(Cr),"incompatible wrap mode for texture, both width and height must be power of 2"),je.mipmask===1?Pr!==1&&Cr!==1&&Z(ye.minFilter!==be&&ye.minFilter!==me&&ye.minFilter!==Te&&ye.minFilter!==nt,"min filter requires mipmap"):(Z(Tt(Pr)&&Tt(Cr),"texture must be a square power of 2 to support mipmapping"),Z(je.mipmask===(Pr<<1)-1,"missing or incomplete mipmap data")),je.type===we&&(Ot.extensions.indexOf("oes_texture_float_linear")<0&&Z(ye.minFilter===Se&&ye.magFilter===Se,"filter not supported, must enable oes_texture_float_linear"),Z(!ye.genMipmaps,"mipmap generation not supported with float textures"));var Zr=je.images;for(xr=0;xr<16;++xr)if(Zr[xr]){var on=Pr>>xr,en=Cr>>xr;Z(je.mipmask&1<<xr,"missing mipmap data");var Yr=Zr[xr];if(Z(Yr.width===on&&Yr.height===en,"invalid shape for mip images"),Z(Yr.format===je.format&&Yr.internalformat===je.internalformat&&Yr.type===je.type,"incompatible type for mip image"),!Yr.compressed)if(Yr.data){var cn=Math.ceil(qe(Yr.type,Er)*on/Yr.unpackAlignment)*Yr.unpackAlignment;Z(Yr.data.byteLength===cn*en,"invalid data for image, buffer size is inconsistent with image format")}else Yr.element||Yr.copy}else ye.genMipmaps||Z((je.mipmask&1<<xr)===0,"extra mipmap data");je.compressed&&Z(!ye.genMipmaps,"mipmap generation for compressed images not supported")}function Ut(ye,je,Ot,xr){var Pr=ye.width,Cr=ye.height,Er=ye.channels;Z(Pr>0&&Pr<=xr.maxTextureSize&&Cr>0&&Cr<=xr.maxTextureSize,"invalid texture shape"),Z(Pr===Cr,"cube map must be square"),Z(je.wrapS===H&&je.wrapT===H,"wrap mode not supported by cube map");for(var Zr=0;Zr<Ot.length;++Zr){var on=Ot[Zr];Z(on.width===Pr&&on.height===Cr,"inconsistent cube map face shape"),je.genMipmaps&&(Z(!on.compressed,"can not generate mipmap for compressed textures"),Z(on.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var en=on.images,Yr=0;Yr<16;++Yr){var cn=en[Yr];if(cn){var Tn=Pr>>Yr,dn=Cr>>Yr;Z(on.mipmask&1<<Yr,"missing mipmap data"),Z(cn.width===Tn&&cn.height===dn,"invalid shape for mip images"),Z(cn.format===ye.format&&cn.internalformat===ye.internalformat&&cn.type===ye.type,"incompatible type for mip image"),cn.compressed||(cn.data?Z(cn.data.byteLength===Tn*dn*Math.max(qe(cn.type,Er),cn.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):cn.element||cn.copy)}}}}var J=m(Z,{optional:oe,raise:i,commandRaise:ht,command:Zt,parameter:$,commandParameter:Qt,constructor:Pe,type:K,commandType:ur,isTypedArray:te,nni:Ge,oneOf:pe,shaderError:Re,linkError:Ve,callSite:Je,saveCommandRef:dt,saveDrawInfo:Me,framebufferFormat:Q,guessCommand:vt,texture2D:at,textureCube:Ut}),Qe=0,ne=0,et=5,kt=6;function dr(ye,je){this.id=Qe++,this.type=ye,this.data=je}function Ye(ye){return ye.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function xt(ye){if(ye.length===0)return[];var je=ye.charAt(0),Ot=ye.charAt(ye.length-1);if(ye.length>1&&je===Ot&&(je==='"'||je==="'"))return['"'+Ye(ye.substr(1,ye.length-2))+'"'];var xr=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(ye);if(xr)return xt(ye.substr(0,xr.index)).concat(xt(xr[1])).concat(xt(ye.substr(xr.index+xr[0].length)));var Pr=ye.split(".");if(Pr.length===1)return['"'+Ye(ye)+'"'];for(var Cr=[],Er=0;Er<Pr.length;++Er)Cr=Cr.concat(xt(Pr[Er]));return Cr}function bt(ye){return"["+xt(ye).join("][")+"]"}function Et(ye,je){return new dr(ye,bt(je+""))}function Fe(ye){return typeof ye=="function"&&!ye._reglType||ye instanceof dr}function pt(ye,je){if(typeof ye=="function")return new dr(ne,ye);if(typeof ye=="number"||typeof ye=="boolean")return new dr(et,ye);if(Array.isArray(ye))return new dr(kt,ye.map(function(Ot,xr){return pt(Ot,je+"["+xr+"]")}));if(ye instanceof dr)return ye;J(!1,"invalid option type in uniform "+je)}var yt={DynamicVariable:dr,define:Et,isDynamic:Fe,unbox:pt,accessor:bt},Ht={next:typeof requestAnimationFrame=="function"?function(ye){return requestAnimationFrame(ye)}:function(ye){return setTimeout(ye,16)},cancel:typeof cancelAnimationFrame=="function"?function(ye){return cancelAnimationFrame(ye)}:clearTimeout},hr=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Hr(){var ye={"":0},je=[""];return{id:function(xr){var Pr=ye[xr];return Pr||(Pr=ye[xr]=je.length,je.push(xr),Pr)},str:function(xr){return je[xr]}}}function gr(ye,je,Ot){var xr=document.createElement("canvas");m(xr.style,{border:0,margin:0,padding:0,top:0,left:0}),ye.appendChild(xr),ye===document.body&&(xr.style.position="absolute",m(ye.style,{margin:0,padding:0}));function Pr(){var Zr=window.innerWidth,on=window.innerHeight;if(ye!==document.body){var en=ye.getBoundingClientRect();Zr=en.right-en.left,on=en.bottom-en.top}xr.width=Ot*Zr,xr.height=Ot*on,m(xr.style,{width:Zr+"px",height:on+"px"})}var Cr;ye!==document.body&&typeof ResizeObserver=="function"?(Cr=new ResizeObserver(function(){setTimeout(Pr)}),Cr.observe(ye)):window.addEventListener("resize",Pr,!1);function Er(){Cr?Cr.disconnect():window.removeEventListener("resize",Pr),ye.removeChild(xr)}return Pr(),{canvas:xr,onDestroy:Er}}function Bn(ye,je){function Ot(xr){try{return ye.getContext(xr,je)}catch(Pr){return null}}return Ot("webgl")||Ot("experimental-webgl")||Ot("webgl-experimental")}function zn(ye){return typeof ye.nodeName=="string"&&typeof ye.appendChild=="function"&&typeof ye.getBoundingClientRect=="function"}function oa(ye){return typeof ye.drawArrays=="function"||typeof ye.drawElements=="function"}function $n(ye){return typeof ye=="string"?ye.split():(J(Array.isArray(ye),"invalid extension array"),ye)}function Yn(ye){return typeof ye=="string"?(J(typeof document!="undefined","not supported outside of DOM"),document.querySelector(ye)):ye}function On(ye){var je=ye||{},Ot,xr,Pr,Cr,Er={},Zr=[],on=[],en=typeof window=="undefined"?1:window.devicePixelRatio,Yr=!1,cn=function(Tr){Tr&&J.raise(Tr)},Tn=function(){};if(typeof je=="string"?(J(typeof document!="undefined","selector queries only supported in DOM enviroments"),Ot=document.querySelector(je),J(Ot,"invalid query string for element")):typeof je=="object"?zn(je)?Ot=je:oa(je)?(Cr=je,Pr=Cr.canvas):(J.constructor(je),"gl"in je?Cr=je.gl:"canvas"in je?Pr=Yn(je.canvas):"container"in je&&(xr=Yn(je.container)),"attributes"in je&&(Er=je.attributes,J.type(Er,"object","invalid context attributes")),"extensions"in je&&(Zr=$n(je.extensions)),"optionalExtensions"in je&&(on=$n(je.optionalExtensions)),"onDone"in je&&(J.type(je.onDone,"function","invalid or missing onDone callback"),cn=je.onDone),"profile"in je&&(Yr=!!je.profile),"pixelRatio"in je&&(en=+je.pixelRatio,J(en>0,"invalid pixel ratio"))):J.raise("invalid arguments to regl"),Ot&&(Ot.nodeName.toLowerCase()==="canvas"?Pr=Ot:xr=Ot),!Cr){if(!Pr){J(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var dn=gr(xr||document.body,cn,en);if(!dn)return null;Pr=dn.canvas,Tn=dn.onDestroy}Er.premultipliedAlpha===void 0&&(Er.premultipliedAlpha=!0),Cr=Bn(Pr,Er)}return Cr?{gl:Cr,canvas:Pr,container:xr,extensions:Zr,optionalExtensions:on,pixelRatio:en,profile:Yr,onDone:cn,onDestroy:Tn}:(Tn(),cn("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function U(ye,je){var Ot={};function xr(Er){J.type(Er,"string","extension name must be string");var Zr=Er.toLowerCase(),on;try{on=Ot[Zr]=ye.getExtension(Zr)}catch(en){}return!!on}for(var Pr=0;Pr<je.extensions.length;++Pr){var Cr=je.extensions[Pr];if(!xr(Cr))return je.onDestroy(),je.onDone('"'+Cr+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return je.optionalExtensions.forEach(xr),{extensions:Ot,restore:function(){Object.keys(Ot).forEach(function(Zr){if(Ot[Zr]&&!xr(Zr))throw new Error("(regl): error restoring extension "+Zr)})}}}function W(ye,je){for(var Ot=Array(ye),xr=0;xr<ye;++xr)Ot[xr]=je(xr);return Ot}var le=5120,xe=5121,st=5122,Ct=5123,Bt=5124,Xe=5125,Lt=5126;function lr(ye){for(var je=16;je<=1<<28;je*=16)if(ye<=je)return je;return 0}function zr(ye){var je,Ot;return je=(ye>65535)<<4,ye>>>=je,Ot=(ye>255)<<3,ye>>>=Ot,je|=Ot,Ot=(ye>15)<<2,ye>>>=Ot,je|=Ot,Ot=(ye>3)<<1,ye>>>=Ot,je|=Ot,je|ye>>1}function Vr(){var ye=W(8,function(){return[]});function je(Cr){var Er=lr(Cr),Zr=ye[zr(Er)>>2];return Zr.length>0?Zr.pop():new ArrayBuffer(Er)}function Ot(Cr){ye[zr(Cr.byteLength)>>2].push(Cr)}function xr(Cr,Er){var Zr=null;switch(Cr){case le:Zr=new Int8Array(je(Er),0,Er);break;case xe:Zr=new Uint8Array(je(Er),0,Er);break;case st:Zr=new Int16Array(je(2*Er),0,Er);break;case Ct:Zr=new Uint16Array(je(2*Er),0,Er);break;case Bt:Zr=new Int32Array(je(4*Er),0,Er);break;case Xe:Zr=new Uint32Array(je(4*Er),0,Er);break;case Lt:Zr=new Float32Array(je(4*Er),0,Er);break;default:return null}return Zr.length!==Er?Zr.subarray(0,Er):Zr}function Pr(Cr){Ot(Cr.buffer)}return{alloc:je,free:Ot,allocType:xr,freeType:Pr}}var cr=Vr();cr.zero=Vr();var Ur=3408,Mn=3410,ln=3411,er=3412,tn=3413,hn=3414,xn=3415,yn=33901,vn=33902,Pn=3379,Va=3386,va=34921,Ma=36347,Ia=36348,Wi=35661,da=35660,di=34930,ga=36349,ya=34076,fa=34024,Si=7936,ns=7937,Xi=7938,Vo=35724,ju=34047,Ga=36063,Ai=34852,Ko=3553,oi=34067,Yi=34069,wo=33984,Ha=6408,oo=5126,so=5121,Eu=36160,$o=36053,Kl=36064,ks=16384,ho=function(je,Ot){var xr=1;Ot.ext_texture_filter_anisotropic&&(xr=je.getParameter(ju));var Pr=1,Cr=1;Ot.webgl_draw_buffers&&(Pr=je.getParameter(Ai),Cr=je.getParameter(Ga));var Er=!!Ot.oes_texture_float;if(Er){var Zr=je.createTexture();je.bindTexture(Ko,Zr),je.texImage2D(Ko,0,Ha,1,1,0,Ha,oo,null);var on=je.createFramebuffer();if(je.bindFramebuffer(Eu,on),je.framebufferTexture2D(Eu,Kl,Ko,Zr,0),je.bindTexture(Ko,null),je.checkFramebufferStatus(Eu)!==$o)Er=!1;else{je.viewport(0,0,1,1),je.clearColor(1,0,0,1),je.clear(ks);var en=cr.allocType(oo,4);je.readPixels(0,0,1,1,Ha,oo,en),je.getError()?Er=!1:(je.deleteFramebuffer(on),je.deleteTexture(Zr),Er=en[0]===1),cr.freeType(en)}}var Yr=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),cn=!0;if(!Yr){var Tn=je.createTexture(),dn=cr.allocType(so,36);je.activeTexture(wo),je.bindTexture(oi,Tn),je.texImage2D(Yi,0,Ha,3,3,0,Ha,so,dn),cr.freeType(dn),je.bindTexture(oi,null),je.deleteTexture(Tn),cn=!je.getError()}return{colorBits:[je.getParameter(Mn),je.getParameter(ln),je.getParameter(er),je.getParameter(tn)],depthBits:je.getParameter(hn),stencilBits:je.getParameter(xn),subpixelBits:je.getParameter(Ur),extensions:Object.keys(Ot).filter(function(nn){return!!Ot[nn]}),maxAnisotropic:xr,maxDrawbuffers:Pr,maxColorAttachments:Cr,pointSizeDims:je.getParameter(yn),lineWidthDims:je.getParameter(vn),maxViewportDims:je.getParameter(Va),maxCombinedTextureUnits:je.getParameter(Wi),maxCubeMapSize:je.getParameter(ya),maxRenderbufferSize:je.getParameter(fa),maxTextureUnits:je.getParameter(di),maxTextureSize:je.getParameter(Pn),maxAttributes:je.getParameter(va),maxVertexUniforms:je.getParameter(Ma),maxVertexTextureUnits:je.getParameter(da),maxVaryingVectors:je.getParameter(Ia),maxFragmentUniforms:je.getParameter(ga),glsl:je.getParameter(Vo),renderer:je.getParameter(ns),vendor:je.getParameter(Si),version:je.getParameter(Xi),readFloat:Er,npotTextureCube:cn}};function Vt(ye){return!!ye&&typeof ye=="object"&&Array.isArray(ye.shape)&&Array.isArray(ye.stride)&&typeof ye.offset=="number"&&ye.shape.length===ye.stride.length&&(Array.isArray(ye.data)||b(ye.data))}var Le=function(je){return Object.keys(je).map(function(Ot){return je[Ot]})},Dt={shape:po,flatten:Ci};function mr(ye,je,Ot){for(var xr=0;xr<je;++xr)Ot[xr]=ye[xr]}function Qr(ye,je,Ot,xr){for(var Pr=0,Cr=0;Cr<je;++Cr)for(var Er=ye[Cr],Zr=0;Zr<Ot;++Zr)xr[Pr++]=Er[Zr]}function En(ye,je,Ot,xr,Pr,Cr){for(var Er=Cr,Zr=0;Zr<je;++Zr)for(var on=ye[Zr],en=0;en<Ot;++en)for(var Yr=on[en],cn=0;cn<xr;++cn)Pr[Er++]=Yr[cn]}function Vn(ye,je,Ot,xr,Pr){for(var Cr=1,Er=Ot+1;Er<je.length;++Er)Cr*=je[Er];var Zr=je[Ot];if(je.length-Ot===4){var on=je[Ot+1],en=je[Ot+2],Yr=je[Ot+3];for(Er=0;Er<Zr;++Er)En(ye[Er],on,en,Yr,xr,Pr),Pr+=Cr}else for(Er=0;Er<Zr;++Er)Vn(ye[Er],je,Ot+1,xr,Pr),Pr+=Cr}function Ci(ye,je,Ot,xr){var Pr=1;if(je.length)for(var Cr=0;Cr<je.length;++Cr)Pr*=je[Cr];else Pr=0;var Er=xr||cr.allocType(Ot,Pr);switch(je.length){case 0:break;case 1:mr(ye,je[0],Er);break;case 2:Qr(ye,je[0],je[1],Er);break;case 3:En(ye,je[0],je[1],je[2],Er,0);break;default:Vn(ye,je,0,Er,0)}return Er}function po(ye){for(var je=[],Ot=ye;Ot.length;Ot=Ot[0])je.push(Ot.length);return je}var mo={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Oo=5120,Fu=5122,Ml=5124,bs=5121,vc=5123,Tu=5125,Mo=5126,zu=5126,Eo={int8:Oo,int16:Fu,int32:Ml,uint8:bs,uint16:vc,uint32:Tu,float:Mo,float32:zu},Fi=35048,Ys=35040,Ks={dynamic:Fi,stream:Ys,static:35044},js=Dt.flatten,Ri=Dt.shape,Vi=35044,xs=35040,vl=5121,Qu=5126,Rt=[];Rt[5120]=1,Rt[5122]=2,Rt[5124]=4,Rt[5121]=1,Rt[5123]=2,Rt[5125]=4,Rt[5126]=4;function fr(ye){return mo[Object.prototype.toString.call(ye)]|0}function Mr(ye,je){for(var Ot=0;Ot<je.length;++Ot)ye[Ot]=je[Ot]}function Wn(ye,je,Ot,xr,Pr,Cr,Er){for(var Zr=0,on=0;on<Ot;++on)for(var en=0;en<xr;++en)ye[Zr++]=je[Pr*on+Cr*en+Er]}function Xa(ye,je,Ot,xr){var Pr=0,Cr={};function Er(Tr){this.id=Pr++,this.buffer=ye.createBuffer(),this.type=Tr,this.usage=Vi,this.byteLength=0,this.dimension=1,this.dtype=vl,this.persistentData=null,Ot.profile&&(this.stats={size:0})}Er.prototype.bind=function(){ye.bindBuffer(this.type,this.buffer)},Er.prototype.destroy=function(){Tn(this)};var Zr=[];function on(Tr,br){var Wr=Zr.pop();return Wr||(Wr=new Er(Tr)),Wr.bind(),cn(Wr,br,xs,0,1,!1),Wr}function en(Tr){Zr.push(Tr)}function Yr(Tr,br,Wr){Tr.byteLength=br.byteLength,ye.bufferData(Tr.type,br,Wr)}function cn(Tr,br,Wr,wn,Rr,ta){var Jr;if(Tr.usage=Wr,Array.isArray(br)){if(Tr.dtype=wn||Qu,br.length>0){var Br;if(Array.isArray(br[0])){Jr=Ri(br);for(var Fr=1,Kr=1;Kr<Jr.length;++Kr)Fr*=Jr[Kr];Tr.dimension=Fr,Br=js(br,Jr,Tr.dtype),Yr(Tr,Br,Wr),ta?Tr.persistentData=Br:cr.freeType(Br)}else if(typeof br[0]=="number"){Tr.dimension=Rr;var Hn=cr.allocType(Tr.dtype,br.length);Mr(Hn,br),Yr(Tr,Hn,Wr),ta?Tr.persistentData=Hn:cr.freeType(Hn)}else b(br[0])?(Tr.dimension=br[0].length,Tr.dtype=wn||fr(br[0])||Qu,Br=js(br,[br.length,br[0].length],Tr.dtype),Yr(Tr,Br,Wr),ta?Tr.persistentData=Br:cr.freeType(Br)):J.raise("invalid buffer data")}}else if(b(br))Tr.dtype=wn||fr(br),Tr.dimension=Rr,Yr(Tr,br,Wr),ta&&(Tr.persistentData=new Uint8Array(new Uint8Array(br.buffer)));else if(Vt(br)){Jr=br.shape;var aa=br.stride,sn=br.offset,Gr=0,jr=0,ha=0,pa=0;Jr.length===1?(Gr=Jr[0],jr=1,ha=aa[0],pa=0):Jr.length===2?(Gr=Jr[0],jr=Jr[1],ha=aa[0],pa=aa[1]):J.raise("invalid shape"),Tr.dtype=wn||fr(br.data)||Qu,Tr.dimension=jr;var Un=cr.allocType(Tr.dtype,Gr*jr);Wn(Un,br.data,Gr,jr,ha,pa,sn),Yr(Tr,Un,Wr),ta?Tr.persistentData=Un:cr.freeType(Un)}else br instanceof ArrayBuffer?(Tr.dtype=vl,Tr.dimension=Rr,Yr(Tr,br,Wr),ta&&(Tr.persistentData=new Uint8Array(new Uint8Array(br)))):J.raise("invalid buffer data")}function Tn(Tr){je.bufferCount--,xr(Tr);var br=Tr.buffer;J(br,"buffer must not be deleted already"),ye.deleteBuffer(br),Tr.buffer=null,delete Cr[Tr.id]}function dn(Tr,br,Wr,wn){je.bufferCount++;var Rr=new Er(br);Cr[Rr.id]=Rr;function ta(Fr){var Kr=Vi,Hn=null,aa=0,sn=0,Gr=1;return Array.isArray(Fr)||b(Fr)||Vt(Fr)||Fr instanceof ArrayBuffer?Hn=Fr:typeof Fr=="number"?aa=Fr|0:Fr&&(J.type(Fr,"object","buffer arguments must be an object, a number or an array"),"data"in Fr&&(J(Hn===null||Array.isArray(Hn)||b(Hn)||Vt(Hn),"invalid data for buffer"),Hn=Fr.data),"usage"in Fr&&(J.parameter(Fr.usage,Ks,"invalid buffer usage"),Kr=Ks[Fr.usage]),"type"in Fr&&(J.parameter(Fr.type,Eo,"invalid buffer type"),sn=Eo[Fr.type]),"dimension"in Fr&&(J.type(Fr.dimension,"number","invalid dimension"),Gr=Fr.dimension|0),"length"in Fr&&(J.nni(aa,"buffer length must be a nonnegative integer"),aa=Fr.length|0)),Rr.bind(),Hn?cn(Rr,Hn,Kr,sn,Gr,wn):(aa&&ye.bufferData(Rr.type,aa,Kr),Rr.dtype=sn||vl,Rr.usage=Kr,Rr.dimension=Gr,Rr.byteLength=aa),Ot.profile&&(Rr.stats.size=Rr.byteLength*Rt[Rr.dtype]),ta}function Jr(Fr,Kr){J(Kr+Fr.byteLength<=Rr.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Fr.byteLength+" starting from offset "+Kr+" to a buffer of size "+Rr.byteLength),ye.bufferSubData(Rr.type,Kr,Fr)}function Br(Fr,Kr){var Hn=(Kr||0)|0,aa;if(Rr.bind(),b(Fr)||Fr instanceof ArrayBuffer)Jr(Fr,Hn);else if(Array.isArray(Fr)){if(Fr.length>0)if(typeof Fr[0]=="number"){var sn=cr.allocType(Rr.dtype,Fr.length);Mr(sn,Fr),Jr(sn,Hn),cr.freeType(sn)}else if(Array.isArray(Fr[0])||b(Fr[0])){aa=Ri(Fr);var Gr=js(Fr,aa,Rr.dtype);Jr(Gr,Hn),cr.freeType(Gr)}else J.raise("invalid buffer data")}else if(Vt(Fr)){aa=Fr.shape;var jr=Fr.stride,ha=0,pa=0,Un=0,Ua=0;aa.length===1?(ha=aa[0],pa=1,Un=jr[0],Ua=0):aa.length===2?(ha=aa[0],pa=aa[1],Un=jr[0],Ua=jr[1]):J.raise("invalid shape");var Oa=Array.isArray(Fr.data)?Rr.dtype:fr(Fr.data),Da=cr.allocType(Oa,ha*pa);Wn(Da,Fr.data,ha,pa,Un,Ua,Fr.offset),Jr(Da,Hn),cr.freeType(Da)}else J.raise("invalid data for buffer subdata");return ta}return Wr||ta(Tr),ta._reglType="buffer",ta._buffer=Rr,ta.subdata=Br,Ot.profile&&(ta.stats=Rr.stats),ta.destroy=function(){Tn(Rr)},ta}function nn(){Le(Cr).forEach(function(Tr){Tr.buffer=ye.createBuffer(),ye.bindBuffer(Tr.type,Tr.buffer),ye.bufferData(Tr.type,Tr.persistentData||Tr.byteLength,Tr.usage)})}return Ot.profile&&(je.getTotalBufferSize=function(){var Tr=0;return Object.keys(Cr).forEach(function(br){Tr+=Cr[br].stats.size}),Tr}),{create:dn,createStream:on,destroyStream:en,clear:function(){Le(Cr).forEach(Tn),Zr.forEach(Tn)},getBuffer:function(br){return br&&br._buffer instanceof Er?br._buffer:null},restore:nn,_initBuffer:cn}}var vi=0,Ki=0,Ya=1,Ii=1,Go=4,Cs=4,pi={points:vi,point:Ki,lines:Ya,line:Ii,triangles:Go,triangle:Cs,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Pl=0,$s=1,Es=4,gl=5120,cu=5121,_u=5122,fu=5123,Uu=5124,Js=5125,Rc=34963,pf=35040,ci=35044;function Ic(ye,je,Ot,xr){var Pr={},Cr=0,Er={uint8:cu,uint16:fu};je.oes_element_index_uint&&(Er.uint32=Js);function Zr(nn){this.id=Cr++,Pr[this.id]=this,this.buffer=nn,this.primType=Es,this.vertCount=0,this.type=0}Zr.prototype.bind=function(){this.buffer.bind()};var on=[];function en(nn){var Tr=on.pop();return Tr||(Tr=new Zr(Ot.create(null,Rc,!0,!1)._buffer)),cn(Tr,nn,pf,-1,-1,0,0),Tr}function Yr(nn){on.push(nn)}function cn(nn,Tr,br,Wr,wn,Rr,ta){nn.buffer.bind();var Jr;if(Tr){var Br=ta;!ta&&(!b(Tr)||Vt(Tr)&&!b(Tr.data))&&(Br=je.oes_element_index_uint?Js:fu),Ot._initBuffer(nn.buffer,Tr,br,Br,3)}else ye.bufferData(Rc,Rr,br),nn.buffer.dtype=Jr||cu,nn.buffer.usage=br,nn.buffer.dimension=3,nn.buffer.byteLength=Rr;if(Jr=ta,!ta){switch(nn.buffer.dtype){case cu:case gl:Jr=cu;break;case fu:case _u:Jr=fu;break;case Js:case Uu:Jr=Js;break;default:J.raise("unsupported type for element array")}nn.buffer.dtype=Jr}nn.type=Jr,J(Jr!==Js||!!je.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Fr=wn;Fr<0&&(Fr=nn.buffer.byteLength,Jr===fu?Fr>>=1:Jr===Js&&(Fr>>=2)),nn.vertCount=Fr;var Kr=Wr;if(Wr<0){Kr=Es;var Hn=nn.buffer.dimension;Hn===1&&(Kr=Pl),Hn===2&&(Kr=$s),Hn===3&&(Kr=Es)}nn.primType=Kr}function Tn(nn){xr.elementsCount--,J(nn.buffer!==null,"must not double destroy elements"),delete Pr[nn.id],nn.buffer.destroy(),nn.buffer=null}function dn(nn,Tr){var br=Ot.create(null,Rc,!0),Wr=new Zr(br._buffer);xr.elementsCount++;function wn(Rr){if(!Rr)br(),Wr.primType=Es,Wr.vertCount=0,Wr.type=cu;else if(typeof Rr=="number")br(Rr),Wr.primType=Es,Wr.vertCount=Rr|0,Wr.type=cu;else{var ta=null,Jr=ci,Br=-1,Fr=-1,Kr=0,Hn=0;Array.isArray(Rr)||b(Rr)||Vt(Rr)?ta=Rr:(J.type(Rr,"object","invalid arguments for elements"),"data"in Rr&&(ta=Rr.data,J(Array.isArray(ta)||b(ta)||Vt(ta),"invalid data for element buffer")),"usage"in Rr&&(J.parameter(Rr.usage,Ks,"invalid element buffer usage"),Jr=Ks[Rr.usage]),"primitive"in Rr&&(J.parameter(Rr.primitive,pi,"invalid element buffer primitive"),Br=pi[Rr.primitive]),"count"in Rr&&(J(typeof Rr.count=="number"&&Rr.count>=0,"invalid vertex count for elements"),Fr=Rr.count|0),"type"in Rr&&(J.parameter(Rr.type,Er,"invalid buffer type"),Hn=Er[Rr.type]),"length"in Rr?Kr=Rr.length|0:(Kr=Fr,Hn===fu||Hn===_u?Kr*=2:(Hn===Js||Hn===Uu)&&(Kr*=4))),cn(Wr,ta,Jr,Br,Fr,Kr,Hn)}return wn}return wn(nn),wn._reglType="elements",wn._elements=Wr,wn.subdata=function(Rr,ta){return br.subdata(Rr,ta),wn},wn.destroy=function(){Tn(Wr)},wn}return{create:dn,createStream:en,destroyStream:Yr,getElements:function(Tr){return typeof Tr=="function"&&Tr._elements instanceof Zr?Tr._elements:null},clear:function(){Le(Pr).forEach(Tn)}}}var gc=new Float32Array(1),Qc=new Uint32Array(gc.buffer),yl=5123;function qc(ye){for(var je=cr.allocType(yl,ye.length),Ot=0;Ot<ye.length;++Ot)if(isNaN(ye[Ot]))je[Ot]=65535;else if(ye[Ot]===Infinity)je[Ot]=31744;else if(ye[Ot]===-Infinity)je[Ot]=64512;else{gc[0]=ye[Ot];var xr=Qc[0],Pr=xr>>>31<<15,Cr=(xr<<1>>>24)-127,Er=xr>>13&(1<<10)-1;if(Cr<-24)je[Ot]=Pr;else if(Cr<-14){var Zr=-14-Cr;je[Ot]=Pr+(Er+(1<<10)>>Zr)}else Cr>15?je[Ot]=Pr+31744:je[Ot]=Pr+(Cr+15<<10)+Er}return je}function $i(ye){return Array.isArray(ye)||b(ye)}var Su=function(je){return!(je&je-1)&&!!je},bl=34467,as=3553,Dc=34067,yc=34069,Ll=6408,qu=6406,Nc=6407,hu=6409,Au=6410,ef=32854,$l=32855,Ti=36194,tf=32819,mf=32820,Jl=33635,kc=34042,Ql=6402,el=34041,Bu=35904,xl=35906,Po=36193,ql=33776,Rl=33777,Il=33778,jc=33779,El=35986,Qs=35987,eo=34798,vf=35840,gf=35841,Tl=35842,ec=35843,tl=36196,Dl=5121,bc=5123,xc=5125,rl=5126,rf=10242,nl=10243,qs=10497,_l=33071,tc=33648,Fc=10240,nf=10241,Fs=9728,yf=9729,al=9984,wi=9985,il=9986,Vu=9987,ui=33170,kn=4352,Oi=4353,ws=4354,Nl=34046,Gu=3317,ol=37440,bf=37441,is=37443,Sl=37444,sl=33984,ul=[al,il,wi,Vu],zi=[0,hu,Au,Nc,Ll],Ts={};Ts[hu]=Ts[qu]=Ts[Ql]=1,Ts[el]=Ts[Au]=2,Ts[Nc]=Ts[Bu]=3,Ts[Ll]=Ts[xl]=4;function kl(ye){return"[object "+ye+"]"}var to=kl("HTMLCanvasElement"),In=kl("OffscreenCanvas"),zs=kl("CanvasRenderingContext2D"),ti=kl("ImageBitmap"),jl=kl("HTMLImageElement"),du=kl("HTMLVideoElement"),Us=Object.keys(mo).concat([to,In,zs,ti,jl,du]),ll=[];ll[Dl]=1,ll[rl]=4,ll[Po]=2,ll[bc]=2,ll[xc]=4;var qr=[];qr[ef]=2,qr[$l]=2,qr[Ti]=2,qr[el]=4,qr[ql]=.5,qr[Rl]=.5,qr[Il]=1,qr[jc]=1,qr[El]=.5,qr[Qs]=1,qr[eo]=1,qr[vf]=.5,qr[gf]=.25,qr[Tl]=.5,qr[ec]=.25,qr[tl]=.5;function Ec(ye){return Array.isArray(ye)&&(ye.length===0||typeof ye[0]=="number")}function os(ye){if(!Array.isArray(ye))return!1;var je=ye.length;return!(je===0||!$i(ye[0]))}function ro(ye){return Object.prototype.toString.call(ye)}function Jo(ye){return ro(ye)===to}function Os(ye){return ro(ye)===In}function Fl(ye){return ro(ye)===zs}function zc(ye){return ro(ye)===ti}function Bs(ye){return ro(ye)===jl}function Cu(ye){return ro(ye)===du}function zl(ye){if(!ye)return!1;var je=ro(ye);return Us.indexOf(je)>=0?!0:Ec(ye)||os(ye)||Vt(ye)}function Ul(ye){return mo[Object.prototype.toString.call(ye)]|0}function af(ye,je){var Ot=je.length;switch(ye.type){case Dl:case bc:case xc:case rl:var xr=cr.allocType(ye.type,Ot);xr.set(je),ye.data=xr;break;case Po:ye.data=qc(je);break;default:J.raise("unsupported texture type, must specify a typed array")}}function Uc(ye,je){return cr.allocType(ye.type===Po?rl:ye.type,je)}function Lo(ye,je){ye.type===Po?(ye.data=qc(je),cr.freeType(je)):ye.data=je}function ss(ye,je,Ot,xr,Pr,Cr){for(var Er=ye.width,Zr=ye.height,on=ye.channels,en=Er*Zr*on,Yr=Uc(ye,en),cn=0,Tn=0;Tn<Zr;++Tn)for(var dn=0;dn<Er;++dn)for(var nn=0;nn<on;++nn)Yr[cn++]=je[Ot*dn+xr*Tn+Pr*nn+Cr];Lo(ye,Yr)}function Pa(ye,je,Ot,xr,Pr,Cr){var Er;if(typeof qr[ye]!="undefined"?Er=qr[ye]:Er=Ts[ye]*ll[je],Cr&&(Er*=6),Pr){for(var Zr=0,on=Ot;on>=1;)Zr+=Er*on*on,on/=2;return Zr}else return Er*Ot*xr}function eu(ye,je,Ot,xr,Pr,Cr,Er){var Zr={"don't care":kn,"dont care":kn,nice:ws,fast:Oi},on={repeat:qs,clamp:_l,mirror:tc},en={nearest:Fs,linear:yf},Yr=m({mipmap:Vu,"nearest mipmap nearest":al,"linear mipmap nearest":wi,"nearest mipmap linear":il,"linear mipmap linear":Vu},en),cn={none:0,browser:Sl},Tn={uint8:Dl,rgba4:tf,rgb565:Jl,"rgb5 a1":mf},dn={alpha:qu,luminance:hu,"luminance alpha":Au,rgb:Nc,rgba:Ll,rgba4:ef,"rgb5 a1":$l,rgb565:Ti},nn={};je.ext_srgb&&(dn.srgb=Bu,dn.srgba=xl),je.oes_texture_float&&(Tn.float32=Tn.float=rl),je.oes_texture_half_float&&(Tn.float16=Tn["half float"]=Po),je.webgl_depth_texture&&(m(dn,{depth:Ql,"depth stencil":el}),m(Tn,{uint16:bc,uint32:xc,"depth stencil":kc})),je.webgl_compressed_texture_s3tc&&m(nn,{"rgb s3tc dxt1":ql,"rgba s3tc dxt1":Rl,"rgba s3tc dxt3":Il,"rgba s3tc dxt5":jc}),je.webgl_compressed_texture_atc&&m(nn,{"rgb atc":El,"rgba atc explicit alpha":Qs,"rgba atc interpolated alpha":eo}),je.webgl_compressed_texture_pvrtc&&m(nn,{"rgb pvrtc 4bppv1":vf,"rgb pvrtc 2bppv1":gf,"rgba pvrtc 4bppv1":Tl,"rgba pvrtc 2bppv1":ec}),je.webgl_compressed_texture_etc1&&(nn["rgb etc1"]=tl);var Tr=Array.prototype.slice.call(ye.getParameter(bl));Object.keys(nn).forEach(function(d){var c=nn[d];Tr.indexOf(c)>=0&&(dn[d]=c)});var br=Object.keys(dn);Ot.textureFormats=br;var Wr=[];Object.keys(dn).forEach(function(d){var c=dn[d];Wr[c]=d});var wn=[];Object.keys(Tn).forEach(function(d){var c=Tn[d];wn[c]=d});var Rr=[];Object.keys(en).forEach(function(d){var c=en[d];Rr[c]=d});var ta=[];Object.keys(Yr).forEach(function(d){var c=Yr[d];ta[c]=d});var Jr=[];Object.keys(on).forEach(function(d){var c=on[d];Jr[c]=d});var Br=br.reduce(function(d,c){var p=dn[c];return p===hu||p===qu||p===hu||p===Au||p===Ql||p===el||je.ext_srgb&&(p===Bu||p===xl)?d[p]=p:p===$l||c.indexOf("rgba")>=0?d[p]=Ll:d[p]=Nc,d},{});function Fr(){this.internalformat=Ll,this.format=Ll,this.type=Dl,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Sl,this.width=0,this.height=0,this.channels=0}function Kr(d,c){d.internalformat=c.internalformat,d.format=c.format,d.type=c.type,d.compressed=c.compressed,d.premultiplyAlpha=c.premultiplyAlpha,d.flipY=c.flipY,d.unpackAlignment=c.unpackAlignment,d.colorSpace=c.colorSpace,d.width=c.width,d.height=c.height,d.channels=c.channels}function Hn(d,c){if(typeof c!="object"||!c)return;if("premultiplyAlpha"in c&&(J.type(c.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),d.premultiplyAlpha=c.premultiplyAlpha),"flipY"in c&&(J.type(c.flipY,"boolean","invalid texture flip"),d.flipY=c.flipY),"alignment"in c&&(J.oneOf(c.alignment,[1,2,4,8],"invalid texture unpack alignment"),d.unpackAlignment=c.alignment),"colorSpace"in c&&(J.parameter(c.colorSpace,cn,"invalid colorSpace"),d.colorSpace=cn[c.colorSpace]),"type"in c){var p=c.type;J(je.oes_texture_float||!(p==="float"||p==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),J(je.oes_texture_half_float||!(p==="half float"||p==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),J(je.webgl_depth_texture||!(p==="uint16"||p==="uint32"||p==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),J.parameter(p,Tn,"invalid texture type"),d.type=Tn[p]}var T=d.width,j=d.height,I=d.channels,k=!1;"shape"in c?(J(Array.isArray(c.shape)&&c.shape.length>=2,"shape must be an array"),T=c.shape[0],j=c.shape[1],c.shape.length===3&&(I=c.shape[2],J(I>0&&I<=4,"invalid number of channels"),k=!0),J(T>=0&&T<=Ot.maxTextureSize,"invalid width"),J(j>=0&&j<=Ot.maxTextureSize,"invalid height")):("radius"in c&&(T=j=c.radius,J(T>=0&&T<=Ot.maxTextureSize,"invalid radius")),"width"in c&&(T=c.width,J(T>=0&&T<=Ot.maxTextureSize,"invalid width")),"height"in c&&(j=c.height,J(j>=0&&j<=Ot.maxTextureSize,"invalid height")),"channels"in c&&(I=c.channels,J(I>0&&I<=4,"invalid number of channels"),k=!0)),d.width=T|0,d.height=j|0,d.channels=I|0;var X=!1;if("format"in c){var ae=c.format;J(je.webgl_depth_texture||!(ae==="depth"||ae==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),J.parameter(ae,dn,"invalid texture format");var $e=d.internalformat=dn[ae];d.format=Br[$e],ae in Tn&&("type"in c||(d.type=Tn[ae])),ae in nn&&(d.compressed=!0),X=!0}!k&&X?d.channels=Ts[d.format]:k&&!X?d.channels!==zi[d.format]&&(d.format=d.internalformat=zi[d.channels]):X&&k&&J(d.channels===Ts[d.format],"number of channels inconsistent with specified format")}function aa(d){ye.pixelStorei(ol,d.flipY),ye.pixelStorei(bf,d.premultiplyAlpha),ye.pixelStorei(is,d.colorSpace),ye.pixelStorei(Gu,d.unpackAlignment)}function sn(){Fr.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Gr(d,c){var p=null;if(zl(c)?p=c:c&&(J.type(c,"object","invalid pixel data type"),Hn(d,c),"x"in c&&(d.xOffset=c.x|0),"y"in c&&(d.yOffset=c.y|0),zl(c.data)&&(p=c.data)),J(!d.compressed||p instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),c.copy){J(!p,"can not specify copy and data field for the same texture");var T=Pr.viewportWidth,j=Pr.viewportHeight;d.width=d.width||T-d.xOffset,d.height=d.height||j-d.yOffset,d.needsCopy=!0,J(d.xOffset>=0&&d.xOffset<T&&d.yOffset>=0&&d.yOffset<j&&d.width>0&&d.width<=T&&d.height>0&&d.height<=j,"copy texture read out of bounds")}else if(!p)d.width=d.width||1,d.height=d.height||1,d.channels=d.channels||4;else if(b(p))d.channels=d.channels||4,d.data=p,!("type"in c)&&d.type===Dl&&(d.type=Ul(p));else if(Ec(p))d.channels=d.channels||4,af(d,p),d.alignment=1,d.needsFree=!0;else if(Vt(p)){var I=p.data;!Array.isArray(I)&&d.type===Dl&&(d.type=Ul(I));var k=p.shape,X=p.stride,ae,$e,Ie,Oe,ft,Ne;k.length===3?(Ie=k[2],Ne=X[2]):(J(k.length===2,"invalid ndarray pixel data, must be 2 or 3D"),Ie=1,Ne=1),ae=k[0],$e=k[1],Oe=X[0],ft=X[1],d.alignment=1,d.width=ae,d.height=$e,d.channels=Ie,d.format=d.internalformat=zi[Ie],d.needsFree=!0,ss(d,I,Oe,ft,Ne,p.offset)}else if(Jo(p)||Os(p)||Fl(p))Jo(p)||Os(p)?d.element=p:d.element=p.canvas,d.width=d.element.width,d.height=d.element.height,d.channels=4;else if(zc(p))d.element=p,d.width=p.width,d.height=p.height,d.channels=4;else if(Bs(p))d.element=p,d.width=p.naturalWidth,d.height=p.naturalHeight,d.channels=4;else if(Cu(p))d.element=p,d.width=p.videoWidth,d.height=p.videoHeight,d.channels=4;else if(os(p)){var lt=d.width||p[0].length,Ue=d.height||p.length,It=d.channels;$i(p[0][0])?It=It||p[0][0].length:It=It||1;for(var $t=Dt.shape(p),ar=1,tr=0;tr<$t.length;++tr)ar*=$t[tr];var pr=Uc(d,ar);Dt.flatten(p,$t,"",pr),Lo(d,pr),d.alignment=1,d.width=lt,d.height=Ue,d.channels=It,d.format=d.internalformat=zi[It],d.needsFree=!0}d.type===rl?J(Ot.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):d.type===Po&&J(Ot.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function jr(d,c,p){var T=d.element,j=d.data,I=d.internalformat,k=d.format,X=d.type,ae=d.width,$e=d.height;aa(d),T?ye.texImage2D(c,p,k,k,X,T):d.compressed?ye.compressedTexImage2D(c,p,I,ae,$e,0,j):d.needsCopy?(xr(),ye.copyTexImage2D(c,p,k,d.xOffset,d.yOffset,ae,$e,0)):ye.texImage2D(c,p,k,ae,$e,0,k,X,j||null)}function ha(d,c,p,T,j){var I=d.element,k=d.data,X=d.internalformat,ae=d.format,$e=d.type,Ie=d.width,Oe=d.height;aa(d),I?ye.texSubImage2D(c,j,p,T,ae,$e,I):d.compressed?ye.compressedTexSubImage2D(c,j,p,T,X,Ie,Oe,k):d.needsCopy?(xr(),ye.copyTexSubImage2D(c,j,p,T,d.xOffset,d.yOffset,Ie,Oe)):ye.texSubImage2D(c,j,p,T,Ie,Oe,ae,$e,k)}var pa=[];function Un(){return pa.pop()||new sn}function Ua(d){d.needsFree&&cr.freeType(d.data),sn.call(d),pa.push(d)}function Oa(){Fr.call(this),this.genMipmaps=!1,this.mipmapHint=kn,this.mipmask=0,this.images=Array(16)}function Da(d,c,p){var T=d.images[0]=Un();d.mipmask=1,T.width=d.width=c,T.height=d.height=p,T.channels=d.channels=4}function fi(d,c){var p=null;if(zl(c))p=d.images[0]=Un(),Kr(p,d),Gr(p,c),d.mipmask=1;else if(Hn(d,c),Array.isArray(c.mipmap))for(var T=c.mipmap,j=0;j<T.length;++j)p=d.images[j]=Un(),Kr(p,d),p.width>>=j,p.height>>=j,Gr(p,T[j]),d.mipmask|=1<<j;else p=d.images[0]=Un(),Kr(p,d),Gr(p,c),d.mipmask=1;Kr(d,d.images[0]),d.compressed&&(d.internalformat===ql||d.internalformat===Rl||d.internalformat===Il||d.internalformat===jc)&&J(d.width%4===0&&d.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function jo(d,c){for(var p=d.images,T=0;T<p.length;++T){if(!p[T])return;jr(p[T],c,T)}}var ps=[];function ei(){var d=ps.pop()||new Oa;Fr.call(d),d.mipmask=0;for(var c=0;c<16;++c)d.images[c]=null;return d}function co(d){for(var c=d.images,p=0;p<c.length;++p)c[p]&&Ua(c[p]),c[p]=null;ps.push(d)}function Mi(){this.minFilter=Fs,this.magFilter=Fs,this.wrapS=_l,this.wrapT=_l,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=kn}function ms(d,c){if("min"in c){var p=c.min;J.parameter(p,Yr),d.minFilter=Yr[p],ul.indexOf(d.minFilter)>=0&&!("faces"in c)&&(d.genMipmaps=!0)}if("mag"in c){var T=c.mag;J.parameter(T,en),d.magFilter=en[T]}var j=d.wrapS,I=d.wrapT;if("wrap"in c){var k=c.wrap;typeof k=="string"?(J.parameter(k,on),j=I=on[k]):Array.isArray(k)&&(J.parameter(k[0],on),J.parameter(k[1],on),j=on[k[0]],I=on[k[1]])}else{if("wrapS"in c){var X=c.wrapS;J.parameter(X,on),j=on[X]}if("wrapT"in c){var ae=c.wrapT;J.parameter(ae,on),I=on[ae]}}if(d.wrapS=j,d.wrapT=I,"anisotropic"in c){var $e=c.anisotropic;J(typeof $e=="number"&&$e>=1&&$e<=Ot.maxAnisotropic,"aniso samples must be between 1 and "),d.anisotropic=c.anisotropic}if("mipmap"in c){var Ie=!1;switch(typeof c.mipmap){case"string":J.parameter(c.mipmap,Zr,"invalid mipmap hint"),d.mipmapHint=Zr[c.mipmap],d.genMipmaps=!0,Ie=!0;break;case"boolean":Ie=d.genMipmaps=c.mipmap;break;case"object":J(Array.isArray(c.mipmap),"invalid mipmap type"),d.genMipmaps=!1,Ie=!0;break;default:J.raise("invalid mipmap type")}Ie&&!("min"in c)&&(d.minFilter=al)}}function Zo(d,c){ye.texParameteri(c,nf,d.minFilter),ye.texParameteri(c,Fc,d.magFilter),ye.texParameteri(c,rf,d.wrapS),ye.texParameteri(c,nl,d.wrapT),je.ext_texture_filter_anisotropic&&ye.texParameteri(c,Nl,d.anisotropic),d.genMipmaps&&(ye.hint(ui,d.mipmapHint),ye.generateMipmap(c))}var Wo=0,es={},Is=Ot.maxTextureUnits,Zi=Array(Is).map(function(){return null});function ia(d){Fr.call(this),this.mipmask=0,this.internalformat=Ll,this.id=Wo++,this.refCount=1,this.target=d,this.texture=ye.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Mi,Er.profile&&(this.stats={size:0})}function Hs(d){ye.activeTexture(sl),ye.bindTexture(d.target,d.texture)}function xi(){var d=Zi[0];d?ye.bindTexture(d.target,d.texture):ye.bindTexture(as,null)}function An(d){var c=d.texture;J(c,"must not double destroy texture");var p=d.unit,T=d.target;p>=0&&(ye.activeTexture(sl+p),ye.bindTexture(T,null),Zi[p]=null),ye.deleteTexture(c),d.texture=null,d.params=null,d.pixels=null,d.refCount=0,delete es[d.id],Cr.textureCount--}m(ia.prototype,{bind:function(){var c=this;c.bindCount+=1;var p=c.unit;if(p<0){for(var T=0;T<Is;++T){var j=Zi[T];if(j){if(j.bindCount>0)continue;j.unit=-1}Zi[T]=c,p=T;break}p>=Is&&J.raise("insufficient number of texture units"),Er.profile&&Cr.maxTextureUnits<p+1&&(Cr.maxTextureUnits=p+1),c.unit=p,ye.activeTexture(sl+p),ye.bindTexture(c.target,c.texture)}return p},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&An(this)}});function Ra(d,c){var p=new ia(as);es[p.id]=p,Cr.textureCount++;function T(k,X){var ae=p.texInfo;Mi.call(ae);var $e=ei();return typeof k=="number"?typeof X=="number"?Da($e,k|0,X|0):Da($e,k|0,k|0):k?(J.type(k,"object","invalid arguments to regl.texture"),ms(ae,k),fi($e,k)):Da($e,1,1),ae.genMipmaps&&($e.mipmask=($e.width<<1)-1),p.mipmask=$e.mipmask,Kr(p,$e),J.texture2D(ae,$e,Ot),p.internalformat=$e.internalformat,T.width=$e.width,T.height=$e.height,Hs(p),jo($e,as),Zo(ae,as),xi(),co($e),Er.profile&&(p.stats.size=Pa(p.internalformat,p.type,$e.width,$e.height,ae.genMipmaps,!1)),T.format=Wr[p.internalformat],T.type=wn[p.type],T.mag=Rr[ae.magFilter],T.min=ta[ae.minFilter],T.wrapS=Jr[ae.wrapS],T.wrapT=Jr[ae.wrapT],T}function j(k,X,ae,$e){J(!!k,"must specify image data");var Ie=X|0,Oe=ae|0,ft=$e|0,Ne=Un();return Kr(Ne,p),Ne.width=0,Ne.height=0,Gr(Ne,k),Ne.width=Ne.width||(p.width>>ft)-Ie,Ne.height=Ne.height||(p.height>>ft)-Oe,J(p.type===Ne.type&&p.format===Ne.format&&p.internalformat===Ne.internalformat,"incompatible format for texture.subimage"),J(Ie>=0&&Oe>=0&&Ie+Ne.width<=p.width&&Oe+Ne.height<=p.height,"texture.subimage write out of bounds"),J(p.mipmask&1<<ft,"missing mipmap data"),J(Ne.data||Ne.element||Ne.needsCopy,"missing image data"),Hs(p),ha(Ne,as,Ie,Oe,ft),xi(),Ua(Ne),T}function I(k,X){var ae=k|0,$e=X|0||ae;if(ae===p.width&&$e===p.height)return T;T.width=p.width=ae,T.height=p.height=$e,Hs(p);for(var Ie=0;p.mipmask>>Ie;++Ie){var Oe=ae>>Ie,ft=$e>>Ie;if(!Oe||!ft)break;ye.texImage2D(as,Ie,p.format,Oe,ft,0,p.format,p.type,null)}return xi(),Er.profile&&(p.stats.size=Pa(p.internalformat,p.type,ae,$e,!1,!1)),T}return T(d,c),T.subimage=j,T.resize=I,T._reglType="texture2d",T._texture=p,Er.profile&&(T.stats=p.stats),T.destroy=function(){p.decRef()},T}function Ba(d,c,p,T,j,I){var k=new ia(Dc);es[k.id]=k,Cr.cubeCount++;var X=new Array(6);function ae(Oe,ft,Ne,lt,Ue,It){var $t,ar=k.texInfo;for(Mi.call(ar),$t=0;$t<6;++$t)X[$t]=ei();if(typeof Oe=="number"||!Oe){var tr=Oe|0||1;for($t=0;$t<6;++$t)Da(X[$t],tr,tr)}else if(typeof Oe=="object")if(ft)fi(X[0],Oe),fi(X[1],ft),fi(X[2],Ne),fi(X[3],lt),fi(X[4],Ue),fi(X[5],It);else if(ms(ar,Oe),Hn(k,Oe),"faces"in Oe){var pr=Oe.faces;for(J(Array.isArray(pr)&&pr.length===6,"cube faces must be a length 6 array"),$t=0;$t<6;++$t)J(typeof pr[$t]=="object"&&!!pr[$t],"invalid input for cube map face"),Kr(X[$t],k),fi(X[$t],pr[$t])}else for($t=0;$t<6;++$t)fi(X[$t],Oe);else J.raise("invalid arguments to cube map");for(Kr(k,X[0]),Ot.npotTextureCube||J(Su(k.width)&&Su(k.height),"your browser does not support non power or two texture dimensions"),ar.genMipmaps?k.mipmask=(X[0].width<<1)-1:k.mipmask=X[0].mipmask,J.textureCube(k,ar,X,Ot),k.internalformat=X[0].internalformat,ae.width=X[0].width,ae.height=X[0].height,Hs(k),$t=0;$t<6;++$t)jo(X[$t],yc+$t);for(Zo(ar,Dc),xi(),Er.profile&&(k.stats.size=Pa(k.internalformat,k.type,ae.width,ae.height,ar.genMipmaps,!0)),ae.format=Wr[k.internalformat],ae.type=wn[k.type],ae.mag=Rr[ar.magFilter],ae.min=ta[ar.minFilter],ae.wrapS=Jr[ar.wrapS],ae.wrapT=Jr[ar.wrapT],$t=0;$t<6;++$t)co(X[$t]);return ae}function $e(Oe,ft,Ne,lt,Ue){J(!!ft,"must specify image data"),J(typeof Oe=="number"&&Oe===(Oe|0)&&Oe>=0&&Oe<6,"invalid face");var It=Ne|0,$t=lt|0,ar=Ue|0,tr=Un();return Kr(tr,k),tr.width=0,tr.height=0,Gr(tr,ft),tr.width=tr.width||(k.width>>ar)-It,tr.height=tr.height||(k.height>>ar)-$t,J(k.type===tr.type&&k.format===tr.format&&k.internalformat===tr.internalformat,"incompatible format for texture.subimage"),J(It>=0&&$t>=0&&It+tr.width<=k.width&&$t+tr.height<=k.height,"texture.subimage write out of bounds"),J(k.mipmask&1<<ar,"missing mipmap data"),J(tr.data||tr.element||tr.needsCopy,"missing image data"),Hs(k),ha(tr,yc+Oe,It,$t,ar),xi(),Ua(tr),ae}function Ie(Oe){var ft=Oe|0;if(ft===k.width)return;ae.width=k.width=ft,ae.height=k.height=ft,Hs(k);for(var Ne=0;Ne<6;++Ne)for(var lt=0;k.mipmask>>lt;++lt)ye.texImage2D(yc+Ne,lt,k.format,ft>>lt,ft>>lt,0,k.format,k.type,null);return xi(),Er.profile&&(k.stats.size=Pa(k.internalformat,k.type,ae.width,ae.height,!1,!0)),ae}return ae(d,c,p,T,j,I),ae.subimage=$e,ae.resize=Ie,ae._reglType="textureCube",ae._texture=k,Er.profile&&(ae.stats=k.stats),ae.destroy=function(){k.decRef()},ae}function Xo(){for(var d=0;d<Is;++d)ye.activeTexture(sl+d),ye.bindTexture(as,null),Zi[d]=null;Le(es).forEach(An),Cr.cubeCount=0,Cr.textureCount=0}Er.profile&&(Cr.getTotalTextureSize=function(){var d=0;return Object.keys(es).forEach(function(c){d+=es[c].stats.size}),d});function gu(){for(var d=0;d<Is;++d){var c=Zi[d];c&&(c.bindCount=0,c.unit=-1,Zi[d]=null)}Le(es).forEach(function(p){p.texture=ye.createTexture(),ye.bindTexture(p.target,p.texture);for(var T=0;T<32;++T){if((p.mipmask&1<<T)===0)continue;if(p.target===as)ye.texImage2D(as,T,p.internalformat,p.width>>T,p.height>>T,0,p.internalformat,p.type,null);else for(var j=0;j<6;++j)ye.texImage2D(yc+j,T,p.internalformat,p.width>>T,p.height>>T,0,p.internalformat,p.type,null)}Zo(p.texInfo,p.target)})}function O(){for(var d=0;d<Is;++d){var c=Zi[d];c&&(c.bindCount=0,c.unit=-1,Zi[d]=null),ye.activeTexture(sl+d),ye.bindTexture(as,null),ye.bindTexture(Dc,null)}}return{create2D:Ra,createCube:Ba,clear:Xo,getTexture:function(c){return null},restore:gu,refresh:O}}var Ro=36161,To=32854,Al=32855,cl=36194,pu=33189,_s=36168,Tc=34041,Jn=35907,jn=34836,_c=34842,us=34843,Io=[];Io[To]=2,Io[Al]=2,Io[cl]=2,Io[pu]=2,Io[_s]=1,Io[Tc]=4,Io[Jn]=4,Io[jn]=16,Io[_c]=8,Io[us]=6;function vo(ye,je,Ot){return Io[ye]*je*Ot}var Ss=function(je,Ot,xr,Pr,Cr){var Er={rgba4:To,rgb565:cl,"rgb5 a1":Al,depth:pu,stencil:_s,"depth stencil":Tc};Ot.ext_srgb&&(Er.srgba=Jn),Ot.ext_color_buffer_half_float&&(Er.rgba16f=_c,Er.rgb16f=us),Ot.webgl_color_buffer_float&&(Er.rgba32f=jn);var Zr=[];Object.keys(Er).forEach(function(nn){var Tr=Er[nn];Zr[Tr]=nn});var on=0,en={};function Yr(nn){this.id=on++,this.refCount=1,this.renderbuffer=nn,this.format=To,this.width=0,this.height=0,Cr.profile&&(this.stats={size:0})}Yr.prototype.decRef=function(){--this.refCount<=0&&cn(this)};function cn(nn){var Tr=nn.renderbuffer;J(Tr,"must not double destroy renderbuffer"),je.bindRenderbuffer(Ro,null),je.deleteRenderbuffer(Tr),nn.renderbuffer=null,nn.refCount=0,delete en[nn.id],Pr.renderbufferCount--}function Tn(nn,Tr){var br=new Yr(je.createRenderbuffer());en[br.id]=br,Pr.renderbufferCount++;function Wr(Rr,ta){var Jr=0,Br=0,Fr=To;if(typeof Rr=="object"&&Rr){var Kr=Rr;if("shape"in Kr){var Hn=Kr.shape;J(Array.isArray(Hn)&&Hn.length>=2,"invalid renderbuffer shape"),Jr=Hn[0]|0,Br=Hn[1]|0}else"radius"in Kr&&(Jr=Br=Kr.radius|0),"width"in Kr&&(Jr=Kr.width|0),"height"in Kr&&(Br=Kr.height|0);"format"in Kr&&(J.parameter(Kr.format,Er,"invalid renderbuffer format"),Fr=Er[Kr.format])}else typeof Rr=="number"?(Jr=Rr|0,typeof ta=="number"?Br=ta|0:Br=Jr):Rr?J.raise("invalid arguments to renderbuffer constructor"):Jr=Br=1;return J(Jr>0&&Br>0&&Jr<=xr.maxRenderbufferSize&&Br<=xr.maxRenderbufferSize,"invalid renderbuffer size"),Jr===br.width&&Br===br.height&&Fr===br.format?void 0:(Wr.width=br.width=Jr,Wr.height=br.height=Br,br.format=Fr,je.bindRenderbuffer(Ro,br.renderbuffer),je.renderbufferStorage(Ro,Fr,Jr,Br),J(je.getError()===0,"invalid render buffer format"),Cr.profile&&(br.stats.size=vo(br.format,br.width,br.height)),Wr.format=Zr[br.format],Wr)}function wn(Rr,ta){var Jr=Rr|0,Br=ta|0||Jr;return Jr===br.width&&Br===br.height||(J(Jr>0&&Br>0&&Jr<=xr.maxRenderbufferSize&&Br<=xr.maxRenderbufferSize,"invalid renderbuffer size"),Wr.width=br.width=Jr,Wr.height=br.height=Br,je.bindRenderbuffer(Ro,br.renderbuffer),je.renderbufferStorage(Ro,br.format,Jr,Br),J(je.getError()===0,"invalid render buffer format"),Cr.profile&&(br.stats.size=vo(br.format,br.width,br.height))),Wr}return Wr(nn,Tr),Wr.resize=wn,Wr._reglType="renderbuffer",Wr._renderbuffer=br,Cr.profile&&(Wr.stats=br.stats),Wr.destroy=function(){br.decRef()},Wr}Cr.profile&&(Pr.getTotalRenderbufferSize=function(){var nn=0;return Object.keys(en).forEach(function(Tr){nn+=en[Tr].stats.size}),nn});function dn(){Le(en).forEach(function(nn){nn.renderbuffer=je.createRenderbuffer(),je.bindRenderbuffer(Ro,nn.renderbuffer),je.renderbufferStorage(Ro,nn.format,nn.width,nn.height)}),je.bindRenderbuffer(Ro,null)}return{create:Tn,clear:function(){Le(en).forEach(cn)},restore:dn}},wu=36160,rc=36161,Ka=3553,no=34069,fl=36064,mu=36096,hl=36128,Ou=33306,Ms=36053,Bc=36054,Vs=36055,xf=36057,Bl=36061,Vl=36193,Sc=5121,ls=5126,Hu=6407,Vc=6408,Cl=6402,Zu=[Hu,Vc],nc=[];nc[Vc]=4,nc[Hu]=3;var Wu=[];Wu[Sc]=1,Wu[ls]=4,Wu[Vl]=2;var Ps=32854,of=32855,ac=36194,ic=33189,oc=36168,s=34041,a=35907,n=34836,l=34842,g=34843,w=[Ps,of,ac,a,l,g,n],L={};L[Ms]="complete",L[Bc]="incomplete attachment",L[xf]="incomplete dimensions",L[Vs]="incomplete, missing attachment",L[Bl]="unsupported";function z(ye,je,Ot,xr,Pr,Cr){var Er={cur:null,next:null,dirty:!1,setFBO:null},Zr=["rgba"],on=["rgba4","rgb565","rgb5 a1"];je.ext_srgb&&on.push("srgba"),je.ext_color_buffer_half_float&&on.push("rgba16f","rgb16f"),je.webgl_color_buffer_float&&on.push("rgba32f");var en=["uint8"];je.oes_texture_half_float&&en.push("half float","float16"),je.oes_texture_float&&en.push("float","float32");function Yr(sn,Gr,jr){this.target=sn,this.texture=Gr,this.renderbuffer=jr;var ha=0,pa=0;Gr?(ha=Gr.width,pa=Gr.height):jr&&(ha=jr.width,pa=jr.height),this.width=ha,this.height=pa}function cn(sn){sn&&(sn.texture&&sn.texture._texture.decRef(),sn.renderbuffer&&sn.renderbuffer._renderbuffer.decRef())}function Tn(sn,Gr,jr){if(!sn)return;if(sn.texture){var ha=sn.texture._texture,pa=Math.max(1,ha.width),Un=Math.max(1,ha.height);J(pa===Gr&&Un===jr,"inconsistent width/height for supplied texture"),ha.refCount+=1}else{var Ua=sn.renderbuffer._renderbuffer;J(Ua.width===Gr&&Ua.height===jr,"inconsistent width/height for renderbuffer"),Ua.refCount+=1}}function dn(sn,Gr){Gr&&(Gr.texture?ye.framebufferTexture2D(wu,sn,Gr.target,Gr.texture._texture.texture,0):ye.framebufferRenderbuffer(wu,sn,rc,Gr.renderbuffer._renderbuffer.renderbuffer))}function nn(sn){var Gr=Ka,jr=null,ha=null,pa=sn;typeof sn=="object"&&(pa=sn.data,"target"in sn&&(Gr=sn.target|0)),J.type(pa,"function","invalid attachment data");var Un=pa._reglType;return Un==="texture2d"?(jr=pa,J(Gr===Ka)):Un==="textureCube"?(jr=pa,J(Gr>=no&&Gr<no+6,"invalid cube map target")):Un==="renderbuffer"?(ha=pa,Gr=rc):J.raise("invalid regl object for attachment"),new Yr(Gr,jr,ha)}function Tr(sn,Gr,jr,ha,pa){if(jr){var Un=xr.create2D({width:sn,height:Gr,format:ha,type:pa});return Un._texture.refCount=0,new Yr(Ka,Un,null)}else{var Ua=Pr.create({width:sn,height:Gr,format:ha});return Ua._renderbuffer.refCount=0,new Yr(rc,null,Ua)}}function br(sn){return sn&&(sn.texture||sn.renderbuffer)}function Wr(sn,Gr,jr){sn&&(sn.texture?sn.texture.resize(Gr,jr):sn.renderbuffer&&sn.renderbuffer.resize(Gr,jr),sn.width=Gr,sn.height=jr)}var wn=0,Rr={};function ta(){this.id=wn++,Rr[this.id]=this,this.framebuffer=ye.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Jr(sn){sn.colorAttachments.forEach(cn),cn(sn.depthAttachment),cn(sn.stencilAttachment),cn(sn.depthStencilAttachment)}function Br(sn){var Gr=sn.framebuffer;J(Gr,"must not double destroy framebuffer"),ye.deleteFramebuffer(Gr),sn.framebuffer=null,Cr.framebufferCount--,delete Rr[sn.id]}function Fr(sn){var Gr;ye.bindFramebuffer(wu,sn.framebuffer);var jr=sn.colorAttachments;for(Gr=0;Gr<jr.length;++Gr)dn(fl+Gr,jr[Gr]);for(Gr=jr.length;Gr<Ot.maxColorAttachments;++Gr)ye.framebufferTexture2D(wu,fl+Gr,Ka,null,0);ye.framebufferTexture2D(wu,Ou,Ka,null,0),ye.framebufferTexture2D(wu,mu,Ka,null,0),ye.framebufferTexture2D(wu,hl,Ka,null,0),dn(mu,sn.depthAttachment),dn(hl,sn.stencilAttachment),dn(Ou,sn.depthStencilAttachment);var ha=ye.checkFramebufferStatus(wu);!ye.isContextLost()&&ha!==Ms&&J.raise("framebuffer configuration not supported, status = "+L[ha]),ye.bindFramebuffer(wu,Er.next?Er.next.framebuffer:null),Er.cur=Er.next,ye.getError()}function Kr(sn,Gr){var jr=new ta;Cr.framebufferCount++;function ha(Un,Ua){var Oa;J(Er.next!==jr,"can not update framebuffer which is currently in use");var Da=0,fi=0,jo=!0,ps=!0,ei=null,co=!0,Mi="rgba",ms="uint8",Zo=1,Wo=null,es=null,Is=null,Zi=!1;if(typeof Un=="number")Da=Un|0,fi=Ua|0||Da;else if(!Un)Da=fi=1;else{J.type(Un,"object","invalid arguments for framebuffer");var ia=Un;if("shape"in ia){var Hs=ia.shape;J(Array.isArray(Hs)&&Hs.length>=2,"invalid shape for framebuffer"),Da=Hs[0],fi=Hs[1]}else"radius"in ia&&(Da=fi=ia.radius),"width"in ia&&(Da=ia.width),"height"in ia&&(fi=ia.height);("color"in ia||"colors"in ia)&&(ei=ia.color||ia.colors,Array.isArray(ei)&&J(ei.length===1||je.webgl_draw_buffers,"multiple render targets not supported")),ei||("colorCount"in ia&&(Zo=ia.colorCount|0,J(Zo>0,"invalid color buffer count")),"colorTexture"in ia&&(co=!!ia.colorTexture,Mi="rgba4"),"colorType"in ia&&(ms=ia.colorType,co?(J(je.oes_texture_float||!(ms==="float"||ms==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),J(je.oes_texture_half_float||!(ms==="half float"||ms==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):ms==="half float"||ms==="float16"?(J(je.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Mi="rgba16f"):(ms==="float"||ms==="float32")&&(J(je.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Mi="rgba32f"),J.oneOf(ms,en,"invalid color type")),"colorFormat"in ia&&(Mi=ia.colorFormat,Zr.indexOf(Mi)>=0?co=!0:on.indexOf(Mi)>=0?co=!1:co?J.oneOf(ia.colorFormat,Zr,"invalid color format for texture"):J.oneOf(ia.colorFormat,on,"invalid color format for renderbuffer"))),("depthTexture"in ia||"depthStencilTexture"in ia)&&(Zi=!!(ia.depthTexture||ia.depthStencilTexture),J(!Zi||je.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in ia&&(typeof ia.depth=="boolean"?jo=ia.depth:(Wo=ia.depth,ps=!1)),"stencil"in ia&&(typeof ia.stencil=="boolean"?ps=ia.stencil:(es=ia.stencil,jo=!1)),"depthStencil"in ia&&(typeof ia.depthStencil=="boolean"?jo=ps=ia.depthStencil:(Is=ia.depthStencil,jo=!1,ps=!1))}var xi=null,An=null,Ra=null,Ba=null;if(Array.isArray(ei))xi=ei.map(nn);else if(ei)xi=[nn(ei)];else for(xi=new Array(Zo),Oa=0;Oa<Zo;++Oa)xi[Oa]=Tr(Da,fi,co,Mi,ms);J(je.webgl_draw_buffers||xi.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),J(xi.length<=Ot.maxColorAttachments,"too many color attachments, not supported"),Da=Da||xi[0].width,fi=fi||xi[0].height,Wo?An=nn(Wo):jo&&!ps&&(An=Tr(Da,fi,Zi,"depth","uint32")),es?Ra=nn(es):ps&&!jo&&(Ra=Tr(Da,fi,!1,"stencil","uint8")),Is?Ba=nn(Is):!Wo&&!es&&ps&&jo&&(Ba=Tr(Da,fi,Zi,"depth stencil","depth stencil")),J(!!Wo+!!es+!!Is<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Xo=null;for(Oa=0;Oa<xi.length;++Oa)if(Tn(xi[Oa],Da,fi),J(!xi[Oa]||xi[Oa].texture&&Zu.indexOf(xi[Oa].texture._texture.format)>=0||xi[Oa].renderbuffer&&w.indexOf(xi[Oa].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Oa+" is invalid"),xi[Oa]&&xi[Oa].texture){var gu=nc[xi[Oa].texture._texture.format]*Wu[xi[Oa].texture._texture.type];Xo===null?Xo=gu:J(Xo===gu,"all color attachments much have the same number of bits per pixel.")}return Tn(An,Da,fi),J(!An||An.texture&&An.texture._texture.format===Cl||An.renderbuffer&&An.renderbuffer._renderbuffer.format===ic,"invalid depth attachment for framebuffer object"),Tn(Ra,Da,fi),J(!Ra||Ra.renderbuffer&&Ra.renderbuffer._renderbuffer.format===oc,"invalid stencil attachment for framebuffer object"),Tn(Ba,Da,fi),J(!Ba||Ba.texture&&Ba.texture._texture.format===s||Ba.renderbuffer&&Ba.renderbuffer._renderbuffer.format===s,"invalid depth-stencil attachment for framebuffer object"),Jr(jr),jr.width=Da,jr.height=fi,jr.colorAttachments=xi,jr.depthAttachment=An,jr.stencilAttachment=Ra,jr.depthStencilAttachment=Ba,ha.color=xi.map(br),ha.depth=br(An),ha.stencil=br(Ra),ha.depthStencil=br(Ba),ha.width=jr.width,ha.height=jr.height,Fr(jr),ha}function pa(Un,Ua){J(Er.next!==jr,"can not resize a framebuffer which is currently in use");var Oa=Math.max(Un|0,1),Da=Math.max(Ua|0||Oa,1);if(Oa===jr.width&&Da===jr.height)return ha;for(var fi=jr.colorAttachments,jo=0;jo<fi.length;++jo)Wr(fi[jo],Oa,Da);return Wr(jr.depthAttachment,Oa,Da),Wr(jr.stencilAttachment,Oa,Da),Wr(jr.depthStencilAttachment,Oa,Da),jr.width=ha.width=Oa,jr.height=ha.height=Da,Fr(jr),ha}return ha(sn,Gr),m(ha,{resize:pa,_reglType:"framebuffer",_framebuffer:jr,destroy:function(){Br(jr),Jr(jr)},use:function(Ua){Er.setFBO({framebuffer:ha},Ua)}})}function Hn(sn){var Gr=Array(6);function jr(pa){var Un;J(Gr.indexOf(Er.next)<0,"can not update framebuffer which is currently in use");var Ua={color:null},Oa=0,Da=null,fi="rgba",jo="uint8",ps=1;if(typeof pa=="number")Oa=pa|0;else if(!pa)Oa=1;else{J.type(pa,"object","invalid arguments for framebuffer");var ei=pa;if("shape"in ei){var co=ei.shape;J(Array.isArray(co)&&co.length>=2,"invalid shape for framebuffer"),J(co[0]===co[1],"cube framebuffer must be square"),Oa=co[0]}else"radius"in ei&&(Oa=ei.radius|0),"width"in ei?(Oa=ei.width|0,"height"in ei&&J(ei.height===Oa,"must be square")):"height"in ei&&(Oa=ei.height|0);("color"in ei||"colors"in ei)&&(Da=ei.color||ei.colors,Array.isArray(Da)&&J(Da.length===1||je.webgl_draw_buffers,"multiple render targets not supported")),Da||("colorCount"in ei&&(ps=ei.colorCount|0,J(ps>0,"invalid color buffer count")),"colorType"in ei&&(J.oneOf(ei.colorType,en,"invalid color type"),jo=ei.colorType),"colorFormat"in ei&&(fi=ei.colorFormat,J.oneOf(ei.colorFormat,Zr,"invalid color format for texture"))),"depth"in ei&&(Ua.depth=ei.depth),"stencil"in ei&&(Ua.stencil=ei.stencil),"depthStencil"in ei&&(Ua.depthStencil=ei.depthStencil)}var Mi;if(Da)if(Array.isArray(Da))for(Mi=[],Un=0;Un<Da.length;++Un)Mi[Un]=Da[Un];else Mi=[Da];else{Mi=Array(ps);var ms={radius:Oa,format:fi,type:jo};for(Un=0;Un<ps;++Un)Mi[Un]=xr.createCube(ms)}for(Ua.color=Array(Mi.length),Un=0;Un<Mi.length;++Un){var Zo=Mi[Un];J(typeof Zo=="function"&&Zo._reglType==="textureCube","invalid cube map"),Oa=Oa||Zo.width,J(Zo.width===Oa&&Zo.height===Oa,"invalid cube map shape"),Ua.color[Un]={target:no,data:Mi[Un]}}for(Un=0;Un<6;++Un){for(var Wo=0;Wo<Mi.length;++Wo)Ua.color[Wo].target=no+Un;Un>0&&(Ua.depth=Gr[0].depth,Ua.stencil=Gr[0].stencil,Ua.depthStencil=Gr[0].depthStencil),Gr[Un]?Gr[Un](Ua):Gr[Un]=Kr(Ua)}return m(jr,{width:Oa,height:Oa,color:Mi})}function ha(pa){var Un,Ua=pa|0;if(J(Ua>0&&Ua<=Ot.maxCubeMapSize,"invalid radius for cube fbo"),Ua===jr.width)return jr;var Oa=jr.color;for(Un=0;Un<Oa.length;++Un)Oa[Un].resize(Ua);for(Un=0;Un<6;++Un)Gr[Un].resize(Ua);return jr.width=jr.height=Ua,jr}return jr(sn),m(jr,{faces:Gr,resize:ha,_reglType:"framebufferCube",destroy:function(){Gr.forEach(function(Un){Un.destroy()})}})}function aa(){Er.cur=null,Er.next=null,Er.dirty=!0,Le(Rr).forEach(function(sn){sn.framebuffer=ye.createFramebuffer(),Fr(sn)})}return m(Er,{getFramebuffer:function(Gr){if(typeof Gr=="function"&&Gr._reglType==="framebuffer"){var jr=Gr._framebuffer;if(jr instanceof ta)return jr}return null},create:Kr,createCube:Hn,clear:function(){Le(Rr).forEach(Br)},restore:aa})}var ue=5126,Ee=34962;function Ke(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=ue,this.offset=0,this.stride=0,this.divisor=0}function tt(ye,je,Ot,xr,Pr){for(var Cr=Ot.maxAttributes,Er=new Array(Cr),Zr=0;Zr<Cr;++Zr)Er[Zr]=new Ke;var on=0,en={},Yr={Record:Ke,scope:{},state:Er,currentVAO:null,targetVAO:null,restore:Tn()?Rr:function(){},createVAO:ta,getVAO:nn,destroyBuffer:cn,setVAO:Tn()?Tr:br,clear:Tn()?Wr:function(){}};function cn(Jr){for(var Br=0;Br<Er.length;++Br){var Fr=Er[Br];Fr.buffer===Jr&&(ye.disableVertexAttribArray(Br),Fr.buffer=null)}}function Tn(){return je.oes_vertex_array_object}function dn(){return je.angle_instanced_arrays}function nn(Jr){return typeof Jr=="function"&&Jr._vao?Jr._vao:null}function Tr(Jr){if(Jr===Yr.currentVAO)return;var Br=Tn();Jr?Br.bindVertexArrayOES(Jr.vao):Br.bindVertexArrayOES(null),Yr.currentVAO=Jr}function br(Jr){if(Jr===Yr.currentVAO)return;if(Jr)Jr.bindAttrs();else for(var Br=dn(),Fr=0;Fr<Er.length;++Fr){var Kr=Er[Fr];Kr.buffer?(ye.enableVertexAttribArray(Fr),ye.vertexAttribPointer(Fr,Kr.size,Kr.type,Kr.normalized,Kr.stride,Kr.offfset),Br&&Kr.divisor&&Br.vertexAttribDivisorANGLE(Fr,Kr.divisor)):(ye.disableVertexAttribArray(Fr),ye.vertexAttrib4f(Fr,Kr.x,Kr.y,Kr.z,Kr.w))}Yr.currentVAO=Jr}function Wr(){Le(en).forEach(function(Jr){Jr.destroy()})}function wn(){this.id=++on,this.attributes=[];var Jr=Tn();Jr?this.vao=Jr.createVertexArrayOES():this.vao=null,en[this.id]=this,this.buffers=[]}wn.prototype.bindAttrs=function(){for(var Jr=dn(),Br=this.attributes,Fr=0;Fr<Br.length;++Fr){var Kr=Br[Fr];Kr.buffer?(ye.enableVertexAttribArray(Fr),ye.bindBuffer(Ee,Kr.buffer.buffer),ye.vertexAttribPointer(Fr,Kr.size,Kr.type,Kr.normalized,Kr.stride,Kr.offset),Jr&&Kr.divisor&&Jr.vertexAttribDivisorANGLE(Fr,Kr.divisor)):(ye.disableVertexAttribArray(Fr),ye.vertexAttrib4f(Fr,Kr.x,Kr.y,Kr.z,Kr.w))}for(var Hn=Br.length;Hn<Cr;++Hn)ye.disableVertexAttribArray(Hn)},wn.prototype.refresh=function(){var Jr=Tn();Jr&&(Jr.bindVertexArrayOES(this.vao),this.bindAttrs(),Yr.currentVAO=this)},wn.prototype.destroy=function(){if(this.vao){var Jr=Tn();this===Yr.currentVAO&&(Yr.currentVAO=null,Jr.bindVertexArrayOES(null)),Jr.deleteVertexArrayOES(this.vao),this.vao=null}en[this.id]&&(delete en[this.id],xr.vaoCount-=1)};function Rr(){var Jr=Tn();Jr&&Le(en).forEach(function(Br){Br.refresh()})}function ta(Jr){var Br=new wn;xr.vaoCount+=1;function Fr(Kr){J(Array.isArray(Kr),"arguments to vertex array constructor must be an array"),J(Kr.length<Cr,"too many attributes"),J(Kr.length>0,"must specify at least one attribute");var Hn={},aa=Br.attributes;aa.length=Kr.length;for(var sn=0;sn<Kr.length;++sn){var Gr=Kr[sn],jr=aa[sn]=new Ke,ha=Gr.data||Gr;if(Array.isArray(ha)||b(ha)||Vt(ha)){var pa;Br.buffers[sn]&&(pa=Br.buffers[sn],b(ha)&&pa._buffer.byteLength>=ha.byteLength?pa.subdata(ha):(pa.destroy(),Br.buffers[sn]=null)),Br.buffers[sn]||(pa=Br.buffers[sn]=Pr.create(Gr,Ee,!1,!0)),jr.buffer=Pr.getBuffer(pa),jr.size=jr.buffer.dimension|0,jr.normalized=!1,jr.type=jr.buffer.dtype,jr.offset=0,jr.stride=0,jr.divisor=0,jr.state=1,Hn[sn]=1}else Pr.getBuffer(Gr)?(jr.buffer=Pr.getBuffer(Gr),jr.size=jr.buffer.dimension|0,jr.normalized=!1,jr.type=jr.buffer.dtype,jr.offset=0,jr.stride=0,jr.divisor=0,jr.state=1):Pr.getBuffer(Gr.buffer)?(jr.buffer=Pr.getBuffer(Gr.buffer),jr.size=(+Gr.size||jr.buffer.dimension)|0,jr.normalized=!!Gr.normalized||!1,"type"in Gr?(J.parameter(Gr.type,Eo,"invalid buffer type"),jr.type=Eo[Gr.type]):jr.type=jr.buffer.dtype,jr.offset=(Gr.offset||0)|0,jr.stride=(Gr.stride||0)|0,jr.divisor=(Gr.divisor||0)|0,jr.state=1,J(jr.size>=1&&jr.size<=4,"size must be between 1 and 4"),J(jr.offset>=0,"invalid offset"),J(jr.stride>=0&&jr.stride<=255,"stride must be between 0 and 255"),J(jr.divisor>=0,"divisor must be positive"),J(!jr.divisor||!!je.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Gr?(J(sn>0,"first attribute must not be a constant"),jr.x=+Gr.x||0,jr.y=+Gr.y||0,jr.z=+Gr.z||0,jr.w=+Gr.w||0,jr.state=2):J(!1,"invalid attribute spec for location "+sn)}for(var Un=0;Un<Br.buffers.length;++Un)!Hn[Un]&&Br.buffers[Un]&&(Br.buffers[Un].destroy(),Br.buffers[Un]=null);return Br.refresh(),Fr}return Fr.destroy=function(){for(var Kr=0;Kr<Br.buffers.length;++Kr)Br.buffers[Kr]&&Br.buffers[Kr].destroy();Br.buffers.length=0,Br.destroy()},Fr._vao=Br,Fr._reglType="vao",Fr(Jr)}return Yr}var rt=35632,Ft=35633,Nt=35718,Kt=35721;function jt(ye,je,Ot,xr){var Pr={},Cr={};function Er(Tr,br,Wr,wn){this.name=Tr,this.id=br,this.location=Wr,this.info=wn}function Zr(Tr,br){for(var Wr=0;Wr<Tr.length;++Wr)if(Tr[Wr].id===br.id){Tr[Wr].location=br.location;return}Tr.push(br)}function on(Tr,br,Wr){var wn=Tr===rt?Pr:Cr,Rr=wn[br];if(!Rr){var ta=je.str(br);Rr=ye.createShader(Tr),ye.shaderSource(Rr,ta),ye.compileShader(Rr),J.shaderError(ye,Rr,ta,Tr,Wr),wn[br]=Rr}return Rr}var en={},Yr=[],cn=0;function Tn(Tr,br){this.id=cn++,this.fragId=Tr,this.vertId=br,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,xr.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function dn(Tr,br,Wr){var wn,Rr,ta=on(rt,Tr.fragId),Jr=on(Ft,Tr.vertId),Br=Tr.program=ye.createProgram();if(ye.attachShader(Br,ta),ye.attachShader(Br,Jr),Wr)for(wn=0;wn<Wr.length;++wn){var Fr=Wr[wn];ye.bindAttribLocation(Br,Fr[0],Fr[1])}ye.linkProgram(Br),J.linkError(ye,Br,je.str(Tr.fragId),je.str(Tr.vertId),br);var Kr=ye.getProgramParameter(Br,Nt);xr.profile&&(Tr.stats.uniformsCount=Kr);var Hn=Tr.uniforms;for(wn=0;wn<Kr;++wn)if(Rr=ye.getActiveUniform(Br,wn),Rr)if(Rr.size>1)for(var aa=0;aa<Rr.size;++aa){var sn=Rr.name.replace("[0]","["+aa+"]");Zr(Hn,new Er(sn,je.id(sn),ye.getUniformLocation(Br,sn),Rr))}else Zr(Hn,new Er(Rr.name,je.id(Rr.name),ye.getUniformLocation(Br,Rr.name),Rr));var Gr=ye.getProgramParameter(Br,Kt);xr.profile&&(Tr.stats.attributesCount=Gr);var jr=Tr.attributes;for(wn=0;wn<Gr;++wn)Rr=ye.getActiveAttrib(Br,wn),Rr&&Zr(jr,new Er(Rr.name,je.id(Rr.name),ye.getAttribLocation(Br,Rr.name),Rr))}xr.profile&&(Ot.getMaxUniformsCount=function(){var Tr=0;return Yr.forEach(function(br){br.stats.uniformsCount>Tr&&(Tr=br.stats.uniformsCount)}),Tr},Ot.getMaxAttributesCount=function(){var Tr=0;return Yr.forEach(function(br){br.stats.attributesCount>Tr&&(Tr=br.stats.attributesCount)}),Tr});function nn(){Pr={},Cr={};for(var Tr=0;Tr<Yr.length;++Tr)dn(Yr[Tr],null,Yr[Tr].attributes.map(function(br){return[br.location,br.name]}))}return{clear:function(){var br=ye.deleteShader.bind(ye);Le(Pr).forEach(br),Pr={},Le(Cr).forEach(br),Cr={},Yr.forEach(function(Wr){ye.deleteProgram(Wr.program)}),Yr.length=0,en={},Ot.shaderCount=0},program:function(br,Wr,wn,Rr){J.command(br>=0,"missing vertex shader",wn),J.command(Wr>=0,"missing fragment shader",wn);var ta=en[Wr];ta||(ta=en[Wr]={});var Jr=ta[br];if(Jr&&(Jr.refCount++,!Rr))return Jr;var Br=new Tn(Wr,br);return Ot.shaderCount++,dn(Br,wn,Rr),Jr||(ta[br]=Br),Yr.push(Br),m(Br,{destroy:function(){if(Br.refCount--,Br.refCount<=0){ye.deleteProgram(Br.program);var Kr=Yr.indexOf(Br);Yr.splice(Kr,1),Ot.shaderCount--}ta[Br.vertId].refCount<=0&&(ye.deleteShader(Cr[Br.vertId]),delete Cr[Br.vertId],delete en[Br.fragId][Br.vertId]),Object.keys(en[Br.fragId]).length||(ye.deleteShader(Pr[Br.fragId]),delete Pr[Br.fragId],delete en[Br.fragId])}})},restore:nn,shader:on,frag:-1,vert:-1}}var Gt=6408,nr=5121,rr=3333,Lr=5126;function vr(ye,je,Ot,xr,Pr,Cr,Er){function Zr(Yr){var cn;je.next===null?(J(Pr.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),cn=nr):(J(je.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),cn=je.next.colorAttachments[0].texture._texture.type,Cr.oes_texture_float?(J(cn===nr||cn===Lr,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),cn===Lr&&J(Er.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):J(cn===nr,"Reading from a framebuffer is only allowed for the type 'uint8'"));var Tn=0,dn=0,nn=xr.framebufferWidth,Tr=xr.framebufferHeight,br=null;b(Yr)?br=Yr:Yr&&(J.type(Yr,"object","invalid arguments to regl.read()"),Tn=Yr.x|0,dn=Yr.y|0,J(Tn>=0&&Tn<xr.framebufferWidth,"invalid x offset for regl.read"),J(dn>=0&&dn<xr.framebufferHeight,"invalid y offset for regl.read"),nn=(Yr.width||xr.framebufferWidth-Tn)|0,Tr=(Yr.height||xr.framebufferHeight-dn)|0,br=Yr.data||null),br&&(cn===nr?J(br instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):cn===Lr&&J(br instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),J(nn>0&&nn+Tn<=xr.framebufferWidth,"invalid width for read pixels"),J(Tr>0&&Tr+dn<=xr.framebufferHeight,"invalid height for read pixels"),Ot();var Wr=nn*Tr*4;return br||(cn===nr?br=new Uint8Array(Wr):cn===Lr&&(br=br||new Float32Array(Wr))),J.isTypedArray(br,"data buffer for regl.read() must be a typedarray"),J(br.byteLength>=Wr,"data buffer for regl.read() too small"),ye.pixelStorei(rr,4),ye.readPixels(Tn,dn,nn,Tr,Gt,cn,br),br}function on(Yr){var cn;return je.setFBO({framebuffer:Yr.framebuffer},function(){cn=Zr(Yr)}),cn}function en(Yr){return!Yr||!("framebuffer"in Yr)?Zr(Yr):on(Yr)}return en}function Sr(ye){return Array.prototype.slice.call(ye)}function Ar(ye){return Sr(ye).join("")}function rn(){var ye=0,je=[],Ot=[];function xr(cn){for(var Tn=0;Tn<Ot.length;++Tn)if(Ot[Tn]===cn)return je[Tn];var dn="g"+ye++;return je.push(dn),Ot.push(cn),dn}function Pr(){var cn=[];function Tn(){cn.push.apply(cn,Sr(arguments))}var dn=[];function nn(){var Tr="v"+ye++;return dn.push(Tr),arguments.length>0&&(cn.push(Tr,"="),cn.push.apply(cn,Sr(arguments)),cn.push(";")),Tr}return m(Tn,{def:nn,toString:function(){return Ar([dn.length>0?"var "+dn.join(",")+";":"",Ar(cn)])}})}function Cr(){var cn=Pr(),Tn=Pr(),dn=cn.toString,nn=Tn.toString;function Tr(br,Wr){Tn(br,Wr,"=",cn.def(br,Wr),";")}return m(function(){cn.apply(cn,Sr(arguments))},{def:cn.def,entry:cn,exit:Tn,save:Tr,set:function(Wr,wn,Rr){Tr(Wr,wn),cn(Wr,wn,"=",Rr,";")},toString:function(){return dn()+nn()}})}function Er(){var cn=Ar(arguments),Tn=Cr(),dn=Cr(),nn=Tn.toString,Tr=dn.toString;return m(Tn,{then:function(){return Tn.apply(Tn,Sr(arguments)),this},else:function(){return dn.apply(dn,Sr(arguments)),this},toString:function(){var Wr=Tr();return Wr&&(Wr="else{"+Wr+"}"),Ar(["if(",cn,"){",nn(),"}",Wr])}})}var Zr=Pr(),on={};function en(cn,Tn){var dn=[];function nn(){var Rr="a"+dn.length;return dn.push(Rr),Rr}Tn=Tn||0;for(var Tr=0;Tr<Tn;++Tr)nn();var br=Cr(),Wr=br.toString,wn=on[cn]=m(br,{arg:nn,toString:function(){return Ar(["function(",dn.join(),"){",Wr(),"}"])}});return wn}function Yr(){var cn=['"use strict";',Zr,"return {"];Object.keys(on).forEach(function(nn){cn.push('"',nn,'":',on[nn].toString(),",")}),cn.push("}");var Tn=Ar(cn).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),dn=Function.apply(null,je.concat(Tn));return dn.apply(null,Ot)}return{global:Zr,link:xr,block:Pr,proc:en,scope:Cr,cond:Er,compile:Yr}}var Xr="xyzw".split(""),mn=5121,Ln=1,qn=2,sa=0,Sa=1,Za=2,Sn=3,ua=4,ba=5,Zn=6,Aa="dither",na="blend.enable",La="blend.color",za="blend.equation",Gi="blend.func",_i="depth.enable",Di="depth.func",gi="depth.range",Ui="depth.mask",Qo="colorMask",qo="cull.enable",vu="cull.face",Mu="frontFace",cs="lineWidth",Gs="polygonOffset.enable",Pu="polygonOffset.offset",sc="sample.alpha",tu="sample.enable",Xu="sample.coverage",uc="stencil.enable",ru="stencil.mask",Lu="stencil.func",fs="stencil.opFront",ao="stencil.opBack",Yu="scissor.enable",Gl="scissor.box",hs="viewport",Do="profile",No="framebuffer",Ho="vert",_o="frag",uo="elements",Ls="primitive",nu="count",Hl="offset",Gc="instances",dl="vao",lc="Width",pl="Height",Rs=No+lc,go=No+pl,Ac=hs+lc,ds=hs+pl,sf="drawingBuffer",Cf=sf+lc,wf=sf+pl,Cc=[Gi,za,Lu,fs,ao,Xu,hs,Gl,Pu],Ku=34962,Ef=34963,uf=35632,Of=35633,Ru=3553,cc=34067,Df=2884,Hc=3042,wc=3024,Qf=2960,qf=2929,eh=3089,th=32823,Mf=32926,rh=32928,Zl=5126,lf=35664,io=35665,fc=35666,Tf=5124,Oc=35667,au=35668,wl=35669,_f=35670,Nf=35671,Zc=35672,cf=35673,Wc=35674,ml=35675,re=35676,se=35678,N=35680,G=4,Ae=1028,ct=1029,Xt=2304,sr=2305,or=32775,Ir=32776,an=519,Gn=7680,ea=0,la=1,qa=32774,Fa=513,yi=36160,Ja=36064,Bi={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},So=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],yo={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Hi={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},ko={frag:uf,vert:Of},Qa={cw:Xt,ccw:sr};function lo(ye){return Array.isArray(ye)||b(ye)||Vt(ye)}function iu(ye){return ye.sort(function(je,Ot){return je===hs?-1:Ot===hs?1:je<Ot?-1:1})}function bi(ye,je,Ot,xr){this.thisDep=ye,this.contextDep=je,this.propDep=Ot,this.append=xr}function Ni(ye){return ye&&!(ye.thisDep||ye.contextDep||ye.propDep)}function xa(ye){return new bi(!1,!1,!1,ye)}function Ao(ye,je){var Ot=ye.type;if(Ot===sa){var xr=ye.data.length;return new bi(!0,xr>=1,xr>=2,je)}else if(Ot===ua){var Pr=ye.data;return new bi(Pr.thisDep,Pr.contextDep,Pr.propDep,je)}else{if(Ot===ba)return new bi(!1,!1,!1,je);if(Ot===Zn){for(var Cr=!1,Er=!1,Zr=!1,on=0;on<ye.data.length;++on){var en=ye.data[on];if(en.type===Sa)Zr=!0;else if(en.type===Za)Er=!0;else if(en.type===Sn)Cr=!0;else if(en.type===sa){Cr=!0;var Yr=en.data;Yr>=1&&(Er=!0),Yr>=2&&(Zr=!0)}else en.type===ua&&(Cr=Cr||en.data.thisDep,Er=Er||en.data.contextDep,Zr=Zr||en.data.propDep)}return new bi(Cr,Er,Zr,je)}else return new bi(Ot===Sn,Ot===Za,Ot===Sa,je)}}var hc=new bi(!1,!1,!1,function(){});function kf(ye,je,Ot,xr,Pr,Cr,Er,Zr,on,en,Yr,cn,Tn,dn,nn){var Tr=en.Record,br={add:32774,subtract:32778,"reverse subtract":32779};Ot.ext_blend_minmax&&(br.min=or,br.max=Ir);var Wr=Ot.angle_instanced_arrays,wn=Ot.webgl_draw_buffers,Rr={dirty:!0,profile:nn.profile},ta={},Jr=[],Br={},Fr={};function Kr(I){return I.replace(".","_")}function Hn(I,k,X){var ae=Kr(I);Jr.push(I),ta[ae]=Rr[ae]=!!X,Br[ae]=k}function aa(I,k,X){var ae=Kr(I);Jr.push(I),Array.isArray(X)?(Rr[ae]=X.slice(),ta[ae]=X.slice()):Rr[ae]=ta[ae]=X,Fr[ae]=k}Hn(Aa,wc),Hn(na,Hc),aa(La,"blendColor",[0,0,0,0]),aa(za,"blendEquationSeparate",[qa,qa]),aa(Gi,"blendFuncSeparate",[la,ea,la,ea]),Hn(_i,qf,!0),aa(Di,"depthFunc",Fa),aa(gi,"depthRange",[0,1]),aa(Ui,"depthMask",!0),aa(Qo,Qo,[!0,!0,!0,!0]),Hn(qo,Df),aa(vu,"cullFace",ct),aa(Mu,Mu,sr),aa(cs,cs,1),Hn(Gs,th),aa(Pu,"polygonOffset",[0,0]),Hn(sc,Mf),Hn(tu,rh),aa(Xu,"sampleCoverage",[1,!1]),Hn(uc,Qf),aa(ru,"stencilMask",-1),aa(Lu,"stencilFunc",[an,0,-1]),aa(fs,"stencilOpSeparate",[Ae,Gn,Gn,Gn]),aa(ao,"stencilOpSeparate",[ct,Gn,Gn,Gn]),Hn(Yu,eh),aa(Gl,"scissor",[0,0,ye.drawingBufferWidth,ye.drawingBufferHeight]),aa(hs,hs,[0,0,ye.drawingBufferWidth,ye.drawingBufferHeight]);var sn={gl:ye,context:Tn,strings:je,next:ta,current:Rr,draw:cn,elements:Cr,buffer:Pr,shader:Yr,attributes:en.state,vao:en,uniforms:on,framebuffer:Zr,extensions:Ot,timer:dn,isBufferArgs:lo},Gr={primTypes:pi,compareFuncs:yo,blendFuncs:Bi,blendEquations:br,stencilOps:Hi,glTypes:Eo,orientationType:Qa};J.optional(function(){sn.isArrayLike=$i}),wn&&(Gr.backBuffer=[ct],Gr.drawBuffer=W(xr.maxDrawbuffers,function(I){return I===0?[0]:W(I,function(k){return Ja+k})}));var jr=0;function ha(){var I=rn(),k=I.link,X=I.global;I.id=jr++,I.batchId="0";var ae=k(sn),$e=I.shared={props:"a0"};Object.keys(sn).forEach(function(lt){$e[lt]=X.def(ae,".",lt)}),J.optional(function(){I.CHECK=k(J),I.commandStr=J.guessCommand(),I.command=k(I.commandStr),I.assert=function(lt,Ue,It){lt("if(!(",Ue,"))",this.CHECK,".commandRaise(",k(It),",",this.command,");")},Gr.invalidBlendCombinations=So});var Ie=I.next={},Oe=I.current={};Object.keys(Fr).forEach(function(lt){Array.isArray(Rr[lt])&&(Ie[lt]=X.def($e.next,".",lt),Oe[lt]=X.def($e.current,".",lt))});var ft=I.constants={};Object.keys(Gr).forEach(function(lt){ft[lt]=X.def(JSON.stringify(Gr[lt]))}),I.invoke=function(lt,Ue){switch(Ue.type){case sa:var It=["this",$e.context,$e.props,I.batchId];return lt.def(k(Ue.data),".call(",It.slice(0,Math.max(Ue.data.length+1,4)),")");case Sa:return lt.def($e.props,Ue.data);case Za:return lt.def($e.context,Ue.data);case Sn:return lt.def("this",Ue.data);case ua:return Ue.data.append(I,lt),Ue.data.ref;case ba:return Ue.data.toString();case Zn:return Ue.data.map(function($t){return I.invoke(lt,$t)})}},I.attribCache={};var Ne={};return I.scopeAttrib=function(lt){var Ue=je.id(lt);if(Ue in Ne)return Ne[Ue];var It=en.scope[Ue];It||(It=en.scope[Ue]=new Tr);var $t=Ne[Ue]=k(It);return $t},I}function pa(I){var k=I.static,X=I.dynamic,ae;if(Do in k){var $e=!!k[Do];ae=xa(function(Oe,ft){return $e}),ae.enable=$e}else if(Do in X){var Ie=X[Do];ae=Ao(Ie,function(Oe,ft){return Oe.invoke(ft,Ie)})}return ae}function Un(I,k){var X=I.static,ae=I.dynamic;if(No in X){var $e=X[No];return $e?($e=Zr.getFramebuffer($e),J.command($e,"invalid framebuffer object"),xa(function(Oe,ft){var Ne=Oe.link($e),lt=Oe.shared;ft.set(lt.framebuffer,".next",Ne);var Ue=lt.context;return ft.set(Ue,"."+Rs,Ne+".width"),ft.set(Ue,"."+go,Ne+".height"),Ne})):xa(function(Oe,ft){var Ne=Oe.shared;ft.set(Ne.framebuffer,".next","null");var lt=Ne.context;return ft.set(lt,"."+Rs,lt+"."+Cf),ft.set(lt,"."+go,lt+"."+wf),"null"})}else if(No in ae){var Ie=ae[No];return Ao(Ie,function(Oe,ft){var Ne=Oe.invoke(ft,Ie),lt=Oe.shared,Ue=lt.framebuffer,It=ft.def(Ue,".getFramebuffer(",Ne,")");J.optional(function(){Oe.assert(ft,"!"+Ne+"||"+It,"invalid framebuffer object")}),ft.set(Ue,".next",It);var $t=lt.context;return ft.set($t,"."+Rs,It+"?"+It+".width:"+$t+"."+Cf),ft.set($t,"."+go,It+"?"+It+".height:"+$t+"."+wf),It})}else return null}function Ua(I,k,X){var ae=I.static,$e=I.dynamic;function Ie(Ne){if(Ne in ae){var lt=ae[Ne];J.commandType(lt,"object","invalid "+Ne,X.commandStr);var Ue=!0,It=lt.x|0,$t=lt.y|0,ar,tr;return"width"in lt?(ar=lt.width|0,J.command(ar>=0,"invalid "+Ne,X.commandStr)):Ue=!1,"height"in lt?(tr=lt.height|0,J.command(tr>=0,"invalid "+Ne,X.commandStr)):Ue=!1,new bi(!Ue&&k&&k.thisDep,!Ue&&k&&k.contextDep,!Ue&&k&&k.propDep,function($r,Cn){var un=$r.shared.context,_n=ar;"width"in lt||(_n=Cn.def(un,".",Rs,"-",It));var Kn=tr;return"height"in lt||(Kn=Cn.def(un,".",go,"-",$t)),[It,$t,_n,Kn]})}else if(Ne in $e){var pr=$e[Ne],wr=Ao(pr,function($r,Cn){var un=$r.invoke(Cn,pr);J.optional(function(){$r.assert(Cn,un+"&&typeof "+un+'==="object"',"invalid "+Ne)});var _n=$r.shared.context,Kn=Cn.def(un,".x|0"),ka=Cn.def(un,".y|0"),Ei=Cn.def('"width" in ',un,"?",un,".width|0:","(",_n,".",Rs,"-",Kn,")"),Pi=Cn.def('"height" in ',un,"?",un,".height|0:","(",_n,".",go,"-",ka,")");return J.optional(function(){$r.assert(Cn,Ei+">=0&&"+Pi+">=0","invalid "+Ne)}),[Kn,ka,Ei,Pi]});return k&&(wr.thisDep=wr.thisDep||k.thisDep,wr.contextDep=wr.contextDep||k.contextDep,wr.propDep=wr.propDep||k.propDep),wr}else return k?new bi(k.thisDep,k.contextDep,k.propDep,function($r,Cn){var un=$r.shared.context;return[0,0,Cn.def(un,".",Rs),Cn.def(un,".",go)]}):null}var Oe=Ie(hs);if(Oe){var ft=Oe;Oe=new bi(Oe.thisDep,Oe.contextDep,Oe.propDep,function(Ne,lt){var Ue=ft.append(Ne,lt),It=Ne.shared.context;return lt.set(It,"."+Ac,Ue[2]),lt.set(It,"."+ds,Ue[3]),Ue})}return{viewport:Oe,scissor_box:Ie(Gl)}}function Oa(I,k){var X=I.static,ae=typeof X[_o]=="string"&&typeof X[Ho]=="string";if(ae){if(Object.keys(k.dynamic).length>0)return null;var $e=k.static,Ie=Object.keys($e);if(Ie.length>0&&typeof $e[Ie[0]]=="number"){for(var Oe=[],ft=0;ft<Ie.length;++ft)J(typeof $e[Ie[ft]]=="number","must specify all vertex attribute locations when using vaos"),Oe.push([$e[Ie[ft]]|0,Ie[ft]]);return Oe}}return null}function Da(I,k,X){var ae=I.static,$e=I.dynamic;function Ie(Ue){if(Ue in ae){var It=je.id(ae[Ue]);J.optional(function(){Yr.shader(ko[Ue],It,J.guessCommand())});var $t=xa(function(){return It});return $t.id=It,$t}else if(Ue in $e){var ar=$e[Ue];return Ao(ar,function(tr,pr){var wr=tr.invoke(pr,ar),$r=pr.def(tr.shared.strings,".id(",wr,")");return J.optional(function(){pr(tr.shared.shader,".shader(",ko[Ue],",",$r,",",tr.command,");")}),$r})}return null}var Oe=Ie(_o),ft=Ie(Ho),Ne=null,lt;return Ni(Oe)&&Ni(ft)?(Ne=Yr.program(ft.id,Oe.id,null,X),lt=xa(function(Ue,It){return Ue.link(Ne)})):lt=new bi(Oe&&Oe.thisDep||ft&&ft.thisDep,Oe&&Oe.contextDep||ft&&ft.contextDep,Oe&&Oe.propDep||ft&&ft.propDep,function(Ue,It){var $t=Ue.shared.shader,ar;Oe?ar=Oe.append(Ue,It):ar=It.def($t,".",_o);var tr;ft?tr=ft.append(Ue,It):tr=It.def($t,".",Ho);var pr=$t+".program("+tr+","+ar;return J.optional(function(){pr+=","+Ue.command}),It.def(pr+")")}),{frag:Oe,vert:ft,progVar:lt,program:Ne}}function fi(I,k){var X=I.static,ae=I.dynamic;function $e(){if(uo in X){var Ue=X[uo];lo(Ue)?Ue=Cr.getElements(Cr.create(Ue,!0)):Ue&&(Ue=Cr.getElements(Ue),J.command(Ue,"invalid elements",k.commandStr));var It=xa(function(ar,tr){if(Ue){var pr=ar.link(Ue);return ar.ELEMENTS=pr,pr}return ar.ELEMENTS=null,null});return It.value=Ue,It}else if(uo in ae){var $t=ae[uo];return Ao($t,function(ar,tr){var pr=ar.shared,wr=pr.isBufferArgs,$r=pr.elements,Cn=ar.invoke(tr,$t),un=tr.def("null"),_n=tr.def(wr,"(",Cn,")"),Kn=ar.cond(_n).then(un,"=",$r,".createStream(",Cn,");").else(un,"=",$r,".getElements(",Cn,");");return J.optional(function(){ar.assert(Kn.else,"!"+Cn+"||"+un,"invalid elements")}),tr.entry(Kn),tr.exit(ar.cond(_n).then($r,".destroyStream(",un,");")),ar.ELEMENTS=un,un})}return null}var Ie=$e();function Oe(){if(Ls in X){var Ue=X[Ls];return J.commandParameter(Ue,pi,"invalid primitve",k.commandStr),xa(function($t,ar){return pi[Ue]})}else if(Ls in ae){var It=ae[Ls];return Ao(It,function($t,ar){var tr=$t.constants.primTypes,pr=$t.invoke(ar,It);return J.optional(function(){$t.assert(ar,pr+" in "+tr,"invalid primitive, must be one of "+Object.keys(pi))}),ar.def(tr,"[",pr,"]")})}else if(Ie)return Ni(Ie)?Ie.value?xa(function($t,ar){return ar.def($t.ELEMENTS,".primType")}):xa(function(){return G}):new bi(Ie.thisDep,Ie.contextDep,Ie.propDep,function($t,ar){var tr=$t.ELEMENTS;return ar.def(tr,"?",tr,".primType:",G)});return null}function ft(Ue,It){if(Ue in X){var $t=X[Ue]|0;return J.command(!It||$t>=0,"invalid "+Ue,k.commandStr),xa(function(tr,pr){return It&&(tr.OFFSET=$t),$t})}else if(Ue in ae){var ar=ae[Ue];return Ao(ar,function(tr,pr){var wr=tr.invoke(pr,ar);return It&&(tr.OFFSET=wr,J.optional(function(){tr.assert(pr,wr+">=0","invalid "+Ue)})),wr})}else if(It&&Ie)return xa(function(tr,pr){return tr.OFFSET="0",0});return null}var Ne=ft(Hl,!0);function lt(){if(nu in X){var Ue=X[nu]|0;return J.command(typeof Ue=="number"&&Ue>=0,"invalid vertex count",k.commandStr),xa(function(){return Ue})}else if(nu in ae){var It=ae[nu];return Ao(It,function(tr,pr){var wr=tr.invoke(pr,It);return J.optional(function(){tr.assert(pr,"typeof "+wr+'==="number"&&'+wr+">=0&&"+wr+"===("+wr+"|0)","invalid vertex count")}),wr})}else if(Ie)if(Ni(Ie)){if(Ie)return Ne?new bi(Ne.thisDep,Ne.contextDep,Ne.propDep,function(tr,pr){var wr=pr.def(tr.ELEMENTS,".vertCount-",tr.OFFSET);return J.optional(function(){tr.assert(pr,wr+">=0","invalid vertex offset/element buffer too small")}),wr}):xa(function(tr,pr){return pr.def(tr.ELEMENTS,".vertCount")});var $t=xa(function(){return-1});return J.optional(function(){$t.MISSING=!0}),$t}else{var ar=new bi(Ie.thisDep||Ne.thisDep,Ie.contextDep||Ne.contextDep,Ie.propDep||Ne.propDep,function(tr,pr){var wr=tr.ELEMENTS;return tr.OFFSET?pr.def(wr,"?",wr,".vertCount-",tr.OFFSET,":-1"):pr.def(wr,"?",wr,".vertCount:-1")});return J.optional(function(){ar.DYNAMIC=!0}),ar}return null}return{elements:Ie,primitive:Oe(),count:lt(),instances:ft(Gc,!1),offset:Ne}}function jo(I,k){var X=I.static,ae=I.dynamic,$e={};return Jr.forEach(function(Ie){var Oe=Kr(Ie);function ft(Ne,lt){if(Ie in X){var Ue=Ne(X[Ie]);$e[Oe]=xa(function(){return Ue})}else if(Ie in ae){var It=ae[Ie];$e[Oe]=Ao(It,function($t,ar){return lt($t,ar,$t.invoke(ar,It))})}}switch(Ie){case qo:case na:case Aa:case uc:case _i:case Yu:case Gs:case sc:case tu:case Ui:return ft(function(Ne){return J.commandType(Ne,"boolean",Ie,k.commandStr),Ne},function(Ne,lt,Ue){return J.optional(function(){Ne.assert(lt,"typeof "+Ue+'==="boolean"',"invalid flag "+Ie,Ne.commandStr)}),Ue});case Di:return ft(function(Ne){return J.commandParameter(Ne,yo,"invalid "+Ie,k.commandStr),yo[Ne]},function(Ne,lt,Ue){var It=Ne.constants.compareFuncs;return J.optional(function(){Ne.assert(lt,Ue+" in "+It,"invalid "+Ie+", must be one of "+Object.keys(yo))}),lt.def(It,"[",Ue,"]")});case gi:return ft(function(Ne){return J.command($i(Ne)&&Ne.length===2&&typeof Ne[0]=="number"&&typeof Ne[1]=="number"&&Ne[0]<=Ne[1],"depth range is 2d array",k.commandStr),Ne},function(Ne,lt,Ue){J.optional(function(){Ne.assert(lt,Ne.shared.isArrayLike+"("+Ue+")&&"+Ue+".length===2&&typeof "+Ue+'[0]==="number"&&typeof '+Ue+'[1]==="number"&&'+Ue+"[0]<="+Ue+"[1]","depth range must be a 2d array")});var It=lt.def("+",Ue,"[0]"),$t=lt.def("+",Ue,"[1]");return[It,$t]});case Gi:return ft(function(Ne){J.commandType(Ne,"object","blend.func",k.commandStr);var lt="srcRGB"in Ne?Ne.srcRGB:Ne.src,Ue="srcAlpha"in Ne?Ne.srcAlpha:Ne.src,It="dstRGB"in Ne?Ne.dstRGB:Ne.dst,$t="dstAlpha"in Ne?Ne.dstAlpha:Ne.dst;return J.commandParameter(lt,Bi,Oe+".srcRGB",k.commandStr),J.commandParameter(Ue,Bi,Oe+".srcAlpha",k.commandStr),J.commandParameter(It,Bi,Oe+".dstRGB",k.commandStr),J.commandParameter($t,Bi,Oe+".dstAlpha",k.commandStr),J.command(So.indexOf(lt+", "+It)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+lt+", "+It+")",k.commandStr),[Bi[lt],Bi[It],Bi[Ue],Bi[$t]]},function(Ne,lt,Ue){var It=Ne.constants.blendFuncs;J.optional(function(){Ne.assert(lt,Ue+"&&typeof "+Ue+'==="object"',"invalid blend func, must be an object")});function $t(un,_n){var Kn=lt.def('"',un,_n,'" in ',Ue,"?",Ue,".",un,_n,":",Ue,".",un);return J.optional(function(){Ne.assert(lt,Kn+" in "+It,"invalid "+Ie+"."+un+_n+", must be one of "+Object.keys(Bi))}),Kn}var ar=$t("src","RGB"),tr=$t("dst","RGB");J.optional(function(){var un=Ne.constants.invalidBlendCombinations;Ne.assert(lt,un+".indexOf("+ar+'+", "+'+tr+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var pr=lt.def(It,"[",ar,"]"),wr=lt.def(It,"[",$t("src","Alpha"),"]"),$r=lt.def(It,"[",tr,"]"),Cn=lt.def(It,"[",$t("dst","Alpha"),"]");return[pr,$r,wr,Cn]});case za:return ft(function(Ne){if(typeof Ne=="string")return J.commandParameter(Ne,br,"invalid "+Ie,k.commandStr),[br[Ne],br[Ne]];if(typeof Ne=="object")return J.commandParameter(Ne.rgb,br,Ie+".rgb",k.commandStr),J.commandParameter(Ne.alpha,br,Ie+".alpha",k.commandStr),[br[Ne.rgb],br[Ne.alpha]];J.commandRaise("invalid blend.equation",k.commandStr)},function(Ne,lt,Ue){var It=Ne.constants.blendEquations,$t=lt.def(),ar=lt.def(),tr=Ne.cond("typeof ",Ue,'==="string"');return J.optional(function(){function pr(wr,$r,Cn){Ne.assert(wr,Cn+" in "+It,"invalid "+$r+", must be one of "+Object.keys(br))}pr(tr.then,Ie,Ue),Ne.assert(tr.else,Ue+"&&typeof "+Ue+'==="object"',"invalid "+Ie),pr(tr.else,Ie+".rgb",Ue+".rgb"),pr(tr.else,Ie+".alpha",Ue+".alpha")}),tr.then($t,"=",ar,"=",It,"[",Ue,"];"),tr.else($t,"=",It,"[",Ue,".rgb];",ar,"=",It,"[",Ue,".alpha];"),lt(tr),[$t,ar]});case La:return ft(function(Ne){return J.command($i(Ne)&&Ne.length===4,"blend.color must be a 4d array",k.commandStr),W(4,function(lt){return+Ne[lt]})},function(Ne,lt,Ue){return J.optional(function(){Ne.assert(lt,Ne.shared.isArrayLike+"("+Ue+")&&"+Ue+".length===4","blend.color must be a 4d array")}),W(4,function(It){return lt.def("+",Ue,"[",It,"]")})});case ru:return ft(function(Ne){return J.commandType(Ne,"number",Oe,k.commandStr),Ne|0},function(Ne,lt,Ue){return J.optional(function(){Ne.assert(lt,"typeof "+Ue+'==="number"',"invalid stencil.mask")}),lt.def(Ue,"|0")});case Lu:return ft(function(Ne){J.commandType(Ne,"object",Oe,k.commandStr);var lt=Ne.cmp||"keep",Ue=Ne.ref||0,It="mask"in Ne?Ne.mask:-1;return J.commandParameter(lt,yo,Ie+".cmp",k.commandStr),J.commandType(Ue,"number",Ie+".ref",k.commandStr),J.commandType(It,"number",Ie+".mask",k.commandStr),[yo[lt],Ue,It]},function(Ne,lt,Ue){var It=Ne.constants.compareFuncs;J.optional(function(){function pr(){Ne.assert(lt,Array.prototype.join.call(arguments,""),"invalid stencil.func")}pr(Ue+"&&typeof ",Ue,'==="object"'),pr('!("cmp" in ',Ue,")||(",Ue,".cmp in ",It,")")});var $t=lt.def('"cmp" in ',Ue,"?",It,"[",Ue,".cmp]",":",Gn),ar=lt.def(Ue,".ref|0"),tr=lt.def('"mask" in ',Ue,"?",Ue,".mask|0:-1");return[$t,ar,tr]});case fs:case ao:return ft(function(Ne){J.commandType(Ne,"object",Oe,k.commandStr);var lt=Ne.fail||"keep",Ue=Ne.zfail||"keep",It=Ne.zpass||"keep";return J.commandParameter(lt,Hi,Ie+".fail",k.commandStr),J.commandParameter(Ue,Hi,Ie+".zfail",k.commandStr),J.commandParameter(It,Hi,Ie+".zpass",k.commandStr),[Ie===ao?ct:Ae,Hi[lt],Hi[Ue],Hi[It]]},function(Ne,lt,Ue){var It=Ne.constants.stencilOps;J.optional(function(){Ne.assert(lt,Ue+"&&typeof "+Ue+'==="object"',"invalid "+Ie)});function $t(ar){return J.optional(function(){Ne.assert(lt,'!("'+ar+'" in '+Ue+")||("+Ue+"."+ar+" in "+It+")","invalid "+Ie+"."+ar+", must be one of "+Object.keys(Hi))}),lt.def('"',ar,'" in ',Ue,"?",It,"[",Ue,".",ar,"]:",Gn)}return[Ie===ao?ct:Ae,$t("fail"),$t("zfail"),$t("zpass")]});case Pu:return ft(function(Ne){J.commandType(Ne,"object",Oe,k.commandStr);var lt=Ne.factor|0,Ue=Ne.units|0;return J.commandType(lt,"number",Oe+".factor",k.commandStr),J.commandType(Ue,"number",Oe+".units",k.commandStr),[lt,Ue]},function(Ne,lt,Ue){J.optional(function(){Ne.assert(lt,Ue+"&&typeof "+Ue+'==="object"',"invalid "+Ie)});var It=lt.def(Ue,".factor|0"),$t=lt.def(Ue,".units|0");return[It,$t]});case vu:return ft(function(Ne){var lt=0;return Ne==="front"?lt=Ae:Ne==="back"&&(lt=ct),J.command(!!lt,Oe,k.commandStr),lt},function(Ne,lt,Ue){return J.optional(function(){Ne.assert(lt,Ue+'==="front"||'+Ue+'==="back"',"invalid cull.face")}),lt.def(Ue,'==="front"?',Ae,":",ct)});case cs:return ft(function(Ne){return J.command(typeof Ne=="number"&&Ne>=xr.lineWidthDims[0]&&Ne<=xr.lineWidthDims[1],"invalid line width, must be a positive number between "+xr.lineWidthDims[0]+" and "+xr.lineWidthDims[1],k.commandStr),Ne},function(Ne,lt,Ue){return J.optional(function(){Ne.assert(lt,"typeof "+Ue+'==="number"&&'+Ue+">="+xr.lineWidthDims[0]+"&&"+Ue+"<="+xr.lineWidthDims[1],"invalid line width")}),Ue});case Mu:return ft(function(Ne){return J.commandParameter(Ne,Qa,Oe,k.commandStr),Qa[Ne]},function(Ne,lt,Ue){return J.optional(function(){Ne.assert(lt,Ue+'==="cw"||'+Ue+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),lt.def(Ue+'==="cw"?'+Xt+":"+sr)});case Qo:return ft(function(Ne){return J.command($i(Ne)&&Ne.length===4,"color.mask must be length 4 array",k.commandStr),Ne.map(function(lt){return!!lt})},function(Ne,lt,Ue){return J.optional(function(){Ne.assert(lt,Ne.shared.isArrayLike+"("+Ue+")&&"+Ue+".length===4","invalid color.mask")}),W(4,function(It){return"!!"+Ue+"["+It+"]"})});case Xu:return ft(function(Ne){J.command(typeof Ne=="object"&&Ne,Oe,k.commandStr);var lt="value"in Ne?Ne.value:1,Ue=!!Ne.invert;return J.command(typeof lt=="number"&&lt>=0&&lt<=1,"sample.coverage.value must be a number between 0 and 1",k.commandStr),[lt,Ue]},function(Ne,lt,Ue){J.optional(function(){Ne.assert(lt,Ue+"&&typeof "+Ue+'==="object"',"invalid sample.coverage")});var It=lt.def('"value" in ',Ue,"?+",Ue,".value:1"),$t=lt.def("!!",Ue,".invert");return[It,$t]})}}),$e}function ps(I,k){var X=I.static,ae=I.dynamic,$e={};return Object.keys(X).forEach(function(Ie){var Oe=X[Ie],ft;if(typeof Oe=="number"||typeof Oe=="boolean")ft=xa(function(){return Oe});else if(typeof Oe=="function"){var Ne=Oe._reglType;Ne==="texture2d"||Ne==="textureCube"?ft=xa(function(lt){return lt.link(Oe)}):Ne==="framebuffer"||Ne==="framebufferCube"?(J.command(Oe.color.length>0,'missing color attachment for framebuffer sent to uniform "'+Ie+'"',k.commandStr),ft=xa(function(lt){return lt.link(Oe.color[0])})):J.commandRaise('invalid data for uniform "'+Ie+'"',k.commandStr)}else $i(Oe)?ft=xa(function(lt){var Ue=lt.global.def("[",W(Oe.length,function(It){return J.command(typeof Oe[It]=="number"||typeof Oe[It]=="boolean","invalid uniform "+Ie,lt.commandStr),Oe[It]}),"]");return Ue}):J.commandRaise('invalid or missing data for uniform "'+Ie+'"',k.commandStr);ft.value=Oe,$e[Ie]=ft}),Object.keys(ae).forEach(function(Ie){var Oe=ae[Ie];$e[Ie]=Ao(Oe,function(ft,Ne){return ft.invoke(Ne,Oe)})}),$e}function ei(I,k){var X=I.static,ae=I.dynamic,$e={};return Object.keys(X).forEach(function(Ie){var Oe=X[Ie],ft=je.id(Ie),Ne=new Tr;if(lo(Oe))Ne.state=Ln,Ne.buffer=Pr.getBuffer(Pr.create(Oe,Ku,!1,!0)),Ne.type=0;else{var lt=Pr.getBuffer(Oe);if(lt)Ne.state=Ln,Ne.buffer=lt,Ne.type=0;else if(J.command(typeof Oe=="object"&&Oe,"invalid data for attribute "+Ie,k.commandStr),"constant"in Oe){var Ue=Oe.constant;Ne.buffer="null",Ne.state=qn,typeof Ue=="number"?Ne.x=Ue:(J.command($i(Ue)&&Ue.length>0&&Ue.length<=4,"invalid constant for attribute "+Ie,k.commandStr),Xr.forEach(function($r,Cn){Cn<Ue.length&&(Ne[$r]=Ue[Cn])}))}else{lo(Oe.buffer)?lt=Pr.getBuffer(Pr.create(Oe.buffer,Ku,!1,!0)):lt=Pr.getBuffer(Oe.buffer),J.command(!!lt,'missing buffer for attribute "'+Ie+'"',k.commandStr);var It=Oe.offset|0;J.command(It>=0,'invalid offset for attribute "'+Ie+'"',k.commandStr);var $t=Oe.stride|0;J.command($t>=0&&$t<256,'invalid stride for attribute "'+Ie+'", must be integer betweeen [0, 255]',k.commandStr);var ar=Oe.size|0;J.command(!("size"in Oe)||ar>0&&ar<=4,'invalid size for attribute "'+Ie+'", must be 1,2,3,4',k.commandStr);var tr=!!Oe.normalized,pr=0;"type"in Oe&&(J.commandParameter(Oe.type,Eo,"invalid type for attribute "+Ie,k.commandStr),pr=Eo[Oe.type]);var wr=Oe.divisor|0;"divisor"in Oe&&(J.command(wr===0||Wr,'cannot specify divisor for attribute "'+Ie+'", instancing not supported',k.commandStr),J.command(wr>=0,'invalid divisor for attribute "'+Ie+'"',k.commandStr)),J.optional(function(){var $r=k.commandStr,Cn=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(Oe).forEach(function(un){J.command(Cn.indexOf(un)>=0,'unknown parameter "'+un+'" for attribute pointer "'+Ie+'" (valid parameters are '+Cn+")",$r)})}),Ne.buffer=lt,Ne.state=Ln,Ne.size=ar,Ne.normalized=tr,Ne.type=pr||lt.dtype,Ne.offset=It,Ne.stride=$t,Ne.divisor=wr}}$e[Ie]=xa(function($r,Cn){var un=$r.attribCache;if(ft in un)return un[ft];var _n={isStream:!1};return Object.keys(Ne).forEach(function(Kn){_n[Kn]=Ne[Kn]}),Ne.buffer&&(_n.buffer=$r.link(Ne.buffer),_n.type=_n.type||_n.buffer+".dtype"),un[ft]=_n,_n})}),Object.keys(ae).forEach(function(Ie){var Oe=ae[Ie];function ft(Ne,lt){var Ue=Ne.invoke(lt,Oe),It=Ne.shared,$t=Ne.constants,ar=It.isBufferArgs,tr=It.buffer;J.optional(function(){Ne.assert(lt,Ue+"&&(typeof "+Ue+'==="object"||typeof '+Ue+'==="function")&&('+ar+"("+Ue+")||"+tr+".getBuffer("+Ue+")||"+tr+".getBuffer("+Ue+".buffer)||"+ar+"("+Ue+'.buffer)||("constant" in '+Ue+"&&(typeof "+Ue+'.constant==="number"||'+It.isArrayLike+"("+Ue+".constant))))",'invalid dynamic attribute "'+Ie+'"')});var pr={isStream:lt.def(!1)},wr=new Tr;wr.state=Ln,Object.keys(wr).forEach(function(_n){pr[_n]=lt.def(""+wr[_n])});var $r=pr.buffer,Cn=pr.type;lt("if(",ar,"(",Ue,")){",pr.isStream,"=true;",$r,"=",tr,".createStream(",Ku,",",Ue,");",Cn,"=",$r,".dtype;","}else{",$r,"=",tr,".getBuffer(",Ue,");","if(",$r,"){",Cn,"=",$r,".dtype;",'}else if("constant" in ',Ue,"){",pr.state,"=",qn,";","if(typeof "+Ue+'.constant === "number"){',pr[Xr[0]],"=",Ue,".constant;",Xr.slice(1).map(function(_n){return pr[_n]}).join("="),"=0;","}else{",Xr.map(function(_n,Kn){return pr[_n]+"="+Ue+".constant.length>"+Kn+"?"+Ue+".constant["+Kn+"]:0;"}).join(""),"}}else{","if(",ar,"(",Ue,".buffer)){",$r,"=",tr,".createStream(",Ku,",",Ue,".buffer);","}else{",$r,"=",tr,".getBuffer(",Ue,".buffer);","}",Cn,'="type" in ',Ue,"?",$t.glTypes,"[",Ue,".type]:",$r,".dtype;",pr.normalized,"=!!",Ue,".normalized;");function un(_n){lt(pr[_n],"=",Ue,".",_n,"|0;")}return un("size"),un("offset"),un("stride"),un("divisor"),lt("}}"),lt.exit("if(",pr.isStream,"){",tr,".destroyStream(",$r,");","}"),pr}$e[Ie]=Ao(Oe,ft)}),$e}function co(I,k){var X=I.static,ae=I.dynamic;if(dl in X){var $e=X[dl];return $e!==null&&en.getVAO($e)===null&&($e=en.createVAO($e)),xa(function(Oe){return Oe.link(en.getVAO($e))})}else if(dl in ae){var Ie=ae[dl];return Ao(Ie,function(Oe,ft){var Ne=Oe.invoke(ft,Ie);return ft.def(Oe.shared.vao+".getVAO("+Ne+")")})}return null}function Mi(I){var k=I.static,X=I.dynamic,ae={};return Object.keys(k).forEach(function($e){var Ie=k[$e];ae[$e]=xa(function(Oe,ft){return typeof Ie=="number"||typeof Ie=="boolean"?""+Ie:Oe.link(Ie)})}),Object.keys(X).forEach(function($e){var Ie=X[$e];ae[$e]=Ao(Ie,function(Oe,ft){return Oe.invoke(ft,Ie)})}),ae}function ms(I,k,X,ae,$e){var Ie=I.static,Oe=I.dynamic;J.optional(function(){var un=[No,Ho,_o,uo,Ls,Hl,nu,Gc,Do,dl].concat(Jr);function _n(Kn){Object.keys(Kn).forEach(function(ka){J.command(un.indexOf(ka)>=0,'unknown parameter "'+ka+'"',$e.commandStr)})}_n(Ie),_n(Oe)});var ft=Oa(I,k),Ne=Un(I,$e),lt=Ua(I,Ne,$e),Ue=fi(I,$e),It=jo(I,$e),$t=Da(I,$e,ft);function ar(un){var _n=lt[un];_n&&(It[un]=_n)}ar(hs),ar(Kr(Gl));var tr=Object.keys(It).length>0,pr={framebuffer:Ne,draw:Ue,shader:$t,state:It,dirty:tr,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(pr.profile=pa(I,$e),pr.uniforms=ps(X,$e),pr.drawVAO=pr.scopeVAO=co(I,$e),!pr.drawVAO&&$t.program&&!ft&&Ot.angle_instanced_arrays){var wr=!0,$r=$t.program.attributes.map(function(un){var _n=k.static[un];return wr=wr&&!!_n,_n});if(wr&&$r.length>0){var Cn=en.getVAO(en.createVAO($r));pr.drawVAO=new bi(null,null,null,function(un,_n){return un.link(Cn)}),pr.useVAO=!0}}return ft?pr.useVAO=!0:pr.attributes=ei(k,$e),pr.context=Mi(ae,$e),pr}function Zo(I,k,X){var ae=I.shared,$e=ae.context,Ie=I.scope();Object.keys(X).forEach(function(Oe){k.save($e,"."+Oe);var ft=X[Oe],Ne=ft.append(I,k);Array.isArray(Ne)?Ie($e,".",Oe,"=[",Ne.join(),"];"):Ie($e,".",Oe,"=",Ne,";")}),k(Ie)}function Wo(I,k,X,ae){var $e=I.shared,Ie=$e.gl,Oe=$e.framebuffer,ft;wn&&(ft=k.def($e.extensions,".webgl_draw_buffers"));var Ne=I.constants,lt=Ne.drawBuffer,Ue=Ne.backBuffer,It;X?It=X.append(I,k):It=k.def(Oe,".next"),ae||k("if(",It,"!==",Oe,".cur){"),k("if(",It,"){",Ie,".bindFramebuffer(",yi,",",It,".framebuffer);"),wn&&k(ft,".drawBuffersWEBGL(",lt,"[",It,".colorAttachments.length]);"),k("}else{",Ie,".bindFramebuffer(",yi,",null);"),wn&&k(ft,".drawBuffersWEBGL(",Ue,");"),k("}",Oe,".cur=",It,";"),ae||k("}")}function es(I,k,X){var ae=I.shared,$e=ae.gl,Ie=I.current,Oe=I.next,ft=ae.current,Ne=ae.next,lt=I.cond(ft,".dirty");Jr.forEach(function(Ue){var It=Kr(Ue);if(It in X.state)return;var $t,ar;if(It in Oe){$t=Oe[It],ar=Ie[It];var tr=W(Rr[It].length,function(wr){return lt.def($t,"[",wr,"]")});lt(I.cond(tr.map(function(wr,$r){return wr+"!=="+ar+"["+$r+"]"}).join("||")).then($e,".",Fr[It],"(",tr,");",tr.map(function(wr,$r){return ar+"["+$r+"]="+wr}).join(";"),";"))}else{$t=lt.def(Ne,".",It);var pr=I.cond($t,"!==",ft,".",It);lt(pr),It in Br?pr(I.cond($t).then($e,".enable(",Br[It],");").else($e,".disable(",Br[It],");"),ft,".",It,"=",$t,";"):pr($e,".",Fr[It],"(",$t,");",ft,".",It,"=",$t,";")}}),Object.keys(X.state).length===0&&lt(ft,".dirty=false;"),k(lt)}function Is(I,k,X,ae){var $e=I.shared,Ie=I.current,Oe=$e.current,ft=$e.gl;iu(Object.keys(X)).forEach(function(Ne){var lt=X[Ne];if(ae&&!ae(lt))return;var Ue=lt.append(I,k);if(Br[Ne]){var It=Br[Ne];Ni(lt)?Ue?k(ft,".enable(",It,");"):k(ft,".disable(",It,");"):k(I.cond(Ue).then(ft,".enable(",It,");").else(ft,".disable(",It,");")),k(Oe,".",Ne,"=",Ue,";")}else if($i(Ue)){var $t=Ie[Ne];k(ft,".",Fr[Ne],"(",Ue,");",Ue.map(function(ar,tr){return $t+"["+tr+"]="+ar}).join(";"),";")}else k(ft,".",Fr[Ne],"(",Ue,");",Oe,".",Ne,"=",Ue,";")})}function Zi(I,k){Wr&&(I.instancing=k.def(I.shared.extensions,".angle_instanced_arrays"))}function ia(I,k,X,ae,$e){var Ie=I.shared,Oe=I.stats,ft=Ie.current,Ne=Ie.timer,lt=X.profile;function Ue(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var It,$t;function ar(un){It=k.def(),un(It,"=",Ue(),";"),typeof $e=="string"?un(Oe,".count+=",$e,";"):un(Oe,".count++;"),dn&&(ae?($t=k.def(),un($t,"=",Ne,".getNumPendingQueries();")):un(Ne,".beginQuery(",Oe,");"))}function tr(un){un(Oe,".cpuTime+=",Ue(),"-",It,";"),dn&&(ae?un(Ne,".pushScopeStats(",$t,",",Ne,".getNumPendingQueries(),",Oe,");"):un(Ne,".endQuery();"))}function pr(un){var _n=k.def(ft,".profile");k(ft,".profile=",un,";"),k.exit(ft,".profile=",_n,";")}var wr;if(lt){if(Ni(lt)){lt.enable?(ar(k),tr(k.exit),pr("true")):pr("false");return}wr=lt.append(I,k),pr(wr)}else wr=k.def(ft,".profile");var $r=I.block();ar($r),k("if(",wr,"){",$r,"}");var Cn=I.block();tr(Cn),k.exit("if(",wr,"){",Cn,"}")}function Hs(I,k,X,ae,$e){var Ie=I.shared;function Oe(Ne){switch(Ne){case lf:case Oc:case Nf:return 2;case io:case au:case Zc:return 3;case fc:case wl:case cf:return 4;default:return 1}}function ft(Ne,lt,Ue){var It=Ie.gl,$t=k.def(Ne,".location"),ar=k.def(Ie.attributes,"[",$t,"]"),tr=Ue.state,pr=Ue.buffer,wr=[Ue.x,Ue.y,Ue.z,Ue.w],$r=["buffer","normalized","offset","stride"];function Cn(){k("if(!",ar,".buffer){",It,".enableVertexAttribArray(",$t,");}");var _n=Ue.type,Kn;if(Ue.size?Kn=k.def(Ue.size,"||",lt):Kn=lt,k("if(",ar,".type!==",_n,"||",ar,".size!==",Kn,"||",$r.map(function(Ei){return ar+"."+Ei+"!=="+Ue[Ei]}).join("||"),"){",It,".bindBuffer(",Ku,",",pr,".buffer);",It,".vertexAttribPointer(",[$t,Kn,_n,Ue.normalized,Ue.stride,Ue.offset],");",ar,".type=",_n,";",ar,".size=",Kn,";",$r.map(function(Ei){return ar+"."+Ei+"="+Ue[Ei]+";"}).join(""),"}"),Wr){var ka=Ue.divisor;k("if(",ar,".divisor!==",ka,"){",I.instancing,".vertexAttribDivisorANGLE(",[$t,ka],");",ar,".divisor=",ka,";}")}}function un(){k("if(",ar,".buffer){",It,".disableVertexAttribArray(",$t,");",ar,".buffer=null;","}if(",Xr.map(function(_n,Kn){return ar+"."+_n+"!=="+wr[Kn]}).join("||"),"){",It,".vertexAttrib4f(",$t,",",wr,");",Xr.map(function(_n,Kn){return ar+"."+_n+"="+wr[Kn]+";"}).join(""),"}")}tr===Ln?Cn():tr===qn?un():(k("if(",tr,"===",Ln,"){"),Cn(),k("}else{"),un(),k("}"))}ae.forEach(function(Ne){var lt=Ne.name,Ue=X.attributes[lt],It;if(Ue){if(!$e(Ue))return;It=Ue.append(I,k)}else{if(!$e(hc))return;var $t=I.scopeAttrib(lt);J.optional(function(){I.assert(k,$t+".state","missing attribute "+lt)}),It={},Object.keys(new Tr).forEach(function(ar){It[ar]=k.def($t,".",ar)})}ft(I.link(Ne),Oe(Ne.info.type),It)})}function xi(I,k,X,ae,$e){for(var Ie=I.shared,Oe=Ie.gl,ft,Ne=0;Ne<ae.length;++Ne){var lt=ae[Ne],Ue=lt.name,It=lt.info.type,$t=X.uniforms[Ue],ar=I.link(lt),tr=ar+".location",pr;if($t){if(!$e($t))continue;if(Ni($t)){var wr=$t.value;if(J.command(wr!==null&&typeof wr!="undefined",'missing uniform "'+Ue+'"',I.commandStr),It===se||It===N){J.command(typeof wr=="function"&&(It===se&&(wr._reglType==="texture2d"||wr._reglType==="framebuffer")||It===N&&(wr._reglType==="textureCube"||wr._reglType==="framebufferCube")),"invalid texture for uniform "+Ue,I.commandStr);var $r=I.link(wr._texture||wr.color[0]._texture);k(Oe,".uniform1i(",tr,",",$r+".bind());"),k.exit($r,".unbind();")}else if(It===Wc||It===ml||It===re){J.optional(function(){J.command($i(wr),"invalid matrix for uniform "+Ue,I.commandStr),J.command(It===Wc&&wr.length===4||It===ml&&wr.length===9||It===re&&wr.length===16,"invalid length for matrix uniform "+Ue,I.commandStr)});var Cn=I.global.def("new Float32Array(["+Array.prototype.slice.call(wr)+"])"),un=2;It===ml?un=3:It===re&&(un=4),k(Oe,".uniformMatrix",un,"fv(",tr,",false,",Cn,");")}else{switch(It){case Zl:J.commandType(wr,"number","uniform "+Ue,I.commandStr),ft="1f";break;case lf:J.command($i(wr)&&wr.length===2,"uniform "+Ue,I.commandStr),ft="2f";break;case io:J.command($i(wr)&&wr.length===3,"uniform "+Ue,I.commandStr),ft="3f";break;case fc:J.command($i(wr)&&wr.length===4,"uniform "+Ue,I.commandStr),ft="4f";break;case _f:J.commandType(wr,"boolean","uniform "+Ue,I.commandStr),ft="1i";break;case Tf:J.commandType(wr,"number","uniform "+Ue,I.commandStr),ft="1i";break;case Nf:J.command($i(wr)&&wr.length===2,"uniform "+Ue,I.commandStr),ft="2i";break;case Oc:J.command($i(wr)&&wr.length===2,"uniform "+Ue,I.commandStr),ft="2i";break;case Zc:J.command($i(wr)&&wr.length===3,"uniform "+Ue,I.commandStr),ft="3i";break;case au:J.command($i(wr)&&wr.length===3,"uniform "+Ue,I.commandStr),ft="3i";break;case cf:J.command($i(wr)&&wr.length===4,"uniform "+Ue,I.commandStr),ft="4i";break;case wl:J.command($i(wr)&&wr.length===4,"uniform "+Ue,I.commandStr),ft="4i";break}k(Oe,".uniform",ft,"(",tr,",",$i(wr)?Array.prototype.slice.call(wr):wr,");")}continue}else pr=$t.append(I,k)}else{if(!$e(hc))continue;pr=k.def(Ie.uniforms,"[",je.id(Ue),"]")}It===se?(J(!Array.isArray(pr),"must specify a scalar prop for textures"),k("if(",pr,"&&",pr,'._reglType==="framebuffer"){',pr,"=",pr,".color[0];","}")):It===N&&(J(!Array.isArray(pr),"must specify a scalar prop for cube maps"),k("if(",pr,"&&",pr,'._reglType==="framebufferCube"){',pr,"=",pr,".color[0];","}")),J.optional(function(){function Pi(Ds,Ns){I.assert(k,Ds,'bad data or missing for uniform "'+Ue+'".  '+Ns)}function Du(Ds){J(!Array.isArray(pr),"must not specify an array type for uniform"),Pi("typeof "+pr+'==="'+Ds+'"',"invalid type, expected "+Ds)}function ou(Ds,Ns){Array.isArray(pr)?J(pr.length===Ds,"must have length "+Ds):Pi(Ie.isArrayLike+"("+pr+")&&"+pr+".length==="+Ds,"invalid vector, should have length "+Ds,I.commandStr)}function Xl(Ds){J(!Array.isArray(pr),"must not specify a value type"),Pi("typeof "+pr+'==="function"&&'+pr+'._reglType==="texture'+(Ds===Ru?"2d":"Cube")+'"',"invalid texture type",I.commandStr)}switch(It){case Tf:Du("number");break;case Oc:ou(2,"number");break;case au:ou(3,"number");break;case wl:ou(4,"number");break;case Zl:Du("number");break;case lf:ou(2,"number");break;case io:ou(3,"number");break;case fc:ou(4,"number");break;case _f:Du("boolean");break;case Nf:ou(2,"boolean");break;case Zc:ou(3,"boolean");break;case cf:ou(4,"boolean");break;case Wc:ou(4,"number");break;case ml:ou(9,"number");break;case re:ou(16,"number");break;case se:Xl(Ru);break;case N:Xl(cc);break}});var _n=1;switch(It){case se:case N:var Kn=k.def(pr,"._texture");k(Oe,".uniform1i(",tr,",",Kn,".bind());"),k.exit(Kn,".unbind();");continue;case Tf:case _f:ft="1i";break;case Oc:case Nf:ft="2i",_n=2;break;case au:case Zc:ft="3i",_n=3;break;case wl:case cf:ft="4i",_n=4;break;case Zl:ft="1f";break;case lf:ft="2f",_n=2;break;case io:ft="3f",_n=3;break;case fc:ft="4f",_n=4;break;case Wc:ft="Matrix2fv";break;case ml:ft="Matrix3fv";break;case re:ft="Matrix4fv";break}if(k(Oe,".uniform",ft,"(",tr,","),ft.charAt(0)==="M"){var ka=Math.pow(It-Wc+2,2),Ei=I.global.def("new Float32Array(",ka,")");Array.isArray(pr)?k("false,(",W(ka,function(Pi){return Ei+"["+Pi+"]="+pr[Pi]}),",",Ei,")"):k("false,(Array.isArray(",pr,")||",pr," instanceof Float32Array)?",pr,":(",W(ka,function(Pi){return Ei+"["+Pi+"]="+pr+"["+Pi+"]"}),",",Ei,")")}else _n>1?k(W(_n,function(Pi){return Array.isArray(pr)?pr[Pi]:pr+"["+Pi+"]"})):(J(!Array.isArray(pr),"uniform value must not be an array"),k(pr));k(");")}}function An(I,k,X,ae){var $e=I.shared,Ie=$e.gl,Oe=$e.draw,ft=ae.draw;function Ne(){var Kn=ft.elements,ka,Ei=k;return Kn?((Kn.contextDep&&ae.contextDynamic||Kn.propDep)&&(Ei=X),ka=Kn.append(I,Ei)):ka=Ei.def(Oe,".",uo),ka&&Ei("if("+ka+")"+Ie+".bindBuffer("+Ef+","+ka+".buffer.buffer);"),ka}function lt(){var Kn=ft.count,ka,Ei=k;return Kn?((Kn.contextDep&&ae.contextDynamic||Kn.propDep)&&(Ei=X),ka=Kn.append(I,Ei),J.optional(function(){Kn.MISSING&&I.assert(k,"false","missing vertex count"),Kn.DYNAMIC&&I.assert(Ei,ka+">=0","missing vertex count")})):(ka=Ei.def(Oe,".",nu),J.optional(function(){I.assert(Ei,ka+">=0","missing vertex count")})),ka}var Ue=Ne();function It(Kn){var ka=ft[Kn];return ka?ka.contextDep&&ae.contextDynamic||ka.propDep?ka.append(I,X):ka.append(I,k):k.def(Oe,".",Kn)}var $t=It(Ls),ar=It(Hl),tr=lt();if(typeof tr=="number"){if(tr===0)return}else X("if(",tr,"){"),X.exit("}");var pr,wr;Wr&&(pr=It(Gc),wr=I.instancing);var $r=Ue+".type",Cn=ft.elements&&Ni(ft.elements);function un(){function Kn(){X(wr,".drawElementsInstancedANGLE(",[$t,tr,$r,ar+"<<(("+$r+"-"+mn+")>>1)",pr],");")}function ka(){X(wr,".drawArraysInstancedANGLE(",[$t,ar,tr,pr],");")}Ue?Cn?Kn():(X("if(",Ue,"){"),Kn(),X("}else{"),ka(),X("}")):ka()}function _n(){function Kn(){X(Ie+".drawElements("+[$t,tr,$r,ar+"<<(("+$r+"-"+mn+")>>1)"]+");")}function ka(){X(Ie+".drawArrays("+[$t,ar,tr]+");")}Ue?Cn?Kn():(X("if(",Ue,"){"),Kn(),X("}else{"),ka(),X("}")):ka()}Wr&&(typeof pr!="number"||pr>=0)?typeof pr=="string"?(X("if(",pr,">0){"),un(),X("}else if(",pr,"<0){"),_n(),X("}")):un():_n()}function Ra(I,k,X,ae,$e){var Ie=ha(),Oe=Ie.proc("body",$e);return J.optional(function(){Ie.commandStr=k.commandStr,Ie.command=Ie.link(k.commandStr)}),Wr&&(Ie.instancing=Oe.def(Ie.shared.extensions,".angle_instanced_arrays")),I(Ie,Oe,X,ae),Ie.compile().body}function Ba(I,k,X,ae){Zi(I,k),X.useVAO?X.drawVAO?k(I.shared.vao,".setVAO(",X.drawVAO.append(I,k),");"):k(I.shared.vao,".setVAO(",I.shared.vao,".targetVAO);"):(k(I.shared.vao,".setVAO(null);"),Hs(I,k,X,ae.attributes,function(){return!0})),xi(I,k,X,ae.uniforms,function(){return!0}),An(I,k,k,X)}function Xo(I,k){var X=I.proc("draw",1);Zi(I,X),Zo(I,X,k.context),Wo(I,X,k.framebuffer),es(I,X,k),Is(I,X,k.state),ia(I,X,k,!1,!0);var ae=k.shader.progVar.append(I,X);if(X(I.shared.gl,".useProgram(",ae,".program);"),k.shader.program)Ba(I,X,k,k.shader.program);else{X(I.shared.vao,".setVAO(null);");var $e=I.global.def("{}"),Ie=X.def(ae,".id"),Oe=X.def($e,"[",Ie,"]");X(I.cond(Oe).then(Oe,".call(this,a0);").else(Oe,"=",$e,"[",Ie,"]=",I.link(function(ft){return Ra(Ba,I,k,ft,1)}),"(",ae,");",Oe,".call(this,a0);"))}Object.keys(k.state).length>0&&X(I.shared.current,".dirty=true;")}function gu(I,k,X,ae){I.batchId="a1",Zi(I,k);function $e(){return!0}Hs(I,k,X,ae.attributes,$e),xi(I,k,X,ae.uniforms,$e),An(I,k,k,X)}function O(I,k,X,ae){Zi(I,k);var $e=X.contextDep,Ie=k.def(),Oe="a0",ft="a1",Ne=k.def();I.shared.props=Ne,I.batchId=Ie;var lt=I.scope(),Ue=I.scope();k(lt.entry,"for(",Ie,"=0;",Ie,"<",ft,";++",Ie,"){",Ne,"=",Oe,"[",Ie,"];",Ue,"}",lt.exit);function It($r){return $r.contextDep&&$e||$r.propDep}function $t($r){return!It($r)}if(X.needsContext&&Zo(I,Ue,X.context),X.needsFramebuffer&&Wo(I,Ue,X.framebuffer),Is(I,Ue,X.state,It),X.profile&&It(X.profile)&&ia(I,Ue,X,!1,!0),ae)X.useVAO?X.drawVAO?It(X.drawVAO)?Ue(I.shared.vao,".setVAO(",X.drawVAO.append(I,Ue),");"):lt(I.shared.vao,".setVAO(",X.drawVAO.append(I,lt),");"):lt(I.shared.vao,".setVAO(",I.shared.vao,".targetVAO);"):(lt(I.shared.vao,".setVAO(null);"),Hs(I,lt,X,ae.attributes,$t),Hs(I,Ue,X,ae.attributes,It)),xi(I,lt,X,ae.uniforms,$t),xi(I,Ue,X,ae.uniforms,It),An(I,lt,Ue,X);else{var ar=I.global.def("{}"),tr=X.shader.progVar.append(I,Ue),pr=Ue.def(tr,".id"),wr=Ue.def(ar,"[",pr,"]");Ue(I.shared.gl,".useProgram(",tr,".program);","if(!",wr,"){",wr,"=",ar,"[",pr,"]=",I.link(function($r){return Ra(gu,I,X,$r,2)}),"(",tr,");}",wr,".call(this,a0[",Ie,"],",Ie,");")}}function d(I,k){var X=I.proc("batch",2);I.batchId="0",Zi(I,X);var ae=!1,$e=!0;Object.keys(k.context).forEach(function(ar){ae=ae||k.context[ar].propDep}),ae||(Zo(I,X,k.context),$e=!1);var Ie=k.framebuffer,Oe=!1;Ie?(Ie.propDep?ae=Oe=!0:Ie.contextDep&&ae&&(Oe=!0),Oe||Wo(I,X,Ie)):Wo(I,X,null),k.state.viewport&&k.state.viewport.propDep&&(ae=!0);function ft(ar){return ar.contextDep&&ae||ar.propDep}es(I,X,k),Is(I,X,k.state,function(ar){return!ft(ar)}),(!k.profile||!ft(k.profile))&&ia(I,X,k,!1,"a1"),k.contextDep=ae,k.needsContext=$e,k.needsFramebuffer=Oe;var Ne=k.shader.progVar;if(Ne.contextDep&&ae||Ne.propDep)O(I,X,k,null);else{var lt=Ne.append(I,X);if(X(I.shared.gl,".useProgram(",lt,".program);"),k.shader.program)O(I,X,k,k.shader.program);else{X(I.shared.vao,".setVAO(null);");var Ue=I.global.def("{}"),It=X.def(lt,".id"),$t=X.def(Ue,"[",It,"]");X(I.cond($t).then($t,".call(this,a0,a1);").else($t,"=",Ue,"[",It,"]=",I.link(function(ar){return Ra(O,I,k,ar,2)}),"(",lt,");",$t,".call(this,a0,a1);"))}}Object.keys(k.state).length>0&&X(I.shared.current,".dirty=true;")}function c(I,k){var X=I.proc("scope",3);I.batchId="a2";var ae=I.shared,$e=ae.current;Zo(I,X,k.context),k.framebuffer&&k.framebuffer.append(I,X),iu(Object.keys(k.state)).forEach(function(Oe){var ft=k.state[Oe],Ne=ft.append(I,X);$i(Ne)?Ne.forEach(function(lt,Ue){X.set(I.next[Oe],"["+Ue+"]",lt)}):X.set(ae.next,"."+Oe,Ne)}),ia(I,X,k,!0,!0),[uo,Hl,nu,Gc,Ls].forEach(function(Oe){var ft=k.draw[Oe];if(!ft)return;X.set(ae.draw,"."+Oe,""+ft.append(I,X))}),Object.keys(k.uniforms).forEach(function(Oe){var ft=k.uniforms[Oe].append(I,X);Array.isArray(ft)&&(ft="["+ft.join()+"]"),X.set(ae.uniforms,"["+je.id(Oe)+"]",ft)}),Object.keys(k.attributes).forEach(function(Oe){var ft=k.attributes[Oe].append(I,X),Ne=I.scopeAttrib(Oe);Object.keys(new Tr).forEach(function(lt){X.set(Ne,"."+lt,ft[lt])})}),k.scopeVAO&&X.set(ae.vao,".targetVAO",k.scopeVAO.append(I,X));function Ie(Oe){var ft=k.shader[Oe];ft&&X.set(ae.shader,"."+Oe,ft.append(I,X))}Ie(Ho),Ie(_o),Object.keys(k.state).length>0&&(X($e,".dirty=true;"),X.exit($e,".dirty=true;")),X("a1(",I.shared.context,",a0,",I.batchId,");")}function p(I){if(typeof I!="object"||$i(I))return;for(var k=Object.keys(I),X=0;X<k.length;++X)if(yt.isDynamic(I[k[X]]))return!0;return!1}function T(I,k,X){var ae=k.static[X];if(!ae||!p(ae))return;var $e=I.global,Ie=Object.keys(ae),Oe=!1,ft=!1,Ne=!1,lt=I.global.def("{}");Ie.forEach(function(It){var $t=ae[It];if(yt.isDynamic($t)){typeof $t=="function"&&($t=ae[It]=yt.unbox($t));var ar=Ao($t,null);Oe=Oe||ar.thisDep,Ne=Ne||ar.propDep,ft=ft||ar.contextDep}else{$e(lt,".",It,"=");switch(typeof $t){case"number":$e($t);break;case"string":$e('"',$t,'"');break;case"object":Array.isArray($t)&&$e("[",$t.join(),"]");break;default:$e(I.link($t));break}$e(";")}});function Ue(It,$t){Ie.forEach(function(ar){var tr=ae[ar];if(!yt.isDynamic(tr))return;var pr=It.invoke($t,tr);$t(lt,".",ar,"=",pr,";")})}k.dynamic[X]=new yt.DynamicVariable(ua,{thisDep:Oe,contextDep:ft,propDep:Ne,ref:lt,append:Ue}),delete k.static[X]}function j(I,k,X,ae,$e){var Ie=ha();Ie.stats=Ie.link($e),Object.keys(k.static).forEach(function(ft){T(Ie,k,ft)}),Cc.forEach(function(ft){T(Ie,I,ft)});var Oe=ms(I,k,X,ae,Ie);return Xo(Ie,Oe),c(Ie,Oe),d(Ie,Oe),m(Ie.compile(),{destroy:function(){Oe.shader.program.destroy()}})}return{next:ta,current:Rr,procs:function(){var I=ha(),k=I.proc("poll"),X=I.proc("refresh"),ae=I.block();k(ae),X(ae);var $e=I.shared,Ie=$e.gl,Oe=$e.next,ft=$e.current;ae(ft,".dirty=false;"),Wo(I,k),Wo(I,X,null,!0);var Ne;Wr&&(Ne=I.link(Wr)),Ot.oes_vertex_array_object&&X(I.link(Ot.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var lt=0;lt<xr.maxAttributes;++lt){var Ue=X.def($e.attributes,"[",lt,"]"),It=I.cond(Ue,".buffer");It.then(Ie,".enableVertexAttribArray(",lt,");",Ie,".bindBuffer(",Ku,",",Ue,".buffer.buffer);",Ie,".vertexAttribPointer(",lt,",",Ue,".size,",Ue,".type,",Ue,".normalized,",Ue,".stride,",Ue,".offset);").else(Ie,".disableVertexAttribArray(",lt,");",Ie,".vertexAttrib4f(",lt,",",Ue,".x,",Ue,".y,",Ue,".z,",Ue,".w);",Ue,".buffer=null;"),X(It),Wr&&X(Ne,".vertexAttribDivisorANGLE(",lt,",",Ue,".divisor);")}return X(I.shared.vao,".currentVAO=null;",I.shared.vao,".setVAO(",I.shared.vao,".targetVAO);"),Object.keys(Br).forEach(function($t){var ar=Br[$t],tr=ae.def(Oe,".",$t),pr=I.block();pr("if(",tr,"){",Ie,".enable(",ar,")}else{",Ie,".disable(",ar,")}",ft,".",$t,"=",tr,";"),X(pr),k("if(",tr,"!==",ft,".",$t,"){",pr,"}")}),Object.keys(Fr).forEach(function($t){var ar=Fr[$t],tr=Rr[$t],pr,wr,$r=I.block();if($r(Ie,".",ar,"("),$i(tr)){var Cn=tr.length;pr=I.global.def(Oe,".",$t),wr=I.global.def(ft,".",$t),$r(W(Cn,function(un){return pr+"["+un+"]"}),");",W(Cn,function(un){return wr+"["+un+"]="+pr+"["+un+"];"}).join("")),k("if(",W(Cn,function(un){return pr+"["+un+"]!=="+wr+"["+un+"]"}).join("||"),"){",$r,"}")}else pr=ae.def(Oe,".",$t),wr=ae.def(ft,".",$t),$r(pr,");",ft,".",$t,"=",pr,";"),k("if(",pr,"!==",wr,"){",$r,"}");X($r)}),I.compile()}(),compile:j}}function uh(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var jf=34918,Iu=34919,Ff=35007,ff=function(je,Ot){if(!Ot.ext_disjoint_timer_query)return null;var xr=[];function Pr(){return xr.pop()||Ot.ext_disjoint_timer_query.createQueryEXT()}function Cr(wn){xr.push(wn)}var Er=[];function Zr(wn){var Rr=Pr();Ot.ext_disjoint_timer_query.beginQueryEXT(Ff,Rr),Er.push(Rr),nn(Er.length-1,Er.length,wn)}function on(){Ot.ext_disjoint_timer_query.endQueryEXT(Ff)}function en(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Yr=[];function cn(){return Yr.pop()||new en}function Tn(wn){Yr.push(wn)}var dn=[];function nn(wn,Rr,ta){var Jr=cn();Jr.startQueryIndex=wn,Jr.endQueryIndex=Rr,Jr.sum=0,Jr.stats=ta,dn.push(Jr)}var Tr=[],br=[];function Wr(){var wn,Rr,ta=Er.length;if(ta===0)return;br.length=Math.max(br.length,ta+1),Tr.length=Math.max(Tr.length,ta+1),Tr[0]=0,br[0]=0;var Jr=0;for(wn=0,Rr=0;Rr<Er.length;++Rr){var Br=Er[Rr];Ot.ext_disjoint_timer_query.getQueryObjectEXT(Br,Iu)?(Jr+=Ot.ext_disjoint_timer_query.getQueryObjectEXT(Br,jf),Cr(Br)):Er[wn++]=Br,Tr[Rr+1]=Jr,br[Rr+1]=wn}for(Er.length=wn,wn=0,Rr=0;Rr<dn.length;++Rr){var Fr=dn[Rr],Kr=Fr.startQueryIndex,Hn=Fr.endQueryIndex;Fr.sum+=Tr[Hn]-Tr[Kr];var aa=br[Kr],sn=br[Hn];sn===aa?(Fr.stats.gpuTime+=Fr.sum/1e6,Tn(Fr)):(Fr.startQueryIndex=aa,Fr.endQueryIndex=sn,dn[wn++]=Fr)}dn.length=wn}return{beginQuery:Zr,endQuery:on,pushScopeStats:nn,update:Wr,getNumPendingQueries:function(){return Er.length},clear:function(){xr.push.apply(xr,Er);for(var Rr=0;Rr<xr.length;Rr++)Ot.ext_disjoint_timer_query.deleteQueryEXT(xr[Rr]);Er.length=0,xr.length=0},restore:function(){Er.length=0,xr.length=0}}},zf=16384,Th=256,lh=1024,Sf=34962,Uf="webglcontextlost",Bf="webglcontextrestored",ch=1,Vf=2,Pf=3;function Wl(ye,je){for(var Ot=0;Ot<ye.length;++Ot)if(ye[Ot]===je)return Ot;return-1}function Dh(ye){var je=On(ye);if(!je)return null;var Ot=je.gl,xr=Ot.getContextAttributes(),Pr=Ot.isContextLost(),Cr=U(Ot,je);if(!Cr)return null;var Er=Hr(),Zr=uh(),on=Cr.extensions,en=ff(Ot,on),Yr=hr(),cn=Ot.drawingBufferWidth,Tn=Ot.drawingBufferHeight,dn={tick:0,time:0,viewportWidth:cn,viewportHeight:Tn,framebufferWidth:cn,framebufferHeight:Tn,drawingBufferWidth:cn,drawingBufferHeight:Tn,pixelRatio:je.pixelRatio},nn={},Tr={elements:null,primitive:4,count:-1,offset:0,instances:-1},br=ho(Ot,on),Wr=Xa(Ot,Zr,je,Rr),wn=tt(Ot,on,br,Zr,Wr);function Rr(An){return wn.destroyBuffer(An)}var ta=Ic(Ot,on,Wr,Zr),Jr=jt(Ot,Er,Zr,je),Br=eu(Ot,on,br,function(){Hn.procs.poll()},dn,Zr,je),Fr=Ss(Ot,on,br,Zr,je),Kr=z(Ot,on,br,Br,Fr,Zr),Hn=kf(Ot,Er,on,br,Wr,ta,Br,Kr,nn,wn,Jr,Tr,dn,en,je),aa=vr(Ot,Kr,Hn.procs.poll,dn,xr,on,br),sn=Hn.next,Gr=Ot.canvas,jr=[],ha=[],pa=[],Un=[je.onDestroy],Ua=null;function Oa(){if(jr.length===0){en&&en.update(),Ua=null;return}Ua=Ht.next(Oa),Is();for(var An=jr.length-1;An>=0;--An){var Ra=jr[An];Ra&&Ra(dn,null,0)}Ot.flush(),en&&en.update()}function Da(){!Ua&&jr.length>0&&(Ua=Ht.next(Oa))}function fi(){Ua&&(Ht.cancel(Oa),Ua=null)}function jo(An){An.preventDefault(),Pr=!0,fi(),ha.forEach(function(Ra){Ra()})}function ps(An){Ot.getError(),Pr=!1,Cr.restore(),Jr.restore(),Wr.restore(),Br.restore(),Fr.restore(),Kr.restore(),wn.restore(),en&&en.restore(),Hn.procs.refresh(),Da(),pa.forEach(function(Ra){Ra()})}Gr&&(Gr.addEventListener(Uf,jo,!1),Gr.addEventListener(Bf,ps,!1));function ei(){jr.length=0,fi(),Gr&&(Gr.removeEventListener(Uf,jo),Gr.removeEventListener(Bf,ps)),Jr.clear(),Kr.clear(),Fr.clear(),Br.clear(),ta.clear(),Wr.clear(),wn.clear(),en&&en.clear(),Un.forEach(function(An){An()})}function co(An){J(!!An,"invalid args to regl({...})"),J.type(An,"object","invalid args to regl({...})");function Ra($e){var Ie=m({},$e);delete Ie.uniforms,delete Ie.attributes,delete Ie.context,delete Ie.vao,"stencil"in Ie&&Ie.stencil.op&&(Ie.stencil.opBack=Ie.stencil.opFront=Ie.stencil.op,delete Ie.stencil.op);function Oe(ft){if(ft in Ie){var Ne=Ie[ft];delete Ie[ft],Object.keys(Ne).forEach(function(lt){Ie[ft+"."+lt]=Ne[lt]})}}return Oe("blend"),Oe("depth"),Oe("cull"),Oe("stencil"),Oe("polygonOffset"),Oe("scissor"),Oe("sample"),"vao"in $e&&(Ie.vao=$e.vao),Ie}function Ba($e,Ie){var Oe={},ft={};return Object.keys($e).forEach(function(Ne){var lt=$e[Ne];if(yt.isDynamic(lt)){ft[Ne]=yt.unbox(lt,Ne);return}else if(Ie&&Array.isArray(lt)){for(var Ue=0;Ue<lt.length;++Ue)if(yt.isDynamic(lt[Ue])){ft[Ne]=yt.unbox(lt,Ne);return}}Oe[Ne]=lt}),{dynamic:ft,static:Oe}}var Xo=Ba(An.context||{},!0),gu=Ba(An.uniforms||{},!0),O=Ba(An.attributes||{},!1),d=Ba(Ra(An),!1),c={gpuTime:0,cpuTime:0,count:0},p=Hn.compile(d,O,gu,Xo,c),T=p.draw,j=p.batch,I=p.scope,k=[];function X($e){for(;k.length<$e;)k.push(null);return k}function ae($e,Ie){var Oe;if(Pr&&J.raise("context lost"),typeof $e=="function")return I.call(this,null,$e,0);if(typeof Ie=="function")if(typeof $e=="number")for(Oe=0;Oe<$e;++Oe)I.call(this,null,Ie,Oe);else if(Array.isArray($e))for(Oe=0;Oe<$e.length;++Oe)I.call(this,$e[Oe],Ie,Oe);else return I.call(this,$e,Ie,0);else if(typeof $e=="number"){if($e>0)return j.call(this,X($e|0),$e|0)}else if(Array.isArray($e)){if($e.length)return j.call(this,$e,$e.length)}else return T.call(this,$e)}return m(ae,{stats:c,destroy:function(){p.destroy()}})}var Mi=Kr.setFBO=co({framebuffer:yt.define.call(null,ch,"framebuffer")});function ms(An,Ra){var Ba=0;Hn.procs.poll();var Xo=Ra.color;Xo&&(Ot.clearColor(+Xo[0]||0,+Xo[1]||0,+Xo[2]||0,+Xo[3]||0),Ba|=zf),"depth"in Ra&&(Ot.clearDepth(+Ra.depth),Ba|=Th),"stencil"in Ra&&(Ot.clearStencil(Ra.stencil|0),Ba|=lh),J(!!Ba,"called regl.clear with no buffer specified"),Ot.clear(Ba)}function Zo(An){if(J(typeof An=="object"&&An,"regl.clear() takes an object as input"),"framebuffer"in An)if(An.framebuffer&&An.framebuffer_reglType==="framebufferCube")for(var Ra=0;Ra<6;++Ra)Mi(m({framebuffer:An.framebuffer.faces[Ra]},An),ms);else Mi(An,ms);else ms(null,An)}function Wo(An){J.type(An,"function","regl.frame() callback must be a function"),jr.push(An);function Ra(){var Ba=Wl(jr,An);J(Ba>=0,"cannot cancel a frame twice");function Xo(){var gu=Wl(jr,Xo);jr[gu]=jr[jr.length-1],jr.length-=1,jr.length<=0&&fi()}jr[Ba]=Xo}return Da(),{cancel:Ra}}function es(){var An=sn.viewport,Ra=sn.scissor_box;An[0]=An[1]=Ra[0]=Ra[1]=0,dn.viewportWidth=dn.framebufferWidth=dn.drawingBufferWidth=An[2]=Ra[2]=Ot.drawingBufferWidth,dn.viewportHeight=dn.framebufferHeight=dn.drawingBufferHeight=An[3]=Ra[3]=Ot.drawingBufferHeight}function Is(){dn.tick+=1,dn.time=ia(),es(),Hn.procs.poll()}function Zi(){Br.refresh(),es(),Hn.procs.refresh(),en&&en.update()}function ia(){return(hr()-Yr)/1e3}Zi();function Hs(An,Ra){J.type(Ra,"function","listener callback must be a function");var Ba;switch(An){case"frame":return Wo(Ra);case"lost":Ba=ha;break;case"restore":Ba=pa;break;case"destroy":Ba=Un;break;default:J.raise("invalid event, must be one of frame,lost,restore,destroy")}return Ba.push(Ra),{cancel:function(){for(var gu=0;gu<Ba.length;++gu)if(Ba[gu]===Ra){Ba[gu]=Ba[Ba.length-1],Ba.pop();return}}}}var xi=m(co,{clear:Zo,prop:yt.define.bind(null,ch),context:yt.define.bind(null,Vf),this:yt.define.bind(null,Pf),draw:co({}),buffer:function(Ra){return Wr.create(Ra,Sf,!1,!1)},elements:function(Ra){return ta.create(Ra,!1)},texture:Br.create2D,cube:Br.createCube,renderbuffer:Fr.create,framebuffer:Kr.create,framebufferCube:Kr.createCube,vao:wn.createVAO,attributes:xr,frame:Wo,on:Hs,limits:br,hasExtension:function(Ra){return br.extensions.indexOf(Ra.toLowerCase())>=0},read:aa,destroy:ei,_gl:Ot,_refresh:Zi,poll:function(){Is(),en&&en.update()},now:ia,stats:Zr});return je.onDone(null,xi),xi}return Dh})},fdMe:function(ze,E,o){"use strict";o.d(E,"a",function(){return b});function b(m,Y){var F=Y.callback;return F&&(m.dataArray=m.dataArray.map(F)),m}},fo6e:function(ze,E){var o=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function b(m){return o.test(m)}ze.exports=b},g4R6:function(ze,E){function o(b,m,Y){return b===b&&(Y!==void 0&&(b=b<=Y?b:Y),m!==void 0&&(b=b>=m?b:m)),b}ze.exports=o},gFfm:function(ze,E){function o(b,m){for(var Y=-1,F=b==null?0:b.length;++Y<F&&!(m(b[Y],Y,b)===!1););return b}ze.exports=o},gMG2:function(ze,E,o){"use strict";o.d(E,"a",function(){return _t});var b={},m={},Y=34,F=10,i=13;function Z(wt){return new Function("d","return {"+wt.map(function(ke,Re){return JSON.stringify(ke)+": d["+Re+'] || ""'}).join(",")+"}")}function D(wt,ke){var Re=Z(wt);return function(Ve,dt){return ke(Re(Ve),dt,wt)}}function $(wt){var ke=Object.create(null),Re=[];return wt.forEach(function(Ve){for(var dt in Ve)dt in ke||Re.push(ke[dt]=dt)}),Re}function te(wt,ke){var Re=wt+"",Ve=Re.length;return Ve<ke?new Array(ke-Ve+1).join(0)+Re:Re}function fe(wt){return wt<0?"-"+te(-wt,6):wt>9999?"+"+te(wt,6):te(wt,4)}function K(wt){var ke=wt.getUTCHours(),Re=wt.getUTCMinutes(),Ve=wt.getUTCSeconds(),dt=wt.getUTCMilliseconds();return isNaN(wt)?"Invalid Date":fe(wt.getUTCFullYear(),4)+"-"+te(wt.getUTCMonth()+1,2)+"-"+te(wt.getUTCDate(),2)+(dt?"T"+te(ke,2)+":"+te(Re,2)+":"+te(Ve,2)+"."+te(dt,3)+"Z":Ve?"T"+te(ke,2)+":"+te(Re,2)+":"+te(Ve,2)+"Z":Re||ke?"T"+te(ke,2)+":"+te(Re,2)+"Z":"")}var Ge=function(wt){var ke=new RegExp('["'+wt+`
\r]`),Re=wt.charCodeAt(0);function Ve(Q,H){var Se,be,Te=dt(Q,function(me,nt){if(Se)return Se(me,nt-1);be=me,Se=H?D(me,H):Z(me)});return Te.columns=be||[],Te}function dt(Q,H){var Se=[],be=Q.length,Te=0,me=0,nt,Jt=be<=0,Mt=!1;Q.charCodeAt(be-1)===F&&--be,Q.charCodeAt(be-1)===i&&--be;function ve(){if(Jt)return m;if(Mt)return Mt=!1,b;var He,ot=Te,we;if(Q.charCodeAt(ot)===Y){for(;Te++<be&&Q.charCodeAt(Te)!==Y||Q.charCodeAt(++Te)===Y;);return(He=Te)>=be?Jt=!0:(we=Q.charCodeAt(Te++))===F?Mt=!0:we===i&&(Mt=!0,Q.charCodeAt(Te)===F&&++Te),Q.slice(ot+1,He-1).replace(/""/g,'"')}for(;Te<be;){if((we=Q.charCodeAt(He=Te++))===F)Mt=!0;else if(we===i)Mt=!0,Q.charCodeAt(Te)===F&&++Te;else if(we!==Re)continue;return Q.slice(ot,He)}return Jt=!0,Q.slice(ot,be)}for(;(nt=ve())!==m;){for(var ge=[];nt!==b&&nt!==m;)ge.push(nt),nt=ve();if(H&&(ge=H(ge,me++))==null)continue;Se.push(ge)}return Se}function Me(Q,H){return Q.map(function(Se){return H.map(function(be){return oe(Se[be])}).join(wt)})}function ht(Q,H){return H==null&&(H=$(Q)),[H.map(oe).join(wt)].concat(Me(Q,H)).join(`
`)}function Zt(Q,H){return H==null&&(H=$(Q)),Me(Q,H).join(`
`)}function Qt(Q){return Q.map(ur).join(`
`)}function ur(Q){return Q.map(oe).join(wt)}function oe(Q){return Q==null?"":Q instanceof Date?K(Q):ke.test(Q+="")?'"'+Q.replace(/"/g,'""')+'"':Q}return{parse:Ve,parseRows:dt,format:ht,formatBody:Zt,formatRows:Qt,formatRow:ur,formatValue:oe}},pe=Ge(","),Ze=pe.parse,Pe=pe.parseRows,mt=pe.format,De=pe.formatBody,At=pe.formatRows,it=pe.formatRow,vt=pe.formatValue,Je=o("5zYK");function _t(wt,ke){var Re=Ze(wt);return Object(Je.a)(Re,ke)}},gQMU:function(ze,E,o){var b=o("0ZTe"),m=b("toUpperCase");ze.exports=m},gzZq:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("MON2"),m=o("FV85"),Y=o("D9lx"),F=o("LKzl"),i=function(){function Z(D){this._binding=D}return Z.prototype.to=function(D){return this._binding.type=m.BindingTypeEnum.Instance,this._binding.implementationType=D,new Y.BindingInWhenOnSyntax(this._binding)},Z.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+b.INVALID_TO_SELF_VALUE);var D=this._binding.serviceIdentifier;return this.to(D)},Z.prototype.toConstantValue=function(D){return this._binding.type=m.BindingTypeEnum.ConstantValue,this._binding.cache=D,this._binding.dynamicValue=null,this._binding.implementationType=null,new F.BindingWhenOnSyntax(this._binding)},Z.prototype.toDynamicValue=function(D){return this._binding.type=m.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=D,this._binding.implementationType=null,new Y.BindingInWhenOnSyntax(this._binding)},Z.prototype.toConstructor=function(D){return this._binding.type=m.BindingTypeEnum.Constructor,this._binding.implementationType=D,new F.BindingWhenOnSyntax(this._binding)},Z.prototype.toFactory=function(D){return this._binding.type=m.BindingTypeEnum.Factory,this._binding.factory=D,new F.BindingWhenOnSyntax(this._binding)},Z.prototype.toFunction=function(D){if(typeof D!="function")throw new Error(b.INVALID_FUNCTION_BINDING);var $=this.toConstantValue(D);return this._binding.type=m.BindingTypeEnum.Function,$},Z.prototype.toAutoFactory=function(D){return this._binding.type=m.BindingTypeEnum.Factory,this._binding.factory=function($){var te=function(){return $.container.get(D)};return te},new F.BindingWhenOnSyntax(this._binding)},Z.prototype.toProvider=function(D){return this._binding.type=m.BindingTypeEnum.Provider,this._binding.provider=D,new F.BindingWhenOnSyntax(this._binding)},Z.prototype.toService=function(D){this.toDynamicValue(function($){return $.container.get(D)})},Z}();E.BindingToSyntax=i},h1nZ:function(ze,E,o){"use strict";var b=o("fX6N");o.d(E,"container",function(){return b.c}),o.d(E,"createSceneContainer",function(){return b.b}),o.d(E,"createLayerContainer",function(){return b.a}),o.d(E,"lazyInject",function(){return b.d});var m=o("+em5"),Y=o("bB6j");o.d(E,"TYPES",function(){return Y.a});var F=o("8/Fi"),i=o("PUg6");o.d(E,"BlendType",function(){return i.a});var Z=o("cZlC");o.d(E,"AttributeType",function(){return Z.a}),o.d(E,"ScaleTypes",function(){return Z.b}),o.d(E,"StyleScaleType",function(){return Z.c});var D=o("O1je"),$=o.n(D);o.o(D,"CameraUniform")&&o.d(E,"CameraUniform",function(){return D.CameraUniform}),o.o(D,"CityBuildingLayer")&&o.d(E,"CityBuildingLayer",function(){return D.CityBuildingLayer}),o.o(D,"Control")&&o.d(E,"Control",function(){return D.Control}),o.o(D,"CoordinateSystem")&&o.d(E,"CoordinateSystem",function(){return D.CoordinateSystem}),o.o(D,"CoordinateUniform")&&o.d(E,"CoordinateUniform",function(){return D.CoordinateUniform}),o.o(D,"HeatmapLayer")&&o.d(E,"HeatmapLayer",function(){return D.HeatmapLayer}),o.o(D,"ImageLayer")&&o.d(E,"ImageLayer",function(){return D.ImageLayer}),o.o(D,"LineLayer")&&o.d(E,"LineLayer",function(){return D.LineLayer}),o.o(D,"Logo")&&o.d(E,"Logo",function(){return D.Logo}),o.o(D,"MapServiceEvent")&&o.d(E,"MapServiceEvent",function(){return D.MapServiceEvent}),o.o(D,"Marker")&&o.d(E,"Marker",function(){return D.Marker}),o.o(D,"PointLayer")&&o.d(E,"PointLayer",function(){return D.PointLayer}),o.o(D,"PolygonLayer")&&o.d(E,"PolygonLayer",function(){return D.PolygonLayer}),o.o(D,"Popup")&&o.d(E,"Popup",function(){return D.Popup}),o.o(D,"PositionType")&&o.d(E,"PositionType",function(){return D.PositionType}),o.o(D,"RasterLayer")&&o.d(E,"RasterLayer",function(){return D.RasterLayer}),o.o(D,"Scale")&&o.d(E,"Scale",function(){return D.Scale}),o.o(D,"Scene")&&o.d(E,"Scene",function(){return D.Scene}),o.o(D,"SceneEventList")&&o.d(E,"SceneEventList",function(){return D.SceneEventList}),o.o(D,"Zoom")&&o.d(E,"Zoom",function(){return D.Zoom}),o.o(D,"gl")&&o.d(E,"gl",function(){return D.gl});var te=o("L56e");o.d(E,"MapServiceEvent",function(){return te.a});var fe=o("HthE");o.d(E,"CoordinateSystem",function(){return fe.a}),o.d(E,"CoordinateUniform",function(){return fe.b});var K=o("/33/"),Ge=o.n(K);o.o(K,"CameraUniform")&&o.d(E,"CameraUniform",function(){return K.CameraUniform}),o.o(K,"CityBuildingLayer")&&o.d(E,"CityBuildingLayer",function(){return K.CityBuildingLayer}),o.o(K,"Control")&&o.d(E,"Control",function(){return K.Control}),o.o(K,"HeatmapLayer")&&o.d(E,"HeatmapLayer",function(){return K.HeatmapLayer}),o.o(K,"ImageLayer")&&o.d(E,"ImageLayer",function(){return K.ImageLayer}),o.o(K,"LineLayer")&&o.d(E,"LineLayer",function(){return K.LineLayer}),o.o(K,"Logo")&&o.d(E,"Logo",function(){return K.Logo}),o.o(K,"Marker")&&o.d(E,"Marker",function(){return K.Marker}),o.o(K,"PointLayer")&&o.d(E,"PointLayer",function(){return K.PointLayer}),o.o(K,"PolygonLayer")&&o.d(E,"PolygonLayer",function(){return K.PolygonLayer}),o.o(K,"Popup")&&o.d(E,"Popup",function(){return K.Popup}),o.o(K,"PositionType")&&o.d(E,"PositionType",function(){return K.PositionType}),o.o(K,"RasterLayer")&&o.d(E,"RasterLayer",function(){return K.RasterLayer}),o.o(K,"Scale")&&o.d(E,"Scale",function(){return K.Scale}),o.o(K,"Scene")&&o.d(E,"Scene",function(){return K.Scene}),o.o(K,"SceneEventList")&&o.d(E,"SceneEventList",function(){return K.SceneEventList}),o.o(K,"Zoom")&&o.d(E,"Zoom",function(){return K.Zoom}),o.o(K,"gl")&&o.d(E,"gl",function(){return K.gl});var pe=o("EfZ0");o.d(E,"CameraUniform",function(){return pe.a});var Ze=o("riiI"),Pe=o.n(Ze);o.o(Ze,"CityBuildingLayer")&&o.d(E,"CityBuildingLayer",function(){return Ze.CityBuildingLayer}),o.o(Ze,"Control")&&o.d(E,"Control",function(){return Ze.Control}),o.o(Ze,"HeatmapLayer")&&o.d(E,"HeatmapLayer",function(){return Ze.HeatmapLayer}),o.o(Ze,"ImageLayer")&&o.d(E,"ImageLayer",function(){return Ze.ImageLayer}),o.o(Ze,"LineLayer")&&o.d(E,"LineLayer",function(){return Ze.LineLayer}),o.o(Ze,"Logo")&&o.d(E,"Logo",function(){return Ze.Logo}),o.o(Ze,"Marker")&&o.d(E,"Marker",function(){return Ze.Marker}),o.o(Ze,"PointLayer")&&o.d(E,"PointLayer",function(){return Ze.PointLayer}),o.o(Ze,"PolygonLayer")&&o.d(E,"PolygonLayer",function(){return Ze.PolygonLayer}),o.o(Ze,"Popup")&&o.d(E,"Popup",function(){return Ze.Popup}),o.o(Ze,"PositionType")&&o.d(E,"PositionType",function(){return Ze.PositionType}),o.o(Ze,"RasterLayer")&&o.d(E,"RasterLayer",function(){return Ze.RasterLayer}),o.o(Ze,"Scale")&&o.d(E,"Scale",function(){return Ze.Scale}),o.o(Ze,"Scene")&&o.d(E,"Scene",function(){return Ze.Scene}),o.o(Ze,"SceneEventList")&&o.d(E,"SceneEventList",function(){return Ze.SceneEventList}),o.o(Ze,"Zoom")&&o.d(E,"Zoom",function(){return Ze.Zoom}),o.o(Ze,"gl")&&o.d(E,"gl",function(){return Ze.gl});var mt=o("eg+a");o.d(E,"SceneEventList",function(){return mt.a});var De=o("bYl4"),At=o.n(De);o.o(De,"CityBuildingLayer")&&o.d(E,"CityBuildingLayer",function(){return De.CityBuildingLayer}),o.o(De,"Control")&&o.d(E,"Control",function(){return De.Control}),o.o(De,"HeatmapLayer")&&o.d(E,"HeatmapLayer",function(){return De.HeatmapLayer}),o.o(De,"ImageLayer")&&o.d(E,"ImageLayer",function(){return De.ImageLayer}),o.o(De,"LineLayer")&&o.d(E,"LineLayer",function(){return De.LineLayer}),o.o(De,"Logo")&&o.d(E,"Logo",function(){return De.Logo}),o.o(De,"Marker")&&o.d(E,"Marker",function(){return De.Marker}),o.o(De,"PointLayer")&&o.d(E,"PointLayer",function(){return De.PointLayer}),o.o(De,"PolygonLayer")&&o.d(E,"PolygonLayer",function(){return De.PolygonLayer}),o.o(De,"Popup")&&o.d(E,"Popup",function(){return De.Popup}),o.o(De,"PositionType")&&o.d(E,"PositionType",function(){return De.PositionType}),o.o(De,"RasterLayer")&&o.d(E,"RasterLayer",function(){return De.RasterLayer}),o.o(De,"Scale")&&o.d(E,"Scale",function(){return De.Scale}),o.o(De,"Scene")&&o.d(E,"Scene",function(){return De.Scene}),o.o(De,"Zoom")&&o.d(E,"Zoom",function(){return De.Zoom}),o.o(De,"gl")&&o.d(E,"gl",function(){return De.gl});var it=o("FI6e"),vt=o.n(it);o.o(it,"CityBuildingLayer")&&o.d(E,"CityBuildingLayer",function(){return it.CityBuildingLayer}),o.o(it,"Control")&&o.d(E,"Control",function(){return it.Control}),o.o(it,"HeatmapLayer")&&o.d(E,"HeatmapLayer",function(){return it.HeatmapLayer}),o.o(it,"ImageLayer")&&o.d(E,"ImageLayer",function(){return it.ImageLayer}),o.o(it,"LineLayer")&&o.d(E,"LineLayer",function(){return it.LineLayer}),o.o(it,"Logo")&&o.d(E,"Logo",function(){return it.Logo}),o.o(it,"Marker")&&o.d(E,"Marker",function(){return it.Marker}),o.o(it,"PointLayer")&&o.d(E,"PointLayer",function(){return it.PointLayer}),o.o(it,"PolygonLayer")&&o.d(E,"PolygonLayer",function(){return it.PolygonLayer}),o.o(it,"Popup")&&o.d(E,"Popup",function(){return it.Popup}),o.o(it,"PositionType")&&o.d(E,"PositionType",function(){return it.PositionType}),o.o(it,"RasterLayer")&&o.d(E,"RasterLayer",function(){return it.RasterLayer}),o.o(it,"Scale")&&o.d(E,"Scale",function(){return it.Scale}),o.o(it,"Scene")&&o.d(E,"Scene",function(){return it.Scene}),o.o(it,"Zoom")&&o.d(E,"Zoom",function(){return it.Zoom}),o.o(it,"gl")&&o.d(E,"gl",function(){return it.gl});var Je=o("D+ow"),_t=o.n(Je);o.o(Je,"CityBuildingLayer")&&o.d(E,"CityBuildingLayer",function(){return Je.CityBuildingLayer}),o.o(Je,"Control")&&o.d(E,"Control",function(){return Je.Control}),o.o(Je,"HeatmapLayer")&&o.d(E,"HeatmapLayer",function(){return Je.HeatmapLayer}),o.o(Je,"ImageLayer")&&o.d(E,"ImageLayer",function(){return Je.ImageLayer}),o.o(Je,"LineLayer")&&o.d(E,"LineLayer",function(){return Je.LineLayer}),o.o(Je,"Logo")&&o.d(E,"Logo",function(){return Je.Logo}),o.o(Je,"Marker")&&o.d(E,"Marker",function(){return Je.Marker}),o.o(Je,"PointLayer")&&o.d(E,"PointLayer",function(){return Je.PointLayer}),o.o(Je,"PolygonLayer")&&o.d(E,"PolygonLayer",function(){return Je.PolygonLayer}),o.o(Je,"Popup")&&o.d(E,"Popup",function(){return Je.Popup}),o.o(Je,"PositionType")&&o.d(E,"PositionType",function(){return Je.PositionType}),o.o(Je,"RasterLayer")&&o.d(E,"RasterLayer",function(){return Je.RasterLayer}),o.o(Je,"Scale")&&o.d(E,"Scale",function(){return Je.Scale}),o.o(Je,"Scene")&&o.d(E,"Scene",function(){return Je.Scene}),o.o(Je,"Zoom")&&o.d(E,"Zoom",function(){return Je.Zoom}),o.o(Je,"gl")&&o.d(E,"gl",function(){return Je.gl});var wt=o("AFH1");o.d(E,"PositionType",function(){return wt.a});var ke=o("8uyu"),Re=o.n(ke);o.o(ke,"CityBuildingLayer")&&o.d(E,"CityBuildingLayer",function(){return ke.CityBuildingLayer}),o.o(ke,"Control")&&o.d(E,"Control",function(){return ke.Control}),o.o(ke,"HeatmapLayer")&&o.d(E,"HeatmapLayer",function(){return ke.HeatmapLayer}),o.o(ke,"ImageLayer")&&o.d(E,"ImageLayer",function(){return ke.ImageLayer}),o.o(ke,"LineLayer")&&o.d(E,"LineLayer",function(){return ke.LineLayer}),o.o(ke,"Logo")&&o.d(E,"Logo",function(){return ke.Logo}),o.o(ke,"Marker")&&o.d(E,"Marker",function(){return ke.Marker}),o.o(ke,"PointLayer")&&o.d(E,"PointLayer",function(){return ke.PointLayer}),o.o(ke,"PolygonLayer")&&o.d(E,"PolygonLayer",function(){return ke.PolygonLayer}),o.o(ke,"Popup")&&o.d(E,"Popup",function(){return ke.Popup}),o.o(ke,"RasterLayer")&&o.d(E,"RasterLayer",function(){return ke.RasterLayer}),o.o(ke,"Scale")&&o.d(E,"Scale",function(){return ke.Scale}),o.o(ke,"Scene")&&o.d(E,"Scene",function(){return ke.Scene}),o.o(ke,"Zoom")&&o.d(E,"Zoom",function(){return ke.Zoom}),o.o(ke,"gl")&&o.d(E,"gl",function(){return ke.gl});var Ve=o("J7lC"),dt=o.n(Ve);o.o(Ve,"CityBuildingLayer")&&o.d(E,"CityBuildingLayer",function(){return Ve.CityBuildingLayer}),o.o(Ve,"Control")&&o.d(E,"Control",function(){return Ve.Control}),o.o(Ve,"HeatmapLayer")&&o.d(E,"HeatmapLayer",function(){return Ve.HeatmapLayer}),o.o(Ve,"ImageLayer")&&o.d(E,"ImageLayer",function(){return Ve.ImageLayer}),o.o(Ve,"LineLayer")&&o.d(E,"LineLayer",function(){return Ve.LineLayer}),o.o(Ve,"Logo")&&o.d(E,"Logo",function(){return Ve.Logo}),o.o(Ve,"Marker")&&o.d(E,"Marker",function(){return Ve.Marker}),o.o(Ve,"PointLayer")&&o.d(E,"PointLayer",function(){return Ve.PointLayer}),o.o(Ve,"PolygonLayer")&&o.d(E,"PolygonLayer",function(){return Ve.PolygonLayer}),o.o(Ve,"Popup")&&o.d(E,"Popup",function(){return Ve.Popup}),o.o(Ve,"RasterLayer")&&o.d(E,"RasterLayer",function(){return Ve.RasterLayer}),o.o(Ve,"Scale")&&o.d(E,"Scale",function(){return Ve.Scale}),o.o(Ve,"Scene")&&o.d(E,"Scene",function(){return Ve.Scene}),o.o(Ve,"Zoom")&&o.d(E,"Zoom",function(){return Ve.Zoom}),o.o(Ve,"gl")&&o.d(E,"gl",function(){return Ve.gl});var Me=o("QGbF"),ht=o.n(Me);o.o(Me,"CityBuildingLayer")&&o.d(E,"CityBuildingLayer",function(){return Me.CityBuildingLayer}),o.o(Me,"Control")&&o.d(E,"Control",function(){return Me.Control}),o.o(Me,"HeatmapLayer")&&o.d(E,"HeatmapLayer",function(){return Me.HeatmapLayer}),o.o(Me,"ImageLayer")&&o.d(E,"ImageLayer",function(){return Me.ImageLayer}),o.o(Me,"LineLayer")&&o.d(E,"LineLayer",function(){return Me.LineLayer}),o.o(Me,"Logo")&&o.d(E,"Logo",function(){return Me.Logo}),o.o(Me,"Marker")&&o.d(E,"Marker",function(){return Me.Marker}),o.o(Me,"PointLayer")&&o.d(E,"PointLayer",function(){return Me.PointLayer}),o.o(Me,"PolygonLayer")&&o.d(E,"PolygonLayer",function(){return Me.PolygonLayer}),o.o(Me,"Popup")&&o.d(E,"Popup",function(){return Me.Popup}),o.o(Me,"RasterLayer")&&o.d(E,"RasterLayer",function(){return Me.RasterLayer}),o.o(Me,"Scale")&&o.d(E,"Scale",function(){return Me.Scale}),o.o(Me,"Scene")&&o.d(E,"Scene",function(){return Me.Scene}),o.o(Me,"Zoom")&&o.d(E,"Zoom",function(){return Me.Zoom}),o.o(Me,"gl")&&o.d(E,"gl",function(){return Me.gl});var Zt=o("V1cb"),Qt=o("bzyH"),ur=o.n(Qt);o.o(Qt,"CityBuildingLayer")&&o.d(E,"CityBuildingLayer",function(){return Qt.CityBuildingLayer}),o.o(Qt,"Control")&&o.d(E,"Control",function(){return Qt.Control}),o.o(Qt,"HeatmapLayer")&&o.d(E,"HeatmapLayer",function(){return Qt.HeatmapLayer}),o.o(Qt,"ImageLayer")&&o.d(E,"ImageLayer",function(){return Qt.ImageLayer}),o.o(Qt,"LineLayer")&&o.d(E,"LineLayer",function(){return Qt.LineLayer}),o.o(Qt,"Logo")&&o.d(E,"Logo",function(){return Qt.Logo}),o.o(Qt,"Marker")&&o.d(E,"Marker",function(){return Qt.Marker}),o.o(Qt,"PointLayer")&&o.d(E,"PointLayer",function(){return Qt.PointLayer}),o.o(Qt,"PolygonLayer")&&o.d(E,"PolygonLayer",function(){return Qt.PolygonLayer}),o.o(Qt,"Popup")&&o.d(E,"Popup",function(){return Qt.Popup}),o.o(Qt,"RasterLayer")&&o.d(E,"RasterLayer",function(){return Qt.RasterLayer}),o.o(Qt,"Scale")&&o.d(E,"Scale",function(){return Qt.Scale}),o.o(Qt,"Scene")&&o.d(E,"Scene",function(){return Qt.Scene}),o.o(Qt,"Zoom")&&o.d(E,"Zoom",function(){return Qt.Zoom}),o.o(Qt,"gl")&&o.d(E,"gl",function(){return Qt.gl});var oe=o("0eqD"),Q=o.n(oe);o.o(oe,"CityBuildingLayer")&&o.d(E,"CityBuildingLayer",function(){return oe.CityBuildingLayer}),o.o(oe,"Control")&&o.d(E,"Control",function(){return oe.Control}),o.o(oe,"HeatmapLayer")&&o.d(E,"HeatmapLayer",function(){return oe.HeatmapLayer}),o.o(oe,"ImageLayer")&&o.d(E,"ImageLayer",function(){return oe.ImageLayer}),o.o(oe,"LineLayer")&&o.d(E,"LineLayer",function(){return oe.LineLayer}),o.o(oe,"Logo")&&o.d(E,"Logo",function(){return oe.Logo}),o.o(oe,"Marker")&&o.d(E,"Marker",function(){return oe.Marker}),o.o(oe,"PointLayer")&&o.d(E,"PointLayer",function(){return oe.PointLayer}),o.o(oe,"PolygonLayer")&&o.d(E,"PolygonLayer",function(){return oe.PolygonLayer}),o.o(oe,"Popup")&&o.d(E,"Popup",function(){return oe.Popup}),o.o(oe,"RasterLayer")&&o.d(E,"RasterLayer",function(){return oe.RasterLayer}),o.o(oe,"Scale")&&o.d(E,"Scale",function(){return oe.Scale}),o.o(oe,"Scene")&&o.d(E,"Scene",function(){return oe.Scene}),o.o(oe,"Zoom")&&o.d(E,"Zoom",function(){return oe.Zoom}),o.o(oe,"gl")&&o.d(E,"gl",function(){return oe.gl});var H=o("/Uc5"),Se=o.n(H);o.o(H,"CityBuildingLayer")&&o.d(E,"CityBuildingLayer",function(){return H.CityBuildingLayer}),o.o(H,"Control")&&o.d(E,"Control",function(){return H.Control}),o.o(H,"HeatmapLayer")&&o.d(E,"HeatmapLayer",function(){return H.HeatmapLayer}),o.o(H,"ImageLayer")&&o.d(E,"ImageLayer",function(){return H.ImageLayer}),o.o(H,"LineLayer")&&o.d(E,"LineLayer",function(){return H.LineLayer}),o.o(H,"Logo")&&o.d(E,"Logo",function(){return H.Logo}),o.o(H,"Marker")&&o.d(E,"Marker",function(){return H.Marker}),o.o(H,"PointLayer")&&o.d(E,"PointLayer",function(){return H.PointLayer}),o.o(H,"PolygonLayer")&&o.d(E,"PolygonLayer",function(){return H.PolygonLayer}),o.o(H,"Popup")&&o.d(E,"Popup",function(){return H.Popup}),o.o(H,"RasterLayer")&&o.d(E,"RasterLayer",function(){return H.RasterLayer}),o.o(H,"Scale")&&o.d(E,"Scale",function(){return H.Scale}),o.o(H,"Scene")&&o.d(E,"Scene",function(){return H.Scene}),o.o(H,"Zoom")&&o.d(E,"Zoom",function(){return H.Zoom}),o.o(H,"gl")&&o.d(E,"gl",function(){return H.gl});var be=o("RMtq"),Te=o.n(be);o.o(be,"CityBuildingLayer")&&o.d(E,"CityBuildingLayer",function(){return be.CityBuildingLayer}),o.o(be,"Control")&&o.d(E,"Control",function(){return be.Control}),o.o(be,"HeatmapLayer")&&o.d(E,"HeatmapLayer",function(){return be.HeatmapLayer}),o.o(be,"ImageLayer")&&o.d(E,"ImageLayer",function(){return be.ImageLayer}),o.o(be,"LineLayer")&&o.d(E,"LineLayer",function(){return be.LineLayer}),o.o(be,"Logo")&&o.d(E,"Logo",function(){return be.Logo}),o.o(be,"Marker")&&o.d(E,"Marker",function(){return be.Marker}),o.o(be,"PointLayer")&&o.d(E,"PointLayer",function(){return be.PointLayer}),o.o(be,"PolygonLayer")&&o.d(E,"PolygonLayer",function(){return be.PolygonLayer}),o.o(be,"Popup")&&o.d(E,"Popup",function(){return be.Popup}),o.o(be,"RasterLayer")&&o.d(E,"RasterLayer",function(){return be.RasterLayer}),o.o(be,"Scale")&&o.d(E,"Scale",function(){return be.Scale}),o.o(be,"Scene")&&o.d(E,"Scene",function(){return be.Scene}),o.o(be,"Zoom")&&o.d(E,"Zoom",function(){return be.Zoom}),o.o(be,"gl")&&o.d(E,"gl",function(){return be.gl});var me=o("1jvM"),nt=o.n(me);o.o(me,"CityBuildingLayer")&&o.d(E,"CityBuildingLayer",function(){return me.CityBuildingLayer}),o.o(me,"Control")&&o.d(E,"Control",function(){return me.Control}),o.o(me,"HeatmapLayer")&&o.d(E,"HeatmapLayer",function(){return me.HeatmapLayer}),o.o(me,"ImageLayer")&&o.d(E,"ImageLayer",function(){return me.ImageLayer}),o.o(me,"LineLayer")&&o.d(E,"LineLayer",function(){return me.LineLayer}),o.o(me,"Logo")&&o.d(E,"Logo",function(){return me.Logo}),o.o(me,"Marker")&&o.d(E,"Marker",function(){return me.Marker}),o.o(me,"PointLayer")&&o.d(E,"PointLayer",function(){return me.PointLayer}),o.o(me,"PolygonLayer")&&o.d(E,"PolygonLayer",function(){return me.PolygonLayer}),o.o(me,"Popup")&&o.d(E,"Popup",function(){return me.Popup}),o.o(me,"RasterLayer")&&o.d(E,"RasterLayer",function(){return me.RasterLayer}),o.o(me,"Scale")&&o.d(E,"Scale",function(){return me.Scale}),o.o(me,"Scene")&&o.d(E,"Scene",function(){return me.Scene}),o.o(me,"Zoom")&&o.d(E,"Zoom",function(){return me.Zoom}),o.o(me,"gl")&&o.d(E,"gl",function(){return me.gl});var Jt=o("bPkA"),Mt=o("PSsN"),ve=o.n(Mt);o.o(Mt,"CityBuildingLayer")&&o.d(E,"CityBuildingLayer",function(){return Mt.CityBuildingLayer}),o.o(Mt,"Control")&&o.d(E,"Control",function(){return Mt.Control}),o.o(Mt,"HeatmapLayer")&&o.d(E,"HeatmapLayer",function(){return Mt.HeatmapLayer}),o.o(Mt,"ImageLayer")&&o.d(E,"ImageLayer",function(){return Mt.ImageLayer}),o.o(Mt,"LineLayer")&&o.d(E,"LineLayer",function(){return Mt.LineLayer}),o.o(Mt,"Logo")&&o.d(E,"Logo",function(){return Mt.Logo}),o.o(Mt,"Marker")&&o.d(E,"Marker",function(){return Mt.Marker}),o.o(Mt,"PointLayer")&&o.d(E,"PointLayer",function(){return Mt.PointLayer}),o.o(Mt,"PolygonLayer")&&o.d(E,"PolygonLayer",function(){return Mt.PolygonLayer}),o.o(Mt,"Popup")&&o.d(E,"Popup",function(){return Mt.Popup}),o.o(Mt,"RasterLayer")&&o.d(E,"RasterLayer",function(){return Mt.RasterLayer}),o.o(Mt,"Scale")&&o.d(E,"Scale",function(){return Mt.Scale}),o.o(Mt,"Scene")&&o.d(E,"Scene",function(){return Mt.Scene}),o.o(Mt,"Zoom")&&o.d(E,"Zoom",function(){return Mt.Zoom}),o.o(Mt,"gl")&&o.d(E,"gl",function(){return Mt.gl});var ge=o("6NqC"),He=o.n(ge);o.o(ge,"CityBuildingLayer")&&o.d(E,"CityBuildingLayer",function(){return ge.CityBuildingLayer}),o.o(ge,"Control")&&o.d(E,"Control",function(){return ge.Control}),o.o(ge,"HeatmapLayer")&&o.d(E,"HeatmapLayer",function(){return ge.HeatmapLayer}),o.o(ge,"ImageLayer")&&o.d(E,"ImageLayer",function(){return ge.ImageLayer}),o.o(ge,"LineLayer")&&o.d(E,"LineLayer",function(){return ge.LineLayer}),o.o(ge,"Logo")&&o.d(E,"Logo",function(){return ge.Logo}),o.o(ge,"Marker")&&o.d(E,"Marker",function(){return ge.Marker}),o.o(ge,"PointLayer")&&o.d(E,"PointLayer",function(){return ge.PointLayer}),o.o(ge,"PolygonLayer")&&o.d(E,"PolygonLayer",function(){return ge.PolygonLayer}),o.o(ge,"Popup")&&o.d(E,"Popup",function(){return ge.Popup}),o.o(ge,"RasterLayer")&&o.d(E,"RasterLayer",function(){return ge.RasterLayer}),o.o(ge,"Scale")&&o.d(E,"Scale",function(){return ge.Scale}),o.o(ge,"Scene")&&o.d(E,"Scene",function(){return ge.Scene}),o.o(ge,"Zoom")&&o.d(E,"Zoom",function(){return ge.Zoom}),o.o(ge,"gl")&&o.d(E,"gl",function(){return ge.gl});var ot=o("bTtR"),we=o.n(ot);o.o(ot,"CityBuildingLayer")&&o.d(E,"CityBuildingLayer",function(){return ot.CityBuildingLayer}),o.o(ot,"Control")&&o.d(E,"Control",function(){return ot.Control}),o.o(ot,"HeatmapLayer")&&o.d(E,"HeatmapLayer",function(){return ot.HeatmapLayer}),o.o(ot,"ImageLayer")&&o.d(E,"ImageLayer",function(){return ot.ImageLayer}),o.o(ot,"LineLayer")&&o.d(E,"LineLayer",function(){return ot.LineLayer}),o.o(ot,"Logo")&&o.d(E,"Logo",function(){return ot.Logo}),o.o(ot,"Marker")&&o.d(E,"Marker",function(){return ot.Marker}),o.o(ot,"PointLayer")&&o.d(E,"PointLayer",function(){return ot.PointLayer}),o.o(ot,"PolygonLayer")&&o.d(E,"PolygonLayer",function(){return ot.PolygonLayer}),o.o(ot,"Popup")&&o.d(E,"Popup",function(){return ot.Popup}),o.o(ot,"RasterLayer")&&o.d(E,"RasterLayer",function(){return ot.RasterLayer}),o.o(ot,"Scale")&&o.d(E,"Scale",function(){return ot.Scale}),o.o(ot,"Scene")&&o.d(E,"Scene",function(){return ot.Scene}),o.o(ot,"Zoom")&&o.d(E,"Zoom",function(){return ot.Zoom}),o.o(ot,"gl")&&o.d(E,"gl",function(){return ot.gl});var gt=o("o+pz");o.d(E,"gl",function(){return gt.a})},h7MG:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("doU7"),m=o("MON2"),Y=o("FV85"),F=o("xfSm"),i=o("qK8v"),Z=o("ujMp"),D=o("oy+k"),$=o("GXnB"),te=o("yMAV"),fe=o("fbrv"),K=o("xiII"),Ge=o("dX1H");function pe(Je){return Je._bindingDictionary}E.getBindingDictionary=pe;function Ze(Je,_t,wt,ke,Re,Ve){var dt=Je?F.MULTI_INJECT_TAG:F.INJECT_TAG,Me=new $.Metadata(dt,wt),ht=new Ge.Target(_t,ke,wt,Me);if(Re!==void 0){var Zt=new $.Metadata(Re,Ve);ht.metadata.push(Zt)}return ht}function Pe(Je,_t,wt,ke,Re){var Ve=At(wt.container,Re.serviceIdentifier),dt=[];return Ve.length===b.BindingCount.NoBindingsAvailable&&wt.container.options.autoBindInjectable&&typeof Re.serviceIdentifier=="function"&&Je.getConstructorMetadata(Re.serviceIdentifier).compilerGeneratedMetadata&&(wt.container.bind(Re.serviceIdentifier).toSelf(),Ve=At(wt.container,Re.serviceIdentifier)),_t?dt=Ve:dt=Ve.filter(function(Me){var ht=new K.Request(Me.serviceIdentifier,wt,ke,Me,Re);return Me.constraint(ht)}),mt(Re.serviceIdentifier,dt,Re,wt.container),dt}function mt(Je,_t,wt,ke){switch(_t.length){case b.BindingCount.NoBindingsAvailable:if(wt.isOptional())return _t;var Re=Z.getServiceIdentifierAsString(Je),Ve=m.NOT_REGISTERED;throw Ve+=Z.listMetadataForTarget(Re,wt),Ve+=Z.listRegisteredBindingsForServiceIdentifier(ke,Re,At),new Error(Ve);case b.BindingCount.OnlyOneBindingAvailable:if(!wt.isArray())return _t;case b.BindingCount.MultipleBindingsAvailable:default:if(wt.isArray())return _t;var Re=Z.getServiceIdentifierAsString(Je),Ve=m.AMBIGUOUS_MATCH+" "+Re;throw Ve+=Z.listRegisteredBindingsForServiceIdentifier(ke,Re,At),new Error(Ve)}}function De(Je,_t,wt,ke,Re,Ve){var dt,Me;if(Re===null){dt=Pe(Je,_t,ke,null,Ve),Me=new K.Request(wt,ke,null,dt,Ve);var ht=new te.Plan(ke,Me);ke.addPlan(ht)}else dt=Pe(Je,_t,ke,Re,Ve),Me=Re.addChildRequest(Ve.serviceIdentifier,dt,Ve);dt.forEach(function(Zt){var Qt=null;if(Ve.isArray())Qt=Me.addChildRequest(Zt.serviceIdentifier,Zt,Ve);else{if(Zt.cache)return;Qt=Me}if(Zt.type===Y.BindingTypeEnum.Instance&&Zt.implementationType!==null){var ur=fe.getDependencies(Je,Zt.implementationType);if(!ke.container.options.skipBaseClassChecks){var oe=fe.getBaseClassDependencyCount(Je,Zt.implementationType);if(ur.length<oe){var Q=m.ARGUMENTS_LENGTH_MISMATCH(fe.getFunctionName(Zt.implementationType));throw new Error(Q)}}ur.forEach(function(H){De(Je,!1,H.serviceIdentifier,ke,Qt,H)})}})}function At(Je,_t){var wt=[],ke=pe(Je);return ke.hasKey(_t)?wt=ke.get(_t):Je.parent!==null&&(wt=At(Je.parent,_t)),wt}function it(Je,_t,wt,ke,Re,Ve,dt,Me){Me===void 0&&(Me=!1);var ht=new D.Context(_t),Zt=Ze(wt,ke,Re,"",Ve,dt);try{return De(Je,Me,Re,ht,null,Zt),ht}catch(Qt){throw i.isStackOverflowExeption(Qt)&&(ht.plan&&Z.circularDependencyToException(ht.plan.rootRequest)),Qt}}E.plan=it;function vt(Je,_t,wt,ke){var Re=new Ge.Target(Y.TargetTypeEnum.Variable,"",_t,new $.Metadata(wt,ke)),Ve=new D.Context(Je),dt=new K.Request(_t,Ve,null,[],Re);return dt}E.createMockRequest=vt},heNW:function(ze,E){function o(b,m,Y){switch(Y.length){case 0:return b.call(m);case 1:return b.call(m,Y[0]);case 2:return b.call(m,Y[0],Y[1]);case 3:return b.call(m,Y[0],Y[1],Y[2])}return b.apply(m,Y)}ze.exports=o},hi0z:function(ze,E,o){"use strict";(function(b,m){ze.exports=m()})(this,function(){function b(fe){var K=[];return fe.AMapUI&&K.push(m(fe.AMapUI)),fe.Loca&&K.push(Y(fe.Loca)),Promise.all(K)}function m(fe){return new Promise(function(K,Ge){var pe=[];if(fe.plugins)for(var Ze=0;Ze<fe.plugins.length;Ze+=1)i.AMapUI.plugins.indexOf(fe.plugins[Ze])==-1&&pe.push(fe.plugins[Ze]);if(Z.AMapUI===F.failed)Ge("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(Z.AMapUI===F.notload){Z.AMapUI=F.loading,i.AMapUI.version=fe.version||i.AMapUI.version,Ze=i.AMapUI.version;var Pe=document.body||document.head,mt=document.createElement("script");mt.type="text/javascript",mt.src="https://webapi.amap.com/ui/"+Ze+"/main.js",mt.onerror=function(De){Z.AMapUI=F.failed,Ge("\u8BF7\u6C42 AMapUI \u5931\u8D25")},mt.onload=function(){if(Z.AMapUI=F.loaded,pe.length)window.AMapUI.loadUI(pe,function(){for(var De=0,At=pe.length;De<At;De++){var it=pe[De].split("/").slice(-1)[0];window.AMapUI[it]=arguments[De]}for(K();D.AMapUI.length;)D.AMapUI.splice(0,1)[0]()});else for(K();D.AMapUI.length;)D.AMapUI.splice(0,1)[0]()},Pe.appendChild(mt)}else Z.AMapUI===F.loaded?fe.version&&fe.version!==i.AMapUI.version?Ge("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):pe.length?window.AMapUI.loadUI(pe,function(){for(var De=0,At=pe.length;De<At;De++){var it=pe[De].split("/").slice(-1)[0];window.AMapUI[it]=arguments[De]}K()}):K():fe.version&&fe.version!==i.AMapUI.version?Ge("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):D.AMapUI.push(function(De){De?Ge(De):pe.length?window.AMapUI.loadUI(pe,function(){for(var At=0,it=pe.length;At<it;At++){var vt=pe[At].split("/").slice(-1)[0];window.AMapUI[vt]=arguments[At]}K()}):K()})})}function Y(fe){return new Promise(function(K,Ge){if(i.AMap.version.startsWith("2.0"))Ge("Loca \u6682\u4E0D\u9002\u914D JSAPI 2.0,\u8BF7\u4F7F\u7528 1.4.15");else if(Z.Loca===F.failed)Ge("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(Z.Loca===F.notload){Z.Loca=F.loading,i.Loca.version=fe.version||i.Loca.version;var pe=i.Loca.version,Ze=i.key,Pe=document.body||document.head,mt=document.createElement("script");mt.type="text/javascript",mt.src="https://webapi.amap.com/loca?v="+pe+"&key="+Ze,mt.onerror=function(De){Z.Loca=F.failed,Ge("\u8BF7\u6C42 AMapUI \u5931\u8D25")},mt.onload=function(){for(Z.Loca=F.loaded,K();D.Loca.length;)D.Loca.splice(0,1)[0]()},Pe.appendChild(mt)}else Z.Loca===F.loaded?fe.version&&fe.version!==i.Loca.version?Ge("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):K():fe.version&&fe.version!==i.Loca.version?Ge("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):D.Loca.push(function(De){De?Ge(De):Ge()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var F;(function(fe){fe.notload="notload",fe.loading="loading",fe.loaded="loaded",fe.failed="failed"})(F||(F={}));var i={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},Z={AMap:F.notload,AMapUI:F.notload,Loca:F.notload},D={AMap:[],AMapUI:[],Loca:[]},$=[],te=function(K){typeof K=="function"&&(Z.AMap===F.loaded?K(window.AMap):$.push(K))};return{load:function(K){return new Promise(function(Ge,pe){if(Z.AMap==F.failed)pe("");else if(Z.AMap==F.notload){var Ze=K.key,Pe=K.version,mt=K.plugins;Ze?(window.AMap&&location.host!=="lbs.amap.com"&&pe("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),i.key=Ze,i.AMap.version=Pe||i.AMap.version,i.AMap.plugins=mt||i.AMap.plugins,Z.AMap=F.loading,Pe=document.body||document.head,window.___onAPILoaded=function(At){if(delete window.___onAPILoaded,At)Z.AMap=F.failed,pe(At);else for(Z.AMap=F.loaded,b(K).then(function(){Ge(window.AMap)}).catch(pe);$.length;)$.splice(0,1)[0]()},mt=document.createElement("script"),mt.type="text/javascript",mt.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+i.AMap.version+"&key="+Ze+"&plugin="+i.AMap.plugins.join(","),mt.onerror=function(At){Z.AMap=F.failed,pe(At)},Pe.appendChild(mt)):pe("\u8BF7\u586B\u5199key")}else if(Z.AMap==F.loaded)if(K.key&&K.key!==i.key)pe("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(K.version&&K.version!==i.AMap.version)pe("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(Ze=[],K.plugins)for(Pe=0;Pe<K.plugins.length;Pe+=1)i.AMap.plugins.indexOf(K.plugins[Pe])==-1&&Ze.push(K.plugins[Pe]);Ze.length?window.AMap.plugin(Ze,function(){b(K).then(function(){Ge(window.AMap)}).catch(pe)}):b(K).then(function(){Ge(window.AMap)}).catch(pe)}else if(K.key&&K.key!==i.key)pe("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(K.version&&K.version!==i.AMap.version)pe("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var De=[];if(K.plugins)for(Pe=0;Pe<K.plugins.length;Pe+=1)i.AMap.plugins.indexOf(K.plugins[Pe])==-1&&De.push(K.plugins[Pe]);te(function(){De.length?window.AMap.plugin(De,function(){b(K).then(function(){Ge(window.AMap)}).catch(pe)}):b(K).then(function(){Ge(window.AMap)}).catch(pe)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,i={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},Z={AMap:F.notload,AMapUI:F.notload,Loca:F.notload},D={AMap:[],AMapUI:[],Loca:[]}}}})},hypo:function(ze,E,o){var b=o("O0oS");function m(Y,F,i){F=="__proto__"&&b?b(Y,F,{configurable:!0,enumerable:!0,value:i,writable:!0}):Y[F]=i}ze.exports=m},iWIM:function(ze,E,o){var b=o("n3AX");function m(Y,F,i){return typeof Reflect!="undefined"&&Reflect.get?ze.exports=m=Reflect.get:ze.exports=m=function(D,$,te){var fe=b(D,$);if(!fe)return;var K=Object.getOwnPropertyDescriptor(fe,$);return K.get?K.get.call(te):K.value},m(Y,F,i||Y)}ze.exports=m},iegG:function(ze,E){function o(b){var m=b.target||b.srcElement;m.__resizeRAF__&&cancelAnimationFrame(m.__resizeRAF__),m.__resizeRAF__=requestAnimationFrame(function(){var Y=m.__resizeTrigger__,F=Y&&Y.__resizeListeners__;F&&F.forEach(function(i){i.call(Y,b)})})}var E=function(m,Y){var F=this,i=F.document,Z,D=i.attachEvent;typeof navigator!="undefined"&&(Z=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function $(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",o)}if(!m.__resizeListeners__)if(m.__resizeListeners__=[],D)m.__resizeTrigger__=m,m.attachEvent("onresize",o);else{getComputedStyle(m).position==="static"&&(m.style.position="relative");var te=m.__resizeTrigger__=i.createElement("object");te.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),te.setAttribute("class","resize-sensor"),te.setAttribute("tabindex","-1"),te.__resizeElement__=m,te.onload=$,te.type="text/html",Z&&m.appendChild(te),te.data="about:blank",Z||m.appendChild(te)}m.__resizeListeners__.push(Y)};ze.exports=typeof window=="undefined"?E:E.bind(window),ze.exports.unbind=function(b,m){var Y=document.attachEvent,F=b.__resizeListeners__||[];if(m){var i=F.indexOf(m);i!==-1&&F.splice(i,1)}else F=b.__resizeListeners__=[];if(!F.length){if(Y)b.detachEvent("onresize",o);else if(b.__resizeTrigger__){var Z=b.__resizeTrigger__.contentDocument,D=Z&&Z.defaultView;D&&(D.removeEventListener("resize",o),delete D.__resizeTrigger__),b.__resizeTrigger__=!b.removeChild(b.__resizeTrigger__)}delete b.__resizeListeners__}}},itsj:function(ze,E){function o(b,m){return m==="constructor"&&typeof b[m]=="function"||m=="__proto__"?void 0:b[m]}ze.exports=o},jCWc:function(ze,E,o){"use strict";var b=o("cIOH"),m=o("1GLa")},"jIg/":function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("xfSm"),m=o("GXnB"),Y=o("Ztfv");function F(i){return function(Z,D,$){var te=new m.Metadata(b.MULTI_INJECT_TAG,i);typeof $=="number"?Y.tagParameter(Z,D,$,te):Y.tagProperty(Z,D,te)}}E.multiInject=F},jYQm:function(ze,E,o){"use strict";var b=o("q1tI"),m=o.n(b),Y=Object(b.createContext)({});E.a=Y},jYx5:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("xfSm"),m=o("GXnB"),Y=o("Ztfv");function F(){return function(i,Z,D){var $=new m.Metadata(b.OPTIONAL_TAG,!0);typeof D=="number"?Y.tagParameter(i,Z,D,$):Y.tagProperty(i,Z,$)}}E.optional=F},"jbM+":function(ze,E,o){var b=o("R/W3");function m(Y,F){var i=Y==null?0:Y.length;return!!i&&b(Y,F,0)>-1}ze.exports=m},jeLo:function(ze,E,o){var b=o("juv8"),m=o("mTTR");function Y(F){return b(F,m(F))}ze.exports=Y},juv8:function(ze,E,o){var b=o("MrPd"),m=o("hypo");function Y(F,i,Z,D){var $=!Z;Z||(Z={});for(var te=-1,fe=i.length;++te<fe;){var K=i[te],Ge=D?D(Z[K],F[K],K,Z,F):void 0;Ge===void 0&&(Ge=F[K]),$?m(Z,K,Ge):b(Z,K,Ge)}return Z}ze.exports=Y},"k5/I":function(ze,E,o){"use strict";o.d(E,"a",function(){return _t}),o.d(E,"b",function(){return Zt}),o.d(E,"e",function(){return oe}),o.d(E,"f",function(){return Se}),o.d(E,"c",function(){return Jt}),o.d(E,"d",function(){return Tt});var b=o("lSNA"),m=o.n(b),Y=o("lwsE"),F=o.n(Y),i=o("W8MJ"),Z=o.n(i),D=o("7W2i"),$=o.n(D),te=o("a1gu"),fe=o.n(te),K=o("Nsbk"),Ge=o.n(K),pe=o("h1nZ"),Ze=o("Hel2"),Pe=o("uhBA");function mt(at,Ut){var J=Object.keys(at);if(Object.getOwnPropertySymbols){var Qe=Object.getOwnPropertySymbols(at);Ut&&(Qe=Qe.filter(function(ne){return Object.getOwnPropertyDescriptor(at,ne).enumerable})),J.push.apply(J,Qe)}return J}function De(at){for(var Ut=1;Ut<arguments.length;Ut++){var J=arguments[Ut]!=null?arguments[Ut]:{};Ut%2?mt(Object(J),!0).forEach(function(Qe){m()(at,Qe,J[Qe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(at,Object.getOwnPropertyDescriptors(J)):mt(Object(J)).forEach(function(Qe){Object.defineProperty(at,Qe,Object.getOwnPropertyDescriptor(J,Qe))})}return at}function At(at){var Ut=it();return function(){var Qe=Ge()(at),ne;if(Ut){var et=Ge()(this).constructor;ne=Reflect.construct(Qe,arguments,et)}else ne=Qe.apply(this,arguments);return fe()(this,ne)}}function it(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(at){return!1}}var vt;(function(at){at.TOPRIGHT="topright",at.TOPLEFT="topleft",at.BOTTOMRIGHT="bottomright",at.BOTTOMLEFT="bottomleft"})(vt||(vt={}));var Je=0,_t=function(at){$()(J,at);var Ut=At(J);function J(Qe){var ne;return F()(this,J),ne=Ut.call(this),ne.controlOption=void 0,ne.container=void 0,ne.sceneContainer=void 0,ne.mapsService=void 0,ne.renderService=void 0,ne.layerService=void 0,ne.controlService=void 0,ne.isShow=void 0,ne.controlOption=De(De({},ne.getDefault()),Qe||{}),ne}return Z()(J,[{key:"getDefault",value:function(){return{position:vt.TOPRIGHT,name:"".concat(Je++)}}},{key:"setPosition",value:function(ne){var et=this.controlService;return et&&et.removeControl(this),this.controlOption.position=ne,et&&et.addControl(this,this.sceneContainer),this}},{key:"addTo",value:function(ne){this.mapsService=ne.get(pe.TYPES.IMapService),this.renderService=ne.get(pe.TYPES.IRendererService),this.layerService=ne.get(pe.TYPES.ILayerService),this.controlService=ne.get(pe.TYPES.IControlService),this.sceneContainer=ne,this.isShow=!0,this.container=this.onAdd();var et=this.container,kt=this.controlOption.position,dr=this.controlService.controlCorners[kt];return Ze.a.addClass(et,"l7-control"),kt.indexOf("bottom")!==-1?dr.insertBefore(et,dr.firstChild):dr.appendChild(et),this}},{key:"onAdd",value:function(){throw new Error("Method not implemented.")}},{key:"onRemove",value:function(){throw new Error("Method not implemented.")}},{key:"hide",value:function(){var ne=this.container;Ze.a.addClass(ne,"l7-control-hide"),this.isShow=!1}},{key:"show",value:function(){var ne=this.container;Ze.a.removeClass(ne,"l7-control-hide"),this.isShow=!0}},{key:"remove",value:function(){if(!this.mapsService)return this;Ze.a.remove(this.container),this.onRemove()}},{key:"_refocusOnMap",value:function(ne){if(this.mapsService&&ne&&ne.screenX>0&&ne.screenY>0){var et=this.mapsService.getContainer();et!==null&&et.focus()}}}]),J}(Pe.EventEmitter),wt=o("PJYZ"),ke=o.n(wt);function Re(at){var Ut=Ve();return function(){var Qe=Ge()(at),ne;if(Ut){var et=Ge()(this).constructor;ne=Reflect.construct(Qe,arguments,et)}else ne=Qe.apply(this,arguments);return fe()(this,ne)}}function Ve(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(at){return!1}}var dt=function(at){$()(J,at);var Ut=Re(J);function J(Qe){var ne;return F()(this,J),ne=Ut.call(this,Qe),ne.layerControlInputs=void 0,ne.layers=void 0,ne.lastZIndex=void 0,ne.handlingClick=void 0,ne.layersLink=void 0,ne.baseLayersList=void 0,ne.separator=void 0,ne.overlaysList=void 0,ne.form=void 0,ne.layerControlInputs=[],ne.layers=[],ne.lastZIndex=0,ne.handlingClick=!1,ne.initLayers(),Object(Ze.i)(["checkDisabledLayers","onLayerChange","collapse","extend","expand","onInputClick"],ke()(ne)),ne}return Z()(J,[{key:"getDefault",value:function(){return{collapsed:!0,position:pe.PositionType.TOPRIGHT,autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,name:"layers"}}},{key:"onAdd",value:function(){var ne=this;return this.initLayout(),this.update(),this.mapsService.on("zoomend",this.checkDisabledLayers),this.layers.forEach(function(et){et.layer.on("remove",ne.onLayerChange),et.layer.on("add",ne.onLayerChange)}),this.container}},{key:"addVisualLayer",value:function(ne,et){return this.addLayer(ne,et,!0),this.mapsService?this.update():this}},{key:"expand",value:function(){var ne=this.renderService.getViewportSize(),et=ne.height;Ze.a.addClass(this.container,"l7-control-layers-expanded"),this.form.style.height="null";var kt=et-(this.container.offsetTop+50);return kt<this.form.clientHeight?(Ze.a.addClass(this.form,"l7-control-layers-scrollbar"),this.form.style.height=kt+"px"):Ze.a.removeClass(this.form,"l7-control-layers-scrollbar"),this.checkDisabledLayers(),this}},{key:"collapse",value:function(){return Ze.a.removeClass(this.container,"l7-control-layers-expanded"),this}},{key:"onRemove",value:function(){var ne=this;if(!this.mapsService)return;this.mapsService.off("click",this.collapse),this.layers.forEach(function(et){et.layer.off("remove",ne.onLayerChange),et.layer.off("add",ne.onLayerChange)})}},{key:"initLayout",value:function(){var ne="l7-control-layers",et=this.container=Ze.a.create("div",ne),kt=this.controlOption.collapsed;et.setAttribute("aria-haspopup","true");var dr=this.form=Ze.a.create("form",ne+"-list");kt&&(this.mapsService.on("click",this.collapse),et.addEventListener("mouseenter",this.expand),et.addEventListener("mouseleave",this.collapse)),this.layersLink=Ze.a.create("a",ne+"-toggle",et);var Ye=this.layersLink;Ye.title="Layers",kt||this.expand(),this.baseLayersList=Ze.a.create("div",ne+"-base",dr),this.separator=Ze.a.create("div",ne+"-separator",dr),this.overlaysList=Ze.a.create("div",ne+"-overlays",dr),et.appendChild(dr)}},{key:"initLayers",value:function(){var ne=this,et=this.controlOption,kt=et.baseLayers,dr=kt===void 0?{}:kt,Ye=et.overlayers,xt=Ye===void 0?{}:Ye;Object.keys(dr).forEach(function(bt,Et){ne.addLayer(dr[bt],bt,!1)}),Object.keys(xt).forEach(function(bt,Et){ne.addLayer(xt[bt],bt,!0)})}},{key:"update",value:function(){if(!this.container)return this;Ze.a.empty(this.baseLayersList),Ze.a.empty(this.overlaysList),this.layerControlInputs=[];var ne,et,kt,dr,Ye=0;for(kt=0;kt<this.layers.length;kt++)dr=this.layers[kt],this.addItem(dr),et=et||dr.overlay,ne=ne||!dr.overlay,Ye+=dr.overlay?0:1;return this.controlOption.hideSingleBase&&(ne=ne&&Ye>1,this.baseLayersList.style.display=ne?"":"none"),this.separator.style.display=et&&ne?"":"none",this}},{key:"checkDisabledLayers",value:function(){for(var ne=this.layerControlInputs,et,kt,dr=this.mapsService.getZoom(),Ye=ne.length-1;Ye>=0;Ye--)if(et=ne[Ye],kt=this.layerService.getLayer(et.layerId),kt&&kt.inited){var xt=kt.getMinZoom(),bt=kt.getMaxZoom();et.disabled=dr<xt||dr>bt}}},{key:"addLayer",value:function(ne,et,kt){this.mapsService&&(ne.on("add",this.onLayerChange),ne.on("remove",this.onLayerChange)),this.layers.push({layer:ne,name:et,overlay:kt});var dr=this.controlOption,Ye=dr.sortLayers,xt=dr.sortFunction,bt=dr.autoZIndex;Ye&&this.layers.sort(function(Et,Fe){return xt(Et.layer,Fe.layer,Et.name,Fe.name)}),bt&&ne.setZIndex&&(this.lastZIndex++,ne.setZIndex(this.lastZIndex)),this.expandIfNotCollapsed()}},{key:"expandIfNotCollapsed",value:function(){return this.mapsService&&!this.controlOption.collapsed&&this.expand(),this}},{key:"onLayerChange",value:function(ne){this.handlingClick||this.update();var et=this.layerService.getLayer(ne.target.layerId),kt=(et==null?void 0:et.overlay)?ne.type==="add"?"overlayadd":"overlayremove":ne.type==="add"?"baselayerchange":null;kt&&this.emit(kt,et)}},{key:"createRadioElement",value:function(ne,et){var kt='<input type="radio" class="l7-control-layers-selector" name="'+ne+'"'+(et?' checked="checked"':"")+"/>",dr=document.createElement("div");return dr.innerHTML=kt,dr.firstChild}},{key:"addItem",value:function(ne){var et=document.createElement("label"),kt=this.layerService.getLayer(ne.layer.id),dr=kt&&kt.inited&&ne.layer.isVisible(),Ye;ne.overlay?(Ye=document.createElement("input"),Ye.type="checkbox",Ye.className="l7-control-layers-selector",Ye.defaultChecked=dr):Ye=this.createRadioElement("l7-base-layers",dr),this.layerControlInputs.push(Ye),Ye.layerId=ne.layer.id,Ye.addEventListener("click",this.onInputClick);var xt=document.createElement("span");xt.innerHTML=" "+ne.name;var bt=document.createElement("div");et.appendChild(bt),bt.appendChild(Ye),bt.appendChild(xt);var Et=ne.overlay?this.overlaysList:this.baseLayersList;return Et.appendChild(et),this.checkDisabledLayers(),et}},{key:"onInputClick",value:function(){var ne=this.layerControlInputs,et,kt,dr=[],Ye=[];this.handlingClick=!0;for(var xt=ne.length-1;xt>=0;xt--)et=ne[xt],kt=this.layerService.getLayer(et.layerId),et.checked?dr.push(kt):et.checked||Ye.push(kt);Ye.forEach(function(bt){bt.hide()}),dr.forEach(function(bt){bt.show()}),this.handlingClick=!1}}]),J}(_t);function Me(at){var Ut=ht();return function(){var Qe=Ge()(at),ne;if(Ut){var et=Ge()(this).constructor;ne=Reflect.construct(Qe,arguments,et)}else ne=Qe.apply(this,arguments);return fe()(this,ne)}}function ht(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(at){return!1}}var Zt=function(at){$()(J,at);var Ut=Me(J);function J(){return F()(this,J),Ut.apply(this,arguments)}return Z()(J,[{key:"getDefault",value:function(){return{position:vt.BOTTOMLEFT,name:"logo"}}},{key:"onAdd",value:function(){var ne="l7-control-logo",et=Ze.a.create("div",ne),kt=Ze.a.create("a","l7-ctrl-logo");return kt.target="_blank",kt.rel="noopener nofollow",kt.href="https://antv.alipay.com/l7",kt.setAttribute("aria-label","AntV logo"),kt.setAttribute("rel","noopener nofollow"),et.appendChild(kt),et}},{key:"onRemove",value:function(){return null}}]),J}(_t);function Qt(at){var Ut=ur();return function(){var Qe=Ge()(at),ne;if(Ut){var et=Ge()(this).constructor;ne=Reflect.construct(Qe,arguments,et)}else ne=Qe.apply(this,arguments);return fe()(this,ne)}}function ur(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(at){return!1}}var oe=function(at){$()(J,at);var Ut=Qt(J);function J(Qe){var ne;return F()(this,J),ne=Ut.call(this,Qe),ne.mScale=void 0,ne.iScale=void 0,Object(Ze.i)(["update"],ke()(ne)),ne}return Z()(J,[{key:"getDefault",value:function(){return{position:vt.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,name:"scale"}}},{key:"onAdd",value:function(){var ne="l7-control-scale",et=Ze.a.create("div",ne);this.addScales(ne+"-line",et);var kt=this.controlOption.updateWhenIdle;return this.mapsService.on(kt?"moveend":"mapmove",this.update),this.mapsService.on(kt?"zoomend":"zoomchange",this.update),this.update(),et}},{key:"onRemove",value:function(){var ne=this.controlOption.updateWhenIdle;this.mapsService.off(ne?"zoomend":"zoomchange",this.update),this.mapsService.off(ne?"moveend":"mapmove",this.update)}},{key:"update",value:function(){var ne=this.mapsService,et=this.controlOption.maxWidth,kt=ne.getSize()[1]/2,dr=ne.containerToLngLat([0,kt]),Ye=ne.containerToLngLat([et,kt]),xt=Object(Ze.q)([dr.lng,dr.lat],[Ye.lng,Ye.lat]);this.updateScales(xt)}},{key:"updateScales",value:function(ne){var et=this.controlOption,kt=et.metric,dr=et.imperial;kt&&ne&&this.updateMetric(ne),dr&&ne&&this.updateImperial(ne)}},{key:"updateMetric",value:function(ne){var et=this.getRoundNum(ne),kt=et<1e3?et+" m":et/1e3+" km";this.updateScale(this.mScale,kt,et/ne)}},{key:"updateImperial",value:function(ne){var et=ne*3.2808399,kt,dr,Ye;et>5280?(kt=et/5280,dr=this.getRoundNum(kt),this.updateScale(this.iScale,dr+" mi",dr/kt)):(Ye=this.getRoundNum(et),this.updateScale(this.iScale,Ye+" ft",Ye/et))}},{key:"updateScale",value:function(ne,et,kt){var dr=this.controlOption.maxWidth;ne.style.width=Math.round(dr*kt)+"px",ne.innerHTML=et}},{key:"getRoundNum",value:function(ne){var et=Math.pow(10,(Math.floor(ne)+"").length-1),kt=ne/et;return kt=kt>=10?10:kt>=5?5:kt>=3?3:kt>=2?2:1,et*kt}},{key:"addScales",value:function(ne,et){var kt=this.controlOption,dr=kt.metric,Ye=kt.imperial;dr&&(this.mScale=Ze.a.create("div",ne,et)),Ye&&(this.iScale=Ze.a.create("div",ne,et))}}]),J}(_t);function Q(at){var Ut=H();return function(){var Qe=Ge()(at),ne;if(Ut){var et=Ge()(this).constructor;ne=Reflect.construct(Qe,arguments,et)}else ne=Qe.apply(this,arguments);return fe()(this,ne)}}function H(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(at){return!1}}var Se=function(at){$()(J,at);var Ut=Q(J);function J(Qe){var ne;return F()(this,J),ne=Ut.call(this,Qe),ne.disabled=void 0,ne.zoomInButton=void 0,ne.zoomOutButton=void 0,Object(Ze.i)(["updateDisabled","zoomIn","zoomOut"],ke()(ne)),ne}return Z()(J,[{key:"getDefault",value:function(){return{position:vt.TOPLEFT,zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out",name:"zoom"}}},{key:"onAdd",value:function(){var ne="l7-control-zoom",et=Ze.a.create("div",ne+" l7-bar");return this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,ne+"-in",et,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,ne+"-out",et,this.zoomOut),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),this.updateDisabled(),et}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"zoomIn",value:function(){!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}},{key:"zoomOut",value:function(){!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}},{key:"createButton",value:function(ne,et,kt,dr,Ye){var xt=Ze.a.create("a",kt,dr);return xt.innerHTML=ne,xt.title=et,xt.href="javascript:void(0)",xt.addEventListener("click",Ye),xt}},{key:"updateDisabled",value:function(){var ne=this.mapsService,et="l7-disabled";Ze.a.removeClass(this.zoomInButton,et),Ze.a.removeClass(this.zoomOutButton,et),(this.disabled||ne.getZoom()<=ne.getMinZoom())&&Ze.a.addClass(this.zoomOutButton,et),(this.disabled||ne.getZoom()>=ne.getMaxZoom())&&Ze.a.addClass(this.zoomInButton,et)}}]),J}(_t);function be(at,Ut){var J=Object.keys(at);if(Object.getOwnPropertySymbols){var Qe=Object.getOwnPropertySymbols(at);Ut&&(Qe=Qe.filter(function(ne){return Object.getOwnPropertyDescriptor(at,ne).enumerable})),J.push.apply(J,Qe)}return J}function Te(at){for(var Ut=1;Ut<arguments.length;Ut++){var J=arguments[Ut]!=null?arguments[Ut]:{};Ut%2?be(Object(J),!0).forEach(function(Qe){m()(at,Qe,J[Qe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(at,Object.getOwnPropertyDescriptors(J)):be(Object(J)).forEach(function(Qe){Object.defineProperty(at,Qe,Object.getOwnPropertyDescriptor(J,Qe))})}return at}function me(at){var Ut=nt();return function(){var Qe=Ge()(at),ne;if(Ut){var et=Ge()(this).constructor;ne=Reflect.construct(Qe,arguments,et)}else ne=Qe.apply(this,arguments);return fe()(this,ne)}}function nt(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(at){return!1}}var Jt=function(at){$()(J,at);var Ut=me(J);function J(Qe){var ne;return F()(this,J),ne=Ut.call(this),ne.markerOption=void 0,ne.defaultMarker=void 0,ne.popup=void 0,ne.mapsService=void 0,ne.sceneSerive=void 0,ne.lngLat=void 0,ne.scene=void 0,ne.added=!1,ne.eventHandle=function(et){ne.emit(et.type,{target:et,data:ne.markerOption.extData,lngLat:ne.lngLat})},ne.markerOption=Te(Te({},ne.getDefault()),Qe),Object(Ze.i)(["update","onMove","onUp","addDragHandler","onMapClick"],ke()(ne)),ne.init(),ne}return Z()(J,[{key:"getDefault",value:function(){return{element:void 0,anchor:Ze.f.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(ne){this.scene=ne,this.mapsService=ne.get(pe.TYPES.IMapService),this.sceneSerive=ne.get(pe.TYPES.ISceneService);var et=this.markerOption,kt=et.element,dr=et.draggable;return this.mapsService.getMarkerContainer().appendChild(kt),this.registerMarkerEvent(kt),this.mapsService.on("camerachange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("mousedown",this.addDragHandler),this.mapsService.off("touchstart",this.addDragHandler),this.mapsService.off("mouseup",this.onUp),this.mapsService.off("touchend",this.onUp)),this.unRegisterMarkerEvent(),this.removeAllListeners();var ne=this.markerOption.element;return ne&&Ze.a.remove(ne),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(ne){return this.lngLat=ne,Array.isArray(ne)&&(this.lngLat={lng:ne[0],lat:ne[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(ne){var et=this;if(!this.added)return this.once("added",function(){et.setElement(ne)}),this;var kt=this.markerOption.element;return kt&&Ze.a.remove(kt),this.markerOption.element=ne,this.init(),this.mapsService.getMarkerContainer().appendChild(ne),this.registerMarkerEvent(ne),this.update(),this}},{key:"openPopup",value:function(){var ne=this;if(!this.added)return this.once("added",function(){ne.openPopup()}),this;var et=this.popup;return et?(et.isOpen()||et.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var ne=this;this.added||this.once("added",function(){ne.closePopup()});var et=this.popup;return et&&et.remove(),this}},{key:"setPopup",value:function(ne){return this.popup=ne,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var ne=this.popup;if(ne)ne.isOpen()?ne.remove():ne.addTo(this.scene);else return this;return this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(ne){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(ne){this.markerOption.extData=ne}},{key:"update",value:function(){if(!this.mapsService)return;var ne=this.markerOption,et=ne.element,kt=ne.anchor;this.updatePosition(),Ze.a.setTransform(et,"".concat(Ze.e[kt]))}},{key:"onMapClick",value:function(ne){var et=this.markerOption.element;this.popup&&et&&this.togglePopup()}},{key:"updatePosition",value:function(){if(!this.mapsService)return;var ne=this.markerOption,et=ne.element,kt=ne.offsets,dr=this.lngLat,Ye=dr.lng,xt=dr.lat,bt=this.mapsService.getBounds(),Et=this.mapsService.getZoom();if((Ye<bt[0][0]||Ye>bt[1][0]||xt<bt[0][1]||xt>bt[1][1])&&Et>3){et&&(et.style.display="none");return}var Fe=this.mapsService.lngLatToContainer([Ye,xt]);et&&(et.style.display="block",et.style.left=Fe.x+kt[0]+"px",et.style.top=Fe.y-kt[1]+"px")}},{key:"init",value:function(){var ne=this,et=this.markerOption.element,kt=this.markerOption,dr=kt.color,Ye=kt.anchor;if(!et){this.defaultMarker=!0,et=Ze.a.create("div"),this.markerOption.element=et;var xt=document.createElementNS("http://www.w3.org/2000/svg","svg");xt.setAttributeNS(null,"display","block"),xt.setAttributeNS(null,"height","48px"),xt.setAttributeNS(null,"width","48px"),xt.setAttributeNS(null,"viewBox","0 0 1024 1024");var bt=document.createElementNS("http://www.w3.org/2000/svg","path");bt.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),bt.setAttributeNS(null,"fill",dr),xt.appendChild(bt),et.appendChild(xt)}Ze.a.addClass(et,"l7-marker"),et.addEventListener("click",function(Et){ne.onMapClick(Et)}),et.addEventListener("click",this.eventHandle),Object(Ze.g)(et,Ye,"marker")}},{key:"registerMarkerEvent",value:function(ne){ne.addEventListener("mousemove",this.eventHandle),ne.addEventListener("click",this.eventHandle),ne.addEventListener("mousedown",this.eventHandle),ne.addEventListener("mouseup",this.eventHandle),ne.addEventListener("dblclick",this.eventHandle),ne.addEventListener("contextmenu",this.eventHandle),ne.addEventListener("mouseover",this.eventHandle),ne.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var ne=this.getElement();ne.removeEventListener("mousemove",this.eventHandle),ne.removeEventListener("click",this.eventHandle),ne.removeEventListener("mousedown",this.eventHandle),ne.removeEventListener("mouseup",this.eventHandle),ne.removeEventListener("dblclick",this.eventHandle),ne.removeEventListener("contextmenu",this.eventHandle),ne.removeEventListener("mouseover",this.eventHandle),ne.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(ne){throw new Error("Method not implemented.")}},{key:"onUp",value:function(ne){throw new Error("Method not implemented.")}}]),J}(Pe.EventEmitter),Mt=o("QkVN"),ve=o.n(Mt),ge=o("mpbz"),He=o.n(ge);function ot(at,Ut){var J=Object.keys(at);if(Object.getOwnPropertySymbols){var Qe=Object.getOwnPropertySymbols(at);Ut&&(Qe=Qe.filter(function(ne){return Object.getOwnPropertyDescriptor(at,ne).enumerable})),J.push.apply(J,Qe)}return J}function we(at){for(var Ut=1;Ut<arguments.length;Ut++){var J=arguments[Ut]!=null?arguments[Ut]:{};Ut%2?ot(Object(J),!0).forEach(function(Qe){m()(at,Qe,J[Qe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(at,Object.getOwnPropertyDescriptors(J)):ot(Object(J)).forEach(function(Qe){Object.defineProperty(at,Qe,Object.getOwnPropertyDescriptor(J,Qe))})}return at}function gt(at){var Ut=C();return function(){var Qe=Ge()(at),ne;if(Ut){var et=Ge()(this).constructor;ne=Reflect.construct(Qe,arguments,et)}else ne=Qe.apply(this,arguments);return fe()(this,ne)}}function C(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(at){return!1}}var R=function(at){$()(J,at);var Ut=gt(J);function J(Qe){var ne,et;return F()(this,J),et=Ut.call(this),et.markers=[],et.markerLayerOption=void 0,et.clusterIndex=void 0,et.points=[],et.clusterMarkers=[],et.mapsService=void 0,et.scene=void 0,et.zoom=void 0,et.bbox=void 0,et.markerLayerOption=ve()(et.getDefault(),Qe),Object(Ze.i)(["update"],ke()(et)),et.zoom=((ne=et.markerLayerOption.clusterOption)===null||ne===void 0?void 0:ne.zoom)||-99,et}return Z()(J,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(ne){return this.scene=ne,this.mapsService=ne.get(pe.TYPES.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update)),this.addMarkers(),this}},{key:"addMarker",value:function(ne){var et=this.markerLayerOption.cluster;et&&this.addPoint(ne,this.markers.length),this.markers.push(ne)}},{key:"removeMarker",value:function(ne){this.markers.indexOf(ne);var et=this.markers.indexOf(ne);et>-1&&this.markers.splice(et,1)}},{key:"getMarkers",value:function(){var ne=this.markerLayerOption.cluster;return ne?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var ne=this;this.getMarkers().forEach(function(et){et.addTo(ne.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(ne){ne.remove()}),this.clusterMarkers.forEach(function(ne){ne.remove()}),this.mapsService.off("camerachange",this.update),this.markers=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"addPoint",value:function(ne,et){var kt=ne.getLnglat(),dr=kt.lng,Ye=kt.lat,xt={geometry:{type:"Point",coordinates:[dr,Ye]},properties:we(we({},ne.getExtData()),{},{marker_id:et})};this.points.push(xt)}},{key:"initCluster",value:function(){if(!this.markerLayerOption.cluster)return;var ne=this.markerLayerOption.clusterOption,et=ne.radius,kt=ne.minZoom,dr=kt===void 0?0:kt,Ye=ne.maxZoom;this.clusterIndex=new He.a({radius:et,minZoom:dr,maxZoom:Ye}),this.clusterIndex.load(this.points)}},{key:"getClusterMarker",value:function(ne,et){var kt=this,dr=ne[0].concat(ne[1]),Ye=this.clusterIndex.getClusters(dr,et);this.clusterMarkers.forEach(function(xt){xt.remove()}),this.clusterMarkers=[],Ye.forEach(function(xt){var bt,Et=kt.markerLayerOption.clusterOption,Fe=Et.field,pt=Et.method;if(xt.properties&&((bt=xt.properties)===null||bt===void 0?void 0:bt.cluster_id)){var yt,Ht=kt.getLeaves((yt=xt.properties)===null||yt===void 0?void 0:yt.cluster_id);if(xt.properties.clusterData=Ht,Fe&&pt){var hr=Ht==null?void 0:Ht.map(function(oa){var $n=m()({},Fe,oa.properties[Fe]);return $n}),Hr=Ze.c.getColumn(hr,Fe),gr=Ze.c.getSatByColumn(pt,Hr),Bn="point_"+pt;xt.properties[Bn]=gr.toFixed(2)}}var zn=kt.clusterMarker(xt);kt.clusterMarkers.push(zn),zn.addTo(kt.scene)})}},{key:"getLeaves",value:function(ne){var et=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Infinity,kt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return ne?this.clusterIndex.getLeaves(ne,et,kt):null}},{key:"clusterMarker",value:function(ne){var et=this.markerLayerOption.clusterOption,kt=et,dr=kt.element,Ye=dr===void 0?this.generateElement.bind(this):dr,xt=new Jt({element:Ye(ne)}).setLnglat({lng:ne.geometry.coordinates[0],lat:ne.geometry.coordinates[1]});return xt}},{key:"normalMarker",value:function(ne){var et=ne.properties.marker_id;return this.markers[et]}},{key:"update",value:function(){var ne=this.mapsService.getZoom(),et=this.mapsService.getBounds();(!this.bbox||Math.abs(ne-this.zoom)>=1||!Object(Ze.j)(this.bbox,et))&&(this.bbox=Object(Ze.r)(et,.5),this.zoom=Math.floor(ne),this.getClusterMarker(this.bbox,this.zoom))}},{key:"generateElement",value:function(ne){var et=Ze.a.create("div","l7-marker-cluster"),kt=Ze.a.create("div","",et),dr=Ze.a.create("span","",kt),Ye=this.markerLayerOption.clusterOption,xt=Ye.field,bt=Ye.method;ne.properties.point_count=ne.properties.point_count||1;var Et=xt&&bt?ne.properties["point_"+bt]||ne.properties[xt]:ne.properties.point_count;return dr.textContent=Et,et}}]),J}(Pe.EventEmitter);function q(at,Ut){var J=Object.keys(at);if(Object.getOwnPropertySymbols){var Qe=Object.getOwnPropertySymbols(at);Ut&&(Qe=Qe.filter(function(ne){return Object.getOwnPropertyDescriptor(at,ne).enumerable})),J.push.apply(J,Qe)}return J}function ce(at){for(var Ut=1;Ut<arguments.length;Ut++){var J=arguments[Ut]!=null?arguments[Ut]:{};Ut%2?q(Object(J),!0).forEach(function(Qe){m()(at,Qe,J[Qe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(at,Object.getOwnPropertyDescriptors(J)):q(Object(J)).forEach(function(Qe){Object.defineProperty(at,Qe,Object.getOwnPropertyDescriptor(J,Qe))})}return at}function We(at){var Ut=qe();return function(){var Qe=Ge()(at),ne;if(Ut){var et=Ge()(this).constructor;ne=Reflect.construct(Qe,arguments,et)}else ne=Qe.apply(this,arguments);return fe()(this,ne)}}function qe(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(at){return!1}}var Tt=function(at){$()(J,at);var Ut=We(J);function J(Qe){var ne;return F()(this,J),ne=Ut.call(this),ne.popupOption=void 0,ne.mapsService=void 0,ne.sceneSerive=void 0,ne.lngLat=void 0,ne.content=void 0,ne.closeButton=void 0,ne.timeoutInstance=void 0,ne.container=void 0,ne.tip=void 0,ne.scene=void 0,ne.popupOption=ce(ce({},ne.getdefault()),Qe),Object(Ze.i)(["update","onClickClose","remove"],ke()(ne)),ne}return Z()(J,[{key:"addTo",value:function(ne){var et=this;return this.mapsService=ne.get(pe.TYPES.IMapService),this.sceneSerive=ne.get(pe.TYPES.ISceneService),this.mapsService.on("camerachange",this.update),this.scene=ne,this.update(),this.popupOption.closeOnClick&&(this.timeoutInstance=setTimeout(function(){et.mapsService.on("click",et.onClickClose)},30)),this.emit("open"),this}},{key:"close",value:function(){this.remove()}},{key:"open",value:function(){this.addTo(this.scene)}},{key:"setHTML",value:function(ne){var et=window.document.createDocumentFragment(),kt=window.document.createElement("body"),dr;for(kt.innerHTML=ne;!(dr=kt.firstChild,!dr);)et.appendChild(dr);return this.setDOMContent(et)}},{key:"setLnglat",value:function(ne){return this.lngLat=ne,Array.isArray(ne)&&(this.lngLat={lng:ne[0],lat:ne[1]}),this.mapsService&&this.mapsService.on("camerachange",this.update),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setText",value:function(ne){return this.setDOMContent(window.document.createTextNode(ne))}},{key:"setMaxWidth",value:function(ne){return this.popupOption.maxWidth=ne,this.update(),this}},{key:"setDOMContent",value:function(ne){return this.createContent(),this.content.appendChild(ne),this.update(),this}},{key:"remove",value:function(){return this.content&&this.removeDom(this.content),this.container&&(this.removeDom(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("click",this.onClickClose),delete this.mapsService),clearTimeout(this.timeoutInstance),this.emit("close"),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"createContent",value:function(){this.content&&Ze.a.remove(this.content),this.content=Ze.a.create("div","l7-popup-content",this.container),this.popupOption.closeButton&&(this.closeButton=Ze.a.create("button","l7-popup-close-button",this.content),this.closeButton.setAttribute("aria-label","Close popup"),this.closeButton.innerHTML="&#215;",this.closeButton.addEventListener("click",this.onClickClose))}},{key:"creatDom",value:function(ne,et,kt){var dr=window.document.createElement(ne);return et!==void 0&&(dr.className=et),kt&&kt.appendChild(dr),dr}},{key:"removeDom",value:function(ne){ne.parentNode&&ne.parentNode.removeChild(ne)}},{key:"getdefault",value:function(){return{closeButton:!0,closeOnClick:!0,maxWidth:"240px",offsets:[0,0],anchor:Ze.f.BOTTOM,className:"",stopPropagation:!0}}},{key:"onClickClose",value:function(ne){ne.stopPropagation&&ne.stopPropagation(),this.remove()}},{key:"update",value:function(){var ne=this,et=this.lngLat,kt=this.popupOption,dr=kt.className,Ye=kt.maxWidth,xt=kt.anchor;if(!this.mapsService||!et||!this.content)return;var bt=this.mapsService.getMarkerContainer();if(!this.container&&bt){this.container=this.creatDom("div","l7-popup",bt),this.tip=this.creatDom("div","l7-popup-tip",this.container),this.container.appendChild(this.content),dr&&dr.split(" ").forEach(function(Fe){return ne.container.classList.add(Fe)});var Et=this.popupOption.stopPropagation;Et&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(Fe){ne.container.addEventListener(Fe,function(pt){pt.stopPropagation()})})}Ye&&this.container.style.maxWidth!==Ye&&(this.container.style.maxWidth=Ye),this.updatePosition(),Ze.a.setTransform(this.container,"".concat(Ze.e[xt])),Object(Ze.g)(this.container,xt,"popup")}},{key:"updatePosition",value:function(){if(!this.mapsService)return;var ne=this.lngLat,et=ne.lng,kt=ne.lat,dr=this.popupOption.offsets,Ye=this.mapsService.lngLatToContainer([et,kt]);this.container.style.left=Ye.x+dr[0]+"px",this.container.style.top=Ye.y-dr[1]+"px"}}]),J}(Pe.EventEmitter);o("BGjm")(`/* @antv/l7-component */
.l7-marker-container {
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: absolute;
 }

.l7-marker {
	position: absolute !important;
	top: 0;
	left: 0;
  z-index: 5;
  cursor: pointer;
}

.l7-marker-cluster {
  background-clip: padding-box;
  border-radius: 20px;
  background-color: rgba(181, 226, 140, 0.6);
  width: 40px;
  height: 40px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-left: 5px;
  margin-top: 5px;
  text-align: center;
  border-radius: 15px;
  font: 12px "Helvetica Neue", Arial, Helvetica, sans-serif;
  background-color: rgba(110, 204, 57, 0.6);
}
.l7-marker-cluster span {
  line-height: 30px;
}

.l7-popup-anchor-bottom,
.l7-popup-anchor-bottom-left,
.l7-popup-anchor-bottom-right {
    -webkit-flex-direction: column-reverse;
    -webkit-box-orient: vertical;
    -webkit-box-direction: reverse;
        -ms-flex-direction: column-reverse;
            flex-direction: column-reverse;
}

.l7-popup-close-button {
  position: absolute;
  right: 0;
  top: 0;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
  background-color: transparent;
}

.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

	/* layers control */

.l7-control-layers {
	-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.4);
	        box-shadow: 0 1px 5px rgba(0,0,0,0.4);
	background: #fff;
	border-radius: 5px;
	}
.l7-popup-anchor-top,
.l7-popup-anchor-top-left,
.l7-popup-anchor-top-right {
    -webkit-flex-direction: column;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
}


.l7-popup-anchor-left {
    -webkit-flex-direction: row;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: normal;
        -ms-flex-direction: row;
            flex-direction: row;
}

.l7-popup-anchor-right {
    -webkit-flex-direction: row-reverse;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: reverse;
        -ms-flex-direction: row-reverse;
            flex-direction: row-reverse;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  display: -webkit-flex;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
  z-index: 5;
}
.l7-popup-tip {
  width: 0;
  height: 0;
  border: 10px solid transparent;
  z-index: 1;
}
.l7-popup-anchor-top .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-top: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-top-left .l7-popup-tip {
	-webkit-align-self: flex-start;
	-ms-flex-item-align: start;
	    align-self: flex-start;
	border-top: none;
	border-left: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-top-right .l7-popup-tip {
	-webkit-align-self: flex-end;
	-ms-flex-item-align: end;
	    align-self: flex-end;
	border-top: none;
	border-right: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-bottom .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-bottom: none;
	border-top-color: #fff;
}

.l7-popup-anchor-bottom-left .l7-popup-tip {
	-webkit-align-self: flex-start;
	-ms-flex-item-align: start;
	    align-self: flex-start;
	border-bottom: none;
	border-left: none;
	border-top-color: #fff;
}

.l7-popup-anchor-bottom-right .l7-popup-tip {
	-webkit-align-self: flex-end;
	-ms-flex-item-align: end;
	    align-self: flex-end;
	border-bottom: none;
	border-right: none;
	border-top-color: #fff;
}

.l7-popup-anchor-left .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-left: none;
	border-right-color: #fff;
}

.l7-popup-anchor-right .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-right: none;
	border-left-color: #fff;
}

.l7-popup-close-button {
	position: absolute;
	right: 0;
	top: 0;
	border: 0;
	padding: 0;
	font-size: 25px;
	line-height: 20px;
	border-radius: 0 3px 0 0;
	cursor: pointer;
	background-color: transparent;
}

.l7-popup-close-button:hover {
	background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
	position: relative;
	background: #fff;
	border-radius: 3px;
	-webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
	        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
	padding: 10px 10px 15px;
	pointer-events: auto;
}

.l7-popup-anchor-top-left .l7-popup-content {
	border-top-left-radius: 0;
}

.l7-popup-anchor-top-right .l7-popup-content {
	border-top-right-radius: 0;
}

.l7-popup-anchor-bottom-left .l7-popup-content {
	border-bottom-left-radius: 0;
}

.l7-popup-anchor-bottom-right .l7-popup-content {
	border-bottom-right-radius: 0;
}

.l7-popup-track-pointer {
	display: none;
}

.l7-popup-track-pointer * {
	pointer-events: none;
	-webkit-user-select: none;
	   -moz-user-select: none;
	    -ms-user-select: none;
	        user-select: none;
}

.l7-map:hover .l7-popup-track-pointer {
	display: -webkit-box;
	display: -webkit-flex;
	display: -ms-flexbox;
	display: flex;
}

.l7-map:active .l7-popup-track-pointer {
	display: none;
}


.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

/* general toolbar styles */

.l7-bar {
	-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.65);
	        box-shadow: 0 1px 5px rgba(0,0,0,0.65);
	border-radius: 4px;
	}
.l7-bar a,
.l7-bar a:hover {
	background-color: #fff;
	width: 30px;
	height: 30px;
  font-size: 20px;
	display: block;
	text-align: center;
	text-decoration: none;
	color: #8E9DAB;
	}
.l7-bar a,
.l7-control-layers-toggle {
	background-position: 50% 50%;
	background-repeat: no-repeat;
	display: block;
	}
.l7-bar a:hover {
	background-color: #f4f4f4;
	}
.l7-bar a:first-child {
	border-top-left-radius: 2px;
	border-top-right-radius: 2px;
	}
.l7-bar a:last-child {
	border-bottom-left-radius: 2px;
	border-bottom-right-radius: 2px;
	border-bottom: none;
	}
.l7-bar a.l7-disabled {
	cursor: default;
	background-color: #f4f4f4;
	color: #bbb;
	}


/* control positioning */

.l7-control-container {
	font: 12px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
}
.l7-control-hide {
	display: none;
}
.l7-control {
	position: relative;
	z-index: 800;
	pointer-events: visiblePainted; /* IE 9-10 doesn't have auto */
	pointer-events: auto;
	}
.l7-control {
	float: left;
	clear: both;
	}.l7-top,
  .l7-bottom {
    position: absolute;
    z-index: 1000;
    pointer-events: none;
    }
  .l7-top {
    top: 0;
    }
  .l7-right {
    right: 0;
    }
  .l7-bottom {
    bottom: 0;
    }
  .l7-left {
    left: 0;
    }

  .l7-control {
    float: left;
    clear: both;
    }
  .l7-right .l7-control {
    float: right;
    }
  .l7-top .l7-control {
    margin-top: 10px;
    }
  .l7-bottom .l7-control {
    margin-bottom: 10px;
    }
  .l7-left .l7-control {
    margin-left: 10px;
    }
  .l7-right .l7-control {
    margin-right: 10px;
    }

  /* attribution and scale controls */

.l7-control-container .l7-control-attribution {
	background: #fff;
	background: rgba(255, 255, 255, 0.7);
	margin: 0;
	}
.l7-control-attribution,
.l7-control-scale-line {
	padding: 0 5px;
  color: #333;
	}
.l7-control-attribution a {
	text-decoration: none;
	}
.l7-control-attribution a:hover {
	text-decoration: underline;
	}
.l7-container .l7-control-attribution,
.l7-container .l7-control-scale {
  font-size: 11px;
  padding: 5px 5px 2px 5px;
  background: rgba(255, 255, 255, 0.7);
	}
.l7-left .l7-control-scale {
	margin-left: 5px;
	}
.l7-bottom .l7-control-scale {
	margin-bottom: 5px;
	}
.l7-control-scale-line {
	border: 2px solid #000;
  border-top: none;
  color: #000;
	line-height: 1.1;
	padding: 2px 5px 1px;
	font-size: 11px;
	white-space: nowrap;
	overflow: hidden;
	-webkit-box-sizing: border-box;
	        box-sizing: border-box;

	background: #fff;
	}
.l7-control-scale-line:not(:first-child) {
	border-top: 2px solid #777;
	border-bottom: none;
	margin-top: -2px;
	}
.l7-control-scale-line:not(:first-child):not(:last-child) {
	border-bottom: 2px solid #777;
	}

.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
	-webkit-box-shadow: none;
	        box-shadow: none;
	}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
	border: 2px solid rgba(0,0,0,0.2);
	background-clip: padding-box;
  }
  /*logo */

  .l7-ctrl-logo {
    background-size: 100% 100%;
    width: 89px;
    height: 16px;
    margin: 0 0 -3px -3px;
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    background-repeat: no-repeat;
    cursor: pointer;
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAAgCAYAAAHBIxK2AAAABGdBTUEAALGPC/xhBQAAIJZJREFUeAHtfAl8Tkf3/9z7PNmDRFbZSawhQcRSaqva1xCqpataqrT2UkuUUiqlaKtafe1VS1pUiypB0dIgIkpKRPZIELI/2/zO98akN48nltL3838//84nNzNzzpkzc+eee+bMOXMfxijNaMJ7LOrGO/HdYfZ8fb12gD2JJINJdR8WNHVQnRtSn7hilpz0u2DMKaEcFhZmhdzLNbiPyNVlwPxcm4Qh93Fr0gO4Ol5hfqiz6Q14G+QzGpYzQ9nXrUl7X/fgbrXdG3skX7m26+bNW2fQqJ5XmCs6RQKd6EQwB0zgtKgsvCidGF+N8wV/SBLqSKnXzx2WKIHw1xNxq2xtrKsBXqgrbePt1rivJFmloa5OoD129NcVQwa9Phxwaflw3ifvHCus1YIVjW7fwEF66dIhdYO/XV7Qk+9HY/5F7RA+w0G5TdRxq7gw10FBPWwA+3r9jpkYGcoJ5/7YiFxMiYCjLspsekOeCiJ1AhJJNER+8rfTX/j4BNcUMNCLMmhF+wC3cE9RZmMd/0IQjeTtGdwJjURD5EajsRQN1EwEHjAkUVce2LLhnKf8xGId3ZhkX4uxmj7MMKqJz0ZmMr3MJNZBmphV8WDBOCCgo+2QiE7DF3005wvU75e8vMLs4+P3HwwN7do5MzOu2NcjpPHRX/csCqjt2wvtxEAy8xJ3o+7j3jjkcurpn2xtrT0EPiS0oQPKSOfi/ygqL9H/qNbls8EXuer4+65xUa149QnBvGYFgapAN21EZ+pnuH3rrrnKdNA/zCRmjoqGzu36RoL21q38BLAAjRgo6iir63g1QAOcOoU27DAgwKtpPzVMKU+qBWIuve3Jx0zw4j/eQ0CASeNnjUi5mrYH72ZxUfFV0emJ479/BvrM9KxDAgZZEjziTp1d8+pL415sEdJloIAhF7QCZmnQoCkuLkkXNPfkozU8b4wVb30P4i4ADNQ41P08mtSBogHc27Vx70CPEHeUgRNwgUOuTqBR8wwODraGSIkrKipKxqVuI300mntri1jz9OOs0IHeHUdvms2t0iG+vn5nxmnan5QeUff6GGWttpidSjvGbCSZJdAAGTMwtjWSH2G5XrOp3oEv9wuWxqdeUPchZkW8OGqcedmcdujgUcMOH/zltmgL2YW2Fu22fbMz6q2xM+IEvmvHiCGyRq7AK3QLe959+T6v46co0uVBisLk0/9SqIIhcnQiVBPqULJ4dPVd2ypLg6Dx8wxuhAGDHrCOHTtqUfZ2b6KsYYIOuUiXL1/dKW4SMJRxkbbpG9nv5ecVutlt+PSoNvw7VPg8V4X5wqf4YQVp9g+NDQZDITr2cm/8lNIGlbvp+edGD/946eqJqOKmoBJRhjyjrclk0qlZAqeumw8YOEwE6ILdgh0raN9pcHeWx9n3mViPh9IKnlmBVBWI4bfoePDAEcOGPz9WWUDBzMe1cUdft5CnUfb2DvFR8rsz2avrkOdmT18wJisz5zDaqthVWjwAtzRgtBF9VbSdVofXIPWmB2CCouYqUBUFH59QbwwEqg0XykAi96/VuCEetRrm59msEfA+nqEtAUeqNEt324JGJEsDxpMi26gnaCpUxqJk6bahkGFp3akrZO8IBurcVGponpGW+VOdQP++uIAznzE1/cBBvRRZTc+OP0miUBJ78OiyxNxE6uX+KSP3vDIZuEE/z9BgWZZtHHj1oxZbkS6uJFNqIn+SWSy1AubjFtLd171xoHrQooyFQJRB7+0eHBrk2cxNtBW5mgYwoYNFXg5r7CvoFXWxajQ3mjiTc84wVkB2kTWt5NYk3lZ02SCvzphDDVrNZOY2p3mdA0wrhQoGSm5ig6SRyTsqwSxUaMKk+t4tXJIy4/IsoP82yNu7pYusKwk2WdslZmScvGHOyNs1tJ5GNrjVaeT2W2xsLCnuv5J6woQq/QtbXoLCMJqYtbWj208pKbGK4aamgWJR19XlCvpFEdxn6SDOl0byAjXB/cp8rlM/PteZ83k1T92PTuAw0Ly8GychmosWLB/v7xFSW+AeJQ/0auyLiYFEBgQ0dYKdDRsJfFOvpe0V76fgCVrgkNQTao63hAONr2vjFtAFltoTTFLzB415Al7RFdNipHRviWlLbzCHhZ05HxfEy9e7T/zX8FV+XLk+96e8Tl0xOJZfOpjdKp4kzboZXgGrouDj1rTunHnTQl1caoZ/unLNlKnTx32sNxobR0ZGakQTDCY8tEtEkG+LfihDg+NC2ccjpBXoyMTqVaLjTaFLduxe219XqH+67HYGKU5D0pbN30X5+vl0a9m6mZOPTxvFUIayPRAbM1RpS1uztp0a/SD6e9hcYlKVqgi7QEg/DAyRsAUsKSlNLyvT56Bs8e2Ias4LZzfnfEowJyOOVocZDs9jt8YnMDvUZzblZ+jis1rwtqg/KMHgwEThCUOCUS64U/An6iiL9oIGcFjwqMOQQB0JdTyEXd/tfR/1rMzsWCrPBxwPCxJMfJMELVYq0KO+fNkXk6CHRV/qXPSLXA0XZejpqiRZ0IgcY7hzu+AS2TB3quInaNnU2vzSlNqcT/fhHSqAVJgawAunEXxCPU4W9MMlcRN0ryZMAl2XcOHm6YlnYgMAToIOuxks+YBBErGrAa0YtKDDDkeYAaBFErjSUl2uKOfm5v1GE9y1nOLe/4IO+b3YchfKw0wy3lZ6m2arxyr4KV4RURH54qtS/fGufEMZZ7Hja/Ko0ptsgYML0+kKGM+4wbTbmGQUtPfLMfBrWWc3gIZenX4aJmUp9OQdqunk4nv2QmzMus0rO730wtj0qu2DqnuQjCYbrOjYrINq5JuRe/CKQp3QtRMweivm0yur+FBQf9xk6WFQX99Tvw2GDO0390jssWXW1vKf6n4q7Dc1EOXledJwQxF7RV/EomQbptMXssJlNyT5YSe4dq1m/s907eik1WprNKjdur9sW/1AWt7535Ur6/zvN2/lpcds/37eM892mEgTXGHuHD1y4qLRYK0YvrJsMly5knKu0tg0csmObbvfC2/ZbETK9bOnW4TU7xtGEw0a2geZbKysz/Xu9txQvV6fX6VOrMTw/hVsdF8b/tbGgX1feqF1m7Bq5hda+/o+pVgXm9Ztmzk0ctTBlMyEi/fnaoZ9g3HH1xmv5GgwI/m3+oAZUOzkj4fx7rQBt7qdxnhJDiuj/YlBe9dG1pLNbF9D8c2dem2xVMA3NQhjBk6WMyVaelmZVaL0+vmcB/Tz/zVa+8lIPlWW2SLMQh559ZSNCE2sbCq/FBuLyrrbLJVHsYZMr/sdfpiKJOv1pOxtyISp0tQRtHXqhNWQZffSy5d/LBOwJ5H71mrcAnzSSA2Z84ObJPlCbiujSZubkRefZI5X61hL5pavbzMvY4kuTCuzm6nXE4+Ztwf/lBRmcW1zcSkwxsXF6bWmEnbQSPJsoqWMZumwUqYC7QCVi3Y6tMmnCZdYDItiJezj0v3MaLJmRmXX58w0zKJ3w3ww2IwE+fk7JSUll9b2Crl4NfPcJXOav1OH7fyfdSs6cS7zl18Y65GRd36Pmk/S+dwex0/tHTN54pxNJ0/I2tTsM5WccqDFQgn9rW4nyphg4J95ut9gZis7p6Ym3BI4L9eQ+sS/ntrbLXDIE8/fLKaHVP7goyN5whKyKKMHcsWboSasqsznORfSRYEaz3v29uZt4JiDxMC8QVJLjzntg+ow+dBe7BhRJ1MwQ/AVkRbwQbBj7OtTXgVu49qt79LDrW/OX4yrqjEJ/OIPVrwlfM2CB/rW6XQ3wd9SgjsM41SsC9pLt+H0AptK2fdRjFdYHHwdhY0QOsL1VZDimkIHfLLD8xThcmCF+p3SjOxc0WlV+Zervm2x68dN/QQ+MLC2DVSHqOOVw6ZFXDRgCXjUBQ1y7Py+3bO+HyQLO0bArGV2auRrkxRv1orPPgjXF6XVARxJz0vCPvz4vbkoT50899yTenvAD0ljLx0L8Gr2Et4C9XXnTkEiecNKv/xiU/q1nHNXlQmN2iYVlpWwL0qLmSR3ZNFgQCpCogXuLDMa45WrTH8AcCVpTL8Q7ChbVDhAgO6XmwwGj7AWoa9lZ+UcBt3ufZvn6Ar0bUSbP/+42cJQ7NhbNjj3ybpW2p0G3LtP966DUIYk0TbZDr4Kk9Ho7lXLw1+0g6qo6Wtz8+f9sfmARQzqPZNWiCCBJ/NLtrOz9SkoKPxDlmT1SiJIHiuH6oAeF5e1o9XRGjWqa6pXrxbcqlm3YY7Wtifu6WDeU1xHF59an1cDki9wm8nnU7h3AV0fergDNrsln0+BtKUoP0yizYJr/57DhuJ1wnY5/mziepTVr6e3R0hrsbPLyck7BrxIZO/eAi2uuwE4I3Aok5rIAtzPPbjtxQuXtgCOOtQTwkqrPvlqMmBd2vcfDGeSpfGCXrS7H96SujCnBy+oj6LComSoEoGvUA0A6EvZ8DLaO9nYsUOoSzNy57Oi4mJyBu2SpuRcj2rGvZievUsRgleBf5gk6cpabd62egFoaYtr6NFl8DaUoz96LzTAq0kDlNWppLhE2UTg9Tuf8MdG2sw4DRjQU9H7e3b/FE2vomLoU3nJjm92rYSEwoXZuX3EJvDZsWtdz/+sjGlqMJqCXx/90jzALlz4syQl5awi7aj/EwnxPfC1srJy7ti232Sb6jZHRT+VJvm909I3pjKWayxjYdODeLkO1hnC2OLC/mhQWsJO6UvInCtjHQWDB+XKK2tvF3Dq5JkvVR4t/tzwiHk6namuefunwruvEq9ft86RW4Ef9sqQcK2WXRkzYtKBgtsFGYCNHjHpt3enzd+cnpvwo8pHbKQd2Wg9M3qDhjz9tqd+O7tao2XZqP+TKf8Ga3vyzP630EdGRpY+OTnutuiv0iQDqDOxVgaaSDLpjqMuResukoXHpwTw7jT5XnQlfHBBOgPcgxIiEqu+jG4NuoYN63a4mHzio0vJvy7Blhcwa2srWW0NAFZVgh0uaTSKj0LQYFERZVmy+WP1Z2uno25vZyd/tX5FO5T79x72faoF+xm4J5m4geLOPl7PHPvl1CeyLF1T875nkpdckq7qdOwIqY4aEz35i+XEXCYJ30MXs7dnSghSzaSqMunN2n36dZsBfG7uzYt3r0vpaVm/AHbkxJ4xJYWpD80PbapK6bmnL8+dvURRJXsPbXu5W49OU6n/ItA/zEapKr4PA8fC7OVVS1EXgwe8sq9Nh4aJ6nYWdyrFmayLvQsrIwleF8n4Jk9ntlCvo00gZ6ujE6UHBujQAZw2ZY52Cv8fvj/wwahXJu6VGFdu2sh4rdTs+M6+fl7dSAI+kTS0yfkbCWEndbhJIzPdjRu3TgcGBijqbcHc6Km21iz+b7C22KTEaGxFi1slHDyLsrGgKHr5kvYCsW3btkpeynskGYSrmaQnvTufLubhyL6WDGwK0zH9ypvSKMHoQXmuoaztz0diJoHu9VfePp6el3BYeOGstVYJ0Ys/VSR81OjhPmQqKAvbg3hqZNOd9PTsZNAt/3Rhi+5dW/cmy6SzaGfv7HS817NDlUUWsFWfrU9LzkxMFfjHyadMe3MZ7HPzCwJjMnK/8JbNI6rib1GSQfxpoTT7TRs+mYzLSJJoWkTYsKqYWIIbTNzWuaZTA0iWOT4l+2zKxx99fpXCUKxXv+5hn6/akP7n5eRztbw9O5rToi7cnx5+0rWIvi/uSU4/M2BgZJ/ZAwb2KiO9HynaXLp0rIAkTZeff/tc7MFju2Qm0T7r8RPcnJa43MjL1+PtocUif8SrE2ZkpWWX0Tmbex4q5q/KNFLLO8mcHSTXRc7nRsmzSkILCOzWsJkAypLjBXE4U+mdtmSCGclC+AEbC8US0Wh+u5Jz7jraIWREYfRGuJG064n7AAvxCHHIMxorpLcac4q9lHesYjLRb06qrgtZMoVpuecqzCi0tZRg2wq4pXEiKCDwlnIRMMD9WFvrjGqrwhK9RRj5kp+bwLgS37NI8C/wgTOgSPLyV7ibxoa9Rp7kV8nrVo1E3qSjJSr/CuNlBUxHTswSZmLFkhWTtLSGUqSEjO7yXEN1DZW1FBuQrQllxzK5FVuTc5HtnnOIwlRf1X6Waa1GM24KoNGQT69SkpiGFtIyYwwrMK1jb1+9/U9bApV6/7fyxGYAwewzZ1IdiosNBvF2PzHmD8FIWfcoKPIV7ZZ7Q8rImmJGPWPpR0jqdMxEAs5IgEkWCUm6mf6YRITIOXIFUC6heCvIyguhPIR5s1PE9TYrMixlWkM9ZqRwC2jLkywKSm4tPc005KKeOxe+qb+oKhE9fAUOvLLi0ubYH6AVNpoaLU++lnWezs8/OLbw8D09GUp8HkB7wHCEEwVHjBkOxqvX7x906kgOzMvn89qZWLm7SbSXmXwnqLHLMdVmWKAq5eolSY2wtDyp8aIcFNSqekl+Uftjhy5IbduGV0tKulrCdMEGrcRupeYm/iLoLOXkMpJqe4fUN+hZHRM3keQ9Wip3IGiSEIupmLjooXwByeoUA2daCrSw4nx2Kucye86qhJUq7MUKSznt+SqSHcq0KAqY1okZxqySrlcQUIEvJ7e+RDocW2JdmR3T8K0UT2lOwk1viKQnh2oUuaIqrFt120ct4ySGwaALHDPuVb8ZM9+OxjlFOh95oGXzrsvpxk2e/jb7ERB6VL6PQw9hS79427lUqzOOGBGZj5i64IcPYUp1paHDXxzs+UH07NUCvnrVumlzZ334h0ajuZqWc+68gKtz+Bq//CSmq4kbrRL/PDbPyalGKPDJySm7n27V+wtJywozshMPqduYl4Ugw/oHDm455A8ryDjEhp3CkV+/HxEYGKC0/XDRyreXLVmVbKeyE8HTPOE0DNmONhS3Gu0f4NPTHP+gOj7JGRwx4icYzRU7kUlfSzMW9+PJJMTLS03MztqahXs1YuuK8tmAqFgp70FM74eXxpeHTvhkR3eKY2wic6K5YmRoWBE51UdI825tuV/7h8Uh1qQzFAf26vusy8zZE1eKdt6+Xl1ooovbt+795fVUXRuC03rzzyecisZBYwoCsvETRgbcupFfunrl1mwSHtIW7EpqduKF5My4VBIG9w3rt7L+g3qtggsRI3t91IvzNq7d/sKVK1drk8bOtaSZ16zc3pw0sdV332/sLYSYzofd7tdj+H/Aw1O2/S0DhX8wlWvFv7eI0jpJqs1gs33brv09ej6TT7wqFKulIbt7utalw5RKxJwO4+yCEGMDFdjILbFCkNFw6k7py0XP8qu0Fm8nl4UTcW1nY81ORHXjPaL2SZcFcxq2xNbUXsSstB0oiCbA5TkWCCMvYQbda9KotCuVkCbTQGYyNCFb3ESh72wmayOlRbePV6L5m5UAOh+sK8wNh4tzxaeLF99lY6KjunGuri7h0BZf/GfZBfhQfDyaNEnPSUgw70o5bm8yuZrDUcdSTXftYL4EaiT5tobZJqXknsq+p52e+wB28vT+cfQyPYtyxOA+nw/oPXwPyiKl5ibE+Xs06UJb9x/OJB4OdXd3aUMmkPX2XWsnNAvu8EGZJDWhZfi62izyouPDRh2v9cabr/iGt2o6UvCa9c7CqfQFo0Gy0ZyJyyg/uiZw/0SuNocelX9qbvwv8F5+suxzv6VLPo211J6EvRZWnCXL5jUb+sKAoaDBh5SYKzyT1JxzRzAvlQQZRNN+kn6Oepq3JXn8gar+JKZBRPQbffnSJ+qEpAgdCTjnt/UbGCt7jkq+lbZwVmQqGPlcaVJWhRBHPcXd6ciG29xDbOecNtIGCm3VkKJLnqiy0JfcbIvxxx7fOc7Gxkpx6G3ZEDNn1rsLEy5cOb6GIkIuPXt3eef5FwaO3LxpByNteTM9Pb7yGO7az7+fPTBR+Km2bIyZPWPa/Pi1m1b0b0FONnt7Oz/0g0Su6oLLSVd+GP/G9G9154uLtZL2lsnGPo6XFjyDB0wx33JCC/8NBoavKQKBogB8noskH89jxs5dOw78MC7h5/VkUjiSQD+1fvPKDi8+/+ZhX0/lawzl5bv70jZ1dHTQTJ0xfr5gv+/HQ4vXr/smC/GC9Ixz6QL+T+aPo5ExrvT0E/BwX7I0RoR9TSajFebgmWc7TgINjk6OG/POKVnLctKzE06SECtNK2+67nKLOipdIEEOp7jI73QKg+lKWE3aDB56N5wPuUvCpInpCazEEM7yS86wQloh7tBVXFLEbpa8REL8fjkdl2Y158NItDOp/XnZimXM/ZW3lJY+WSH2dwttRt5o+6+3r+6C4A/6Tkq6EjNp4uz44pIS05wZi94V4164ZNYSN1cXKyz54hyowFnK+0X0GJGccXpneKuwQRcvJB3YvXPfAgSX6CPVeBK2avUb1huy79COLecuHp1Dx5fgU+wCId70zapnhNdZaGPwb9mq2SgBRx45uK87p1Xgjh3NjrV0FmHm92YtnirGggfYp09XV5PRFIBNIeDGohstke/9edtrCNmifC0l/YdXXxz3Cxy76dfPVz4DC4L/sYQvkhFh+HT1h62EEP+45+dFEGJ8xp6enXhSfUsWBRkEM45KubIDe5qE+DsE9XSlNM2lbMv0YP4OxaJIzsm+ePd6DivMb8vu6GKYviyJFRq7Se/d+hq4KMa104PZLBLgDXRiRkPhbU5h7s03PNgx4J9UCvBsGqDnBh/YoO07PDUefEtLyzK7tI9Yh80dQtTr1m7JPHL4+HLg6GxB9f2Hy0M1CNtg5wx4VUnWaO1bNn12YJBfizf69hr+5Zujpqx5PnLUp43rtZvVtFHHCBFAdHFxDlu28v1w8JEljf6FIaN/FseJ8DGe4I9wvYAj37Z113XZVnsaZxUyM8+nkYJJw5Gjn386/JFos3Tl+3NQ1nMpDB/aGbmpxkfL329Wu46fcqiD7je7U9u+n0M72jr5nhDt/ldzH7fgIJOJ+0+aNjaw34AeihI6ezph7YiX3zpGk3sjI/fsWfN7q1KQQUibvNIF51kECfMysmuNlFPUjy2sHchWvhzAyXNM9aWshDTsQOmD0vrShwWKkI704vZFddkXRDuXhJgsELKYS9n7CxKkF1b8KNFr8WQS3Gw6g74JztRNeefNDwXXyeNnzSIBI88gl40GpkRyhg4aeeD69RvKQ8aSHbNrfS+Exvy8yn9OQ7Q1z2kCd+D8BDZnGdcTTqTmJCTjRKgky3nQntezc0+JNl7etRT7WqM1XcOuX9ZoKnlvBB1yrdb6CmhwqU2cjNzEs/A2vPj82Nj0tMz9oLWzt/Pfd3DbYNjntJmr06x5Ywf6ZEIRbuBHvz5lWplOp7jrnvRxZPD/byZ8IE0u3IZ16wbaTpw8Zgn6pjBiQq9uQ2Po6/SyjJwEiy/qfQW5/AYkvviyNIEEcgIFqstweou07GgXA4sZ6cxrlNP89X9MDe7sILM9JK4v60CrYyUlejZy0Z/SrL+oHr8EB7w4q7hr78ZZcLMJritXL16jXr5FGZsoQdOqTfNRM2ZNrGvU81pVfXUGWnoZlN2seqOl8PgH/dFWtm4noF07te33KX0GmIv+GjdpOIzs4SCUN2xZ9Q5lyrPbuuW7uT/tPXjLykq6bMmzAfr/pVQs3WmG8W785rMRlCkr//w50eWrKWPx9zyHuzenvZs/MItOl1a85cGvajjbpJNYdYpd97C3YkfH2fGeK0qkdDCg3x4JoI3fXknH6hMNRnFLx9igZTnSwQd28IgExw9fpO9PTVbQVOR6CkFzslvP0pI/+36scLwRp+9A88a4Vxbt2bV3WHz8hUb0uzm3yn9i4H6tVbgHmCQqykcuptBX2/6uYXFk37d4+413pn62Jvo/YPLm+Nfmt+/QZouzs5PiL066dHnrhHEz4xB8QLDnkTv6hxuQtyWAPESKXV9VV5JReyM193QWBNTXlT4Y4boaeGF9fL26og3cbF9vjsmRtdqcq9nxVX6R9NCCDKYf50jfv+3EO5gYHYbjzItATZg1OzVG5t3IFrWmjeGPpL9cCQ8HXYpGw3rQB38XUX2SCd8ilOmMrouXzAmBpgJvsnUNg/u/shBlnMC2dD7Wzy24HTaAzVuFxtSrFxhBk6fd+u1X8+rXaT2Jlcmt6ZzVHQMYPKEk0SecYEVnd/WCpZNzjZoKjII28FrgvK9tDftjly//dkfQIL+WF5dF9nDyrl37WLeYZ+b3j+g5kzaX9s2aN3kV+OLC4iud2vXfiMMqdYJdfk2NBfT/jfTc0P49unXrVKXQiVEWFhUXvT12xgHaK+jpxf3doNH7IUjWf0DPZwXNvh8OHkFZMsiKshRw8/yRBBmNl+VLZ0fb8ZayzH4krdyEnpQnudbiKRxMAbry9Y5gJwnfOzpfUpZF804fp46dOwlxvY5dnnZ64aVIRbOC39ovN8/GAW9ZsrpoSYhBU82dnczPkbpiI5iUcrK1ra2Nl2M1x7oHf/lueOd2/TeYmEnxAID2iSSDdQbZVp6ff7J214IPZ3YnnnLdunUiyNSJuMvfSC/fi8eOnepAp6EOnss5Rydc/kp0EDORfuXOZeyoqSeDmzSIQVtg8Q3K4IGvzkSZW9vd87sdgP+3Ejw05n3hFxroMgffU6f7KBs4uM8fy5euTjFKRkf6ks4FRJ61PJojL7hTePH99z5Kwsuael3R2gBbTPcMwiKVBeBkxh0KtGw7mQ/dhbeUynihvrU2sKEr2JPb1Km7h238a+ylp4zc6IRNXsdObV3JTswqKCw0kUeCNmLxiWp68zLOBpTeLm5LGydt377dXJycnazhewUd/K/YLZPmk8aOf80/LSW96Ntvf8jFRGodXA5iyRf88Es5xQZda0GbkZZVtGP77ntocaKXlRW3wQOv5ugot+vUyqluUGB18CGT5hZ+jwuOfRx0FbzVOcLQaz7Z0Q6eCsDRHzayiodCI58URwXVbR6l/Lghavw6hYGZsDr/rYSNLSKQcfS7AwiOSGWF4eJewRAmRVAD59MPOjPytwUZncAN5yyzhVacDSFlbDJIbO1qkzQXuP9Gql+/bTXj7WLbUq1t4V3H+kN3q5zWOnq5Jn05Jdm6GvMTExPJnC9PCDgYC2/X1Mp6o38j1xv3m0Q1LT5wu985DghlzGcxdqUaKzvSRpLJXtaFhdUpND8mLsZhKQcPuhSTxRL+UWFCkM3bPexZC/N2/9b/nYF/Z+AxZuD/AA8zEhkTLyOGAAAAAElFTkSuQmCC');
}


	/* layers control */

.l7-control-layers {
	-webkit-box-shadow: 0 1px 8px rgba(0,0,0,0.4);
	        box-shadow: 0 1px 8px rgba(0,0,0,0.4);
	background: #fff;
	border-radius: 2px;
	}
.l7-control-layers-toggle {
	background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAkCAYAAAGf7Ah0AAAABGdBTUEAALGPC/xhBQAABzdJREFUWAnVV3lslEUUn/l2F0tpwdAih1HEqCReDcphNCo1EkgFkXa5PNpuC0Fo2e7Wgko8KiaKWrvbK5672xYFpNtiRRuNiY0aURA14BGviBcVlaKltVa6+42/N9v5Mrtt05rwj/PHzjt+8743b+a9N8vYwKgMNlUQyemnMtAkaJajvb3dToQSGp8e6boopkr4VYgEMYwO0vhCTfMVzBcMf8bx086YyODcuM80zTqp9IWat+7evW8sMdIxIqqCLa6oiAaJpuEtcBqcc2HEWMZ0JclgZR/Nchf++ubrzKjJSguXS4tVjXvPjfb3/UAAacGTn/MOMb7QnjNpNqP/bKZ50Ai0tqYmCi0n4zbM+W+lBc7JBOa+QPhDwcTsxJXE2+32edKCL9h8hRDmRzpIOWydAylhrcMfDN+ugBRKSdP3KwPhsFJIPth02FISIYQwYsDYcVfWhy/Bon4JgumffMGmiGTwQ0B/sHml4q2ZFAD3WQIQVhx0IdFw8B189lolN+w8w5PnjPmlhJgtA8/vfn3iye7u3yGzDljDxZEG4097Cp3rSSjBtMHunp6vFR+HHoIxmbgTe1xHKssDHecLNFUjMzbqMs5ZlHF7ute17M84+TMHDzr+OvR9JwKdCms9yRkzJq6bPTsWXh05QOPUN+PUHyPWMPhm6UHd7vaUohWZPSRE8OqxpTyibQa/qcTlbEP0vwF7AWUAT3JM9dy69FfSNza+MU4awNE8iQtXSkJuGLleV852ov2h5jkwVof0mUs8aO4LhTuYYFOAjExId0wcFIPahpaLTkWiX9ECfHG/sLNi1i8+HODfgLFFRI96+INNi0cNTgTS1obKQh03aAuk9DeELzcj4pACYivvwvXrFK/PcQZiQWo+hmidpYMUjQC7EOB6xdNsGfAHwk/RDdOVw9Dm+NTUSWtWLDohDVQ37JkbiUT2DwMeVswZP+gtdM4x3HnLDhjcGM2XLWOISaenIGee9MCSgqgMht/H/q/SZYk0qviV3oKcj5XcioESyOoqIseFYDYloxnAGm/hcrcuk3JV2XBMl+pKqn6mENux11+w12m6jpqMMFn7rPPTHdwfCm8yTfG4tMaNu+GepPUFiqbM7T105ARSPQU+dY/LOC/N2gI65WEkyWUEtjmSppfkLvlRLaQ5VnZFDtGGzbheNRROKZmbu/AvUvh3tE4Wff2/0IUC+y2q+4VVoXBW1BSvkR7Rb8BW84lWJQBdlGozcs7GLy3Nd35OSqTxBqtfgkc1+sPjcqbDgEl6xK0dH5lv545LOCVL1/F+3CoY4eyY1+WcBiC2KYEHQBd5XDkyndE17xCm2Ug6BLcSwb3LigE1AlOYu6TS4HUwVEw0Df1osfBnLDwnpiFDCQPuvQ73Fkqxg8/hEVYLXt66MXbbzOK8bKre1hhkgDT0RDja3fEHytwZxCMLH0YWPkD0fxqjqUZDejDSV3z1LbexqPkEPJxKWLqtKOGbvPnZL460NlE/KgfkIZiRrfjShsQcG2QQDUwwXjcuZcID61Ys6ErUJ/LDOiCfLUzUjVQdEg0O4jn/ABEq0iuIjrEcwE0x/KGWNbjPj4BO00Gni0ZOoIPzLR5X9vMqqaQDqDzzENra4V5zp8sBZQcROYjsLvYUOPdbEVBKeiZ193QjCmwtZCM+ldS6EWYTH3wuNSV1i+pFCj/IAaWgGUfBq0N78qPM3DZcp9TxcTQeyzZm3ON2LatXpSlOP8BIB6qDLddHmHnFrBlpNZmZmdZbNXEB9XsRlZXFennqGHzoXW5DaId4iSoc/Q365EjnRjszPnYXZL9NDWUtGsqzCjAw7xprTypbn7fkaILcYqkInzzeX06C8emO8sKlS7stZQLxVMPes/+O9FVAvEpXob+utY6gZmfrtMjf/RUI+2odhF7wJbq+Gzf3zTj5CAwyaoEwozVoCzN1KKK00z7WUbZx9dIOklsO6CAZpu87i5gpHoJ8gtLh9vZixSO2KckV7qysf5Sc5uq2tjOix3rL0FW3IJuSNV0XM/iDs85LqxvqeKUD8n3LxUobt5WVuLJlS9IM4O9i09VRwWtxLWfpcix+hXjs8mZdjn19YuOiuKRgufzXqOuqQi2r8O+yAk/tl2Q/RMW7ETe8UdX1GJhHDM5qjDHJ5e7bs07qBp7ZsTe9t6/vUXykkLKEdLFbLgLJSUn3rrt1yXEdX/1C23jzVG+5Keg/B5r2wJD9g/NcaUAJq4MvXxxl/TWoATcoGc0Av4eUKnIXZlsvXpLHO0CS2KgOtGQgdeuwqWuUjGbUgrdszLHRXXDLF0oe54AS0kyPnc5Iz/2CmV7EeIzSwcjvsHQPXkUhld/kCP6Xu+DRNjg/SWHh+SnODF+aPeVh9XCydAPEsA4kAqsCzcuiTPiw7+maTj6SwGsVk/9gY9xbUpizR8MNS47aAd0C7s35CG8VdrxYyjl/FcdUgo73nY77X9D/Au9RDMh+aBoVAAAAAElFTkSuQmCC');
	width: 30px;
  height: 30px;
  background-size: 20px 20px;
	}

.l7-touch .l7-control-layers-toggle {
	width: 44px;
	height: 44px;
	}
.l7-control-layers .l7-control-layers-list,
.l7-control-layers-expanded .l7-control-layers-toggle {
	display: none;
	}
.l7-control-layers-expanded .l7-control-layers-list {
	display: block;
	position: relative;
	}
.l7-control-layers-expanded {
	padding: 6px 10px 6px 6px;
	color: #59626B;
	background: #fff;
	}
.l7-control-layers-scrollbar {
	overflow-y: scroll;
	overflow-x: hidden;
	padding-right: 5px;
	}
.l7-control-layers-selector {
	margin-top: 2px;
	position: relative;
	top: 1px;
	}
.l7-control-layers label {
  display: block;
  padding: 8px;
  }
  .l7-control-layers label input[type="radio"],
  .l7-control-layers label input[type="checkbox"] {
  width: 14px;
  height: 14px;
  margin: 0;
}
.l7-control-layers-separator {
	height: 0;
	border-top: 1px solid #D8D8D8;
	margin: 5px -10px 5px -6px;
}
.mapboxgl-ctrl-logo {
  display: none !important;
 }
 .amap-logo{
  display: none !important;
 }


`)},kPKH:function(ze,E,o){"use strict";var b=o("/kpp");E.a=b.a},"kQ+U":function(ze,E,o){"use strict";o.d(E,"a",function(){return xt});var b=o("lSNA"),m=o.n(b),Y=o("lwsE"),F=o.n(Y),i=o("W8MJ"),Z=o.n(i),D=o("k5/I"),$=o("h1nZ"),te=o("o0o1"),fe=o.n(te),K=o("yXPU"),Ge=o.n(K),pe=o("4cb6"),Ze=o("fbvF"),Pe=o.n(Ze),mt=function(){function bt(Et,Fe){F()(this,bt),this.attribute=void 0,this.buffer=void 0;var pt=Fe.buffer,yt=Fe.offset,Ht=Fe.stride,hr=Fe.normalized,Hr=Fe.size,gr=Fe.divisor;this.buffer=pt,this.attribute={buffer:pt.get(),offset:yt||0,stride:Ht||0,normalized:hr||!1,divisor:gr||0},Hr&&(this.attribute.size=Hr)}return Z()(bt,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(Fe){this.buffer.subData(Fe)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),bt}(),De,At,it,vt,Je,_t,wt,ke,Re,Ve,dt,Me,ht,Zt,Qt=(De={},m()(De,$.gl.POINTS,"points"),m()(De,$.gl.LINES,"lines"),m()(De,$.gl.LINE_LOOP,"line loop"),m()(De,$.gl.LINE_STRIP,"line strip"),m()(De,$.gl.TRIANGLES,"triangles"),m()(De,$.gl.TRIANGLE_FAN,"triangle fan"),m()(De,$.gl.TRIANGLE_STRIP,"triangle strip"),De),ur=(At={},m()(At,$.gl.STATIC_DRAW,"static"),m()(At,$.gl.DYNAMIC_DRAW,"dynamic"),m()(At,$.gl.STREAM_DRAW,"stream"),At),oe=(it={},m()(it,$.gl.BYTE,"int8"),m()(it,$.gl.UNSIGNED_INT,"int16"),m()(it,$.gl.INT,"int32"),m()(it,$.gl.UNSIGNED_BYTE,"uint8"),m()(it,$.gl.UNSIGNED_SHORT,"uint16"),m()(it,$.gl.UNSIGNED_INT,"uint32"),m()(it,$.gl.FLOAT,"float"),it),Q=(vt={},m()(vt,$.gl.ALPHA,"alpha"),m()(vt,$.gl.LUMINANCE,"luminance"),m()(vt,$.gl.LUMINANCE_ALPHA,"luminance alpha"),m()(vt,$.gl.RGB,"rgb"),m()(vt,$.gl.RGBA,"rgba"),m()(vt,$.gl.RGBA4,"rgba4"),m()(vt,$.gl.RGB5_A1,"rgb5 a1"),m()(vt,$.gl.RGB565,"rgb565"),m()(vt,$.gl.DEPTH_COMPONENT,"depth"),m()(vt,$.gl.DEPTH_STENCIL,"depth stencil"),vt),H=(Je={},m()(Je,$.gl.DONT_CARE,"dont care"),m()(Je,$.gl.NICEST,"nice"),m()(Je,$.gl.FASTEST,"fast"),Je),Se=(_t={},m()(_t,$.gl.NEAREST,"nearest"),m()(_t,$.gl.LINEAR,"linear"),m()(_t,$.gl.LINEAR_MIPMAP_LINEAR,"mipmap"),m()(_t,$.gl.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),m()(_t,$.gl.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),m()(_t,$.gl.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),_t),be=(wt={},m()(wt,$.gl.REPEAT,"repeat"),m()(wt,$.gl.CLAMP_TO_EDGE,"clamp"),m()(wt,$.gl.MIRRORED_REPEAT,"mirror"),wt),Te=(ke={},m()(ke,$.gl.NONE,"none"),m()(ke,$.gl.BROWSER_DEFAULT_WEBGL,"browser"),ke),me=(Re={},m()(Re,$.gl.NEVER,"never"),m()(Re,$.gl.ALWAYS,"always"),m()(Re,$.gl.LESS,"less"),m()(Re,$.gl.LEQUAL,"lequal"),m()(Re,$.gl.GREATER,"greater"),m()(Re,$.gl.GEQUAL,"gequal"),m()(Re,$.gl.EQUAL,"equal"),m()(Re,$.gl.NOTEQUAL,"notequal"),Re),nt=(Ve={},m()(Ve,$.gl.FUNC_ADD,"add"),m()(Ve,$.gl.MIN_EXT,"min"),m()(Ve,$.gl.MAX_EXT,"max"),m()(Ve,$.gl.FUNC_SUBTRACT,"subtract"),m()(Ve,$.gl.FUNC_REVERSE_SUBTRACT,"reverse subtract"),Ve),Jt=(dt={},m()(dt,$.gl.ZERO,"zero"),m()(dt,$.gl.ONE,"one"),m()(dt,$.gl.SRC_COLOR,"src color"),m()(dt,$.gl.ONE_MINUS_SRC_COLOR,"one minus src color"),m()(dt,$.gl.SRC_ALPHA,"src alpha"),m()(dt,$.gl.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),m()(dt,$.gl.DST_COLOR,"dst color"),m()(dt,$.gl.ONE_MINUS_DST_COLOR,"one minus dst color"),m()(dt,$.gl.DST_ALPHA,"dst alpha"),m()(dt,$.gl.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),m()(dt,$.gl.CONSTANT_COLOR,"constant color"),m()(dt,$.gl.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),m()(dt,$.gl.CONSTANT_ALPHA,"constant alpha"),m()(dt,$.gl.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),m()(dt,$.gl.SRC_ALPHA_SATURATE,"src alpha saturate"),dt),Mt=(Me={},m()(Me,$.gl.NEVER,"never"),m()(Me,$.gl.ALWAYS,"always"),m()(Me,$.gl.LESS,"less"),m()(Me,$.gl.LEQUAL,"lequal"),m()(Me,$.gl.GREATER,"greater"),m()(Me,$.gl.GEQUAL,"gequal"),m()(Me,$.gl.EQUAL,"equal"),m()(Me,$.gl.NOTEQUAL,"notequal"),Me),ve=(ht={},m()(ht,$.gl.ZERO,"zero"),m()(ht,$.gl.KEEP,"keep"),m()(ht,$.gl.REPLACE,"replace"),m()(ht,$.gl.INVERT,"invert"),m()(ht,$.gl.INCR,"increment"),m()(ht,$.gl.DECR,"decrement"),m()(ht,$.gl.INCR_WRAP,"increment wrap"),m()(ht,$.gl.DECR_WRAP,"decrement wrap"),ht),ge=(Zt={},m()(Zt,$.gl.FRONT,"front"),m()(Zt,$.gl.BACK,"back"),Zt),He=function(){function bt(Et,Fe){F()(this,bt),this.buffer=void 0;var pt=Fe.data,yt=Fe.usage,Ht=Fe.type;this.buffer=Et.buffer({data:pt,usage:ur[yt||$.gl.STATIC_DRAW],type:oe[Ht||$.gl.UNSIGNED_BYTE]})}return Z()(bt,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(Fe){var pt=Fe.data,yt=Fe.offset;this.buffer.subdata(pt,yt)}}]),bt}(),ot=function(){function bt(Et,Fe){F()(this,bt),this.elements=void 0;var pt=Fe.data,yt=Fe.usage,Ht=Fe.type,hr=Fe.count;this.elements=Et.elements({data:pt,usage:ur[yt||$.gl.STATIC_DRAW],type:oe[Ht||$.gl.UNSIGNED_BYTE],count:hr})}return Z()(bt,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(Fe){var pt=Fe.data;this.elements.subdata(pt)}},{key:"destroy",value:function(){}}]),bt}(),we=function(){function bt(Et,Fe){F()(this,bt),this.framebuffer=void 0;var pt=Fe.width,yt=Fe.height,Ht=Fe.color,hr=Fe.colors,Hr=Fe.depth,gr=Fe.stencil,Bn={width:pt,height:yt};Array.isArray(hr)&&(Bn.colors=hr.map(function(zn){return zn.get()})),Ht&&typeof Ht!="boolean"&&(Bn.color=Ht.get()),this.framebuffer=Et.framebuffer(Bn)}return Z()(bt,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(Fe){var pt=Fe.width,yt=Fe.height;this.framebuffer.resize(pt,yt)}}]),bt}(),gt=o("cDf5"),C=o.n(gt),R=o("c6wG"),q=o.n(R),ce=o("YO3V"),We=o.n(ce);function qe(bt,Et){var Fe=Object.keys(bt);if(Object.getOwnPropertySymbols){var pt=Object.getOwnPropertySymbols(bt);Et&&(pt=pt.filter(function(yt){return Object.getOwnPropertyDescriptor(bt,yt).enumerable})),Fe.push.apply(Fe,pt)}return Fe}function Tt(bt){for(var Et=1;Et<arguments.length;Et++){var Fe=arguments[Et]!=null?arguments[Et]:{};Et%2?qe(Object(Fe),!0).forEach(function(pt){m()(bt,pt,Fe[pt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(bt,Object.getOwnPropertyDescriptors(Fe)):qe(Object(Fe)).forEach(function(pt){Object.defineProperty(bt,pt,Object.getOwnPropertyDescriptor(Fe,pt))})}return bt}var at=function(){function bt(Et,Fe){F()(this,bt),this.reGl=void 0,this.destroyed=!1,this.drawCommand=void 0,this.drawParams=void 0,this.options=void 0,this.uniforms={},this.reGl=Et;var pt=Fe.vs,yt=Fe.fs,Ht=Fe.attributes,hr=Fe.uniforms,Hr=Fe.primitive,gr=Fe.count,Bn=Fe.elements,zn=Fe.depth,oa=Fe.blend,$n=Fe.stencil,Yn=Fe.cull,On=Fe.instances,U={};this.options=Fe,hr&&(this.uniforms=this.extractUniforms(hr),Object.keys(hr).forEach(function(xe){U[xe]=Et.prop(xe)}));var W={};Object.keys(Ht).forEach(function(xe){W[xe]=Ht[xe].get()});var le={attributes:W,frag:yt,uniforms:U,vert:pt,primitive:Qt[Hr===void 0?$.gl.TRIANGLES:Hr]};On&&(le.instances=On),gr&&(le.count=gr),Bn&&(le.elements=Bn.get()),this.initDepthDrawParams({depth:zn},le),this.initBlendDrawParams({blend:oa},le),this.initStencilDrawParams({stencil:$n},le),this.initCullDrawParams({cull:Yn},le),this.drawCommand=Et(le),this.drawParams=le}return Z()(bt,[{key:"addUniforms",value:function(Fe){this.uniforms=Tt(Tt({},this.uniforms),this.extractUniforms(Fe))}},{key:"draw",value:function(Fe){if(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)return;var pt=Tt(Tt({},this.uniforms),this.extractUniforms(Fe.uniforms||{})),yt={};Object.keys(pt).forEach(function(Ht){var hr=C()(pt[Ht]);hr==="boolean"||hr==="number"||Array.isArray(pt[Ht])||pt[Ht].BYTES_PER_ELEMENT?yt[Ht]=pt[Ht]:yt[Ht]=pt[Ht].get()}),this.drawCommand(yt)}},{key:"destroy",value:function(){this.drawParams.elements.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(Fe){Fe.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(Fe,pt){var yt=Fe.depth;yt&&(pt.depth={enable:yt.enable===void 0?!0:!!yt.enable,mask:yt.mask===void 0?!0:!!yt.mask,func:me[yt.func||$.gl.LESS],range:yt.range||[0,1]})}},{key:"initBlendDrawParams",value:function(Fe,pt){var yt=Fe.blend;if(yt){var Ht=yt.enable,hr=yt.func,Hr=yt.equation,gr=yt.color,Bn=gr===void 0?[0,0,0,0]:gr;pt.blend={enable:!!Ht,func:{srcRGB:Jt[hr&&hr.srcRGB||$.gl.SRC_ALPHA],srcAlpha:Jt[hr&&hr.srcAlpha||$.gl.SRC_ALPHA],dstRGB:Jt[hr&&hr.dstRGB||$.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:Jt[hr&&hr.dstAlpha||$.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:nt[Hr&&Hr.rgb||$.gl.FUNC_ADD],alpha:nt[Hr&&Hr.alpha||$.gl.FUNC_ADD]},color:Bn}}}},{key:"initStencilDrawParams",value:function(Fe,pt){var yt=Fe.stencil;if(yt){var Ht=yt.enable,hr=yt.mask,Hr=hr===void 0?-1:hr,gr=yt.func,Bn=gr===void 0?{cmp:$.gl.ALWAYS,ref:0,mask:-1}:gr,zn=yt.opFront,oa=zn===void 0?{fail:$.gl.KEEP,zfail:$.gl.KEEP,zpass:$.gl.KEEP}:zn,$n=yt.opBack,Yn=$n===void 0?{fail:$.gl.KEEP,zfail:$.gl.KEEP,zpass:$.gl.KEEP}:$n;pt.stencil={enable:!!Ht,mask:Hr,func:Tt(Tt({},Bn),{},{cmp:Mt[Bn.cmp]}),opFront:{fail:ve[oa.fail],zfail:ve[oa.zfail],zpass:ve[oa.zpass]},opBack:{fail:ve[Yn.fail],zfail:ve[Yn.zfail],zpass:ve[Yn.zpass]}}}}},{key:"initCullDrawParams",value:function(Fe,pt){var yt=Fe.cull;if(yt){var Ht=yt.enable,hr=yt.face,Hr=hr===void 0?$.gl.BACK:hr;pt.cull={enable:!!Ht,face:ge[Hr]}}}},{key:"extractUniforms",value:function(Fe){var pt=this,yt={};return Object.keys(Fe).forEach(function(Ht){pt.extractUniformsRecursively(Ht,Fe[Ht],yt,"")}),yt}},{key:"extractUniformsRecursively",value:function(Fe,pt,yt,Ht){var hr=this;if(pt===null||typeof pt=="number"||typeof pt=="boolean"||Array.isArray(pt)&&typeof pt[0]=="number"||q()(pt)||pt===""||"resize"in pt){yt["".concat(Ht&&Ht+".").concat(Fe)]=pt;return}We()(pt)&&Object.keys(pt).forEach(function(Hr){hr.extractUniformsRecursively(Hr,pt[Hr],yt,"".concat(Ht&&Ht+".").concat(Fe))}),Array.isArray(pt)&&pt.forEach(function(Hr,gr){Object.keys(Hr).forEach(function(Bn){hr.extractUniformsRecursively(Bn,Hr[Bn],yt,"".concat(Ht&&Ht+".").concat(Fe,"[").concat(gr,"]"))})})}}]),bt}(),Ut=function(){function bt(Et,Fe){F()(this,bt),this.texture=void 0,this.width=void 0,this.height=void 0;var pt=Fe.data,yt=Fe.type,Ht=yt===void 0?$.gl.UNSIGNED_BYTE:yt,hr=Fe.width,Hr=Fe.height,gr=Fe.flipY,Bn=gr===void 0?!1:gr,zn=Fe.format,oa=zn===void 0?$.gl.RGBA:zn,$n=Fe.mipmap,Yn=$n===void 0?!1:$n,On=Fe.wrapS,U=On===void 0?$.gl.CLAMP_TO_EDGE:On,W=Fe.wrapT,le=W===void 0?$.gl.CLAMP_TO_EDGE:W,xe=Fe.aniso,st=xe===void 0?0:xe,Ct=Fe.alignment,Bt=Ct===void 0?1:Ct,Xe=Fe.premultiplyAlpha,Lt=Xe===void 0?!1:Xe,lr=Fe.mag,zr=lr===void 0?$.gl.NEAREST:lr,Vr=Fe.min,cr=Vr===void 0?$.gl.NEAREST:Vr,Ur=Fe.colorSpace,Mn=Ur===void 0?$.gl.BROWSER_DEFAULT_WEBGL:Ur;this.width=hr,this.height=Hr;var ln={width:hr,height:Hr,type:oe[Ht],format:Q[oa],wrapS:be[U],wrapT:be[le],mag:Se[zr],min:Se[cr],alignment:Bt,flipY:Bn,colorSpace:Te[Mn],premultiplyAlpha:Lt,aniso:st};pt&&(ln.data=pt),typeof Yn=="number"?ln.mipmap=H[Yn]:typeof Yn=="boolean"&&(ln.mipmap=Yn),this.texture=Et.texture(ln)}return Z()(bt,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var Fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(Fe)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(Fe){var pt=Fe.width,yt=Fe.height;this.texture.resize(pt,yt),this.width=pt,this.height=yt}},{key:"destroy",value:function(){this.texture.destroy()}}]),bt}(),J,Qe,ne,et=(J=Object(pe.injectable)(),J(Qe=(ne=function(){function bt(){var Et=this;F()(this,bt),this.gl=void 0,this.$container=void 0,this.canvas=void 0,this.width=void 0,this.height=void 0,this.isDirty=void 0,this.createModel=function(Fe){return new at(Et.gl,Fe)},this.createAttribute=function(Fe){return new mt(Et.gl,Fe)},this.createBuffer=function(Fe){return new He(Et.gl,Fe)},this.createElements=function(Fe){return new ot(Et.gl,Fe)},this.createTexture2D=function(Fe){return new Ut(Et.gl,Fe)},this.createFramebuffer=function(Fe){return new we(Et.gl,Fe)},this.useFramebuffer=function(Fe,pt){Et.gl({framebuffer:Fe?Fe.get():null})(pt)},this.clear=function(Fe){var pt=Fe.color,yt=Fe.depth,Ht=Fe.stencil,hr=Fe.framebuffer,Hr=hr===void 0?null:hr,gr={color:pt,depth:yt,stencil:Ht};gr.framebuffer=Hr===null?Hr:Hr.get(),Et.gl.clear(gr)},this.viewport=function(Fe){var pt=Fe.x,yt=Fe.y,Ht=Fe.width,hr=Fe.height;Et.gl._gl.viewport(pt,yt,Ht,hr),Et.width=Ht,Et.height=hr,Et.gl._refresh()},this.readPixels=function(Fe){var pt=Fe.framebuffer,yt=Fe.x,Ht=Fe.y,hr=Fe.width,Hr=Fe.height,gr={x:yt,y:Ht,width:hr,height:Hr};return pt&&(gr.framebuffer=pt.get()),Et.gl.read(gr)},this.getViewportSize=function(){return{width:Et.gl._gl.drawingBufferWidth,height:Et.gl._gl.drawingBufferHeight}},this.getContainer=function(){var Fe;return(Fe=Et.canvas)===null||Fe===void 0?void 0:Fe.parentElement},this.getCanvas=function(){return Et.canvas},this.getGLContext=function(){return Et.gl._gl},this.destroy=function(){Et.gl.destroy()}}return Z()(bt,[{key:"init",value:function(){var Et=Ge()(fe.a.mark(function pt(yt,Ht){var hr=this;return fe.a.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return this.canvas=yt,gr.next=3,new Promise(function(Bn,zn){Pe()({canvas:hr.canvas,attributes:{alpha:!0,antialias:Ht.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:Ht.preserveDrawingBuffer},extensions:["OES_element_index_uint","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function($n,Yn){($n||!Yn)&&zn($n),Bn(Yn)}})});case 3:this.gl=gr.sent;case 4:case"end":return gr.stop()}},pt,this)}));function Fe(pt,yt){return Et.apply(this,arguments)}return Fe}()},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var Fe=this.getGLContext();Fe.disable(Fe.CULL_FACE)}},{key:"setDirty",value:function(Fe){this.isDirty=Fe}},{key:"getDirty",value:function(){return this.isDirty}}]),bt}(),ne))||Qe),kt=o("Hel2");function dr(bt,Et){var Fe=Object.keys(bt);if(Object.getOwnPropertySymbols){var pt=Object.getOwnPropertySymbols(bt);Et&&(pt=pt.filter(function(yt){return Object.getOwnPropertyDescriptor(bt,yt).enumerable})),Fe.push.apply(Fe,pt)}return Fe}function Ye(bt){for(var Et=1;Et<arguments.length;Et++){var Fe=arguments[Et]!=null?arguments[Et]:{};Et%2?dr(Object(Fe),!0).forEach(function(pt){m()(bt,pt,Fe[pt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(bt,Object.getOwnPropertyDescriptors(Fe)):dr(Object(Fe)).forEach(function(pt){Object.defineProperty(bt,pt,Object.getOwnPropertyDescriptor(Fe,pt))})}return bt}var xt=function(){function bt(Et){F()(this,bt),this.sceneService=void 0,this.mapService=void 0,this.controlService=void 0,this.layerService=void 0,this.iconService=void 0,this.markerService=void 0,this.popupService=void 0,this.fontService=void 0,this.interactionService=void 0,this.container=void 0;var Fe=Et.id,pt=Et.map,yt=Object($.createSceneContainer)();this.container=yt,pt.setContainer(yt,Fe),yt.bind($.TYPES.IRendererService).to(et).inSingletonScope(),this.sceneService=yt.get($.TYPES.ISceneService),this.mapService=yt.get($.TYPES.IMapService),this.iconService=yt.get($.TYPES.IIconService),this.fontService=yt.get($.TYPES.IFontService),this.controlService=yt.get($.TYPES.IControlService),this.layerService=yt.get($.TYPES.ILayerService),this.markerService=yt.get($.TYPES.IMarkerService),this.interactionService=yt.get($.TYPES.IInteractionService),this.popupService=yt.get($.TYPES.IPopupService),this.initComponent(Fe),this.sceneService.init(Et),this.initControl()}return Z()(bt,[{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(Fe){return this.sceneService.exportPng(Fe)}},{key:"exportMap",value:function(Fe){return this.sceneService.exportPng(Fe)}},{key:"registerRenderService",value:function(Fe){var pt=this;if(this.sceneService.loaded){var yt=new Fe(this);yt.init()}else this.on("loaded",function(){var Ht=new Fe(pt);Ht.init()})}},{key:"addLayer",value:function(Fe){var pt=Object($.createLayerContainer)(this.container);Fe.setContainer(pt),this.sceneService.addLayer(Fe)}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(Fe){return this.layerService.getLayer(Fe)}},{key:"getLayerByName",value:function(Fe){return this.layerService.getLayerByName(Fe)}},{key:"removeLayer",value:function(Fe){this.layerService.remove(Fe)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"addImage",value:function(Fe,pt){this.iconService.addImage(Fe,pt)}},{key:"hasImage",value:function(Fe){return this.iconService.hasImage(Fe)}},{key:"removeImage",value:function(Fe){this.iconService.removeImage(Fe)}},{key:"addIconFontGlyphs",value:function(Fe,pt){this.fontService.addIconGlyphs(pt)}},{key:"addControl",value:function(Fe){this.controlService.addControl(Fe,this.container)}},{key:"removeControl",value:function(Fe){this.controlService.removeControl(Fe)}},{key:"getControlByName",value:function(Fe){return this.controlService.getControlByName(Fe)}},{key:"addMarker",value:function(Fe){this.markerService.addMarker(Fe)}},{key:"addMarkerLayer",value:function(Fe){this.markerService.addMarkerLayer(Fe)}},{key:"removeMarkerLayer",value:function(Fe){this.markerService.removeMarkerLayer(Fe)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(Fe){this.popupService.addPopup(Fe)}},{key:"on",value:function(Fe,pt){$.SceneEventList.indexOf(Fe)===-1?this.mapService.on(Fe,pt):this.sceneService.on(Fe,pt)}},{key:"off",value:function(Fe,pt){$.SceneEventList.indexOf(Fe)===-1?this.mapService.off(Fe,pt):this.sceneService.off(Fe,pt)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(){return this.mapService.getCenter()}},{key:"setCenter",value:function(Fe){return this.mapService.setCenter(Fe)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(Fe){return this.mapService.setPitch(Fe)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(Fe){this.mapService.setRotation(Fe)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(Fe){this.mapService.panTo(Fe)}},{key:"panBy",value:function(Fe){this.mapService.panBy(Fe)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(Fe){this.mapService.setZoom(Fe)}},{key:"fitBounds",value:function(Fe,pt){var yt=this.sceneService.getSceneConfig(),Ht=yt.fitBoundsOptions,hr=yt.animate;this.mapService.fitBounds(Fe,pt||Ye(Ye({},Ht),{},{animate:hr}))}},{key:"setZoomAndCenter",value:function(Fe,pt){this.mapService.setZoomAndCenter(Fe,pt)}},{key:"setMapStyle",value:function(Fe){this.mapService.setMapStyle(Fe)}},{key:"setMapStatus",value:function(Fe){this.mapService.setMapStatus(Fe)}},{key:"pixelToLngLat",value:function(Fe){return this.mapService.pixelToLngLat(Fe)}},{key:"lngLatToPixel",value:function(Fe){return this.mapService.lngLatToPixel(Fe)}},{key:"containerToLngLat",value:function(Fe){return this.mapService.containerToLngLat(Fe)}},{key:"lngLatToContainer",value:function(Fe){return this.mapService.lngLatToContainer(Fe)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(Fe,pt){this.container.bind($.TYPES.IPostProcessingPass).to(Fe).whenTargetNamed(pt)}},{key:"initComponent",value:function(Fe){this.controlService.init({container:kt.a.getContainer(Fe)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var Fe=this.sceneService.getSceneConfig(),pt=Fe.logoVisible,yt=Fe.logoPosition;pt&&this.addControl(new D.b({position:yt}))}},{key:"map",get:function(){return this.mapService.map}}]),bt}()},l94r:function(ze,E,o){"use strict";o.d(E,"a",function(){return Q});var b=o("lSNA"),m=o.n(b),Y=o("lwsE"),F=o.n(Y),i=o("W8MJ"),Z=o.n(i),D=o("7W2i"),$=o.n(D),te=o("a1gu"),fe=o.n(te),K=o("Nsbk"),Ge=o.n(K),pe=o("4qC0"),Ze=o.n(pe),Pe=o("lSCD"),mt=o.n(Pe),De=o("BkRI"),At=o.n(De),it=o("xp6e"),vt=o("Hel2"),Je=o("uhBA"),_t=o("rlAn"),wt=o("qxNg");function ke(H){if(H.length===0)throw new Error("max requires at least one data point");for(var Se=H[0],be=1;be<H.length;be++)H[be]>Se&&(Se=H[be]);return Se}function Re(H){if(H.length===0)throw new Error("min requires at least one data point");for(var Se=H[0],be=1;be<H.length;be++)H[be]<Se&&(Se=H[be]);return Se}function Ve(H){if(H.length===0)return 0;for(var Se=H[0],be=0,Te,me=1;me<H.length;me++)Te=Se+H[me]*1,Math.abs(Se)>=Math.abs(H[me])?be+=Se-Te+H[me]:be+=H[me]-Te+Se,Se=Te;return Se+be*1}function dt(H){if(H.length===0)throw new Error("mean requires at least one data point");return Ve(H)/H.length}var Me={min:Re,max:ke,mean:dt,sum:Ve};function ht(H,Se){return H.map(function(be){return be[Se]*1})}function Zt(H,Se){var be=Object.keys(H);if(Object.getOwnPropertySymbols){var Te=Object.getOwnPropertySymbols(H);Se&&(Te=Te.filter(function(me){return Object.getOwnPropertyDescriptor(H,me).enumerable})),be.push.apply(be,Te)}return be}function Qt(H){for(var Se=1;Se<arguments.length;Se++){var be=arguments[Se]!=null?arguments[Se]:{};Se%2?Zt(Object(be),!0).forEach(function(Te){m()(H,Te,be[Te])}):Object.getOwnPropertyDescriptors?Object.defineProperties(H,Object.getOwnPropertyDescriptors(be)):Zt(Object(be)).forEach(function(Te){Object.defineProperty(H,Te,Object.getOwnPropertyDescriptor(be,Te))})}return H}function ur(H){var Se=oe();return function(){var Te=Ge()(H),me;if(Se){var nt=Ge()(this).constructor;me=Reflect.construct(Te,arguments,nt)}else me=Te.apply(this,arguments);return fe()(this,me)}}function oe(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(H){return!1}}var Q=function(H){$()(be,H);var Se=ur(be);function be(Te,me){var nt;return F()(this,be),nt=Se.call(this),nt.data=void 0,nt.extent=void 0,nt.hooks={init:new it.c},nt.parser={type:"geojson"},nt.transforms=[],nt.cluster=!1,nt.clusterOptions={enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"},nt.originData=void 0,nt.rawData=void 0,nt.clusterIndex=void 0,nt.originData=Te,nt.initCfg(me),nt.hooks.init.tap("parser",function(){nt.excuteParser()}),nt.hooks.init.tap("cluster",function(){nt.initCluster()}),nt.hooks.init.tap("transform",function(){nt.executeTrans()}),nt.init(),nt}return Z()(be,[{key:"setData",value:function(me,nt){this.rawData=me,this.originData=me,this.initCfg(nt),this.init(),this.emit("update")}},{key:"getClusters",value:function(me){return this.clusterIndex.getClusters(this.extent,me)}},{key:"getClustersLeaves",value:function(me){return this.clusterIndex.getLeaves(me,Infinity)}},{key:"updateClusterData",value:function(me){var nt=this,Jt=this.clusterOptions,Mt=Jt.method,ve=Mt===void 0?"sum":Mt,ge=Jt.field,He=Object(vt.r)(Object(vt.h)(this.extent),2),ot=this.clusterIndex.getClusters(He[0].concat(He[1]),Math.floor(me));this.clusterOptions.zoom=me,ot.forEach(function(we){we.id||(we.properties.point_count=1)}),(ge||mt()(ve))&&(ot=ot.map(function(we){var gt=we.id;if(gt){var C=nt.clusterIndex.getLeaves(gt,Infinity),R=C.map(function(We){return We.properties}),q;if(Ze()(ve)&&ge){var ce=ht(R,ge);q=Me[ve](ce)}mt()(ve)&&(q=ve(R)),we.properties.stat=q}else we.properties.point_count=1;return we})),this.data=Object(_t.getParser)("geojson")({type:"FeatureCollection",features:ot}),this.executeTrans()}},{key:"getFeatureById",value:function(me){var nt=this.parser.type,Jt=nt===void 0?"geojson":nt;if(Jt==="geojson"&&!this.cluster){var Mt=me<this.originData.features.length?this.originData.features[me]:"null",ve=At()(Mt);if(this.transforms.length!==0){var ge=this.data.dataArray.find(function(He){return He._id===me});ve.properties=ge}return ve}else return me<this.data.dataArray.length?this.data.dataArray[me]:"null"}},{key:"getFeatureId",value:function(me,nt){var Jt=this.data.dataArray.find(function(Mt){return Mt[me]===name});return Jt==null?void 0:Jt._id}},{key:"destroy",value:function(){this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null}},{key:"initCfg",value:function(me){me&&(me.parser&&(this.parser=me.parser),me.transforms&&(this.transforms=me.transforms),this.cluster=me.cluster||!1,me.clusterOptions&&(this.cluster=!0,this.clusterOptions=Qt(Qt({},this.clusterOptions),me.clusterOptions)))}},{key:"excuteParser",value:function(){var me=this.parser,nt=me.type||"geojson",Jt=Object(_t.getParser)(nt);this.data=Jt(this.originData,me),this.extent=Object(vt.m)(this.data.dataArray)}},{key:"executeTrans",value:function(){var me=this,nt=this.transforms;nt.forEach(function(Jt){var Mt=Jt.type,ve=Object(_t.getTransform)(Mt)(me.data,Jt);Object.assign(me.data,ve)})}},{key:"initCluster",value:function(){if(!this.cluster)return;var me=this.clusterOptions||{};this.clusterIndex=Object(wt.a)(this.data,me)}},{key:"init",value:function(){this.hooks.init.call(this)}}]),be}(Je.EventEmitter)},lJbI:function(ze,E,o){"use strict";o.d(E,"a",function(){return b});function b(m,Y){var F=Y.extent,i=Y.width,Z=Y.height,D=Y.min,$=Y.max,te={_id:1,dataArray:[{_id:1,data:Array.from(m),width:i,height:Z,min:D,max:$,coordinates:[[F[0],F[1]],[F[2],F[3]]]}]};return te}},mNvP:function(ze,E,o){(function(b,m){/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Y;(function(F){(function(i){var Z=typeof m=="object"?m:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),D=$(F);typeof Z.Reflect=="undefined"?Z.Reflect=F:D=$(Z.Reflect,D),i(D);function $(te,fe){return function(K,Ge){typeof te[K]!="function"&&Object.defineProperty(te,K,{configurable:!0,writable:!0,value:Ge}),fe&&fe(K,Ge)}}})(function(i){var Z=Object.prototype.hasOwnProperty,D=typeof Symbol=="function",$=D&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",te=D&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",fe=typeof Object.create=="function",K={__proto__:[]}instanceof Array,Ge=!fe&&!K,pe={create:fe?function(){return dr(Object.create(null))}:K?function(){return dr({__proto__:null})}:function(){return dr({})},has:Ge?function(Ye,xt){return Z.call(Ye,xt)}:function(Ye,xt){return xt in Ye},get:Ge?function(Ye,xt){return Z.call(Ye,xt)?Ye[xt]:void 0}:function(Ye,xt){return Ye[xt]}},Ze=Object.getPrototypeOf(Function),Pe=typeof b=="object"&&Object({NODE_ENV:"production"})&&Object({NODE_ENV:"production"}).REFLECT_METADATA_USE_MAP_POLYFILL==="true",mt=!Pe&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:ne(),De=!Pe&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:et(),At=!Pe&&typeof WeakMap=="function"?WeakMap:kt(),it=new At;function vt(Ye,xt,bt,Et){if(Jt(bt)){if(!R(Ye))throw new TypeError;if(!ce(xt))throw new TypeError;return Zt(Ye,xt)}else{if(!R(Ye))throw new TypeError;if(!ge(xt))throw new TypeError;if(!ge(Et)&&!Jt(Et)&&!Mt(Et))throw new TypeError;return Mt(Et)&&(Et=void 0),bt=C(bt),Qt(Ye,xt,bt,Et)}}i("decorate",vt);function Je(Ye,xt){function bt(Et,Fe){if(!ge(Et))throw new TypeError;if(!Jt(Fe)&&!We(Fe))throw new TypeError;be(Ye,xt,Et,Fe)}return bt}i("metadata",Je);function _t(Ye,xt,bt,Et){if(!ge(bt))throw new TypeError;return Jt(Et)||(Et=C(Et)),be(Ye,xt,bt,Et)}i("defineMetadata",_t);function wt(Ye,xt,bt){if(!ge(xt))throw new TypeError;return Jt(bt)||(bt=C(bt)),oe(Ye,xt,bt)}i("hasMetadata",wt);function ke(Ye,xt,bt){if(!ge(xt))throw new TypeError;return Jt(bt)||(bt=C(bt)),Q(Ye,xt,bt)}i("hasOwnMetadata",ke);function Re(Ye,xt,bt){if(!ge(xt))throw new TypeError;return Jt(bt)||(bt=C(bt)),H(Ye,xt,bt)}i("getMetadata",Re);function Ve(Ye,xt,bt){if(!ge(xt))throw new TypeError;return Jt(bt)||(bt=C(bt)),Se(Ye,xt,bt)}i("getOwnMetadata",Ve);function dt(Ye,xt){if(!ge(Ye))throw new TypeError;return Jt(xt)||(xt=C(xt)),Te(Ye,xt)}i("getMetadataKeys",dt);function Me(Ye,xt){if(!ge(Ye))throw new TypeError;return Jt(xt)||(xt=C(xt)),me(Ye,xt)}i("getOwnMetadataKeys",Me);function ht(Ye,xt,bt){if(!ge(xt))throw new TypeError;Jt(bt)||(bt=C(bt));var Et=ur(xt,bt,!1);if(Jt(Et))return!1;if(!Et.delete(Ye))return!1;if(Et.size>0)return!0;var Fe=it.get(xt);return Fe.delete(bt),Fe.size>0||it.delete(xt),!0}i("deleteMetadata",ht);function Zt(Ye,xt){for(var bt=Ye.length-1;bt>=0;--bt){var Et=Ye[bt],Fe=Et(xt);if(!Jt(Fe)&&!Mt(Fe)){if(!ce(Fe))throw new TypeError;xt=Fe}}return xt}function Qt(Ye,xt,bt,Et){for(var Fe=Ye.length-1;Fe>=0;--Fe){var pt=Ye[Fe],yt=pt(xt,bt,Et);if(!Jt(yt)&&!Mt(yt)){if(!ge(yt))throw new TypeError;Et=yt}}return Et}function ur(Ye,xt,bt){var Et=it.get(Ye);if(Jt(Et)){if(!bt)return;Et=new mt,it.set(Ye,Et)}var Fe=Et.get(xt);if(Jt(Fe)){if(!bt)return;Fe=new mt,Et.set(xt,Fe)}return Fe}function oe(Ye,xt,bt){var Et=Q(Ye,xt,bt);if(Et)return!0;var Fe=Qe(xt);return Mt(Fe)?!1:oe(Ye,Fe,bt)}function Q(Ye,xt,bt){var Et=ur(xt,bt,!1);return Jt(Et)?!1:we(Et.has(Ye))}function H(Ye,xt,bt){var Et=Q(Ye,xt,bt);if(Et)return Se(Ye,xt,bt);var Fe=Qe(xt);return Mt(Fe)?void 0:H(Ye,Fe,bt)}function Se(Ye,xt,bt){var Et=ur(xt,bt,!1);return Jt(Et)?void 0:Et.get(Ye)}function be(Ye,xt,bt,Et){var Fe=ur(bt,Et,!0);Fe.set(Ye,xt)}function Te(Ye,xt){var bt=me(Ye,xt),Et=Qe(Ye);if(Et===null)return bt;var Fe=Te(Et,xt);if(Fe.length<=0)return bt;if(bt.length<=0)return Fe;for(var pt=new De,yt=[],Ht=0,hr=bt;Ht<hr.length;Ht++){var Hr=hr[Ht],gr=pt.has(Hr);gr||(pt.add(Hr),yt.push(Hr))}for(var Bn=0,zn=Fe;Bn<zn.length;Bn++){var Hr=zn[Bn],gr=pt.has(Hr);gr||(pt.add(Hr),yt.push(Hr))}return yt}function me(Ye,xt){var bt=[],Et=ur(Ye,xt,!1);if(Jt(Et))return bt;for(var Fe=Et.keys(),pt=Tt(Fe),yt=0;;){var Ht=Ut(pt);if(!Ht)return bt.length=yt,bt;var hr=at(Ht);try{bt[yt]=hr}catch(Hr){try{J(pt)}finally{throw Hr}}yt++}}function nt(Ye){if(Ye===null)return 1;switch(typeof Ye){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return Ye===null?1:6;default:return 6}}function Jt(Ye){return Ye===void 0}function Mt(Ye){return Ye===null}function ve(Ye){return typeof Ye=="symbol"}function ge(Ye){return typeof Ye=="object"?Ye!==null:typeof Ye=="function"}function He(Ye,xt){switch(nt(Ye)){case 0:return Ye;case 1:return Ye;case 2:return Ye;case 3:return Ye;case 4:return Ye;case 5:return Ye}var bt=xt===3?"string":xt===5?"number":"default",Et=qe(Ye,$);if(Et!==void 0){var Fe=Et.call(Ye,bt);if(ge(Fe))throw new TypeError;return Fe}return ot(Ye,bt==="default"?"number":bt)}function ot(Ye,xt){if(xt==="string"){var bt=Ye.toString;if(q(bt)){var Et=bt.call(Ye);if(!ge(Et))return Et}var Fe=Ye.valueOf;if(q(Fe)){var Et=Fe.call(Ye);if(!ge(Et))return Et}}else{var Fe=Ye.valueOf;if(q(Fe)){var Et=Fe.call(Ye);if(!ge(Et))return Et}var pt=Ye.toString;if(q(pt)){var Et=pt.call(Ye);if(!ge(Et))return Et}}throw new TypeError}function we(Ye){return!!Ye}function gt(Ye){return""+Ye}function C(Ye){var xt=He(Ye,3);return ve(xt)?xt:gt(xt)}function R(Ye){return Array.isArray?Array.isArray(Ye):Ye instanceof Object?Ye instanceof Array:Object.prototype.toString.call(Ye)==="[object Array]"}function q(Ye){return typeof Ye=="function"}function ce(Ye){return typeof Ye=="function"}function We(Ye){switch(nt(Ye)){case 3:return!0;case 4:return!0;default:return!1}}function qe(Ye,xt){var bt=Ye[xt];if(bt==null)return;if(!q(bt))throw new TypeError;return bt}function Tt(Ye){var xt=qe(Ye,te);if(!q(xt))throw new TypeError;var bt=xt.call(Ye);if(!ge(bt))throw new TypeError;return bt}function at(Ye){return Ye.value}function Ut(Ye){var xt=Ye.next();return xt.done?!1:xt}function J(Ye){var xt=Ye.return;xt&&xt.call(Ye)}function Qe(Ye){var xt=Object.getPrototypeOf(Ye);if(typeof Ye!="function"||Ye===Ze)return xt;if(xt!==Ze)return xt;var bt=Ye.prototype,Et=bt&&Object.getPrototypeOf(bt);if(Et==null||Et===Object.prototype)return xt;var Fe=Et.constructor;return typeof Fe!="function"||Fe===Ye?xt:Fe}function ne(){var Ye={},xt=[],bt=function(){function yt(Ht,hr,Hr){this._index=0,this._keys=Ht,this._values=hr,this._selector=Hr}return yt.prototype["@@iterator"]=function(){return this},yt.prototype[te]=function(){return this},yt.prototype.next=function(){var Ht=this._index;if(Ht>=0&&Ht<this._keys.length){var hr=this._selector(this._keys[Ht],this._values[Ht]);return Ht+1>=this._keys.length?(this._index=-1,this._keys=xt,this._values=xt):this._index++,{value:hr,done:!1}}return{value:void 0,done:!0}},yt.prototype.throw=function(Ht){throw this._index>=0&&(this._index=-1,this._keys=xt,this._values=xt),Ht},yt.prototype.return=function(Ht){return this._index>=0&&(this._index=-1,this._keys=xt,this._values=xt),{value:Ht,done:!0}},yt}();return function(){function yt(){this._keys=[],this._values=[],this._cacheKey=Ye,this._cacheIndex=-2}return Object.defineProperty(yt.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),yt.prototype.has=function(Ht){return this._find(Ht,!1)>=0},yt.prototype.get=function(Ht){var hr=this._find(Ht,!1);return hr>=0?this._values[hr]:void 0},yt.prototype.set=function(Ht,hr){var Hr=this._find(Ht,!0);return this._values[Hr]=hr,this},yt.prototype.delete=function(Ht){var hr=this._find(Ht,!1);if(hr>=0){for(var Hr=this._keys.length,gr=hr+1;gr<Hr;gr++)this._keys[gr-1]=this._keys[gr],this._values[gr-1]=this._values[gr];return this._keys.length--,this._values.length--,Ht===this._cacheKey&&(this._cacheKey=Ye,this._cacheIndex=-2),!0}return!1},yt.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=Ye,this._cacheIndex=-2},yt.prototype.keys=function(){return new bt(this._keys,this._values,Et)},yt.prototype.values=function(){return new bt(this._keys,this._values,Fe)},yt.prototype.entries=function(){return new bt(this._keys,this._values,pt)},yt.prototype["@@iterator"]=function(){return this.entries()},yt.prototype[te]=function(){return this.entries()},yt.prototype._find=function(Ht,hr){return this._cacheKey!==Ht&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Ht)),this._cacheIndex<0&&hr&&(this._cacheIndex=this._keys.length,this._keys.push(Ht),this._values.push(void 0)),this._cacheIndex},yt}();function Et(yt,Ht){return yt}function Fe(yt,Ht){return Ht}function pt(yt,Ht){return[yt,Ht]}}function et(){return function(){function Ye(){this._map=new mt}return Object.defineProperty(Ye.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),Ye.prototype.has=function(xt){return this._map.has(xt)},Ye.prototype.add=function(xt){return this._map.set(xt,xt),this},Ye.prototype.delete=function(xt){return this._map.delete(xt)},Ye.prototype.clear=function(){this._map.clear()},Ye.prototype.keys=function(){return this._map.keys()},Ye.prototype.values=function(){return this._map.values()},Ye.prototype.entries=function(){return this._map.entries()},Ye.prototype["@@iterator"]=function(){return this.keys()},Ye.prototype[te]=function(){return this.keys()},Ye}()}function kt(){var Ye=16,xt=pe.create(),bt=Et();return function(){function hr(){this._key=Et()}return hr.prototype.has=function(Hr){var gr=Fe(Hr,!1);return gr!==void 0?pe.has(gr,this._key):!1},hr.prototype.get=function(Hr){var gr=Fe(Hr,!1);return gr!==void 0?pe.get(gr,this._key):void 0},hr.prototype.set=function(Hr,gr){var Bn=Fe(Hr,!0);return Bn[this._key]=gr,this},hr.prototype.delete=function(Hr){var gr=Fe(Hr,!1);return gr!==void 0?delete gr[this._key]:!1},hr.prototype.clear=function(){this._key=Et()},hr}();function Et(){var hr;do hr="@@WeakMap@@"+Ht();while(pe.has(xt,hr));return xt[hr]=!0,hr}function Fe(hr,Hr){if(!Z.call(hr,bt)){if(!Hr)return;Object.defineProperty(hr,bt,{value:pe.create()})}return hr[bt]}function pt(hr,Hr){for(var gr=0;gr<Hr;++gr)hr[gr]=Math.random()*255|0;return hr}function yt(hr){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(hr)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(hr)):pt(new Uint8Array(hr),hr):pt(new Array(hr),hr)}function Ht(){var hr=yt(Ye);hr[6]=hr[6]&79|64,hr[8]=hr[8]&191|128;for(var Hr="",gr=0;gr<Ye;++gr){var Bn=hr[gr];(gr===4||gr===6||gr===8)&&(Hr+="-"),Bn<16&&(Hr+="0"),Hr+=Bn.toString(16).toLowerCase()}return Hr}}function dr(Ye){return Ye.__=void 0,delete Ye.__,Ye}})})(Y||(Y={}))}).call(this,o("Q2Ig"),o("yLpj"))},mTTR:function(ze,E,o){var b=o("b80T"),m=o("QcOe"),Y=o("MMmD");function F(i){return Y(i)?b(i,!0):m(i)}ze.exports=F},mc0g:function(ze,E){function o(b){return function(m,Y,F){for(var i=-1,Z=Object(m),D=F(m),$=D.length;$--;){var te=D[b?$:++i];if(Y(Z[te],te,Z)===!1)break}return m}}ze.exports=o},mhV4:function(ze,E,o){var b=o("ZK94");ze.exports.geometry=m,ze.exports.ring=F;function m(Z){var D=0,$;switch(Z.type){case"Polygon":return Y(Z.coordinates);case"MultiPolygon":for($=0;$<Z.coordinates.length;$++)D+=Y(Z.coordinates[$]);return D;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for($=0;$<Z.geometries.length;$++)D+=m(Z.geometries[$]);return D}}function Y(Z){var D=0;if(Z&&Z.length>0){D+=Math.abs(F(Z[0]));for(var $=1;$<Z.length;$++)D-=Math.abs(F(Z[$]))}return D}function F(Z){var D,$,te,fe,K,Ge,pe,Ze=0,Pe=Z.length;if(Pe>2){for(pe=0;pe<Pe;pe++)pe===Pe-2?(fe=Pe-2,K=Pe-1,Ge=0):pe===Pe-1?(fe=Pe-1,K=0,Ge=1):(fe=pe,K=pe+1,Ge=pe+2),D=Z[fe],$=Z[K],te=Z[Ge],Ze+=(i(te[0])-i(D[0]))*Math.sin(i($[1]));Ze=Ze*b.RADIUS*b.RADIUS/2}return Ze}function i(Z){return Z*Math.PI/180}},mpbz:function(ze,E,o){(function(b,m){ze.exports=m()})(this,function(){"use strict";function b(ke,Re,Ve,dt,Me,ht){if(Me-dt<=Ve)return;var Zt=dt+Me>>1;m(ke,Re,Zt,dt,Me,ht%2),b(ke,Re,Ve,dt,Zt-1,ht+1),b(ke,Re,Ve,Zt+1,Me,ht+1)}function m(ke,Re,Ve,dt,Me,ht){for(;Me>dt;){if(Me-dt>600){var Zt=Me-dt+1,Qt=Ve-dt+1,ur=Math.log(Zt),oe=.5*Math.exp(2*ur/3),Q=.5*Math.sqrt(ur*oe*(Zt-oe)/Zt)*(Qt-Zt/2<0?-1:1),H=Math.max(dt,Math.floor(Ve-Qt*oe/Zt+Q)),Se=Math.min(Me,Math.floor(Ve+(Zt-Qt)*oe/Zt+Q));m(ke,Re,Ve,H,Se,ht)}var be=Re[2*Ve+ht],Te=dt,me=Me;for(Y(ke,Re,dt,Ve),Re[2*Me+ht]>be&&Y(ke,Re,dt,Me);Te<me;){for(Y(ke,Re,Te,me),Te++,me--;Re[2*Te+ht]<be;)Te++;for(;Re[2*me+ht]>be;)me--}Re[2*dt+ht]===be?Y(ke,Re,dt,me):(me++,Y(ke,Re,me,Me)),me<=Ve&&(dt=me+1),Ve<=me&&(Me=me-1)}}function Y(ke,Re,Ve,dt){F(ke,Ve,dt),F(Re,2*Ve,2*dt),F(Re,2*Ve+1,2*dt+1)}function F(ke,Re,Ve){var dt=ke[Re];ke[Re]=ke[Ve],ke[Ve]=dt}function i(ke,Re,Ve,dt,Me,ht,Zt){for(var Qt=[0,ke.length-1,0],ur=[],oe,Q;Qt.length;){var H=Qt.pop(),Se=Qt.pop(),be=Qt.pop();if(Se-be<=Zt){for(var Te=be;Te<=Se;Te++)oe=Re[2*Te],Q=Re[2*Te+1],oe>=Ve&&oe<=Me&&Q>=dt&&Q<=ht&&ur.push(ke[Te]);continue}var me=Math.floor((be+Se)/2);oe=Re[2*me],Q=Re[2*me+1],oe>=Ve&&oe<=Me&&Q>=dt&&Q<=ht&&ur.push(ke[me]);var nt=(H+1)%2;(H===0?Ve<=oe:dt<=Q)&&(Qt.push(be),Qt.push(me-1),Qt.push(nt)),(H===0?Me>=oe:ht>=Q)&&(Qt.push(me+1),Qt.push(Se),Qt.push(nt))}return ur}function Z(ke,Re,Ve,dt,Me,ht){for(var Zt=[0,ke.length-1,0],Qt=[],ur=Me*Me;Zt.length;){var oe=Zt.pop(),Q=Zt.pop(),H=Zt.pop();if(Q-H<=ht){for(var Se=H;Se<=Q;Se++)D(Re[2*Se],Re[2*Se+1],Ve,dt)<=ur&&Qt.push(ke[Se]);continue}var be=Math.floor((H+Q)/2),Te=Re[2*be],me=Re[2*be+1];D(Te,me,Ve,dt)<=ur&&Qt.push(ke[be]);var nt=(oe+1)%2;(oe===0?Ve-Me<=Te:dt-Me<=me)&&(Zt.push(H),Zt.push(be-1),Zt.push(nt)),(oe===0?Ve+Me>=Te:dt+Me>=me)&&(Zt.push(be+1),Zt.push(Q),Zt.push(nt))}return Qt}function D(ke,Re,Ve,dt){var Me=ke-Ve,ht=Re-dt;return Me*Me+ht*ht}var $=function(Re){return Re[0]},te=function(Re){return Re[1]},fe=function(Re,Ve,dt,Me,ht){Ve===void 0&&(Ve=$),dt===void 0&&(dt=te),Me===void 0&&(Me=64),ht===void 0&&(ht=Float64Array),this.nodeSize=Me,this.points=Re;for(var Zt=Re.length<65536?Uint16Array:Uint32Array,Qt=this.ids=new Zt(Re.length),ur=this.coords=new ht(Re.length*2),oe=0;oe<Re.length;oe++)Qt[oe]=oe,ur[2*oe]=Ve(Re[oe]),ur[2*oe+1]=dt(Re[oe]);b(Qt,ur,Me,0,Qt.length-1,0)};fe.prototype.range=function(Re,Ve,dt,Me){return i(this.ids,this.coords,Re,Ve,dt,Me,this.nodeSize)},fe.prototype.within=function(Re,Ve,dt){return Z(this.ids,this.coords,Re,Ve,dt,this.nodeSize)};var K={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Re){return Re}},Ge=function(Re){this.options=Je(Object.create(K),Re),this.trees=new Array(this.options.maxZoom+1)};Ge.prototype.load=function(Re){var Ve=this.options,dt=Ve.log,Me=Ve.minZoom,ht=Ve.maxZoom,Zt=Ve.nodeSize;dt&&console.time("total time");var Qt="prepare "+Re.length+" points";dt&&console.time(Qt),this.points=Re;for(var ur=[],oe=0;oe<Re.length;oe++){if(!Re[oe].geometry)continue;ur.push(Ze(Re[oe],oe))}this.trees[ht+1]=new fe(ur,_t,wt,Zt,Float32Array),dt&&console.timeEnd(Qt);for(var Q=ht;Q>=Me;Q--){var H=+Date.now();ur=this._cluster(ur,Q),this.trees[Q]=new fe(ur,_t,wt,Zt,Float32Array),dt&&console.log("z%d: %d clusters in %dms",Q,ur.length,+Date.now()-H)}return dt&&console.timeEnd("total time"),this},Ge.prototype.getClusters=function(Re,Ve){var dt=((Re[0]+180)%360+360)%360-180,Me=Math.max(-90,Math.min(90,Re[1])),ht=Re[2]===180?180:((Re[2]+180)%360+360)%360-180,Zt=Math.max(-90,Math.min(90,Re[3]));if(Re[2]-Re[0]>=360)dt=-180,ht=180;else if(dt>ht){var Qt=this.getClusters([dt,Me,180,Zt],Ve),ur=this.getClusters([-180,Me,ht,Zt],Ve);return Qt.concat(ur)}for(var oe=this.trees[this._limitZoom(Ve)],Q=oe.range(De(dt),At(Zt),De(ht),At(Me)),H=[],Se=0,be=Q;Se<be.length;Se+=1){var Te=be[Se],me=oe.points[Te];H.push(me.numPoints?Pe(me):this.points[me.index])}return H},Ge.prototype.getChildren=function(Re){var Ve=this._getOriginId(Re),dt=this._getOriginZoom(Re),Me="No cluster with the specified id.",ht=this.trees[dt];if(!ht)throw new Error(Me);var Zt=ht.points[Ve];if(!Zt)throw new Error(Me);for(var Qt=this.options.radius/(this.options.extent*Math.pow(2,dt-1)),ur=ht.within(Zt.x,Zt.y,Qt),oe=[],Q=0,H=ur;Q<H.length;Q+=1){var Se=H[Q],be=ht.points[Se];be.parentId===Re&&oe.push(be.numPoints?Pe(be):this.points[be.index])}if(oe.length===0)throw new Error(Me);return oe},Ge.prototype.getLeaves=function(Re,Ve,dt){Ve=Ve||10,dt=dt||0;var Me=[];return this._appendLeaves(Me,Re,Ve,dt,0),Me},Ge.prototype.getTile=function(Re,Ve,dt){var Me=this.trees[this._limitZoom(Re)],ht=Math.pow(2,Re),Zt=this.options,Qt=Zt.extent,ur=Zt.radius,oe=ur/Qt,Q=(dt-oe)/ht,H=(dt+1+oe)/ht,Se={features:[]};return this._addTileFeatures(Me.range((Ve-oe)/ht,Q,(Ve+1+oe)/ht,H),Me.points,Ve,dt,ht,Se),Ve===0&&this._addTileFeatures(Me.range(1-oe/ht,Q,1,H),Me.points,ht,dt,ht,Se),Ve===ht-1&&this._addTileFeatures(Me.range(0,Q,oe/ht,H),Me.points,-1,dt,ht,Se),Se.features.length?Se:null},Ge.prototype.getClusterExpansionZoom=function(Re){for(var Ve=this._getOriginZoom(Re)-1;Ve<=this.options.maxZoom;){var dt=this.getChildren(Re);if(Ve++,dt.length!==1)break;Re=dt[0].properties.cluster_id}return Ve},Ge.prototype._appendLeaves=function(Re,Ve,dt,Me,ht){for(var Zt=this.getChildren(Ve),Qt=0,ur=Zt;Qt<ur.length;Qt+=1){var oe=ur[Qt],Q=oe.properties;if(Q&&Q.cluster?ht+Q.point_count<=Me?ht+=Q.point_count:ht=this._appendLeaves(Re,Q.cluster_id,dt,Me,ht):ht<Me?ht++:Re.push(oe),Re.length===dt)break}return ht},Ge.prototype._addTileFeatures=function(Re,Ve,dt,Me,ht,Zt){for(var Qt=0,ur=Re;Qt<ur.length;Qt+=1){var oe=ur[Qt],Q=Ve[oe],H=Q.numPoints,Se={type:1,geometry:[[Math.round(this.options.extent*(Q.x*ht-dt)),Math.round(this.options.extent*(Q.y*ht-Me))]],tags:H?mt(Q):this.points[Q.index].properties},be=void 0;H?be=Q.id:this.options.generateId?be=Q.index:this.points[Q.index].id&&(be=this.points[Q.index].id),be!==void 0&&(Se.id=be),Zt.features.push(Se)}},Ge.prototype._limitZoom=function(Re){return Math.max(this.options.minZoom,Math.min(+Re,this.options.maxZoom+1))},Ge.prototype._cluster=function(Re,Ve){for(var dt=[],Me=this.options,ht=Me.radius,Zt=Me.extent,Qt=Me.reduce,ur=Me.minPoints,oe=ht/(Zt*Math.pow(2,Ve)),Q=0;Q<Re.length;Q++){var H=Re[Q];if(H.zoom<=Ve)continue;H.zoom=Ve;for(var Se=this.trees[Ve+1],be=Se.within(H.x,H.y,oe),Te=H.numPoints||1,me=Te,nt=0,Jt=be;nt<Jt.length;nt+=1){var Mt=Jt[nt],ve=Se.points[Mt];ve.zoom>Ve&&(me+=ve.numPoints||1)}if(me>=ur){for(var ge=H.x*Te,He=H.y*Te,ot=Qt&&Te>1?this._map(H,!0):null,we=(Q<<5)+(Ve+1)+this.points.length,gt=0,C=be;gt<C.length;gt+=1){var R=C[gt],q=Se.points[R];if(q.zoom<=Ve)continue;q.zoom=Ve;var ce=q.numPoints||1;ge+=q.x*ce,He+=q.y*ce,q.parentId=we,Qt&&(ot||(ot=this._map(H,!0)),Qt(ot,this._map(q)))}H.parentId=we,dt.push(pe(ge/me,He/me,we,me,ot))}else if(dt.push(H),me>1)for(var We=0,qe=be;We<qe.length;We+=1){var Tt=qe[We],at=Se.points[Tt];if(at.zoom<=Ve)continue;at.zoom=Ve,dt.push(at)}}return dt},Ge.prototype._getOriginId=function(Re){return Re-this.points.length>>5},Ge.prototype._getOriginZoom=function(Re){return(Re-this.points.length)%32},Ge.prototype._map=function(Re,Ve){if(Re.numPoints)return Ve?Je({},Re.properties):Re.properties;var dt=this.points[Re.index].properties,Me=this.options.map(dt);return Ve&&Me===dt?Je({},Me):Me};function pe(ke,Re,Ve,dt,Me){return{x:ke,y:Re,zoom:Infinity,id:Ve,parentId:-1,numPoints:dt,properties:Me}}function Ze(ke,Re){var Ve=ke.geometry.coordinates,dt=Ve[0],Me=Ve[1];return{x:De(dt),y:At(Me),zoom:Infinity,index:Re,parentId:-1}}function Pe(ke){return{type:"Feature",id:ke.id,properties:mt(ke),geometry:{type:"Point",coordinates:[it(ke.x),vt(ke.y)]}}}function mt(ke){var Re=ke.numPoints,Ve=Re>=1e4?Math.round(Re/1e3)+"k":Re>=1e3?Math.round(Re/100)/10+"k":Re;return Je(Je({},ke.properties),{cluster:!0,cluster_id:ke.id,point_count:Re,point_count_abbreviated:Ve})}function De(ke){return ke/360+.5}function At(ke){var Re=Math.sin(ke*Math.PI/180),Ve=.5-.25*Math.log((1+Re)/(1-Re))/Math.PI;return Ve<0?0:Ve>1?1:Ve}function it(ke){return(ke-.5)*360}function vt(ke){var Re=(180-ke*360)*Math.PI/180;return 360*Math.atan(Math.exp(Re))/Math.PI-90}function Je(ke,Re){for(var Ve in Re)ke[Ve]=Re[Ve];return ke}function _t(ke){return ke.x}function wt(ke){return ke.y}return Ge})},"mv/X":function(ze,E,o){var b=o("ljhN"),m=o("MMmD"),Y=o("wJg7"),F=o("GoyQ");function i(Z,D,$){if(!F($))return!1;var te=typeof D;return(te=="number"?m($)&&Y(D,$.length):te=="string"&&D in $)?b($[D],Z):!1}ze.exports=i},"n+fv":function(ze,E,o){"use strict";o.r(E),o.d(E,"create",function(){return m}),o.d(E,"clone",function(){return Y}),o.d(E,"length",function(){return F}),o.d(E,"fromValues",function(){return i}),o.d(E,"copy",function(){return Z}),o.d(E,"set",function(){return D}),o.d(E,"add",function(){return $}),o.d(E,"subtract",function(){return te}),o.d(E,"multiply",function(){return fe}),o.d(E,"divide",function(){return K}),o.d(E,"ceil",function(){return Ge}),o.d(E,"floor",function(){return pe}),o.d(E,"min",function(){return Ze}),o.d(E,"max",function(){return Pe}),o.d(E,"round",function(){return mt}),o.d(E,"scale",function(){return De}),o.d(E,"scaleAndAdd",function(){return At}),o.d(E,"distance",function(){return it}),o.d(E,"squaredDistance",function(){return vt}),o.d(E,"squaredLength",function(){return Je}),o.d(E,"negate",function(){return _t}),o.d(E,"inverse",function(){return wt}),o.d(E,"normalize",function(){return ke}),o.d(E,"dot",function(){return Re}),o.d(E,"cross",function(){return Ve}),o.d(E,"lerp",function(){return dt}),o.d(E,"hermite",function(){return Me}),o.d(E,"bezier",function(){return ht}),o.d(E,"random",function(){return Zt}),o.d(E,"transformMat4",function(){return Qt}),o.d(E,"transformMat3",function(){return ur}),o.d(E,"transformQuat",function(){return oe}),o.d(E,"rotateX",function(){return Q}),o.d(E,"rotateY",function(){return H}),o.d(E,"rotateZ",function(){return Se}),o.d(E,"angle",function(){return be}),o.d(E,"zero",function(){return Te}),o.d(E,"str",function(){return me}),o.d(E,"exactEquals",function(){return nt}),o.d(E,"equals",function(){return Jt}),o.d(E,"sub",function(){return Mt}),o.d(E,"mul",function(){return ve}),o.d(E,"div",function(){return ge}),o.d(E,"dist",function(){return He}),o.d(E,"sqrDist",function(){return ot}),o.d(E,"len",function(){return we}),o.d(E,"sqrLen",function(){return gt}),o.d(E,"forEach",function(){return C});var b=o("yU0y");function m(){var R=new b.a(3);return b.a!=Float32Array&&(R[0]=0,R[1]=0,R[2]=0),R}function Y(R){var q=new b.a(3);return q[0]=R[0],q[1]=R[1],q[2]=R[2],q}function F(R){var q=R[0],ce=R[1],We=R[2];return Math.hypot(q,ce,We)}function i(R,q,ce){var We=new b.a(3);return We[0]=R,We[1]=q,We[2]=ce,We}function Z(R,q){return R[0]=q[0],R[1]=q[1],R[2]=q[2],R}function D(R,q,ce,We){return R[0]=q,R[1]=ce,R[2]=We,R}function $(R,q,ce){return R[0]=q[0]+ce[0],R[1]=q[1]+ce[1],R[2]=q[2]+ce[2],R}function te(R,q,ce){return R[0]=q[0]-ce[0],R[1]=q[1]-ce[1],R[2]=q[2]-ce[2],R}function fe(R,q,ce){return R[0]=q[0]*ce[0],R[1]=q[1]*ce[1],R[2]=q[2]*ce[2],R}function K(R,q,ce){return R[0]=q[0]/ce[0],R[1]=q[1]/ce[1],R[2]=q[2]/ce[2],R}function Ge(R,q){return R[0]=Math.ceil(q[0]),R[1]=Math.ceil(q[1]),R[2]=Math.ceil(q[2]),R}function pe(R,q){return R[0]=Math.floor(q[0]),R[1]=Math.floor(q[1]),R[2]=Math.floor(q[2]),R}function Ze(R,q,ce){return R[0]=Math.min(q[0],ce[0]),R[1]=Math.min(q[1],ce[1]),R[2]=Math.min(q[2],ce[2]),R}function Pe(R,q,ce){return R[0]=Math.max(q[0],ce[0]),R[1]=Math.max(q[1],ce[1]),R[2]=Math.max(q[2],ce[2]),R}function mt(R,q){return R[0]=Math.round(q[0]),R[1]=Math.round(q[1]),R[2]=Math.round(q[2]),R}function De(R,q,ce){return R[0]=q[0]*ce,R[1]=q[1]*ce,R[2]=q[2]*ce,R}function At(R,q,ce,We){return R[0]=q[0]+ce[0]*We,R[1]=q[1]+ce[1]*We,R[2]=q[2]+ce[2]*We,R}function it(R,q){var ce=q[0]-R[0],We=q[1]-R[1],qe=q[2]-R[2];return Math.hypot(ce,We,qe)}function vt(R,q){var ce=q[0]-R[0],We=q[1]-R[1],qe=q[2]-R[2];return ce*ce+We*We+qe*qe}function Je(R){var q=R[0],ce=R[1],We=R[2];return q*q+ce*ce+We*We}function _t(R,q){return R[0]=-q[0],R[1]=-q[1],R[2]=-q[2],R}function wt(R,q){return R[0]=1/q[0],R[1]=1/q[1],R[2]=1/q[2],R}function ke(R,q){var ce=q[0],We=q[1],qe=q[2],Tt=ce*ce+We*We+qe*qe;return Tt>0&&(Tt=1/Math.sqrt(Tt)),R[0]=q[0]*Tt,R[1]=q[1]*Tt,R[2]=q[2]*Tt,R}function Re(R,q){return R[0]*q[0]+R[1]*q[1]+R[2]*q[2]}function Ve(R,q,ce){var We=q[0],qe=q[1],Tt=q[2],at=ce[0],Ut=ce[1],J=ce[2];return R[0]=qe*J-Tt*Ut,R[1]=Tt*at-We*J,R[2]=We*Ut-qe*at,R}function dt(R,q,ce,We){var qe=q[0],Tt=q[1],at=q[2];return R[0]=qe+We*(ce[0]-qe),R[1]=Tt+We*(ce[1]-Tt),R[2]=at+We*(ce[2]-at),R}function Me(R,q,ce,We,qe,Tt){var at=Tt*Tt,Ut=at*(2*Tt-3)+1,J=at*(Tt-2)+Tt,Qe=at*(Tt-1),ne=at*(3-2*Tt);return R[0]=q[0]*Ut+ce[0]*J+We[0]*Qe+qe[0]*ne,R[1]=q[1]*Ut+ce[1]*J+We[1]*Qe+qe[1]*ne,R[2]=q[2]*Ut+ce[2]*J+We[2]*Qe+qe[2]*ne,R}function ht(R,q,ce,We,qe,Tt){var at=1-Tt,Ut=at*at,J=Tt*Tt,Qe=Ut*at,ne=3*Tt*Ut,et=3*J*at,kt=J*Tt;return R[0]=q[0]*Qe+ce[0]*ne+We[0]*et+qe[0]*kt,R[1]=q[1]*Qe+ce[1]*ne+We[1]*et+qe[1]*kt,R[2]=q[2]*Qe+ce[2]*ne+We[2]*et+qe[2]*kt,R}function Zt(R,q){q=q||1;var ce=b.c()*2*Math.PI,We=b.c()*2-1,qe=Math.sqrt(1-We*We)*q;return R[0]=Math.cos(ce)*qe,R[1]=Math.sin(ce)*qe,R[2]=We*q,R}function Qt(R,q,ce){var We=q[0],qe=q[1],Tt=q[2],at=ce[3]*We+ce[7]*qe+ce[11]*Tt+ce[15];return at=at||1,R[0]=(ce[0]*We+ce[4]*qe+ce[8]*Tt+ce[12])/at,R[1]=(ce[1]*We+ce[5]*qe+ce[9]*Tt+ce[13])/at,R[2]=(ce[2]*We+ce[6]*qe+ce[10]*Tt+ce[14])/at,R}function ur(R,q,ce){var We=q[0],qe=q[1],Tt=q[2];return R[0]=We*ce[0]+qe*ce[3]+Tt*ce[6],R[1]=We*ce[1]+qe*ce[4]+Tt*ce[7],R[2]=We*ce[2]+qe*ce[5]+Tt*ce[8],R}function oe(R,q,ce){var We=ce[0],qe=ce[1],Tt=ce[2],at=ce[3],Ut=q[0],J=q[1],Qe=q[2],ne=qe*Qe-Tt*J,et=Tt*Ut-We*Qe,kt=We*J-qe*Ut,dr=qe*kt-Tt*et,Ye=Tt*ne-We*kt,xt=We*et-qe*ne,bt=at*2;return ne*=bt,et*=bt,kt*=bt,dr*=2,Ye*=2,xt*=2,R[0]=Ut+ne+dr,R[1]=J+et+Ye,R[2]=Qe+kt+xt,R}function Q(R,q,ce,We){var qe=[],Tt=[];return qe[0]=q[0]-ce[0],qe[1]=q[1]-ce[1],qe[2]=q[2]-ce[2],Tt[0]=qe[0],Tt[1]=qe[1]*Math.cos(We)-qe[2]*Math.sin(We),Tt[2]=qe[1]*Math.sin(We)+qe[2]*Math.cos(We),R[0]=Tt[0]+ce[0],R[1]=Tt[1]+ce[1],R[2]=Tt[2]+ce[2],R}function H(R,q,ce,We){var qe=[],Tt=[];return qe[0]=q[0]-ce[0],qe[1]=q[1]-ce[1],qe[2]=q[2]-ce[2],Tt[0]=qe[2]*Math.sin(We)+qe[0]*Math.cos(We),Tt[1]=qe[1],Tt[2]=qe[2]*Math.cos(We)-qe[0]*Math.sin(We),R[0]=Tt[0]+ce[0],R[1]=Tt[1]+ce[1],R[2]=Tt[2]+ce[2],R}function Se(R,q,ce,We){var qe=[],Tt=[];return qe[0]=q[0]-ce[0],qe[1]=q[1]-ce[1],qe[2]=q[2]-ce[2],Tt[0]=qe[0]*Math.cos(We)-qe[1]*Math.sin(We),Tt[1]=qe[0]*Math.sin(We)+qe[1]*Math.cos(We),Tt[2]=qe[2],R[0]=Tt[0]+ce[0],R[1]=Tt[1]+ce[1],R[2]=Tt[2]+ce[2],R}function be(R,q){var ce=R[0],We=R[1],qe=R[2],Tt=q[0],at=q[1],Ut=q[2],J=Math.sqrt(ce*ce+We*We+qe*qe),Qe=Math.sqrt(Tt*Tt+at*at+Ut*Ut),ne=J*Qe,et=ne&&Re(R,q)/ne;return Math.acos(Math.min(Math.max(et,-1),1))}function Te(R){return R[0]=0,R[1]=0,R[2]=0,R}function me(R){return"vec3("+R[0]+", "+R[1]+", "+R[2]+")"}function nt(R,q){return R[0]===q[0]&&R[1]===q[1]&&R[2]===q[2]}function Jt(R,q){var ce=R[0],We=R[1],qe=R[2],Tt=q[0],at=q[1],Ut=q[2];return Math.abs(ce-Tt)<=b.b*Math.max(1,Math.abs(ce),Math.abs(Tt))&&Math.abs(We-at)<=b.b*Math.max(1,Math.abs(We),Math.abs(at))&&Math.abs(qe-Ut)<=b.b*Math.max(1,Math.abs(qe),Math.abs(Ut))}var Mt=te,ve=fe,ge=K,He=it,ot=vt,we=F,gt=Je,C=function(){var R=m();return function(q,ce,We,qe,Tt,at){var Ut,J;for(ce||(ce=3),We||(We=0),qe?J=Math.min(qe*ce+We,q.length):J=q.length,Ut=We;Ut<J;Ut+=ce)R[0]=q[Ut],R[1]=q[Ut+1],R[2]=q[Ut+2],Tt(R,R,at),q[Ut]=R[0],q[Ut+1]=R[1],q[Ut+2]=R[2];return q}}()},n2J3:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("xfSm"),m=o("GXnB"),Y=o("Ztfv");function F(){return function(i,Z,D){var $=new m.Metadata(b.UNMANAGED_TAG,!0);Y.tagParameter(i,Z,D,$)}}E.unmanaged=F},n3AX:function(ze,E,o){var b=o("Nsbk");function m(Y,F){for(;!Object.prototype.hasOwnProperty.call(Y,F)&&!(Y=b(Y),Y===null););return Y}ze.exports=m},"o+pz":function(ze,E,o){"use strict";o.d(E,"a",function(){return b});var b;(function(m){m[m.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",m[m.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",m[m.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",m[m.POINTS=0]="POINTS",m[m.LINES=1]="LINES",m[m.LINE_LOOP=2]="LINE_LOOP",m[m.LINE_STRIP=3]="LINE_STRIP",m[m.TRIANGLES=4]="TRIANGLES",m[m.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",m[m.TRIANGLE_FAN=6]="TRIANGLE_FAN",m[m.ZERO=0]="ZERO",m[m.ONE=1]="ONE",m[m.SRC_COLOR=768]="SRC_COLOR",m[m.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",m[m.SRC_ALPHA=770]="SRC_ALPHA",m[m.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",m[m.DST_ALPHA=772]="DST_ALPHA",m[m.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",m[m.DST_COLOR=774]="DST_COLOR",m[m.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",m[m.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",m[m.FUNC_ADD=32774]="FUNC_ADD",m[m.BLEND_EQUATION=32777]="BLEND_EQUATION",m[m.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",m[m.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",m[m.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",m[m.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",m[m.MAX_EXT=32776]="MAX_EXT",m[m.MIN_EXT=32775]="MIN_EXT",m[m.BLEND_DST_RGB=32968]="BLEND_DST_RGB",m[m.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",m[m.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",m[m.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",m[m.CONSTANT_COLOR=32769]="CONSTANT_COLOR",m[m.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",m[m.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",m[m.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",m[m.BLEND_COLOR=32773]="BLEND_COLOR",m[m.ARRAY_BUFFER=34962]="ARRAY_BUFFER",m[m.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",m[m.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",m[m.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",m[m.STREAM_DRAW=35040]="STREAM_DRAW",m[m.STATIC_DRAW=35044]="STATIC_DRAW",m[m.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",m[m.BUFFER_SIZE=34660]="BUFFER_SIZE",m[m.BUFFER_USAGE=34661]="BUFFER_USAGE",m[m.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",m[m.FRONT=1028]="FRONT",m[m.BACK=1029]="BACK",m[m.FRONT_AND_BACK=1032]="FRONT_AND_BACK",m[m.CULL_FACE=2884]="CULL_FACE",m[m.BLEND=3042]="BLEND",m[m.DITHER=3024]="DITHER",m[m.STENCIL_TEST=2960]="STENCIL_TEST",m[m.DEPTH_TEST=2929]="DEPTH_TEST",m[m.SCISSOR_TEST=3089]="SCISSOR_TEST",m[m.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",m[m.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",m[m.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",m[m.NO_ERROR=0]="NO_ERROR",m[m.INVALID_ENUM=1280]="INVALID_ENUM",m[m.INVALID_VALUE=1281]="INVALID_VALUE",m[m.INVALID_OPERATION=1282]="INVALID_OPERATION",m[m.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",m[m.CW=2304]="CW",m[m.CCW=2305]="CCW",m[m.LINE_WIDTH=2849]="LINE_WIDTH",m[m.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",m[m.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",m[m.CULL_FACE_MODE=2885]="CULL_FACE_MODE",m[m.FRONT_FACE=2886]="FRONT_FACE",m[m.DEPTH_RANGE=2928]="DEPTH_RANGE",m[m.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",m[m.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",m[m.DEPTH_FUNC=2932]="DEPTH_FUNC",m[m.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",m[m.STENCIL_FUNC=2962]="STENCIL_FUNC",m[m.STENCIL_FAIL=2964]="STENCIL_FAIL",m[m.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",m[m.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",m[m.STENCIL_REF=2967]="STENCIL_REF",m[m.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",m[m.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",m[m.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",m[m.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",m[m.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",m[m.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",m[m.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",m[m.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",m[m.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",m[m.VIEWPORT=2978]="VIEWPORT",m[m.SCISSOR_BOX=3088]="SCISSOR_BOX",m[m.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",m[m.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",m[m.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",m[m.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",m[m.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",m[m.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",m[m.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",m[m.RED_BITS=3410]="RED_BITS",m[m.GREEN_BITS=3411]="GREEN_BITS",m[m.BLUE_BITS=3412]="BLUE_BITS",m[m.ALPHA_BITS=3413]="ALPHA_BITS",m[m.DEPTH_BITS=3414]="DEPTH_BITS",m[m.STENCIL_BITS=3415]="STENCIL_BITS",m[m.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",m[m.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",m[m.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",m[m.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",m[m.SAMPLES=32937]="SAMPLES",m[m.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",m[m.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",m[m.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",m[m.DONT_CARE=4352]="DONT_CARE",m[m.FASTEST=4353]="FASTEST",m[m.NICEST=4354]="NICEST",m[m.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",m[m.BYTE=5120]="BYTE",m[m.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",m[m.SHORT=5122]="SHORT",m[m.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",m[m.INT=5124]="INT",m[m.UNSIGNED_INT=5125]="UNSIGNED_INT",m[m.FLOAT=5126]="FLOAT",m[m.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",m[m.ALPHA=6406]="ALPHA",m[m.RGB=6407]="RGB",m[m.RGBA=6408]="RGBA",m[m.LUMINANCE=6409]="LUMINANCE",m[m.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",m[m.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",m[m.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",m[m.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",m[m.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",m[m.VERTEX_SHADER=35633]="VERTEX_SHADER",m[m.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",m[m.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",m[m.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",m[m.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",m[m.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",m[m.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",m[m.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",m[m.SHADER_TYPE=35663]="SHADER_TYPE",m[m.DELETE_STATUS=35712]="DELETE_STATUS",m[m.LINK_STATUS=35714]="LINK_STATUS",m[m.VALIDATE_STATUS=35715]="VALIDATE_STATUS",m[m.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",m[m.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",m[m.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",m[m.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",m[m.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",m[m.NEVER=512]="NEVER",m[m.LESS=513]="LESS",m[m.EQUAL=514]="EQUAL",m[m.LEQUAL=515]="LEQUAL",m[m.GREATER=516]="GREATER",m[m.NOTEQUAL=517]="NOTEQUAL",m[m.GEQUAL=518]="GEQUAL",m[m.ALWAYS=519]="ALWAYS",m[m.KEEP=7680]="KEEP",m[m.REPLACE=7681]="REPLACE",m[m.INCR=7682]="INCR",m[m.DECR=7683]="DECR",m[m.INVERT=5386]="INVERT",m[m.INCR_WRAP=34055]="INCR_WRAP",m[m.DECR_WRAP=34056]="DECR_WRAP",m[m.VENDOR=7936]="VENDOR",m[m.RENDERER=7937]="RENDERER",m[m.VERSION=7938]="VERSION",m[m.NEAREST=9728]="NEAREST",m[m.LINEAR=9729]="LINEAR",m[m.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",m[m.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",m[m.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",m[m.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",m[m.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",m[m.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",m[m.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",m[m.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",m[m.TEXTURE_2D=3553]="TEXTURE_2D",m[m.TEXTURE=5890]="TEXTURE",m[m.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",m[m.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",m[m.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",m[m.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",m[m.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",m[m.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",m[m.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",m[m.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",m[m.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",m[m.TEXTURE0=33984]="TEXTURE0",m[m.TEXTURE1=33985]="TEXTURE1",m[m.TEXTURE2=33986]="TEXTURE2",m[m.TEXTURE3=33987]="TEXTURE3",m[m.TEXTURE4=33988]="TEXTURE4",m[m.TEXTURE5=33989]="TEXTURE5",m[m.TEXTURE6=33990]="TEXTURE6",m[m.TEXTURE7=33991]="TEXTURE7",m[m.TEXTURE8=33992]="TEXTURE8",m[m.TEXTURE9=33993]="TEXTURE9",m[m.TEXTURE10=33994]="TEXTURE10",m[m.TEXTURE11=33995]="TEXTURE11",m[m.TEXTURE12=33996]="TEXTURE12",m[m.TEXTURE13=33997]="TEXTURE13",m[m.TEXTURE14=33998]="TEXTURE14",m[m.TEXTURE15=33999]="TEXTURE15",m[m.TEXTURE16=34e3]="TEXTURE16",m[m.TEXTURE17=34001]="TEXTURE17",m[m.TEXTURE18=34002]="TEXTURE18",m[m.TEXTURE19=34003]="TEXTURE19",m[m.TEXTURE20=34004]="TEXTURE20",m[m.TEXTURE21=34005]="TEXTURE21",m[m.TEXTURE22=34006]="TEXTURE22",m[m.TEXTURE23=34007]="TEXTURE23",m[m.TEXTURE24=34008]="TEXTURE24",m[m.TEXTURE25=34009]="TEXTURE25",m[m.TEXTURE26=34010]="TEXTURE26",m[m.TEXTURE27=34011]="TEXTURE27",m[m.TEXTURE28=34012]="TEXTURE28",m[m.TEXTURE29=34013]="TEXTURE29",m[m.TEXTURE30=34014]="TEXTURE30",m[m.TEXTURE31=34015]="TEXTURE31",m[m.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",m[m.REPEAT=10497]="REPEAT",m[m.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",m[m.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",m[m.FLOAT_VEC2=35664]="FLOAT_VEC2",m[m.FLOAT_VEC3=35665]="FLOAT_VEC3",m[m.FLOAT_VEC4=35666]="FLOAT_VEC4",m[m.INT_VEC2=35667]="INT_VEC2",m[m.INT_VEC3=35668]="INT_VEC3",m[m.INT_VEC4=35669]="INT_VEC4",m[m.BOOL=35670]="BOOL",m[m.BOOL_VEC2=35671]="BOOL_VEC2",m[m.BOOL_VEC3=35672]="BOOL_VEC3",m[m.BOOL_VEC4=35673]="BOOL_VEC4",m[m.FLOAT_MAT2=35674]="FLOAT_MAT2",m[m.FLOAT_MAT3=35675]="FLOAT_MAT3",m[m.FLOAT_MAT4=35676]="FLOAT_MAT4",m[m.SAMPLER_2D=35678]="SAMPLER_2D",m[m.SAMPLER_CUBE=35680]="SAMPLER_CUBE",m[m.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",m[m.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",m[m.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",m[m.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",m[m.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",m[m.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",m[m.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",m[m.COMPILE_STATUS=35713]="COMPILE_STATUS",m[m.LOW_FLOAT=36336]="LOW_FLOAT",m[m.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",m[m.HIGH_FLOAT=36338]="HIGH_FLOAT",m[m.LOW_INT=36339]="LOW_INT",m[m.MEDIUM_INT=36340]="MEDIUM_INT",m[m.HIGH_INT=36341]="HIGH_INT",m[m.FRAMEBUFFER=36160]="FRAMEBUFFER",m[m.RENDERBUFFER=36161]="RENDERBUFFER",m[m.RGBA4=32854]="RGBA4",m[m.RGB5_A1=32855]="RGB5_A1",m[m.RGB565=36194]="RGB565",m[m.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",m[m.STENCIL_INDEX=6401]="STENCIL_INDEX",m[m.STENCIL_INDEX8=36168]="STENCIL_INDEX8",m[m.DEPTH_STENCIL=34041]="DEPTH_STENCIL",m[m.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",m[m.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",m[m.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",m[m.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",m[m.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",m[m.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",m[m.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",m[m.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",m[m.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",m[m.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",m[m.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",m[m.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",m[m.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",m[m.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",m[m.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",m[m.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",m[m.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",m[m.NONE=0]="NONE",m[m.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",m[m.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",m[m.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",m[m.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",m[m.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",m[m.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",m[m.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",m[m.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",m[m.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",m[m.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",m[m.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",m[m.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",m[m.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",m[m.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL"})(b||(b={}))},"oCl/":function(ze,E,o){var b=o("CH3K"),m=o("LcsW"),Y=o("MvSz"),F=o("0ycA"),i=Object.getOwnPropertySymbols,Z=i?function(D){for(var $=[];D;)b($,Y(D)),D=m(D);return $}:F;ze.exports=Z},oShl:function(ze,E,o){var b=o("Nsbk"),m=o("SksO"),Y=o("xfeJ"),F=o("sXyB");function i(Z){var D=typeof Map=="function"?new Map:void 0;return ze.exports=i=function(te){if(te===null||!Y(te))return te;if(typeof te!="function")throw new TypeError("Super expression must either be null or a function");if(typeof D!="undefined"){if(D.has(te))return D.get(te);D.set(te,fe)}function fe(){return F(te,arguments,b(this).constructor)}return fe.prototype=Object.create(te.prototype,{constructor:{value:fe,enumerable:!1,writable:!0,configurable:!0}}),m(fe,te)},i(Z)}ze.exports=i},oaX6:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("xfSm"),m=o("GXnB"),Y=o("Ztfv");function F(i){return function(Z,D,$){var te=new m.Metadata(b.NAME_TAG,i);Y.tagParameter(Z,D,$,te)}}E.targetName=F},"otv/":function(ze,E,o){var b=o("nmnc"),m=b?b.prototype:void 0,Y=m?m.valueOf:void 0;function F(i){return Y?Object(Y.call(i)):{}}ze.exports=F},"oy+k":function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("d9O0"),m=function(){function Y(F){this.id=b.id(),this.container=F}return Y.prototype.addPlan=function(F){this.plan=F},Y.prototype.setCurrentRequest=function(F){this.currentRequest=F},Y}();E.Context=m},pFRH:function(ze,E,o){var b=o("cvCv"),m=o("O0oS"),Y=o("zZ0H"),F=m?function(i,Z){return m(i,"toString",{configurable:!0,enumerable:!1,value:b(Z),writable:!0})}:Y;ze.exports=F},q4HE:function(ze,E){var o="\\ud800-\\udfff",b="\\u0300-\\u036f",m="\\ufe20-\\ufe2f",Y="\\u20d0-\\u20ff",F=b+m+Y,i="\\ufe0e\\ufe0f",Z="["+o+"]",D="["+F+"]",$="\\ud83c[\\udffb-\\udfff]",te="(?:"+D+"|"+$+")",fe="[^"+o+"]",K="(?:\\ud83c[\\udde6-\\uddff]){2}",Ge="[\\ud800-\\udbff][\\udc00-\\udfff]",pe="\\u200d",Ze=te+"?",Pe="["+i+"]?",mt="(?:"+pe+"(?:"+[fe,K,Ge].join("|")+")"+Pe+Ze+")*",De=Pe+Ze+mt,At="(?:"+[fe+D+"?",D,K,Ge,Z].join("|")+")",it=RegExp($+"(?="+$+")|"+At+De,"g");function vt(Je){for(var _t=it.lastIndex=0;it.test(Je);)++_t;return _t}ze.exports=vt},qK8v:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("MON2");function m(Y){return Y instanceof RangeError||Y.message===b.STACK_OVERFLOW}E.isStackOverflowExeption=m},qRkn:function(ze,E,o){var b=o("3cYt"),m={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Y=b(m);ze.exports=Y},qd8s:function(ze,E,o){(function(b,m){var Y=200,F="__lodash_hash_undefined__",i=800,Z=16,D=9007199254740991,$="[object Arguments]",te="[object Array]",fe="[object AsyncFunction]",K="[object Boolean]",Ge="[object Date]",pe="[object Error]",Ze="[object Function]",Pe="[object GeneratorFunction]",mt="[object Map]",De="[object Number]",At="[object Null]",it="[object Object]",vt="[object Proxy]",Je="[object RegExp]",_t="[object Set]",wt="[object String]",ke="[object Undefined]",Re="[object WeakMap]",Ve="[object ArrayBuffer]",dt="[object DataView]",Me="[object Float32Array]",ht="[object Float64Array]",Zt="[object Int8Array]",Qt="[object Int16Array]",ur="[object Int32Array]",oe="[object Uint8Array]",Q="[object Uint8ClampedArray]",H="[object Uint16Array]",Se="[object Uint32Array]",be=/[\\^$.*+?()[\]{}|]/g,Te=/^\[object .+?Constructor\]$/,me=/^(?:0|[1-9]\d*)$/,nt={};nt[Me]=nt[ht]=nt[Zt]=nt[Qt]=nt[ur]=nt[oe]=nt[Q]=nt[H]=nt[Se]=!0,nt[$]=nt[te]=nt[Ve]=nt[K]=nt[dt]=nt[Ge]=nt[pe]=nt[Ze]=nt[mt]=nt[De]=nt[it]=nt[Je]=nt[_t]=nt[wt]=nt[Re]=!1;var Jt=typeof b=="object"&&b&&b.Object===Object&&b,Mt=typeof self=="object"&&self&&self.Object===Object&&self,ve=Jt||Mt||Function("return this")(),ge=E&&!E.nodeType&&E,He=ge&&typeof m=="object"&&m&&!m.nodeType&&m,ot=He&&He.exports===ge,we=ot&&Jt.process,gt=function(){try{var Rt=He&&He.require&&He.require("util").types;return Rt||we&&we.binding&&we.binding("util")}catch(fr){}}(),C=gt&&gt.isTypedArray;function R(Rt,fr,Mr){switch(Mr.length){case 0:return Rt.call(fr);case 1:return Rt.call(fr,Mr[0]);case 2:return Rt.call(fr,Mr[0],Mr[1]);case 3:return Rt.call(fr,Mr[0],Mr[1],Mr[2])}return Rt.apply(fr,Mr)}function q(Rt,fr){for(var Mr=-1,Wn=Array(Rt);++Mr<Rt;)Wn[Mr]=fr(Mr);return Wn}function ce(Rt){return function(fr){return Rt(fr)}}function We(Rt,fr){return Rt==null?void 0:Rt[fr]}function qe(Rt,fr){return function(Mr){return Rt(fr(Mr))}}var Tt=Array.prototype,at=Function.prototype,Ut=Object.prototype,J=ve["__core-js_shared__"],Qe=at.toString,ne=Ut.hasOwnProperty,et=function(){var Rt=/[^.]+$/.exec(J&&J.keys&&J.keys.IE_PROTO||"");return Rt?"Symbol(src)_1."+Rt:""}(),kt=Ut.toString,dr=Qe.call(Object),Ye=RegExp("^"+Qe.call(ne).replace(be,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),xt=ot?ve.Buffer:void 0,bt=ve.Symbol,Et=ve.Uint8Array,Fe=xt?xt.allocUnsafe:void 0,pt=qe(Object.getPrototypeOf,Object),yt=Object.create,Ht=Ut.propertyIsEnumerable,hr=Tt.splice,Hr=bt?bt.toStringTag:void 0,gr=function(){try{var Rt=Eu(Object,"defineProperty");return Rt({},"",{}),Rt}catch(fr){}}(),Bn=xt?xt.isBuffer:void 0,zn=Math.max,oa=Date.now,$n=Eu(ve,"Map"),Yn=Eu(Object,"create"),On=function(){function Rt(){}return function(fr){if(!Eo(fr))return{};if(yt)return yt(fr);Rt.prototype=fr;var Mr=new Rt;return Rt.prototype=void 0,Mr}}();function U(Rt){var fr=-1,Mr=Rt==null?0:Rt.length;for(this.clear();++fr<Mr;){var Wn=Rt[fr];this.set(Wn[0],Wn[1])}}function W(){this.__data__=Yn?Yn(null):{},this.size=0}function le(Rt){var fr=this.has(Rt)&&delete this.__data__[Rt];return this.size-=fr?1:0,fr}function xe(Rt){var fr=this.__data__;if(Yn){var Mr=fr[Rt];return Mr===F?void 0:Mr}return ne.call(fr,Rt)?fr[Rt]:void 0}function st(Rt){var fr=this.__data__;return Yn?fr[Rt]!==void 0:ne.call(fr,Rt)}function Ct(Rt,fr){var Mr=this.__data__;return this.size+=this.has(Rt)?0:1,Mr[Rt]=Yn&&fr===void 0?F:fr,this}U.prototype.clear=W,U.prototype.delete=le,U.prototype.get=xe,U.prototype.has=st,U.prototype.set=Ct;function Bt(Rt){var fr=-1,Mr=Rt==null?0:Rt.length;for(this.clear();++fr<Mr;){var Wn=Rt[fr];this.set(Wn[0],Wn[1])}}function Xe(){this.__data__=[],this.size=0}function Lt(Rt){var fr=this.__data__,Mr=Wi(fr,Rt);if(Mr<0)return!1;var Wn=fr.length-1;return Mr==Wn?fr.pop():hr.call(fr,Mr,1),--this.size,!0}function lr(Rt){var fr=this.__data__,Mr=Wi(fr,Rt);return Mr<0?void 0:fr[Mr][1]}function zr(Rt){return Wi(this.__data__,Rt)>-1}function Vr(Rt,fr){var Mr=this.__data__,Wn=Wi(Mr,Rt);return Wn<0?(++this.size,Mr.push([Rt,fr])):Mr[Wn][1]=fr,this}Bt.prototype.clear=Xe,Bt.prototype.delete=Lt,Bt.prototype.get=lr,Bt.prototype.has=zr,Bt.prototype.set=Vr;function cr(Rt){var fr=-1,Mr=Rt==null?0:Rt.length;for(this.clear();++fr<Mr;){var Wn=Rt[fr];this.set(Wn[0],Wn[1])}}function Ur(){this.size=0,this.__data__={hash:new U,map:new($n||Bt),string:new U}}function Mn(Rt){var fr=so(this,Rt).delete(Rt);return this.size-=fr?1:0,fr}function ln(Rt){return so(this,Rt).get(Rt)}function er(Rt){return so(this,Rt).has(Rt)}function tn(Rt,fr){var Mr=so(this,Rt),Wn=Mr.size;return Mr.set(Rt,fr),this.size+=Mr.size==Wn?0:1,this}cr.prototype.clear=Ur,cr.prototype.delete=Mn,cr.prototype.get=ln,cr.prototype.has=er,cr.prototype.set=tn;function hn(Rt){var fr=this.__data__=new Bt(Rt);this.size=fr.size}function xn(){this.__data__=new Bt,this.size=0}function yn(Rt){var fr=this.__data__,Mr=fr.delete(Rt);return this.size=fr.size,Mr}function vn(Rt){return this.__data__.get(Rt)}function Pn(Rt){return this.__data__.has(Rt)}function Va(Rt,fr){var Mr=this.__data__;if(Mr instanceof Bt){var Wn=Mr.__data__;if(!$n||Wn.length<Y-1)return Wn.push([Rt,fr]),this.size=++Mr.size,this;Mr=this.__data__=new cr(Wn)}return Mr.set(Rt,fr),this.size=Mr.size,this}hn.prototype.clear=xn,hn.prototype.delete=yn,hn.prototype.get=vn,hn.prototype.has=Pn,hn.prototype.set=Va;function va(Rt,fr){var Mr=Ml(Rt),Wn=!Mr&&Fu(Rt),Xa=!Mr&&!Wn&&Tu(Rt),vi=!Mr&&!Wn&&!Xa&&Ks(Rt),Ki=Mr||Wn||Xa||vi,Ya=Ki?q(Rt.length,String):[],Ii=Ya.length;for(var Go in Rt)(fr||ne.call(Rt,Go))&&!(Ki&&(Go=="length"||Xa&&(Go=="offset"||Go=="parent")||vi&&(Go=="buffer"||Go=="byteLength"||Go=="byteOffset")||ks(Go,Ii)))&&Ya.push(Go);return Ya}function Ma(Rt,fr,Mr){(Mr!==void 0&&!Oo(Rt[fr],Mr)||Mr===void 0&&!(fr in Rt))&&da(Rt,fr,Mr)}function Ia(Rt,fr,Mr){var Wn=Rt[fr];(!(ne.call(Rt,fr)&&Oo(Wn,Mr))||Mr===void 0&&!(fr in Rt))&&da(Rt,fr,Mr)}function Wi(Rt,fr){for(var Mr=Rt.length;Mr--;)if(Oo(Rt[Mr][0],fr))return Mr;return-1}function da(Rt,fr,Mr){fr=="__proto__"&&gr?gr(Rt,fr,{configurable:!0,enumerable:!0,value:Mr,writable:!0}):Rt[fr]=Mr}var di=oo();function ga(Rt){return Rt==null?Rt===void 0?ke:At:Hr&&Hr in Object(Rt)?$o(Rt):Qr(Rt)}function ya(Rt){return Fi(Rt)&&ga(Rt)==$}function fa(Rt){if(!Eo(Rt)||Le(Rt))return!1;var fr=Mo(Rt)?Ye:Te;return fr.test(mo(Rt))}function Si(Rt){return Fi(Rt)&&zu(Rt.length)&&!!nt[ga(Rt)]}function ns(Rt){if(!Eo(Rt))return mr(Rt);var fr=Dt(Rt),Mr=[];for(var Wn in Rt)Wn=="constructor"&&(fr||!ne.call(Rt,Wn))||Mr.push(Wn);return Mr}function Xi(Rt,fr,Mr,Wn,Xa){if(Rt===fr)return;di(fr,function(vi,Ki){if(Xa||(Xa=new hn),Eo(vi))Vo(Rt,fr,Ki,Mr,Xi,Wn,Xa);else{var Ya=Wn?Wn(Vn(Rt,Ki),vi,Ki+"",Rt,fr,Xa):void 0;Ya===void 0&&(Ya=vi),Ma(Rt,Ki,Ya)}},Ri)}function Vo(Rt,fr,Mr,Wn,Xa,vi,Ki){var Ya=Vn(Rt,Mr),Ii=Vn(fr,Mr),Go=Ki.get(Ii);if(Go){Ma(Rt,Mr,Go);return}var Cs=vi?vi(Ya,Ii,Mr+"",Rt,fr,Ki):void 0,pi=Cs===void 0;if(pi){var Pl=Ml(Ii),$s=!Pl&&Tu(Ii),Es=!Pl&&!$s&&Ks(Ii);Cs=Ii,Pl||$s||Es?Ml(Ya)?Cs=Ya:vc(Ya)?Cs=Yi(Ya):$s?(pi=!1,Cs=Ai(Ii,!0)):Es?(pi=!1,Cs=oi(Ii,!0)):Cs=[]:Ys(Ii)||Fu(Ii)?(Cs=Ya,Fu(Ya)?Cs=js(Ya):(!Eo(Ya)||Mo(Ya))&&(Cs=Kl(Ii))):pi=!1}pi&&(Ki.set(Ii,Cs),Xa(Cs,Ii,Wn,vi,Ki),Ki.delete(Ii)),Ma(Rt,Mr,Cs)}function ju(Rt,fr){return Ci(En(Rt,fr,vl),Rt+"")}var Ga=gr?function(Rt,fr){return gr(Rt,"toString",{configurable:!0,enumerable:!1,value:xs(fr),writable:!0})}:vl;function Ai(Rt,fr){if(fr)return Rt.slice();var Mr=Rt.length,Wn=Fe?Fe(Mr):new Rt.constructor(Mr);return Rt.copy(Wn),Wn}function Ko(Rt){var fr=new Rt.constructor(Rt.byteLength);return new Et(fr).set(new Et(Rt)),fr}function oi(Rt,fr){var Mr=fr?Ko(Rt.buffer):Rt.buffer;return new Rt.constructor(Mr,Rt.byteOffset,Rt.length)}function Yi(Rt,fr){var Mr=-1,Wn=Rt.length;for(fr||(fr=Array(Wn));++Mr<Wn;)fr[Mr]=Rt[Mr];return fr}function wo(Rt,fr,Mr,Wn){var Xa=!Mr;Mr||(Mr={});for(var vi=-1,Ki=fr.length;++vi<Ki;){var Ya=fr[vi],Ii=Wn?Wn(Mr[Ya],Rt[Ya],Ya,Mr,Rt):void 0;Ii===void 0&&(Ii=Rt[Ya]),Xa?da(Mr,Ya,Ii):Ia(Mr,Ya,Ii)}return Mr}function Ha(Rt){return ju(function(fr,Mr){var Wn=-1,Xa=Mr.length,vi=Xa>1?Mr[Xa-1]:void 0,Ki=Xa>2?Mr[2]:void 0;for(vi=Rt.length>3&&typeof vi=="function"?(Xa--,vi):void 0,Ki&&ho(Mr[0],Mr[1],Ki)&&(vi=Xa<3?void 0:vi,Xa=1),fr=Object(fr);++Wn<Xa;){var Ya=Mr[Wn];Ya&&Rt(fr,Ya,Wn,vi)}return fr})}function oo(Rt){return function(fr,Mr,Wn){for(var Xa=-1,vi=Object(fr),Ki=Wn(fr),Ya=Ki.length;Ya--;){var Ii=Ki[Rt?Ya:++Xa];if(Mr(vi[Ii],Ii,vi)===!1)break}return fr}}function so(Rt,fr){var Mr=Rt.__data__;return Vt(fr)?Mr[typeof fr=="string"?"string":"hash"]:Mr.map}function Eu(Rt,fr){var Mr=We(Rt,fr);return fa(Mr)?Mr:void 0}function $o(Rt){var fr=ne.call(Rt,Hr),Mr=Rt[Hr];try{Rt[Hr]=void 0;var Wn=!0}catch(vi){}var Xa=kt.call(Rt);return Wn&&(fr?Rt[Hr]=Mr:delete Rt[Hr]),Xa}function Kl(Rt){return typeof Rt.constructor=="function"&&!Dt(Rt)?On(pt(Rt)):{}}function ks(Rt,fr){var Mr=typeof Rt;return fr=fr==null?D:fr,!!fr&&(Mr=="number"||Mr!="symbol"&&me.test(Rt))&&Rt>-1&&Rt%1==0&&Rt<fr}function ho(Rt,fr,Mr){if(!Eo(Mr))return!1;var Wn=typeof fr;return(Wn=="number"?bs(Mr)&&ks(fr,Mr.length):Wn=="string"&&fr in Mr)?Oo(Mr[fr],Rt):!1}function Vt(Rt){var fr=typeof Rt;return fr=="string"||fr=="number"||fr=="symbol"||fr=="boolean"?Rt!=="__proto__":Rt===null}function Le(Rt){return!!et&&et in Rt}function Dt(Rt){var fr=Rt&&Rt.constructor,Mr=typeof fr=="function"&&fr.prototype||Ut;return Rt===Mr}function mr(Rt){var fr=[];if(Rt!=null)for(var Mr in Object(Rt))fr.push(Mr);return fr}function Qr(Rt){return kt.call(Rt)}function En(Rt,fr,Mr){return fr=zn(fr===void 0?Rt.length-1:fr,0),function(){for(var Wn=arguments,Xa=-1,vi=zn(Wn.length-fr,0),Ki=Array(vi);++Xa<vi;)Ki[Xa]=Wn[fr+Xa];Xa=-1;for(var Ya=Array(fr+1);++Xa<fr;)Ya[Xa]=Wn[Xa];return Ya[fr]=Mr(Ki),R(Rt,this,Ya)}}function Vn(Rt,fr){return fr==="constructor"&&typeof Rt[fr]=="function"||fr=="__proto__"?void 0:Rt[fr]}var Ci=po(Ga);function po(Rt){var fr=0,Mr=0;return function(){var Wn=oa(),Xa=Z-(Wn-Mr);if(Mr=Wn,Xa>0){if(++fr>=i)return arguments[0]}else fr=0;return Rt.apply(void 0,arguments)}}function mo(Rt){if(Rt!=null){try{return Qe.call(Rt)}catch(fr){}try{return Rt+""}catch(fr){}}return""}function Oo(Rt,fr){return Rt===fr||Rt!==Rt&&fr!==fr}var Fu=ya(function(){return arguments}())?ya:function(Rt){return Fi(Rt)&&ne.call(Rt,"callee")&&!Ht.call(Rt,"callee")},Ml=Array.isArray;function bs(Rt){return Rt!=null&&zu(Rt.length)&&!Mo(Rt)}function vc(Rt){return Fi(Rt)&&bs(Rt)}var Tu=Bn||Qu;function Mo(Rt){if(!Eo(Rt))return!1;var fr=ga(Rt);return fr==Ze||fr==Pe||fr==fe||fr==vt}function zu(Rt){return typeof Rt=="number"&&Rt>-1&&Rt%1==0&&Rt<=D}function Eo(Rt){var fr=typeof Rt;return Rt!=null&&(fr=="object"||fr=="function")}function Fi(Rt){return Rt!=null&&typeof Rt=="object"}function Ys(Rt){if(!Fi(Rt)||ga(Rt)!=it)return!1;var fr=pt(Rt);if(fr===null)return!0;var Mr=ne.call(fr,"constructor")&&fr.constructor;return typeof Mr=="function"&&Mr instanceof Mr&&Qe.call(Mr)==dr}var Ks=C?ce(C):Si;function js(Rt){return wo(Rt,Ri(Rt))}function Ri(Rt){return bs(Rt)?va(Rt,!0):ns(Rt)}var Vi=Ha(function(Rt,fr,Mr,Wn){Xi(Rt,fr,Mr,Wn)});function xs(Rt){return function(){return Rt}}function vl(Rt){return Rt}function Qu(){return!1}m.exports=Vi}).call(this,o("yLpj"),o("YuTi")(ze))},quyA:function(ze,E){var o="\\ud800-\\udfff",b="\\u0300-\\u036f",m="\\ufe20-\\ufe2f",Y="\\u20d0-\\u20ff",F=b+m+Y,i="\\ufe0e\\ufe0f",Z="\\u200d",D=RegExp("["+Z+o+F+i+"]");function $(te){return D.test(te)}ze.exports=$},qxNg:function(ze,E,o){"use strict";o.d(E,"a",function(){return D});var b=o("lSNA"),m=o.n(b),Y=o("mpbz"),F=o.n(Y);function i(te,fe){var K=Object.keys(te);if(Object.getOwnPropertySymbols){var Ge=Object.getOwnPropertySymbols(te);fe&&(Ge=Ge.filter(function(pe){return Object.getOwnPropertyDescriptor(te,pe).enumerable})),K.push.apply(K,Ge)}return K}function Z(te){for(var fe=1;fe<arguments.length;fe++){var K=arguments[fe]!=null?arguments[fe]:{};fe%2?i(Object(K),!0).forEach(function(Ge){m()(te,Ge,K[Ge])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(K)):i(Object(K)).forEach(function(Ge){Object.defineProperty(te,Ge,Object.getOwnPropertyDescriptor(K,Ge))})}return te}function D(te,fe){var K=fe.radius,Ge=K===void 0?40:K,pe=fe.maxZoom,Ze=pe===void 0?18:pe,Pe=fe.minZoom,mt=Pe===void 0?0:Pe,De=fe.zoom,At=De===void 0?2:De;if(te.pointIndex){var it=te.pointIndex.getClusters(te.extent,Math.floor(At));return te.dataArray=$(it),te}var vt=new F.a({radius:Ge,minZoom:mt,maxZoom:Ze}),Je={type:"FeatureCollection",features:[]};return Je.features=te.dataArray.map(function(_t){return{type:"Feature",geometry:{type:"Point",coordinates:_t.coordinates},properties:Z({},_t)}}),vt.load(Je.features),vt}function $(te){return te.map(function(fe,K){return Z({coordinates:fe.geometry.coordinates,_id:K+1},fe.properties)})}},riiI:function(ze,E){},rlAn:function(ze,E,o){"use strict";var b=o("ISu3"),m=o("gMG2"),Y=o("5gLl"),F=o("BpBL"),i=o("5zYK"),Z=o("lJbI"),D=o("l94r"),$=o("qxNg"),te=o("Y8BV"),fe=o("VIsB"),K=o("+VLl"),Ge=o("aF1E"),pe=o("fdMe");o.d(E,"getTransform",function(){return b.b}),o.d(E,"getParser",function(){return b.a});var Ze=o("U1ZX"),Pe=o.n(Ze);E.default=D.a,Object(b.c)("geojson",Y.a),Object(b.c)("image",F.a),Object(b.c)("csv",m.a),Object(b.c)("json",i.a),Object(b.c)("raster",Z.a),Object(b.d)("cluster",$.a),Object(b.d)("filter",te.a),Object(b.d)("join",Ge.a),Object(b.d)("map",pe.a),Object(b.d)("grid",fe.a),Object(b.d)("hexagon",K.a)},rxlC:function(ze,E,o){"use strict";ze.exports=m,ze.exports.default=m;var b=1e20;function m(i,Z,D,$,te,fe){this.fontSize=i||24,this.buffer=Z===void 0?3:Z,this.cutoff=$||.25,this.fontFamily=te||"sans-serif",this.fontWeight=fe||"normal",this.radius=D||8;var K=this.size=this.fontSize+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=K,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(K*K),this.gridInner=new Float64Array(K*K),this.f=new Float64Array(K),this.d=new Float64Array(K),this.z=new Float64Array(K+1),this.v=new Int16Array(K),this.middle=Math.round(K/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}m.prototype.draw=function(i){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(i,this.buffer,this.middle);for(var Z=this.ctx.getImageData(0,0,this.size,this.size),D=new Uint8ClampedArray(this.size*this.size),$=0;$<this.size*this.size;$++){var te=Z.data[$*4+3]/255;this.gridOuter[$]=te===1?0:te===0?b:Math.pow(Math.max(0,.5-te),2),this.gridInner[$]=te===1?b:te===0?0:Math.pow(Math.max(0,te-.5),2)}for(Y(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Y(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),$=0;$<this.size*this.size;$++){var fe=this.gridOuter[$]-this.gridInner[$];D[$]=Math.max(0,Math.min(255,Math.round(255-255*(fe/this.radius+this.cutoff))))}return D};function Y(i,Z,D,$,te,fe,K){for(var Ge=0;Ge<Z;Ge++){for(var pe=0;pe<D;pe++)$[pe]=i[pe*Z+Ge];for(F($,te,fe,K,D),pe=0;pe<D;pe++)i[pe*Z+Ge]=te[pe]}for(pe=0;pe<D;pe++){for(Ge=0;Ge<Z;Ge++)$[Ge]=i[pe*Z+Ge];for(F($,te,fe,K,Z),Ge=0;Ge<Z;Ge++)i[pe*Z+Ge]=Math.sqrt(te[Ge])}}function F(i,Z,D,$,te){D[0]=0,$[0]=-b,$[1]=+b;for(var fe=1,K=0;fe<te;fe++){for(var Ge=(i[fe]+fe*fe-(i[D[K]]+D[K]*D[K]))/(2*fe-2*D[K]);Ge<=$[K];)K--,Ge=(i[fe]+fe*fe-(i[D[K]]+D[K]*D[K]))/(2*fe-2*D[K]);K++,D[K]=fe,$[K]=Ge,$[K+1]=+b}for(fe=0,K=0;fe<te;fe++){for(;$[K+1]<fe;)K++;Z[fe]=(fe-D[K])*(fe-D[K])+i[D[K]]}}},sGsY:function(ze,E,o){"use strict";var b=o("lSNA"),m=o.n(b),Y=o("pVnL"),F=o.n(Y),i=o("q1tI"),Z=o("TSYQ"),D=o.n(Z),$=o("H84U"),te=o("/ezw"),fe=o("B6l+"),K=o.n(fe),Ge=function(me){var nt=me.value,Jt=me.formatter,Mt=me.precision,ve=me.decimalSeparator,ge=me.groupSeparator,He=ge===void 0?"":ge,ot=me.prefixCls,we;if(typeof Jt=="function")we=Jt(nt);else{var gt=String(nt),C=gt.match(/^(-?)(\d*)(\.(\d+))?$/);if(!C||gt==="-")we=gt;else{var R=C[1],q=C[2]||"0",ce=C[4]||"";q=q.replace(/\B(?=(\d{3})+(?!\d))/g,He),typeof Mt=="number"&&(ce=K()(ce,Mt,"0").slice(0,Mt)),ce&&(ce="".concat(ve).concat(ce)),we=[i.createElement("span",{key:"int",className:"".concat(ot,"-content-value-int")},R,q),ce&&i.createElement("span",{key:"decimal",className:"".concat(ot,"-content-value-decimal")},ce)]}}return i.createElement("span",{className:"".concat(ot,"-content-value")},we)},pe=Ge,Ze=function(me){var nt=me.prefixCls,Jt=me.className,Mt=me.style,ve=me.valueStyle,ge=me.value,He=ge===void 0?0:ge,ot=me.title,we=me.valueRender,gt=me.prefix,C=me.suffix,R=me.loading,q=me.direction,ce=me.onMouseEnter,We=me.onMouseLeave,qe=i.createElement(pe,F()({},me,{value:He})),Tt=D()(nt,m()({},"".concat(nt,"-rtl"),q==="rtl"),Jt);return i.createElement("div",{className:Tt,style:Mt,onMouseEnter:ce,onMouseLeave:We},ot&&i.createElement("div",{className:"".concat(nt,"-title")},ot),i.createElement(te.a,{paragraph:!1,loading:R},i.createElement("div",{style:ve,className:"".concat(nt,"-content")},gt&&i.createElement("span",{className:"".concat(nt,"-content-prefix")},gt),we?we(qe):qe,C&&i.createElement("span",{className:"".concat(nt,"-content-suffix")},C))))};Ze.defaultProps={decimalSeparator:".",groupSeparator:",",loading:!1};var Pe=Object($.c)({prefixCls:"statistic"})(Ze),mt=Pe,De=o("lwsE"),At=o.n(De),it=o("W8MJ"),vt=o.n(it),Je=o("7W2i"),_t=o.n(Je),wt=o("LQ03"),ke=o.n(wt),Re=o("J4zp"),Ve=o.n(Re),dt=o("QQZ/"),Me=o.n(dt),ht=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function Zt(Te,me){var nt=Te,Jt=/\[[^\]]*]/g,Mt=(me.match(Jt)||[]).map(function(ot){return ot.slice(1,-1)}),ve=me.replace(Jt,"[]"),ge=ht.reduce(function(ot,we){var gt=Ve()(we,2),C=gt[0],R=gt[1];if(ot.indexOf(C)!==-1){var q=Math.floor(nt/R);return nt-=q*R,ot.replace(new RegExp("".concat(C,"+"),"g"),function(ce){var We=ce.length;return Me()(q.toString(),We,"0")})}return ot},ve),He=0;return ge.replace(Jt,function(){var ot=Mt[He];return He+=1,ot})}function Qt(Te,me){var nt=me.format,Jt=nt===void 0?"":nt,Mt=new Date(Te).getTime(),ve=Date.now(),ge=Math.max(Mt-ve,0);return Zt(ge,Jt)}var ur=o("0n0R"),oe=1e3/30;function Q(Te){return new Date(Te).getTime()}var H=function(Te){_t()(nt,Te);var me=ke()(nt);function nt(){var Jt;return At()(this,nt),Jt=me.apply(this,arguments),Jt.syncTimer=function(){var Mt=Jt.props.value,ve=Q(Mt);ve>=Date.now()?Jt.startTimer():Jt.stopTimer()},Jt.startTimer=function(){if(Jt.countdownId)return;Jt.countdownId=window.setInterval(function(){Jt.forceUpdate()},oe)},Jt.stopTimer=function(){var Mt=Jt.props,ve=Mt.onFinish,ge=Mt.value;if(Jt.countdownId){clearInterval(Jt.countdownId),Jt.countdownId=void 0;var He=Q(ge);ve&&He<Date.now()&&ve()}},Jt.formatCountdown=function(Mt,ve){var ge=Jt.props.format;return Qt(Mt,F()(F()({},ve),{format:ge}))},Jt.valueRender=function(Mt){return Object(ur.a)(Mt,{title:void 0})},Jt}return vt()(nt,[{key:"componentDidMount",value:function(){this.syncTimer()}},{key:"componentDidUpdate",value:function(){this.syncTimer()}},{key:"componentWillUnmount",value:function(){this.stopTimer()}},{key:"render",value:function(){return i.createElement(mt,F()({valueRender:this.valueRender},this.props,{formatter:this.formatCountdown}))}}]),nt}(i.Component);H.defaultProps={format:"HH:mm:ss"};var Se=H;mt.Countdown=Se;var be=E.a=mt},sKgW:function(ze,E){var o=9007199254740991,b=Math.floor;function m(Y,F){var i="";if(!Y||F<1||F>o)return i;do F%2&&(i+=Y),F=b(F/2),F&&(Y+=Y);while(F);return i}ze.exports=m},sXyB:function(ze,E,o){var b=o("SksO"),m=o("b48C");function Y(F,i,Z){return m()?ze.exports=Y=Reflect.construct:ze.exports=Y=function($,te,fe){var K=[null];K.push.apply(K,te);var Ge=Function.bind.apply($,K),pe=new Ge;return fe&&b(pe,fe.prototype),pe},Y.apply(null,arguments)}ze.exports=Y},sgoq:function(ze,E,o){var b=o("asDA"),m=o("TKrE"),Y=o("6nK8"),F="['\u2019]",i=RegExp(F,"g");function Z(D){return function($){return b(Y(m($).replace(i,"")),D,"")}}ze.exports=Z},sxDa:function(ze,E,o){"use strict";o.d(E,"e",function(){return ul}),o.d(E,"f",function(){return ro}),o.d(E,"d",function(){return Nc}),o.d(E,"a",function(){return so}),o.d(E,"c",function(){return Ii}),o.d(E,"g",function(){return Uc}),o.d(E,"b",function(){return vl});var b=o("h1nZ"),m=o("lwsE"),Y=o.n(m),F=o("W8MJ"),i=o.n(F),Z=o("7W2i"),D=o.n(Z),$=o("a1gu"),te=o.n($),fe=o("Nsbk"),K=o.n(fe),Ge=o("QILm"),pe=o.n(Ge),Ze=o("lSNA"),Pe=o.n(Ze),mt=o("yG8O"),De=o.n(mt),At=o("PJYZ"),it=o.n(At),vt=o("U+yc"),Je=o.n(vt),_t=o("1ABj"),wt=o("GoyQ"),ke=o.n(wt),Re=o("lSCD"),Ve=o.n(Re),dt=o("xp6e"),Me=o("Hel2"),ht=o("uhBA"),Zt=o("4U9+"),Qt=o.n(Zt),ur=o("4cb6"),oe,Q,H,Se,be,Te;function me(h){return h.map(function(_){return typeof _=="string"&&(_=[_,{}]),_})}var nt=(oe=Object(ur.injectable)(),Q=Object(ur.inject)(b.TYPES.IGlobalConfigService),oe(H=(Se=(Te=function(){function h(){Y()(this,h),De()(this,"configService",be,this),this.enabled=void 0}return i()(h,[{key:"apply",value:function(x,y){var A=this,M=y.rendererService,B=y.postProcessingPassFactory,ie=y.normalPassFactory;x.hooks.init.tap("MultiPassRendererPlugin",function(){var de=x.getLayerConfig(),Be=de.enableMultiPassRenderer,zt=de.passes,qt=zt===void 0?[]:zt;A.enabled=!!Be&&x.getLayerConfig().enableMultiPassRenderer!==!1,A.enabled&&(x.multiPassRenderer=A.createMultiPassRenderer(x,qt,B,ie),x.multiPassRenderer.setRenderFlag(!0))}),x.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){})}},{key:"createMultiPassRenderer",value:function(x,y,A,M){var B=x.multiPassRenderer,ie=x.getLayerConfig(),de=ie.enablePicking,Be=ie.enableTAA;return de&&B.add(M("pixelPicking")),B}}]),h}(),Te),be=Je()(Se.prototype,"configService",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Se))||H),Jt,Mt=(Jt={},Pe()(Jt,b.BlendType.additive,{enable:!0,func:{srcRGB:b.gl.ONE,dstRGB:b.gl.ONE,srcAlpha:1,dstAlpha:1}}),Pe()(Jt,b.BlendType.none,{enable:!1}),Pe()(Jt,b.BlendType.normal,{enable:!0,func:{srcRGB:b.gl.SRC_ALPHA,dstRGB:b.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),Pe()(Jt,b.BlendType.subtractive,{enable:!0,func:{srcRGB:b.gl.ONE,dstRGB:b.gl.ONE,srcAlpha:b.gl.ZERO,dstAlpha:b.gl.ONE_MINUS_SRC_COLOR},equation:{rgb:b.gl.FUNC_SUBTRACT,alpha:b.gl.FUNC_SUBTRACT}}),Pe()(Jt,b.BlendType.max,{enable:!0,func:{srcRGB:b.gl.ONE,dstRGB:b.gl.ONE},equation:{rgb:b.gl.MAX_EXT}}),Pe()(Jt,b.BlendType.min,{enable:!0,func:{srcRGB:b.gl.ONE,dstRGB:b.gl.ONE},equation:{rgb:b.gl.MIN_EXT}}),Jt),ve={properties:{enablePicking:{type:"boolean"},enableHighlight:{type:"boolean"},highlightColor:{oneOf:[{type:"array",items:{type:"number",minimum:0,maximum:1}},{type:"string"}]}}},ge,He,ot,we,gt,C,R,q;function ce(h,_){var x;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(x=We(h))||_&&h&&typeof h.length=="number"){x&&(h=x);var y=0,A=function(){};return{s:A,n:function(){return y>=h.length?{done:!0}:{done:!1,value:h[y++]}},e:function(Be){throw Be},f:A}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,B=!1,ie;return{s:function(){x=h[Symbol.iterator]()},n:function(){var Be=x.next();return M=Be.done,Be},e:function(Be){B=!0,ie=Be},f:function(){try{!M&&x.return!=null&&x.return()}finally{if(B)throw ie}}}}function We(h,_){if(!h)return;if(typeof h=="string")return qe(h,_);var x=Object.prototype.toString.call(h).slice(8,-1);if(x==="Object"&&h.constructor&&(x=h.constructor.name),x==="Map"||x==="Set")return Array.from(h);if(x==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(x))return qe(h,_)}function qe(h,_){(_==null||_>h.length)&&(_=h.length);for(var x=0,y=new Array(_);x<_;x++)y[x]=h[x];return y}function Tt(h,_){var x=Object.keys(h);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(h);_&&(y=y.filter(function(A){return Object.getOwnPropertyDescriptor(h,A).enumerable})),x.push.apply(x,y)}return x}function at(h){for(var _=1;_<arguments.length;_++){var x=arguments[_]!=null?arguments[_]:{};_%2?Tt(Object(x),!0).forEach(function(y){Pe()(h,y,x[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(x)):Tt(Object(x)).forEach(function(y){Object.defineProperty(h,y,Object.getOwnPropertyDescriptor(x,y))})}return h}function Ut(h){var _=J();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function J(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Qe=0,ne=(ge=Object(b.lazyInject)(b.TYPES.ILogService),He=Object(b.lazyInject)(b.TYPES.IGlobalConfigService),ot=Object(b.lazyInject)(b.TYPES.IShaderModuleService),we=(q=function(h){D()(x,h);var _=Ut(x);function x(){var y,A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Y()(this,x),y=_.call(this),y.id="".concat(Qe++),y.name="".concat(Qe),y.type=void 0,y.visible=!0,y.zIndex=0,y.minZoom=void 0,y.maxZoom=void 0,y.inited=!1,y.layerModelNeedUpdate=!1,y.pickedFeatureID=null,y.selectedFeatureID=null,y.styleNeedUpdate=!1,y.dataState={dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1},y.hooks={init:new dt.b,afterInit:new dt.b,beforeRender:new dt.b,beforeRenderData:new dt.d,afterRender:new dt.c,beforePickingEncode:new dt.c,afterPickingEncode:new dt.c,beforeHighlight:new dt.c(["pickedColor"]),afterHighlight:new dt.c,beforeSelect:new dt.c(["pickedColor"]),afterSelect:new dt.c,beforeDestroy:new dt.c,afterDestroy:new dt.c},y.models=[],y.multiPassRenderer=void 0,y.plugins=void 0,y.sourceOption=void 0,y.layerModel=void 0,De()(y,"logger",gt,it()(y)),De()(y,"configService",C,it()(y)),De()(y,"shaderModuleService",R,it()(y)),y.cameraService=void 0,y.coordinateService=void 0,y.iconService=void 0,y.fontService=void 0,y.rendererService=void 0,y.layerService=void 0,y.interactionService=void 0,y.mapService=void 0,y.styleAttributeService=void 0,y.layerSource=void 0,y.postProcessingPassFactory=void 0,y.normalPassFactory=void 0,y.animateOptions={enable:!1},y.container=void 0,y.encodedData=void 0,y.configSchema=void 0,y.currentPickId=null,y.rawConfig=void 0,y.needUpdateConfig=void 0,y.pendingStyleAttributes=[],y.scaleOptions={},y.animateStartTime=void 0,y.aniamateStatus=!1,y.sourceEvent=function(){y.dataState.dataSourceNeedUpdate=!0;var M=y.getLayerConfig(),B=M.autoFit,ie=M.fitBoundsOptions;B&&y.fitBounds(ie),y.emit("dataUpdate"),y.reRender()},y.name=A.name||y.id,y.zIndex=A.zIndex||0,y.rawConfig=A,y}return i()(x,[{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(A){if(!this.inited)this.needUpdateConfig=at(at({},this.needUpdateConfig),A);else{var M=this.container.get(b.TYPES.SceneID);this.configService.setLayerConfig(M,this.id,at(at(at({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),A)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(A){this.container=A}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(A){return this.plugins.push(A),this}},{key:"init",value:function(){var A=this,M=this.container.get(b.TYPES.SceneID),B=this.rawConfig.enableMultiPassRenderer,ie=B===void 0?!1:B;this.configService.setLayerConfig(M,this.id,{enableMultiPassRenderer:ie}),this.iconService=this.container.get(b.TYPES.IIconService),this.fontService=this.container.get(b.TYPES.IFontService),this.rendererService=this.container.get(b.TYPES.IRendererService),this.layerService=this.container.get(b.TYPES.ILayerService),this.interactionService=this.container.get(b.TYPES.IInteractionService),this.mapService=this.container.get(b.TYPES.IMapService),this.cameraService=this.container.get(b.TYPES.ICameraService),this.coordinateService=this.container.get(b.TYPES.ICoordinateSystemService),this.postProcessingPassFactory=this.container.get(b.TYPES.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(b.TYPES.IFactoryNormalPass),this.styleAttributeService=this.container.get(b.TYPES.IStyleAttributeService),this.multiPassRenderer=this.container.get(b.TYPES.IMultiPassRenderer),this.multiPassRenderer.setLayer(this),this.pendingStyleAttributes.forEach(function(qt){var Or=qt.attributeName,Nr=qt.attributeField,bn=qt.attributeValues,gn=qt.updateOptions;A.styleAttributeService.updateStyleAttribute(Or,{scale:at({field:Nr},A.splitValuesAndCallbackInAttribute(bn,A.getLayerConfig()[Or]))},gn)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(b.TYPES.ILayerPlugin);var de=ce(this.plugins),Be;try{for(de.s();!(Be=de.n()).done;){var zt=Be.value;zt.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}}catch(qt){de.e(qt)}finally{de.f()}return this.hooks.init.call(),this.hooks.afterInit.call(),this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this}},{key:"prepareBuildModel",value:function(){this.inited=!0,this.updateLayerConfig(at(at({},this.getDefaultConfig()),this.rawConfig));var A=this.getLayerConfig(),M=A.animateOption;(M==null?void 0:M.enable)&&(this.layerService.startAnimate(),this.aniamateStatus=!0)}},{key:"color",value:function(A,M,B){return this.updateStyleAttribute("color",A,M,B),this}},{key:"size",value:function(A,M,B){return this.updateStyleAttribute("size",A,M,B),this}},{key:"filter",value:function(A,M,B){return this.updateStyleAttribute("filter",A,M,B),this}},{key:"shape",value:function(A,M,B){return this.updateStyleAttribute("shape",A,M,B),this}},{key:"label",value:function(A,M,B){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:A,attributeValues:M,updateOptions:B}),this}},{key:"animate",value:function(A){var M={};return ke()(A)?(M.enable=!0,M=at(at({},M),A)):M.enable=A,this.updateLayerConfig({animateOption:M}),this}},{key:"source",value:function(A,M){return this.sourceOption={data:A,options:M},this}},{key:"setData",value:function(A,M){var B=this;return this.inited?this.layerSource.setData(A,M):this.on("inited",function(){B.layerSource.setData(A,M)}),this}},{key:"style",value:function(A){var M=this,B=A.passes,ie=pe()(A,["passes"]);return B&&me(B).forEach(function(de){var Be=M.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(de[0]);Be&&Be.updateOptions(de[1])}),this.rawConfig=at(at({},this.rawConfig),ie),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),this}},{key:"scale",value:function(A,M){return ke()(A)?this.scaleOptions=at(at({},this.scaleOptions),A):this.scaleOptions[A]=M,this}},{key:"render",value:function(){return this.renderModels(),this}},{key:"active",value:function(A){var M={};return M.enableHighlight=ke()(A)?!0:A,ke()(A)?(M.enableHighlight=!0,A.color&&(M.highlightColor=A.color)):M.enableHighlight=!!A,this.updateLayerConfig(M),this}},{key:"setActive",value:function(A,M){var B=this;if(ke()(A)){var ie=A.x,de=ie===void 0?0:ie,Be=A.y,zt=Be===void 0?0:Be;this.updateLayerConfig({highlightColor:ke()(M)?M.color:this.getLayerConfig().highlightColor}),this.pick({x:de,y:zt})}else this.updateLayerConfig({pickedFeatureID:A,highlightColor:ke()(M)?M.color:this.getLayerConfig().highlightColor}),this.hooks.beforeSelect.call(Object(Me.l)(A)).then(function(){setTimeout(function(){B.reRender()},1)})}},{key:"select",value:function(A){var M={};return M.enableSelect=ke()(A)?!0:A,ke()(A)?(M.enableSelect=!0,A.color&&(M.selectColor=A.color)):M.enableSelect=!!A,this.updateLayerConfig(M),this}},{key:"setSelect",value:function(A,M){var B=this;if(ke()(A)){var ie=A.x,de=ie===void 0?0:ie,Be=A.y,zt=Be===void 0?0:Be;this.updateLayerConfig({selectColor:ke()(M)?M.color:this.getLayerConfig().selectColor}),this.pick({x:de,y:zt})}else this.updateLayerConfig({pickedFeatureID:A,selectColor:ke()(M)?M.color:this.getLayerConfig().selectColor}),this.hooks.beforeSelect.call(Object(Me.l)(A)).then(function(){setTimeout(function(){B.reRender()},1)})}},{key:"setBlend",value:function(A){this.updateLayerConfig({blend:A}),this.layerModelNeedUpdate=!0,this.reRender()}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this}},{key:"setIndex",value:function(A){return this.zIndex=A,this.layerService.updateRenderOrder(),this}},{key:"setCurrentPickId",value:function(A){this.currentPickId=A}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(A){this.selectedFeatureID=A}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var A=this.mapService.getZoom(),M=this.getLayerConfig(),B=M.visible,ie=M.minZoom,de=ie===void 0?-Infinity:ie,Be=M.maxZoom,zt=Be===void 0?Infinity:Be;return!!B&&A>=de&&A<=zt}},{key:"setMinZoom",value:function(A){return this.updateLayerConfig({minZoom:A}),this}},{key:"getMinZoom",value:function(){var A=this.getLayerConfig(),M=A.minZoom;return M}},{key:"getMaxZoom",value:function(){var A=this.getLayerConfig(),M=A.maxZoom;return M}},{key:"get",value:function(A){var M=this.getLayerConfig();return M[A]}},{key:"setMaxZoom",value:function(A){return this.updateLayerConfig({maxZoom:A}),this}},{key:"fitBounds",value:function(A){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var M=this.getSource(),B=M.extent,ie=B.some(function(de){return Math.abs(de)===Infinity});return ie?this:(this.mapService.fitBounds([[B[0],B[1]],[B[2],B[3]]],A),this)}},{key:"destroy",value:function(){this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),this.multiPassRenderer.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),this.emit("remove",{target:this,type:"remove"}),this.removeAllListeners()}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){this.models.forEach(function(A){return A.destroy()}),this.layerModel.clearModels()}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(A){return A.needRescale||A.needRemapping||A.needRegenerateVertices}).length}},{key:"setSource",value:function(A){this.layerSource=A;var M=this.mapService.getZoom();this.layerSource.cluster&&this.layerSource.updateClusterData(M),this.layerSource.on("update",this.sourceEvent)}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(A){this.encodedData=A}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getConfigSchemaForValidation",value:function(){return this.configSchema||(this.configSchema=Qt()([ve,this.getConfigSchema()])),this.configSchema}},{key:"getLegendItems",value:function(A){var M=this.styleAttributeService.getLayerAttributeScale(A);if(M){if(M.ticks){var B=M.ticks().map(function(de){return Pe()({value:de},A,M(de))});return B}else if(M.invertExtent){var ie=M.range().map(function(de){return Pe()({value:M.invertExtent(de)},A,de)});return ie}}else return[]}},{key:"pick",value:function(A){var M=A.x,B=A.y;this.interactionService.triggerHover({x:M,y:B})}},{key:"buildLayerModel",value:function(A){var M=A.moduleName,B=A.vertexShader,ie=A.fragmentShader,de=A.triangulation,Be=pe()(A,["moduleName","vertexShader","fragmentShader","triangulation"]);this.shaderModuleService.registerModule(M,{vs:B,fs:ie});var zt=this.shaderModuleService.getModule(M),qt=zt.vs,Or=zt.fs,Nr=zt.uniforms,bn=this.rendererService.createModel,gn=this.styleAttributeService.createAttributesAndIndices(this.encodedData,de),Fn=gn.attributes,Ta=gn.elements;return bn(at({attributes:Fn,uniforms:Nr,fs:Or,vs:qt,elements:Ta,blend:Mt[b.BlendType.normal]},Be))}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.aniamateStatus&&(this.layerService.stopAnimate(),this.aniamateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(A){var M=this.getLayerConfig(),B=M.enableHighlight,ie=B===void 0?!0:B,de=M.enableSelect,Be=de===void 0?!0:de,zt=this.eventNames().indexOf(A)!==-1||this.eventNames().indexOf("un"+A)!==-1;return(A==="click"||A==="dblclick")&&Be&&(zt=!0),A==="mousemove"&&(ie||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(zt=!0),this.isVisible()&&zt}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"rebuildModels",value:function(){throw new Error("Method not implemented.")}},{key:"renderModels",value:function(){var A=this;return this.layerModelNeedUpdate&&this.layerModel&&(this.models=this.layerModel.buildModels(),this.hooks.beforeRender.call(),this.layerModelNeedUpdate=!1),this.models.forEach(function(M){M.draw({uniforms:A.layerModel.getUninforms()})}),this}},{key:"getConfigSchema",value:function(){throw new Error("Method not implemented.")}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"reRender",value:function(){this.inited&&this.layerService.renderLayers()}},{key:"splitValuesAndCallbackInAttribute",value:function(A,M){return{values:Ve()(A)?void 0:A||M,callback:Ve()(A)?A:void 0}}},{key:"updateStyleAttribute",value:function(A,M,B,ie){this.inited?this.styleAttributeService.updateStyleAttribute(A,{scale:at({field:M},this.splitValuesAndCallbackInAttribute(B,this.getLayerConfig()[M]))},ie):this.pendingStyleAttributes.push({attributeName:A,attributeField:M,attributeValues:B,updateOptions:ie})}}]),x}(ht.EventEmitter),q),gt=Je()(we.prototype,"logger",[ge],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=Je()(we.prototype,"configService",[He],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=Je()(we.prototype,"shaderModuleService",[ot],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),we),et,kt,dr,Ye,xt,bt,Et=(et=Object(b.lazyInject)(b.TYPES.IGlobalConfigService),kt=Object(b.lazyInject)(b.TYPES.IShaderModuleService),dr=(bt=function(){function h(_){Y()(this,h),this.triangulation=void 0,this.layer=void 0,De()(this,"configService",Ye,this),De()(this,"shaderModuleService",xt,this),this.rendererService=void 0,this.iconService=void 0,this.fontService=void 0,this.styleAttributeService=void 0,this.mapService=void 0,this.cameraService=void 0,this.layerService=void 0,this.layer=_,this.rendererService=_.getContainer().get(b.TYPES.IRendererService),this.styleAttributeService=_.getContainer().get(b.TYPES.IStyleAttributeService),this.mapService=_.getContainer().get(b.TYPES.IMapService),this.iconService=_.getContainer().get(b.TYPES.IIconService),this.fontService=_.getContainer().get(b.TYPES.IFontService),this.cameraService=_.getContainer().get(b.TYPES.ICameraService),this.layerService=_.getContainer().get(b.TYPES.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate()}return i()(h,[{key:"getBlend",value:function(){var x=this.layer.getLayerConfig(),y=x.blend,A=y===void 0?"normal":y;return Mt[b.BlendType[A]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){return!1}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){throw new Error("Method not implemented.")}},{key:"clearModels",value:function(){return}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(x){return[x.enable?0:1,x.duration||4,x.interval||.2,x.trailLength||.1]}},{key:"startModelAnimate",value:function(){var x=this.layer.getLayerConfig(),y=x.animateOption;y.enable&&this.layer.setAnimateStartTime()}}]),h}(),bt),Ye=Je()(dr.prototype,"configService",[et],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xt=Je()(dr.prototype,"shaderModuleService",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dr),Fe=o("J4zp"),pt=o.n(Fe),yt=o("RIqP"),Ht=o.n(yt),hr=o("VmRL"),Hr=o.n(hr),gr=o("IOcx"),Bn=gr.c.create(),zn=gr.c.create(),oa=gr.c.create(),$n=gr.c.create(),Yn=gr.c.create();function On(h,_,x,y,A){gr.c.add(h,x,y),gr.c.normalize(h,h),_=gr.c.fromValues(-h[1],h[0]);var M=gr.c.fromValues(-x[1],x[0]);return[A/gr.c.dot(_,M),_]}function U(h,_){return gr.c.set(h,-_[1],_[0])}function W(h,_,x){return gr.c.sub(h,_,x),gr.c.normalize(h,h),h}function le(h,_){return h[0]===_[0]&&h[1]===_[1]}function xe(h){for(var _=new Map,x=0;x<h.length;x++){var y=h[0].toString()+"-"+h[1].toString();_.get(y)?(h.splice(x,1),x++):_.set(y,y)}return h}var st=function(){function h(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Y()(this,h),this.complex=void 0,this.join=void 0,this.cap=void 0,this.miterLimit=void 0,this.thickness=void 0,this.normal=void 0,this.lastFlip=-1,this.miter=gr.c.fromValues(0,0),this.started=!1,this.dash=!1,this.totalDistance=0,this.join=_.join||"miter",this.cap=_.cap||"butt",this.miterLimit=_.miterLimit||10,this.thickness=_.thickness||1,this.dash=_.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0}}return i()(h,[{key:"extrude",value:function(x){var y=this.complex;if(x.length<=1)return y;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var A=x.length,M=y.startIndex,B=1;B<A;B++){var ie=x[B-1],de=x[B],Be=B<x.length-1?x[B+1]:null,zt=this.segment(y,M,ie,de,Be);M+=zt}if(this.dash)for(var qt=0;qt<y.positions.length/6;qt++)y.positions[qt*6+5]=this.totalDistance;return y.startIndex=y.positions.length/6,y}},{key:"segment",value:function(x,y,A,M,B){var ie=0,de=x.indices,Be=x.positions,zt=x.normals,qt=this.cap==="square",Or=this.join==="bevel",Nr=Object(Me.d)([M[0],M[1]]),bn=Object(Me.d)([A[0],A[1]]);W(oa,Nr,bn);var gn=0;if(this.dash&&(gn=this.lineSegmentDistance(Nr,bn),this.totalDistance+=gn),this.normal||(this.normal=gr.c.create(),U(this.normal,oa)),!this.started)if(this.started=!0,qt){var Fn=gr.c.create(),Ta=gr.c.create();gr.c.add(Fn,this.normal,oa),gr.c.add(Ta,this.normal,oa),zt.push(Ta[0],Ta[1],0),zt.push(Fn[0],Fn[1],0),Be.push(A[0],A[1],0,this.totalDistance-gn,-this.thickness,0),Be.push(A[0],A[1],0,this.totalDistance-gn,this.thickness,0)}else this.extrusions(Be,zt,A,this.normal,this.thickness,this.totalDistance-gn);if(de.push(y+0,y+1,y+2),B){var ai=Object(Me.d)([B[0],B[1]]);le(Nr,ai)&&gr.c.add(ai,Nr,gr.c.normalize(ai,gr.c.subtract(ai,Nr,bn))),W($n,ai,Nr);var ii=On(Yn,gr.c.create(),oa,$n,this.thickness),Qi=pt()(ii,2),wa=Qi[0],qi=Qi[1],xo=gr.c.dot(Yn,this.normal)<0?-1:1,Xs=Or;if(!Xs&&this.join==="miter"){var Wa=wa;Wa>this.miterLimit&&(Xs=!0)}Xs?(zt.push(this.normal[0],this.normal[1],0),zt.push(qi[0],qi[1],0),Be.push(M[0],M[1],0,this.totalDistance,-this.thickness*xo,0),Be.push(M[0],M[1],0,this.totalDistance,this.thickness*xo,0),de.push.apply(de,Ht()(this.lastFlip!==-xo?[y,y+2,y+3]:[y+2,y+1,y+3])),de.push(y+2,y+3,y+4),U(Bn,$n),gr.c.copy(this.normal,Bn),zt.push(this.normal[0],this.normal[1],0),Be.push(M[0],M[1],0,this.totalDistance,-this.thickness*xo,0),ie+=3):(this.extrusions(Be,zt,M,qi,wa,this.totalDistance),de.push.apply(de,Ht()(this.lastFlip===1?[y,y+2,y+3]:[y+2,y+1,y+3])),xo=-1,gr.c.copy(this.normal,qi),ie+=2),this.lastFlip=xo}else{if(U(this.normal,oa),qt){var Ca=gr.c.create(),Li=gr.c.create();gr.c.sub(Li,oa,this.normal),gr.c.add(Ca,oa,this.normal),zt.push(Li[0],Li[1],0),zt.push(Ca[0],Ca[1],0),Be.push(M[0],M[1],0,this.totalDistance,this.thickness,0),Be.push(M[0],M[1],0,this.totalDistance,this.thickness,0)}else this.extrusions(Be,zt,M,this.normal,this.thickness,this.totalDistance);de.push.apply(de,Ht()(this.lastFlip===1?[y,y+2,y+3]:[y+2,y+1,y+3])),ie+=2}return ie}},{key:"extrusions",value:function(x,y,A,M,B,ie){y.push(M[0],M[1],0),y.push(M[0],M[1],0),x.push(A[0],A[1],0,ie,-B,0),x.push(A[0],A[1],0,ie,B,0)}},{key:"lineSegmentDistance",value:function(x,y){var A=y[0]-x[0],M=y[1]-x[1];return Math.sqrt(A*A+M*M)}}]),h}(),Ct=o("UB5X"),Bt=o.n(Ct);function Xe(h){if(Bt()(h[0]))return h;if(Bt()(h[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(Bt()(h[0][0][0])){var _=h,x=0,y=0,A=0;return _.forEach(function(M){M.forEach(function(B){x+=B[0],y+=B[1],A++})}),[x/A,y/A,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function Lt(h){var _=h[0][0],x=h[0][h[0].length-1];_[0]===x[0]&&_[1]===x[1]&&(h[0]=h[0].slice(0,h[0].length-1));for(var y=h[0].length,A=Hr.a.flatten(h),M=A.vertices,B=A.dimensions,ie=[],de=[],Be=0;Be<M.length/B;Be++)B===2?ie.push(M[Be*2],M[Be*2+1],1):ie.push(M[Be*3],M[Be*3+1],1);var zt=Hr()(A.vertices,A.holes,A.dimensions);de.push.apply(de,Ht()(zt));for(var qt=function(bn){var gn=A.vertices.slice(bn*B,(bn+1)*B),Fn=A.vertices.slice((bn+1)*B,(bn+2)*B);Fn.length===0&&(Fn=A.vertices.slice(0,B));var Ta=ie.length/3;ie.push(gn[0],gn[1],1,Fn[0],Fn[1],1,gn[0],gn[1],0,Fn[0],Fn[1],0),de.push.apply(de,Ht()([0,2,1,2,3,1].map(function(Ca){return Ca+Ta})))},Or=0;Or<y;Or++)qt(Or);return{positions:ie,index:de}}function lr(h){var _=Hr.a.flatten(h),x=Hr()(_.vertices,_.holes,_.dimensions);return{positions:_.vertices,index:x}}function zr(h){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,x=h[0][0],y=h[0][h[0].length-1];x[0]===y[0]&&x[1]===y[1]&&(h[0]=h[0].slice(0,h[0].length-1));for(var A=h[0].length,M=Hr.a.flatten(h),B=M.vertices,ie=M.dimensions,de=[],Be=[],zt=[],qt=0;qt<B.length/ie;qt++)ie===2?de.push(B[qt*2],B[qt*2+1],1,-1,-1):de.push(B[qt*3],B[qt*3+1],1,-1,-1),zt.push(0,0,1);var Or=Hr()(M.vertices,M.holes,M.dimensions);Be.push.apply(Be,Ht()(Or));for(var Nr=function(Fn){var Ta=M.vertices.slice(Fn*ie,(Fn+1)*ie),Ca=M.vertices.slice((Fn+1)*ie,(Fn+2)*ie);Ca.length===0&&(Ca=M.vertices.slice(0,ie));var Li=de.length/5;de.push(Ta[0],Ta[1],1,0,0,Ca[0],Ca[1],1,.1,0,Ta[0],Ta[1],0,0,.8,Ca[0],Ca[1],0,.1,.8);var ai=Vr([Ca[0],Ca[1],1],[Ta[0],Ta[1],0],[Ta[0],Ta[1],1],_);zt.push.apply(zt,Ht()(ai).concat(Ht()(ai),Ht()(ai),Ht()(ai))),Be.push.apply(Be,Ht()([1,2,0,3,2,1].map(function(ii){return ii+Li})))},bn=0;bn<A;bn++)Nr(bn);return{positions:de,index:Be,normals:zt}}function Vr(h,_,x){var y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,A=gr.d.create(),M=gr.d.create(),B=gr.d.create();y&&(h=Object(Me.p)(h),_=Object(Me.p)(_),x=Object(Me.p)(x));var ie=gr.d.fromValues.apply(gr.d,Ht()(h)),de=gr.d.fromValues.apply(gr.d,Ht()(_)),Be=gr.d.fromValues.apply(gr.d,Ht()(x));gr.d.sub(A,Be,de),gr.d.sub(M,ie,de),gr.d.cross(B,A,M);var zt=gr.d.create();return gr.d.normalize(zt,B),zt}var cr,Ur;(function(h){h.CYLINDER="cylinder",h.SQUARECOLUMN="squareColumn",h.TRIANGLECOLUMN="triangleColumn",h.HEXAGONCOLUMN="hexagonColumn",h.PENTAGONCOLUMN="pentagonColumn"})(Ur||(Ur={}));var Mn;(function(h){h.CIRCLE="circle",h.SQUARE="square",h.TRIANGLE="triangle",h.HEXAGON="hexagon",h.PENTAGON="pentagon"})(Mn||(Mn={}));function ln(h){for(var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,x=Math.PI*2/h,y=[],A=0;A<h;A++)y.push(x*A+_*Math.PI/12);var M=y.map(function(B){var ie=Math.sin(B+Math.PI/4),de=Math.cos(B+Math.PI/4);return[ie,de,0]});return M}function er(){return ln(30)}function tn(){return ln(4)}function hn(){return ln(3)}function xn(){return ln(6,1)}function yn(){return ln(5)}var vn=(cr={},Pe()(cr,Mn.CIRCLE,er),Pe()(cr,Mn.HEXAGON,xn),Pe()(cr,Mn.TRIANGLE,hn),Pe()(cr,Mn.SQUARE,tn),Pe()(cr,Mn.PENTAGON,yn),Pe()(cr,Ur.CYLINDER,er),Pe()(cr,Ur.HEXAGONCOLUMN,xn),Pe()(cr,Ur.TRIANGLECOLUMN,hn),Pe()(cr,Ur.SQUARECOLUMN,tn),Pe()(cr,Ur.PENTAGONCOLUMN,yn),cr),Pn={};function Va(h){var _=Xe(h.coordinates);return{vertices:[].concat(Ht()(_),Ht()(_),Ht()(_),Ht()(_)),indices:[0,1,2,2,3,0],size:_.length}}function va(h){var _=h.shape,x=Si(_,!1),y=x.positions,A=x.index,M=x.normals;return{vertices:y,indices:A,normals:M,size:5}}function Ma(h){var _=Xe(h.coordinates);return{vertices:Ht()(_),indices:[0],size:_.length}}function Ia(h){var _=h.coordinates,x=_;Array.isArray(x[0][0])||(x=[_]);var y=new st({dash:!0,join:"bevel"});x.forEach(function(M){y.extrude(M)});var A=y.complex;return{vertices:A.positions,indices:A.indices,normals:A.normals,size:6}}function Wi(h){var _=h.coordinates,x=Hr.a.flatten(_),y=x.vertices,A=x.dimensions,M=x.holes;return{indices:Hr()(y,M,A),vertices:y,size:A}}function da(h){var _=h.coordinates,x=zr(_,!0),y=x.positions,A=x.index,M=x.normals;return{vertices:y,indices:A,normals:M,size:5}}function di(h){var _=h.shape,x=ju(_),y=x.positions,A=x.index;return{vertices:y,indices:A,size:3}}function ga(h){var _=h.coordinates,x=[].concat(Ht()(_[0]),[0,0,1,_[1][0],_[0][1],0,1,1],Ht()(_[1]),[0,1,0],Ht()(_[0]),[0,0,1],Ht()(_[1]),[0,1,0,_[0][0],_[1][1],0,0,0]),y=[0,1,2,3,4,5];return{vertices:x,indices:y,size:5}}function ya(h){for(var _=30,x=h.coordinates,y=[],A=[],M=function(de){y.push(de,1,de,x[0][0],x[0][1],x[1][0],x[1][1],de,-1,de,x[0][0],x[0][1],x[1][0],x[1][1]),de!==_-1&&A.push.apply(A,Ht()([0,1,2,1,3,2].map(function(Be){return de*2+Be})))},B=0;B<_;B++)M(B);return{vertices:y,indices:A,size:7}}function fa(h){var _=h.coordinates;_.length===2&&_.push(0);var x=h.size,y=Ga(-1,1),A=Ga(1,1),M=Ga(-1,-1),B=Ga(1,-1),ie=[].concat(Ht()(_),Ht()(y),Ht()(_),Ht()(M),Ht()(_),Ht()(B),Ht()(_),Ht()(A)),de=[0,1,2,3,0,2];return{vertices:ie,indices:de,size:5}}function Si(h){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(Pn&&Pn[h])return Pn[h];var x=vn[h]?vn[h]():vn.cylinder(),y=zr([x],_);return Pn[h]=y,y}function ns(h,_){for(var x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,A=new Float32Array(h.length/x*3),M,B,ie,de=gr.d.create(),Be=gr.d.create(),zt=gr.d.create(),qt=0,Or=_.length;qt<Or;qt+=3){M=_[qt+0]*3,B=_[qt+1]*3,ie=_[qt+2]*3;var Nr=[h[M],h[M+1]],bn=[h[B],h[B+1]],gn=[h[ie],h[ie+1]];y&&(Nr=Object(Me.p)(Nr),bn=Object(Me.p)(bn),gn=Object(Me.p)(gn));var Fn=Nr,Ta=pt()(Fn,2),Ca=Ta[0],Li=Ta[1],ai=gr.d.fromValues(Ca,Li,h[M+2]),ii=bn,Qi=pt()(ii,2),wa=Qi[0],qi=Qi[1],xo=gr.d.fromValues(wa,qi,h[B+2]),Xs=gn,Wa=pt()(Xs,2),As=Wa[0],Yo=Wa[1],df=gr.d.fromValues(As,Yo,h[ie+2]);gr.d.sub(de,df,xo),gr.d.sub(Be,ai,xo),gr.d.cross(zt,de,Be),A[M]+=de[0],A[M+1]+=de[1],A[M+2]+=de[2],A[B]+=de[0],A[B+1]+=de[1],A[B+2]+=de[2],A[ie]+=de[0],A[ie+1]+=de[1],A[ie+2]+=de[2]}return Xi(A),A}function Xi(h){for(var _=0,x=h.length;_<x;_+=3){var y=gr.d.fromValues(h[_],h[_+1],h[_+2]),A=gr.d.create();gr.d.normalize(A,y),h.set(A,_)}}function Vo(h){var _=h[0][0],x=h[0][h[0].length-1];return _[0]===x[0]&&_[1]===x[1]}function ju(h){var _=["cylinder","triangleColumn","hexagonColumn","squareColumn"],x=vn[h]?vn[h]():vn.circle(),y=_.indexOf(h)===-1?lr([x]):Lt([x]);return y}function Ga(h,_){var x=(h+1)/2,y=(_+1)/2;return[x,y]}function Ai(h){var _=Ko();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function Ko(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var oi=`uniform float u_opacity: 1.0;
uniform vec4 u_baseColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_brightColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_windowColor : [ 1.0, 0, 0, 1.0 ];
uniform float u_near : 0;
uniform float u_far : 1;
varying vec4 v_Color;
varying vec2 v_texCoord;
uniform float u_Zoom : 1;
uniform float u_time;

#pragma include "picking"

vec3 getWindowColor(float n, float hot, vec3 brightColor, vec3 darkColor) {
    float s = step(hot, n);
    vec3 color = mix(brightColor,vec3(0.9,0.9,1.0),n);

    return mix(darkColor, color, s);
}
float random (vec2 st) {
    return fract(sin(dot(st.xy, vec2(12.9898,78.233)))* 43758.5453123);
}

float LinearizeDepth()
{
    float z = gl_FragCoord.z * 2.0 - 1.0;
    return (2.0 * u_near * u_far) / (u_far + u_near - z * (u_far - u_near));
}

vec3 fog(vec3 color, vec3 fogColor, float depth){
    float fogFactor=clamp(depth,0.0,1.0);
    vec3 output_color=mix(fogColor,color,fogFactor);
    return output_color;
}

float sdRect(vec2 p, vec2 sz) {
  vec2 d = abs(p) - sz;
  float outside = length(max(d, 0.));
  float inside = min(max(d.x, d.y), 0.);
  return outside + inside;
}

void main() {
  gl_FragColor = v_Color;
  vec3 baseColor = u_baseColor.xyz;
  vec3 brightColor = u_brightColor.xyz;
  vec3 windowColor = u_windowColor.xyz;
  float targetColId = 5.;
  float depth = 1.0 - LinearizeDepth() / u_far * u_Zoom;
  vec3 fogColor = vec3(23.0/255.0,31.0/255.0,51.0/255.0);
  if(v_texCoord.x < 0.) { //\u9876\u90E8\u989C\u8272
       vec3 foggedColor = fog(baseColor.xyz + vec3(0.12*0.9,0.2*0.9,0.3*0.9),fogColor,depth);
       gl_FragColor = vec4( foggedColor, v_Color.w);
  }else { // \u4FA7\u9762\u989C\u8272
        vec2 st = v_texCoord;
        vec2  UvScale = v_texCoord;
        float tStep = min(0.08,max(0.05* (18.0-u_Zoom),0.02));
        float tStart = 0.25 * tStep;
        float tEnd = 0.75 * tStep;
        float u = mod(UvScale.x, tStep);
        float v = mod(UvScale.y, tStep);
        float ux = floor(UvScale.x/tStep);
        float uy = floor(UvScale.y/tStep);
        float n = random(vec2(ux,uy));
        float lightP = u_time;
        float head = 1.0- step(0.005,st.y);
        /*step3*/
        // \u5C06\u7A97\u6237\u989C\u8272\u548C\u5899\u9762\u989C\u8272\u533A\u522B\u5F00\u6765
        float sU = step(tStart, u) - step(tEnd, u);
        float sV = step(tStart, v) - step(tEnd, v);
        vec2 windowSize = vec2(abs(tEnd-tStart),abs(tEnd-tStart));
        float dist = sdRect(vec2(u,v), windowSize);
        float s = sU * sV;

        float curColId = floor(UvScale.x / tStep);
        float sCol = step(targetColId - 0.2, curColId) - step(targetColId + 0.2, curColId);

        float mLightP = mod(lightP, 2.);
        float sRow = step(mLightP - 0.2, st.y) - step(mLightP, st.y);
        if(ux == targetColId){
            n =0.;
        }
        float timeP = min(0.75, abs ( sin(u_time/3.0) ) );
        float hot = smoothstep(1.0,0.0,timeP);
        vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), s);
        //vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), 1.0);
        float sFinal = s * sCol * sRow;
        color += mix(baseColor, brightColor, sFinal*n);
        if (st.y<0.01){
        color = baseColor;
         }
        if(head ==1.0) { // \u9876\u90E8\u4EAE\u7EBF
            color = brightColor;
        }
        color = color * v_Color.rgb;

        vec3 foggedColor = fog(color,fogColor,depth);

        gl_FragColor = vec4(foggedColor,1.0);
  }
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Yi=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

attribute vec2 a_Uv;
varying vec2 v_texCoord;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);
   v_texCoord = a_Uv;
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,wo=function(h){D()(x,h);var _=Ai(x);function x(){return Y()(this,x),_.apply(this,arguments)}return i()(x,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=M===void 0?1:M,ie=A.baseColor,de=ie===void 0?"rgb(16,16,16)":ie,Be=A.brightColor,zt=Be===void 0?"rgb(255,176,38)":Be,qt=A.windowColor,Or=qt===void 0?"rgb(30,60,89)":qt,Nr=A.time,bn=Nr===void 0?0:Nr;return{u_opacity:B,u_baseColor:Object(Me.s)(de),u_brightColor:Object(Me.s)(zt),u_windowColor:Object(Me.s)(Or),u_time:this.layer.getLayerAnimateTime()||bn}}},{key:"initModels",value:function(){return this.startModelAnimate(),[this.layer.buildLayerModel({moduleName:"cityBuilding",vertexShader:Yi,fragmentShader:oi,triangulation:da})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:b.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:b.gl.STATIC_DRAW,data:[],type:b.gl.FLOAT},size:3,update:function(M,B,ie,de,Be){return Be}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(M,B,ie,de){var Be=M.size,zt=Be===void 0?10:Be;return Array.isArray(zt)?[zt[0]]:[zt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:b.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:2,update:function(M,B,ie,de){var Be=M.size;return[ie[3],ie[4]]}}})}}]),x}(Et);function Ha(h){var _=oo();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function oo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var so=function(h){D()(x,h);var _=Ha(x);function x(){var y;Y()(this,x);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return y=_.call.apply(_,[this].concat(M)),y.type="PolygonLayer",y}return i()(x,[{key:"buildModels",value:function(){this.layerModel=new wo(this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"setLight",value:function(A){this.updateLayerConfig({time:A})}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){return"citybuilding"}}]),x}(ne);function Eu(h){var _=$o();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function $o(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Kl=`precision highp float;\r
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807\r
attribute vec3 a_Position;\r
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807\r
attribute vec3 a_Pos;\r
attribute float a_Size;\r
attribute vec4 a_Color;\r
uniform vec2 u_radius;\r
uniform float u_coverage: 0.9;\r
uniform float u_angle: 0;\r
uniform mat4 u_ModelMatrix;\r
varying vec4 v_color;\r
\r
#pragma include "projection"\r
#pragma include "project"\r
#pragma include "picking"\r
\r
void main() {\r
  v_color = a_Color;\r
\r
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\r
  vec2 offset = a_Position.xy * u_radius * rotationMatrix * u_coverage ;\r
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\r
  gl_Position = project_common_position_to_clipspace(project_pos);\r
\r
  setPickingColor(a_PickingColor);\r
}\r
`,ks=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,ho=function(h){D()(x,h);var _=Eu(x);function x(){return Y()(this,x),_.apply(this,arguments)}return i()(x,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=A.coverage,ie=A.angle;return{u_opacity:M||1,u_coverage:B||.9,u_angle:ie||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"gridheatmap",vertexShader:Kl,fragmentShader:ks,triangulation:di,depth:{enable:!1},primitive:b.gl.TRIANGLES,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:b.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:3,update:function(M,B){var ie=M.coordinates;return[ie[0],ie[1],0]}}})}}]),x}(Et);function Vt(h){var _=Le();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function Le(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Dt=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;

attribute vec3 a_Normal;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
varying vec4 v_color;

#pragma include "projection"
#pragma include "project"
#pragma include "light"
#pragma include "picking"

void main() {
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
  vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));
  float lightWeight = calc_lighting(project_pos);
  v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);

  gl_Position = project_common_position_to_clipspace(project_pos);
  setPickingColor(a_PickingColor);
}
`,mr=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,Qr=function(h){D()(x,h);var _=Vt(x);function x(){return Y()(this,x),_.apply(this,arguments)}return i()(x,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=A.coverage,ie=A.angle;return{u_opacity:M||1,u_coverage:B||1,u_angle:ie||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"grid3dheatmap",vertexShader:Dt,fragmentShader:mr,triangulation:va,depth:{enable:!0},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(M,B,ie,de){var Be=M.size;return Array.isArray(Be)?[Be[0]]:[Be]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:b.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:b.gl.STATIC_DRAW,data:[],type:b.gl.FLOAT},size:3,update:function(M,B,ie,de,Be){return Be}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:b.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:3,update:function(M,B){var ie=M.coordinates;return[ie[0],ie[1],0]}}})}}]),x}(Et);function En(h,_){for(var x=[],y=[],A=[],M=h+1,B=_+1,ie=h/2,de=_/2,Be=0;Be<B;Be++)for(var zt=Be-de,qt=0;qt<M;qt++){var Or=qt-ie;y.push(Or/ie,-zt/de,0),A.push(qt/h),A.push(1-Be/_)}for(var Nr=0;Nr<_;Nr++)for(var bn=0;bn<h;bn++){var gn=bn+M*Nr,Fn=bn+M*(Nr+1),Ta=bn+1+M*(Nr+1),Ca=bn+1+M*Nr;x.push(gn,Fn,Ca),x.push(Fn,Ta,Ca)}return{vertices:y,indices:x,uvs:A}}function Vn(h,_){var x=Object.keys(h);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(h);_&&(y=y.filter(function(A){return Object.getOwnPropertyDescriptor(h,A).enumerable})),x.push.apply(x,y)}return x}function Ci(h){for(var _=1;_<arguments.length;_++){var x=arguments[_]!=null?arguments[_]:{};_%2?Vn(Object(x),!0).forEach(function(y){Pe()(h,y,x[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(x)):Vn(Object(x)).forEach(function(y){Object.defineProperty(h,y,Object.getOwnPropertyDescriptor(x,y))})}return h}function po(h){var _=mo();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function mo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Oo=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
   
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor = color;
    // gl_FragColor.a = color.a * smoothstep(0.1,0.2,intensity)* u_opacity;
     gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,Fu=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
uniform mat4 u_ModelMatrix;
uniform mat4 u_InverseViewProjectionMatrix;
uniform mat4 u_ViewProjectionMatrixUncentered;
varying float v_intensity;

vec2 toBezier(float t, vec2 P0, vec2 P1, vec2 P2, vec2 P3) {
    float t2 = t * t;
    float one_minus_t = 1.0 - t;
    float one_minus_t2 = one_minus_t * one_minus_t;
    return (P0 * one_minus_t2 * one_minus_t + P1 * 3.0 * t * one_minus_t2 + P2 * 3.0 * t2 * one_minus_t + P3 * t2 * t);
}
vec2 toBezier(float t, vec4 p){
    return toBezier(t, vec2(0.0, 0.0), vec2(p.x, p.y), vec2(p.z, p.w), vec2(1.0, 1.0));
}
#pragma include "projection"
void main() {
  v_texCoord = a_Uv;

  vec2 pos =(a_Uv * vec2(2.0) - vec2(1.0));


  vec4 p1 = vec4(pos, 0.0, 1.0);
	vec4 p2 = vec4(pos, 1.0, 1.0);

	vec4 inverseP1 = u_InverseViewProjectionMatrix * p1;
	vec4 inverseP2 = u_InverseViewProjectionMatrix * p2;

  inverseP1 = inverseP1 / inverseP1.w;
	inverseP2 = inverseP2 / inverseP2.w;

	float zPos = (0.0 - inverseP1.z) / (inverseP2.z - inverseP1.z);
	vec4 position = inverseP1 + zPos * (inverseP2 - inverseP1);

  vec4 b= vec4(0.5000, 0, 1, 0.5000);
  float fh;

  v_intensity = texture2D(u_texture, v_texCoord).r;
  fh = toBezier(v_intensity, b).y;
  gl_Position = u_ViewProjectionMatrixUncentered * vec4(position.xy, fh * project_pixel(50.), 1.0);

}
`,Ml=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor =color;
    gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,bs=`precision highp float;
uniform float u_intensity;
varying float v_weight;
varying vec2 v_extrude;
#define GAUSS_COEF  0.3989422804014327
void main(){
    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);
    float val = v_weight * u_intensity * GAUSS_COEF * exp(d);
    gl_FragColor = vec4(val, 1., 1., 1.);
}
`,vc=`precision highp float;
attribute vec3 a_Position;
attribute float a_Size;
attribute vec2 a_Dir;
uniform float u_intensity;
uniform float u_radius;
varying vec2 v_extrude;
varying float v_weight;
uniform mat4 u_ModelMatrix;

#define GAUSS_COEF  0.3989422804014327

#pragma include "projection"

void main(){
    v_weight = a_Size;
    float ZERO = 1.0 / 255.0 / 16.0;
    float extrude_x = a_Dir.x * 2.0 -1.0;
    float extrude_y = a_Dir.y * 2.0 -1.0;
    vec2 extrude_dir = normalize(vec2(extrude_x,extrude_y));
    float S = sqrt(-2.0 * log(ZERO / a_Size / u_intensity / GAUSS_COEF)) / 3.0;
    v_extrude = extrude_dir * S;

    vec2 offset = project_pixel(v_extrude * u_radius);
    vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
}
`,Tu=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
varying float v_intensity;
void main() {
  v_texCoord = a_Uv;
  v_intensity = texture2D(u_texture, v_texCoord).r;
  gl_Position = vec4(a_Position.xy, 0, 1.);
}
`,Mo=function(h){D()(x,h);var _=po(x);function x(){var y;Y()(this,x);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return y=_.call.apply(_,[this].concat(M)),y.texture=void 0,y.colorTexture=void 0,y.heatmapFramerBuffer=void 0,y.intensityModel=void 0,y.colorModel=void 0,y.shapeType=void 0,y}return i()(x,[{key:"render",value:function(){var A=this,M=this.rendererService,B=M.clear,ie=M.useFramebuffer;ie(this.heatmapFramerBuffer,function(){B({color:[0,0,0,0],depth:1,stencil:0,framebuffer:A.heatmapFramerBuffer}),A.drawIntensityMode()}),this.layer.styleNeedUpdate&&this.updateColorTexture(),this.shapeType==="heatmap"?this.drawColorMode():this.draw3DHeatMap()}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){var A,M=this.rendererService,B=M.createFramebuffer,ie=M.clear,de=M.getViewportSize,Be=M.createTexture2D,zt=M.useFramebuffer,qt=this.styleAttributeService.getLayerStyleAttribute("shape"),Or=(qt==null||((A=qt.scale)===null||A===void 0)?void 0:A.field)||"heatmap";this.shapeType=Or,this.intensityModel=this.buildHeatMapIntensity(),this.colorModel=Or==="heatmap"?this.buildHeatmapColor():this.build3dHeatMap();var Nr=this.layer.getLayerConfig(),bn=Nr.rampColors,gn=Object(Me.n)(bn),Fn=de(),Ta=Fn.width,Ca=Fn.height;return this.heatmapFramerBuffer=B({color:Be({width:Math.floor(Ta/4),height:Math.floor(Ca/4),wrapS:b.gl.CLAMP_TO_EDGE,wrapT:b.gl.CLAMP_TO_EDGE,min:b.gl.LINEAR,mag:b.gl.LINEAR}),depth:!1}),this.updateColorTexture(),[this.intensityModel,this.colorModel]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"dir",type:b.AttributeType.Attribute,descriptor:{name:"a_Dir",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:2,update:function(M,B,ie,de){return[ie[3],ie[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(M,B,ie,de){var Be=M.size,zt=Be===void 0?1:Be;return[zt]}}})}},{key:"buildHeatMapIntensity",value:function(){return this.layer.buildLayerModel({moduleName:"heatmapintensity",vertexShader:vc,fragmentShader:bs,triangulation:fa,depth:{enable:!1},blend:{enable:!0,func:{srcRGB:b.gl.ONE,srcAlpha:1,dstRGB:b.gl.ONE,dstAlpha:1}}})}},{key:"buildHeatmapColor",value:function(){this.shaderModuleService.registerModule("heatmapColor",{vs:Tu,fs:Ml});var A=this.shaderModuleService.getModule("heatmapColor"),M=A.vs,B=A.fs,ie=A.uniforms,de=this.rendererService,Be=de.createAttribute,zt=de.createElements,qt=de.createBuffer,Or=de.createModel;return Or({vs:M,fs:B,attributes:{a_Position:Be({buffer:qt({data:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],type:b.gl.FLOAT}),size:3}),a_Uv:Be({buffer:qt({data:[0,1,1,1,0,0,1,0],type:b.gl.FLOAT}),size:2})},uniforms:Ci({},ie),depth:{enable:!1},blend:this.getBlend(),count:6,elements:zt({data:[0,2,1,2,3,1],type:b.gl.UNSIGNED_INT,count:6})})}},{key:"drawIntensityMode",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=A.intensity,ie=B===void 0?10:B,de=A.radius,Be=de===void 0?5:de;this.intensityModel.draw({uniforms:{u_opacity:M||1,u_radius:Be,u_intensity:ie}})}},{key:"drawColorMode",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity;this.colorModel.draw({uniforms:{u_opacity:M||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer}})}},{key:"draw3DHeatMap",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=gr.b.invert(gr.b.create(),gr.b.fromValues.apply(gr.b,Ht()(this.cameraService.getViewProjectionMatrixUncentered())));this.colorModel.draw({uniforms:{u_opacity:M||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer,u_ViewProjectionMatrixUncentered:this.cameraService.getViewProjectionMatrixUncentered(),u_InverseViewProjectionMatrix:Ht()(B)}})}},{key:"build3dHeatMap",value:function(){var A=this.rendererService.getViewportSize,M=A(),B=M.width,ie=M.height,de=En(B/4,ie/4);this.shaderModuleService.registerModule("heatmap3dColor",{vs:Fu,fs:Oo});var Be=this.shaderModuleService.getModule("heatmap3dColor"),zt=Be.vs,qt=Be.fs,Or=Be.uniforms,Nr=this.rendererService,bn=Nr.createAttribute,gn=Nr.createElements,Fn=Nr.createBuffer,Ta=Nr.createModel;return Ta({vs:zt,fs:qt,attributes:{a_Position:bn({buffer:Fn({data:de.vertices,type:b.gl.FLOAT}),size:3}),a_Uv:bn({buffer:Fn({data:de.uvs,type:b.gl.FLOAT}),size:2})},primitive:b.gl.TRIANGLES,uniforms:Ci({},Or),depth:{enable:!0},blend:{enable:!0,func:{srcRGB:b.gl.SRC_ALPHA,srcAlpha:1,dstRGB:b.gl.ONE_MINUS_SRC_ALPHA,dstAlpha:1}},elements:gn({data:de.indices,type:b.gl.UNSIGNED_INT,count:de.indices.length})})}},{key:"updateStyle",value:function(){this.updateColorTexture()}},{key:"updateColorTexture",value:function(){var A=this.rendererService.createTexture2D;this.texture&&this.texture.destroy();var M=this.layer.getLayerConfig(),B=M.rampColors,ie=Object(Me.n)(B);this.colorTexture=A({data:new Uint8Array(ie.data),width:ie.width,height:ie.height,wrapS:b.gl.CLAMP_TO_EDGE,wrapT:b.gl.CLAMP_TO_EDGE,min:b.gl.NEAREST,mag:b.gl.NEAREST,flipY:!1})}}]),x}(Et);function zu(h){var _=Eo();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function Eo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Fi=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,Ys=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
varying vec4 v_color;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

void main() {
  v_color = a_Color;
    
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));
  setPickingColor(a_PickingColor);
}
`,Ks=function(h){D()(x,h);var _=zu(x);function x(){return Y()(this,x),_.apply(this,arguments)}return i()(x,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=A.coverage,ie=A.angle;return{u_opacity:M||1,u_coverage:B||.9,u_angle:ie||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"hexagonheatmap",vertexShader:Ys,fragmentShader:Fi,triangulation:di,depth:{enable:!1},primitive:b.gl.TRIANGLES,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:b.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:3,update:function(M,B){var ie=M.coordinates;return[ie[0],ie[1],0]}}})}}]),x}(Et),js={heatmap:Mo,heatmap3d:Mo,grid:ho,grid3d:Qr,hexagon:Ks},Ri=js;function Vi(h){var _=xs();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function xs(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var vl=function(h){D()(x,h);var _=Vi(x);function x(){var y;Y()(this,x);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return y=_.call.apply(_,[this].concat(M)),y.type="HeatMapLayer",y}return i()(x,[{key:"buildModels",value:function(){var A=this.getModelType();this.layerModel=new Ri[A](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"renderModels",value:function(){var A=this,M=this.getModelType();return M==="heatmap"?(this.layerModel&&this.layerModel.render(),this):(this.layerModelNeedUpdate&&(this.models=this.layerModel.buildModels(),this.layerModelNeedUpdate=!1),this.models.forEach(function(B){return B.draw({uniforms:A.layerModel.getUninforms()})}),this)}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var A,M=this.styleAttributeService.getLayerStyleAttribute("shape"),B=this.getLayerConfig(),ie=B.shape3d,de=this.getSource(),Be=de.data.type,zt=(M==null||((A=M.scale)===null||A===void 0)?void 0:A.field)||"heatmap";return zt==="heatmap"||zt==="heatmap3d"?"heatmap":Be==="hexagon"?(ie==null?void 0:ie.indexOf(zt))===-1?"hexagon":"grid3d":Be==="grid"?(ie==null?void 0:ie.indexOf(zt))===-1?"grid":"grid3d":"heatmap"}}]),x}(ne);function Qu(h){var _=Rt();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function Rt(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var fr=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
}
`,Mr=`precision highp float;
uniform mat4 u_ModelMatrix;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
}
`,Wn=function(h){D()(x,h);var _=Qu(x);function x(){var y;Y()(this,x);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return y=_.call.apply(_,[this].concat(M)),y.texture=void 0,y}return i()(x,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity;return{u_opacity:M||1,u_texture:this.texture}}},{key:"initModels",value:function(){var A=this,M=this.layer.getSource(),B=this.rendererService.createTexture2D;return this.texture=B({height:0,width:0}),M.data.images.then(function(ie){A.texture=B({data:ie[0],width:ie[0].width,height:ie[0].height}),A.layerService.renderLayers()}),[this.layer.buildLayerModel({moduleName:"RasterImage",vertexShader:Mr,fragmentShader:fr,triangulation:ga,primitive:b.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:b.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:2,update:function(M,B,ie,de){return[ie[3],ie[4]]}}})}}]),x}(Et),Xa={image:Wn},vi=Xa;function Ki(h){var _=Ya();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function Ya(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Ii=function(h){D()(x,h);var _=Ki(x);function x(){var y;Y()(this,x);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return y=_.call.apply(_,[this].concat(M)),y.type="ImageLayer",y}return i()(x,[{key:"buildModels",value:function(){var A=this.getModelType();this.layerModel=new vi[A](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var A=this.getModelType(),M={image:{}};return M[A]}},{key:"getModelType",value:function(){return"image"}}]),x}(ne);function Go(h){var _=Cs();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function Cs(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var pi=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,Pl=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;
#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  vec2 source = a_Instance.rg;
  vec2 target =  a_Instance.ba;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  if(u_line_type == LineTypeDash) {
      v_distance_ratio = segmentIndex / segmentNumber;
      float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
      v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
    }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio), 0.0, 1.0));
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  setPickingColor(a_PickingColor);
}
`,$s={solid:0,dash:1},Es=function(h){D()(x,h);var _=Go(x);function x(){return Y()(this,x),_.apply(this,arguments)}return i()(x,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=A.lineType,ie=B===void 0?"solid":B,de=A.dashArray,Be=de===void 0?[10,5]:de;return Be.length===2&&Be.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:$s[ie||"solid"],u_dash_array:Be,u_blur:.9}}},{key:"getAnimateUniforms",value:function(){var A=this.layer.getLayerConfig(),M=A.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:Pl,fragmentShader:pi,triangulation:ya,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(M,B,ie,de){var Be=M.size,zt=Be===void 0?1:Be;return Array.isArray(zt)?[zt[0]]:[zt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:b.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:b.gl.STATIC_DRAW,data:[],type:b.gl.FLOAT},size:4,update:function(M,B,ie,de){return[ie[3],ie[4],ie[5],ie[6]]}}})}}]),x}(Et);function gl(h){var _=cu();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function cu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var _u=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;
varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

   if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  setPickingColor(a_PickingColor);
}
`,fu=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,Uu={solid:0,dash:1},Js=function(h){D()(x,h);var _=gl(x);function x(){return Y()(this,x),_.apply(this,arguments)}return i()(x,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=A.lineType,ie=B===void 0?"solid":B,de=A.dashArray,Be=de===void 0?[10,5]:de;return Be.length===2&&Be.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:Uu[ie]||0,u_dash_array:Be}}},{key:"getAnimateUniforms",value:function(){var A=this.layer.getLayerConfig(),M=A.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc3Dline",vertexShader:_u,fragmentShader:fu,triangulation:ya,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(M,B,ie,de){var Be=M.size,zt=Be===void 0?1:Be;return Array.isArray(zt)?[zt[0]]:[zt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:b.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:b.gl.STATIC_DRAW,data:[],type:b.gl.FLOAT},size:4,update:function(M,B,ie,de){return[ie[3],ie[4],ie[5],ie[6]]}}})}}]),x}(Et);function Rc(h){var _=pf();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function pf(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ci=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,Ic=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
    vec2 x = mix(source, target, ratio);
    vec2 center = mix(source, target, 0.5);
    float dSourceCenter = distance(source, center);
    float dXCenter = distance(x, center);
    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
     float vertex_height = paraboloid(source, target, segmentRatio);

    return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
    );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}
vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(abs(angularDist - PI) < 0.001) {
    return (1.0 - t) * source + t * target;
  }
  float a = sin((1.0 - t) * angularDist) / sin(angularDist);
  float b = sin(t * angularDist) / sin(angularDist);
  vec2 sin_source = sin(source);
  vec2 cos_source = cos(source);
  vec2 sin_target = sin(target);
  vec2 cos_target = cos(target);
  float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
  float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
  float z = a * sin_source.y + b * sin_target.y;
  return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
}

void main() {
  v_color = a_Color;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba);
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));
  setPickingColor(a_PickingColor);
}

`,gc={solid:0,dash:1},Qc=function(h){D()(x,h);var _=Rc(x);function x(){return Y()(this,x),_.apply(this,arguments)}return i()(x,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=A.lineType,ie=B===void 0?"solid":B,de=A.dashArray,Be=de===void 0?[10,5]:de;return Be.length===2&&Be.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:gc[ie]||0,u_dash_array:Be}}},{key:"getAnimateUniforms",value:function(){var A=this.layer.getLayerConfig(),M=A.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:Ic,fragmentShader:ci,triangulation:ya,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(M,B,ie,de){var Be=M.size,zt=Be===void 0?1:Be;return Array.isArray(zt)?[zt[0]]:[zt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:b.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:b.gl.STATIC_DRAW,data:[],type:b.gl.FLOAT},size:4,update:function(M,B,ie,de){return[ie[3],ie[4],ie[5],ie[6]]}}})}}]),x}(Et);function yl(h){var _=qc();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function qc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var $i=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
uniform float u_blur : 0.99;
uniform float u_line_type: 0.0;
uniform float u_opacity : 1.0;
varying vec4 v_color;
varying vec2 v_normal;


// dash
uniform float u_dash_offset : 0.0;
uniform float u_dash_ratio : 0.1;
varying float v_distance_ratio;
varying vec4 v_dash_array;
varying float v_side;


#pragma include "picking"

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
// [animate, duration, interval, trailLength],
void main() {
  gl_FragColor = v_color;
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
 // dash line
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
    // gl_FragColor.a *=(1.0- step(v_dash_array.x, mod(v_distance_ratio, dashLength)));
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,Su=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5.\uFF0C0, 0];
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_dash_array;
varying vec2 v_normal;
varying float v_distance_ratio;
varying float v_side;


void main() {

  if(u_line_type == LineTypeDash) {
    v_distance_ratio = a_Distance / a_Total_Distance;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = a_Distance / a_Total_Distance;
  }
  v_normal = vec2(reverse_offset_normal(a_Normal) * sign(a_Miter));
  v_color = a_Color;
  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  vec2 offset = project_pixel(size.xy);
  v_side = a_Miter * a_Size.x;
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  setPickingColor(a_PickingColor);
}
`,bl={solid:0,dash:1},as=function(h){D()(x,h);var _=yl(x);function x(){return Y()(this,x),_.apply(this,arguments)}return i()(x,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=A.lineType,ie=B===void 0?"solid":B,de=A.dashArray,Be=de===void 0?[10,5,0,0]:de;return Be.length===2&&Be.push(0,0),{u_opacity:M||1,u_line_type:bl[ie],u_dash_array:Be}}},{key:"getAnimateUniforms",value:function(){var A=this.layer.getLayerConfig(),M=A.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"line",vertexShader:Su,fragmentShader:$i,triangulation:Ia,primitive:b.gl.TRIANGLES,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){var A=this.layer.getLayerConfig(),M=A.lineType,B=M===void 0?"solid":M;this.styleAttributeService.registerStyleAttribute({name:"distance",type:b.AttributeType.Attribute,descriptor:{name:"a_Distance",buffer:{usage:b.gl.STATIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(de,Be,zt,qt){return[zt[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:b.AttributeType.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:b.gl.STATIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(de,Be,zt,qt){return[zt[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:2,update:function(de,Be,zt,qt){var Or=de.size,Nr=Or===void 0?1:Or;return Array.isArray(Nr)?[Nr[0],Nr[1]]:[Nr,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:b.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:b.gl.STATIC_DRAW,data:[],type:b.gl.FLOAT},size:3,update:function(de,Be,zt,qt,Or){return Or}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:b.AttributeType.Attribute,descriptor:{name:"a_Miter",buffer:{usage:b.gl.STATIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(de,Be,zt,qt){return[zt[4]]}}})}}]),x}(Et),Dc={arc:Es,arc3d:Js,greatcircle:Qc,line:as},yc=Dc;function Ll(h){var _=qu();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function qu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Nc=function(h){D()(x,h);var _=Ll(x);function x(){var y;Y()(this,x);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return y=_.call.apply(_,[this].concat(M)),y.type="LineLayer",y}return i()(x,[{key:"buildModels",value:function(){var A=this.getModelType();this.layerModel=new yc[A](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var A=this.getModelType(),M={line:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"}};return M[A]}},{key:"getModelType",value:function(){var A,M=this.styleAttributeService.getLayerStyleAttribute("shape"),B=M==null||((A=M.scale)===null||A===void 0)?void 0:A.field;return B||"line"}}]),x}(ne);function hu(h){var _=Au();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function Au(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ef=`varying vec4 v_color;
uniform float u_opacity: 1.0;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,$l=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform mat4 u_ModelMatrix;
uniform vec2 u_offsets;
varying vec4 v_color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec3 size = a_Size * a_Position;

  vec2 offset = project_pixel(size.xy);

  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  vec4 pos = vec4(project_pos.xy + offset, project_pixel(size.z), 1.0);

  float lightWeight = calc_lighting(pos);
  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  gl_Position = project_common_position_to_clipspace(pos);
  setPickingColor(a_PickingColor);
}
`,Ti=function(h){D()(x,h);var _=hu(x);function x(){return Y()(this,x),_.apply(this,arguments)}return i()(x,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=A.offsets;return{u_opacity:M||1,u_offsets:B||[0,0]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointExtrude2",vertexShader:$l,fragmentShader:ef,triangulation:va,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:3,update:function(M,B,ie,de){var Be=M.size;if(Be){var zt=[];return Array.isArray(Be)&&(zt=Be.length===2?[Be[0],Be[0],Be[1]]:Be),Array.isArray(Be)||(zt=[Be]),zt}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:b.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:b.gl.STATIC_DRAW,data:[],type:b.gl.FLOAT},size:3,update:function(M,B,ie,de,Be){return Be}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:b.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:3,update:function(M,B){var ie=Xe(M.coordinates);return[ie[0],ie[1],0]}}})}}]),x}(Et);function tf(h){var _=mf();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function mf(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Jl=`#define Animate 0.0

uniform float u_blur : 0;
uniform float u_opacity : 1;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [0, 0, 0, 0];
uniform float u_stroke_opacity : 1;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  int shape = int(floor(v_data.w + 0.5));

  lowp float antialiasblur = v_data.z;
  float antialiased_blur = -max(u_blur, antialiasblur);
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);
  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiased_blur,
    0.0,
    inner_df
  );
  vec4 strokeColor = u_stroke_color == vec4(0) ? v_color : u_stroke_color;
  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  // gl_FragColor = v_color * color_t;
  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor.a = gl_FragColor.a * opacity_t;
  if(u_aimate.x == Animate) {
    float d = length(v_data.xy);
    float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_aimate.z - u_aimate.y * u_time)), 0.0, 1.0);
    gl_FragColor = vec4(gl_FragColor.xyz, intensity);
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,kc=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec2 a_Extrude;
attribute float a_Size;
attribute float a_Shape;
uniform mat4 u_ModelMatrix;

uniform float u_stroke_width : 2;
uniform vec2 u_offsets;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "projection"
#pragma include "picking"

void main() {
  // unpack color(vec2)
  v_color = a_Color;
  vec2 extrude = a_Extrude;

  float shape_type = a_Shape;

  float newSize = setPickingSize(a_Size);

  // radius(16-bit)
  v_radius = newSize;

  vec2 offset = project_pixel(extrude * (newSize + u_stroke_width) + u_offsets);
  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  // TODO: billboard
  // anti-alias
  float antialiasblur = 1.0 / u_DevicePixelRatio / (newSize + u_stroke_width);

  // construct point coords
  v_data = vec4(extrude, antialiasblur,shape_type);

  setPickingColor(a_PickingColor);
}
`,Ql=function(h){D()(x,h);var _=tf(x);function x(){return Y()(this,x),_.apply(this,arguments)}return i()(x,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=M===void 0?1:M,ie=A.stroke,de=ie===void 0?"rgb(0,0,0,0)":ie,Be=A.strokeWidth,zt=Be===void 0?1:Be,qt=A.strokeOpacity,Or=qt===void 0?1:qt,Nr=A.offsets,bn=Nr===void 0?[0,0]:Nr;return{u_opacity:B,u_stroke_width:zt,u_stroke_color:Object(Me.s)(de),u_stroke_opacity:Or,u_offsets:[-bn[0],bn[1]]}}},{key:"getAnimateUniforms",value:function(){var A=this.layer.getLayerConfig(),M=A.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Va)}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointfill",vertexShader:kc,fragmentShader:Jl,triangulation:Va,depth:{enable:!1},blend:this.getBlend()})]}},{key:"animateOption2Array",value:function(A){return[A.enable?0:1,A.speed||1,A.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var A=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:b.AttributeType.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:2,update:function(B,ie,de,Be){var zt=[1,1,-1,1,-1,-1,1,-1],qt=Be%4*2;return[zt[qt],zt[qt+1]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(B,ie,de,Be){var zt=B.size,qt=zt===void 0?5:zt;return Array.isArray(qt)?[qt[0]]:[qt]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:b.AttributeType.Attribute,descriptor:{name:"a_Shape",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(B,ie,de,Be){var zt=B.shape,qt=zt===void 0?2:zt,Or=A.layer.getLayerConfig().shape2d,Nr=Or.indexOf(qt);return[Nr]}}})}}]),x}(Et);function el(h){var _=Bu();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function Bu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var xl=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [1, 1, 1, 1];
uniform float u_stroke_opacity : 1;
uniform float u_opacity : 1;

varying float v_size;
#pragma include "picking"
void main(){
vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
vec2 fragmentPosition = 2.0*gl_PointCoord - 1.0;
float distance = length(fragmentPosition);
float distanceSqrd = distance * distance;
float radius = 1.;
float r = 1.0 - smoothstep(radius-(radius*0.01),
                         radius+(radius*0.01),
                         distanceSqrd);
  vec4 textureColor=texture2D(u_texture,pos);
  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
        gl_FragColor= vec4(textureColor.xyz, textureColor.w);
  }else {
        gl_FragColor= step(0.01, textureColor.z) * v_color;
  }
  gl_FragColor.a =gl_FragColor.a * u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Po=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform float u_stroke_width : 1;
uniform vec2 u_offsets;
varying float v_size;

#pragma include "projection"
#pragma include "picking"

void main() {
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   v_size = a_Size;
   vec2 offset = project_pixel(u_offsets);
   gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,ql=function(h){D()(x,h);var _=el(x);function x(){var y;Y()(this,x);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return y=_.call.apply(_,[this].concat(M)),y.texture=void 0,y}return i()(x,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity;return{u_opacity:M||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"initModels",value:function(){var A=this;return this.initIconFontGlyphs(),this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",function(){A.updateTexture(),A.layer.render()}),[this.layer.buildLayerModel({moduleName:"pointiconImage",vertexShader:Po,fragmentShader:xl,triangulation:Ma,primitive:b.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var A=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(B,ie,de,Be){var zt=B.size;return Array.isArray(zt)?[zt[0]]:[zt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:b.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:2,update:function(B,ie,de,Be){var zt=A.fontService.mapping,qt=B.shape,Or=A.fontService.getGlyph(qt),Nr=zt[Or],bn=Nr.x,gn=Nr.y;return[bn,gn]}}})}},{key:"updateTexture",value:function(){var A=this.rendererService.createTexture2D,M=this.fontService.canvas;this.texture=A({data:M,mag:b.gl.LINEAR,min:b.gl.LINEAR,width:M.width,height:M.height})}},{key:"initIconFontGlyphs",value:function(){var A=this,M=this.layer.getLayerConfig(),B=M.fontWeight,ie=B===void 0?"normal":B,de=M.fontFamily,Be=de===void 0?"sans-serif":de,zt=this.layer.getEncodedData(),qt=[];zt.forEach(function(Or){var Nr=Or.shape,bn=Nr===void 0?"":Nr;bn=bn.toString();var gn=A.fontService.getGlyph(bn);qt.indexOf(gn)===-1&&qt.push(gn)}),this.fontService.setFontOptions({characterSet:qt,fontWeight:ie,fontFamily:Be,fontSize:48})}}]),x}(Et);function Rl(h){var _=Il();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function Il(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var jc=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [1, 1, 1, 1];
uniform float u_stroke_opacity : 1;
uniform float u_opacity : 1;

varying float v_size;
#pragma include "picking"
void main(){
vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
vec2 fragmentPosition = 2.0*gl_PointCoord - 1.0;
float distance = length(fragmentPosition);
float distanceSqrd = distance * distance;
float radius = 1.;
float r = 1.0 - smoothstep(radius-(radius*0.01),
                         radius+(radius*0.01),
                         distanceSqrd);
  vec4 textureColor=texture2D(u_texture,pos);
  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
        gl_FragColor= vec4(textureColor.xyz, textureColor.w);
  }else {
        gl_FragColor= step(0.01, textureColor.z) * v_color;
  }
  gl_FragColor.a =gl_FragColor.a * u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,El=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform float u_stroke_width : 1;
uniform vec2 u_offsets;
varying float v_size;

#pragma include "projection"
#pragma include "picking"

void main() {
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   v_size = a_Size;
   vec2 offset = project_pixel(u_offsets);
   gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,Qs=function(h){D()(x,h);var _=Rl(x);function x(){var y;Y()(this,x);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return y=_.call.apply(_,[this].concat(M)),y.texture=void 0,y.updateTexture=function(){var ie=y.rendererService.createTexture2D;if(y.texture){y.texture.update({data:y.iconService.getCanvas()}),y.layer.render();return}y.texture=ie({data:y.iconService.getCanvas(),mag:b.gl.LINEAR,min:b.gl.LINEAR,width:1024,height:y.iconService.canvasHeight||128})},y}return i()(x,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=A.offsets,ie=B===void 0?[0,0]:B;return this.rendererService.getDirty()&&this.texture.bind(),{u_opacity:M||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_offsets:[-ie[0],ie[1]]}}},{key:"initModels",value:function(){return this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){this.texture&&this.texture.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:El,fragmentShader:jc,triangulation:Ma,primitive:b.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var A=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(B,ie,de,Be){var zt=B.size,qt=zt===void 0?5:zt;return Array.isArray(qt)?[qt[0]]:[qt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:b.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:2,update:function(B,ie,de,Be){var zt=A.iconService.getIconMap(),qt=B.shape,Or=zt[qt]||{x:0,y:0},Nr=Or.x,bn=Or.y;return[Nr,bn]}}})}}]),x}(Et);function eo(h){var _=vf();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function vf(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var gf=`
uniform float u_opacity : 1;
uniform vec2 u_offsets;
varying vec4 v_color;

#pragma include "picking"
void main() {
  gl_FragColor = v_color;
  gl_FragColor.a =gl_FragColor.a * u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,Tl=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform vec2 u_offsets;

#pragma include "projection"
#pragma include "picking"
void main() {
  v_color = a_Color;
  vec2 offset = project_pixel(u_offsets);
  vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
    setPickingColor(a_PickingColor);
}
`;function ec(h){var _=h.coordinates;return{vertices:Ht()(_),indices:[0],size:_.length}}var tl=function(h){D()(x,h);var _=eo(x);function x(){return Y()(this,x),_.apply(this,arguments)}return i()(x,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=M===void 0?1:M,ie=A.stroke,de=ie===void 0?"rgb(0,0,0,0)":ie,Be=A.strokeWidth,zt=Be===void 0?1:Be,qt=A.offsets,Or=qt===void 0?[0,0]:qt;return{u_opacity:B,u_stroke_width:zt,u_stroke_color:Object(Me.s)(de),u_offsets:[-Or[0],Or[1]]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"normalpoint",vertexShader:Tl,fragmentShader:gf,triangulation:ec,depth:{enable:!1},primitive:b.gl.POINTS,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(M,B,ie,de){var Be=M.size,zt=Be===void 0?1:Be;return Array.isArray(zt)?[zt[0]]:[zt]}}})}},{key:"defaultStyleOptions",value:function(){return{blend:b.BlendType.additive}}}]),x}(Et);function Dl(h,_){var x;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(x=bc(h))||_&&h&&typeof h.length=="number"){x&&(h=x);var y=0,A=function(){};return{s:A,n:function(){return y>=h.length?{done:!0}:{done:!1,value:h[y++]}},e:function(Be){throw Be},f:A}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,B=!1,ie;return{s:function(){x=h[Symbol.iterator]()},n:function(){var Be=x.next();return M=Be.done,Be},e:function(Be){B=!0,ie=Be},f:function(){try{!M&&x.return!=null&&x.return()}finally{if(B)throw ie}}}}function bc(h,_){if(!h)return;if(typeof h=="string")return xc(h,_);var x=Object.prototype.toString.call(h).slice(8,-1);if(x==="Object"&&h.constructor&&(x=h.constructor.name),x==="Map"||x==="Set")return Array.from(h);if(x==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(x))return xc(h,_)}function xc(h,_){(_==null||_>h.length)&&(_=h.length);for(var x=0,y=new Array(_);x<_;x++)y[x]=h[x];return y}var rl=function(){function h(_,x,y){Y()(this,h),this.boxCells=[],this.xCellCount=void 0,this.yCellCount=void 0,this.boxKeys=void 0,this.bboxes=void 0,this.width=void 0,this.height=void 0,this.xScale=void 0,this.yScale=void 0,this.boxUid=void 0;var A=this.boxCells;this.xCellCount=Math.ceil(_/y),this.yCellCount=Math.ceil(x/y);for(var M=0;M<this.xCellCount*this.yCellCount;M++)A.push([]);this.boxKeys=[],this.bboxes=[],this.width=_,this.height=x,this.xScale=this.xCellCount/_,this.yScale=this.yCellCount/x,this.boxUid=0}return i()(h,[{key:"insert",value:function(x,y,A,M,B){this.forEachCell(y,A,M,B,this.insertBoxCell,this.boxUid++),this.boxKeys.push(x),this.bboxes.push(y),this.bboxes.push(A),this.bboxes.push(M),this.bboxes.push(B)}},{key:"query",value:function(x,y,A,M,B){return this.queryHitTest(x,y,A,M,!1,B)}},{key:"hitTest",value:function(x,y,A,M,B){return this.queryHitTest(x,y,A,M,!0,B)}},{key:"insertBoxCell",value:function(x,y,A,M,B,ie){this.boxCells[B].push(ie)}},{key:"queryHitTest",value:function(x,y,A,M,B,ie){if(A<0||x>this.width||M<0||y>this.height)return B?!1:[];var de=[];if(x<=0&&y<=0&&this.width<=A&&this.height<=M){if(B)return!0;for(var Be=0;Be<this.boxKeys.length;Be++)de.push({key:this.boxKeys[Be],x1:this.bboxes[Be*4],y1:this.bboxes[Be*4+1],x2:this.bboxes[Be*4+2],y2:this.bboxes[Be*4+3]});return ie?de.filter(ie):de}var zt={hitTest:B,seenUids:{box:{},circle:{}}};return this.forEachCell(x,y,A,M,this.queryCell,de,zt,ie),B?de.length>0:de}},{key:"queryCell",value:function(x,y,A,M,B,ie,de,Be){var zt=de.seenUids,qt=this.boxCells[B];if(qt!==null){var Or=this.bboxes,Nr=Dl(qt),bn;try{for(Nr.s();!(bn=Nr.n()).done;){var gn=bn.value;if(!zt.box[gn]){zt.box[gn]=!0;var Fn=gn*4;if(x<=Or[Fn+2]&&y<=Or[Fn+3]&&A>=Or[Fn+0]&&M>=Or[Fn+1]&&(!Be||Be(this.boxKeys[gn]))){if(de.hitTest)return ie.push(!0),!0;ie.push({key:this.boxKeys[gn],x1:Or[Fn],y1:Or[Fn+1],x2:Or[Fn+2],y2:Or[Fn+3]})}}}}catch(Ta){Nr.e(Ta)}finally{Nr.f()}}return!1}},{key:"forEachCell",value:function(x,y,A,M,B,ie,de,Be){for(var zt=this.convertToXCellCoord(x),qt=this.convertToYCellCoord(y),Or=this.convertToXCellCoord(A),Nr=this.convertToYCellCoord(M),bn=zt;bn<=Or;bn++)for(var gn=qt;gn<=Nr;gn++){var Fn=this.xCellCount*gn+bn;if(B.call(this,x,y,A,M,Fn,ie,de,Be))return}}},{key:"convertToXCellCoord",value:function(x){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(x*this.xScale)))}},{key:"convertToYCellCoord",value:function(x){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(x*this.yScale)))}}]),h}(),rf=rl,nl=function(){function h(_,x){Y()(this,h),this.width=void 0,this.height=void 0,this.grid=void 0,this.viewportPadding=100,this.screenRightBoundary=void 0,this.screenBottomBoundary=void 0,this.gridRightBoundary=void 0,this.gridBottomBoundary=void 0,this.width=_,this.height=x,this.viewportPadding=Math.max(_,x),this.grid=new rf(_+this.viewportPadding,x+this.viewportPadding,25),this.screenRightBoundary=_+this.viewportPadding,this.screenBottomBoundary=x+this.viewportPadding,this.gridRightBoundary=_+2*this.viewportPadding,this.gridBottomBoundary=x+2*this.viewportPadding}return i()(h,[{key:"placeCollisionBox",value:function(x){var y=x.x1+x.anchorPointX+this.viewportPadding,A=x.y1+x.anchorPointY+this.viewportPadding,M=x.x2+x.anchorPointX+this.viewportPadding,B=x.y2+x.anchorPointY+this.viewportPadding;return!this.isInsideGrid(y,A,M,B)||this.grid.hitTest(y,A,M,B)?{box:[]}:{box:[y,A,M,B]}}},{key:"insertCollisionBox",value:function(x,y){var A={featureIndex:y};this.grid.insert(A,x[0],x[1],x[2],x[3])}},{key:"project",value:function(x,y,A){var M=gr.e.fromValues(y,A,0,1),B=gr.e.create(),ie=gr.b.fromValues.apply(gr.b,Ht()(x));return gr.e.transformMat4(B,M,ie),{x:(B[0]/B[3]+1)/2*this.width+this.viewportPadding,y:(-B[1]/B[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(x,y,A,M){return A>=0&&x<this.gridRightBoundary&&M>=0&&y<this.gridBottomBoundary}}]),h}();function qs(h,_){var x;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(x=_l(h))||_&&h&&typeof h.length=="number"){x&&(h=x);var y=0,A=function(){};return{s:A,n:function(){return y>=h.length?{done:!0}:{done:!1,value:h[y++]}},e:function(Be){throw Be},f:A}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,B=!1,ie;return{s:function(){x=h[Symbol.iterator]()},n:function(){var Be=x.next();return M=Be.done,Be},e:function(Be){B=!0,ie=Be},f:function(){try{!M&&x.return!=null&&x.return()}finally{if(B)throw ie}}}}function _l(h,_){if(!h)return;if(typeof h=="string")return tc(h,_);var x=Object.prototype.toString.call(h).slice(8,-1);if(x==="Object"&&h.constructor&&(x=h.constructor.name),x==="Map"||x==="Set")return Array.from(h);if(x==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(x))return tc(h,_)}function tc(h,_){(_==null||_>h.length)&&(_=h.length);for(var x=0,y=new Array(_);x<_;x++)y[x]=h[x];return y}function Fc(h){var _=.5,x=.5;switch(h){case"right":case"top-right":case"bottom-right":_=1;break;case"left":case"top-left":case"bottom-left":_=0;break;default:_=.5}switch(h){case"bottom":case"bottom-right":case"bottom-left":x=1;break;case"top":case"top-right":case"top-left":x=0;break;default:x=.5}return{horizontalAlign:_,verticalAlign:x}}function nf(h,_,x,y,A){if(!A)return;var M=h[y],B=M.glyph;if(B)for(var ie=_[B].advance*M.scale,de=(h[y].x+ie)*A,Be=x;Be<=y;Be++)h[Be].x-=de}function Fs(h,_,x,y,A,M,B){var ie=(_-x)*A,de=(-y*B+.5)*M,Be=qs(h),zt;try{for(Be.s();!(zt=Be.n()).done;){var qt=zt.value;qt.x+=ie,qt.y+=de}}catch(Or){Be.e(Or)}finally{Be.f()}}function yf(h,_,x,y,A,M,B){var ie=-8,de=0,Be=ie,zt=0,qt=h.positionedGlyphs,Or=M==="right"?1:M==="left"?0:.5,Nr=qt.length;x.forEach(function(Ca){if(Ca.split("").forEach(function(ai){var ii=_[ai],Qi=0;ii&&(qt.push({glyph:ai,x:de,y:Be+Qi,vertical:!1,scale:1,metrics:ii}),de+=ii.advance+B)}),qt.length!==Nr){var Li=de-B;zt=Math.max(Li,zt),nf(qt,_,Nr,qt.length-1,Or)}de=0,Be+=y});var bn=Fc(A),gn=bn.horizontalAlign,Fn=bn.verticalAlign;Fs(qt,Or,gn,Fn,zt,y,x.length);var Ta=Be-ie;h.top+=-Fn*Ta,h.bottom=h.top+Ta,h.left+=-gn*zt,h.right=h.left+zt}function al(h,_,x,y,A,M){var B=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],ie=h.split(`
`),de=[],Be={positionedGlyphs:de,top:B[1],bottom:B[1],left:B[0],right:B[0],lineCount:ie.length,text:h};return yf(Be,_,ie,x,y,A,M),de.length?Be:!1}function wi(h){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],x=arguments.length>2?arguments[2]:void 0,y=h.positionedGlyphs,A=y===void 0?[]:y,M=[],B=qs(A),ie;try{for(B.s();!(ie=B.n()).done;){var de=ie.value,Be=de.metrics,zt=4,qt=Be.advance*de.scale/2,Or=x?[de.x+qt,de.y]:[0,0],Nr=x?[0,0]:[de.x+qt+_[0],de.y+_[1]],bn=(0-zt)*de.scale-qt+Nr[0],gn=(0-zt)*de.scale+Nr[1],Fn=bn+Be.width*de.scale,Ta=gn+Be.height*de.scale,Ca={x:bn,y:gn},Li={x:Fn,y:gn},ai={x:bn,y:Ta},ii={x:Fn,y:Ta};M.push({tl:Ca,tr:Li,bl:ai,br:ii,tex:Be,glyphOffset:Or})}}catch(Qi){B.e(Qi)}finally{B.f()}return M}function il(h,_){var x;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(x=Vu(h))||_&&h&&typeof h.length=="number"){x&&(h=x);var y=0,A=function(){};return{s:A,n:function(){return y>=h.length?{done:!0}:{done:!1,value:h[y++]}},e:function(Be){throw Be},f:A}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,B=!1,ie;return{s:function(){x=h[Symbol.iterator]()},n:function(){var Be=x.next();return M=Be.done,Be},e:function(Be){B=!0,ie=Be},f:function(){try{!M&&x.return!=null&&x.return()}finally{if(B)throw ie}}}}function Vu(h,_){if(!h)return;if(typeof h=="string")return ui(h,_);var x=Object.prototype.toString.call(h).slice(8,-1);if(x==="Object"&&h.constructor&&(x=h.constructor.name),x==="Map"||x==="Set")return Array.from(h);if(x==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(x))return ui(h,_)}function ui(h,_){(_==null||_>h.length)&&(_=h.length);for(var x=0,y=new Array(_);x<_;x++)y[x]=h[x];return y}function kn(h){var _=Oi();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function Oi(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ws=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
// uniform float u_font_size : 24.0;
uniform float u_opacity : 1.0;
uniform float u_stroke_opacity: 1.0;
uniform vec4 u_stroke : [0, 0, 0, 1];
uniform float u_strokeWidth : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

#pragma include "picking"
void main() {
  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  // float fontScale = u_font_size / FONT_SIZE;

  lowp float buff = (6.0 - u_strokeWidth / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke.rgb, u_stroke.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Nl=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying float v_fontScale;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_color = a_Color;
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
   v_fontScale = fontScale;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  gl_Position = vec4(projected_position.xy / projected_position.w
    + a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`;function Gu(h){var _=this,x=h.id,y=[],A=[];if(!_.glyphInfoMap||!_.glyphInfoMap[x])return{vertices:[],indices:[],size:7};var M=_.glyphInfoMap[x].centroid,B=M.length===2?[M[0],M[1],0]:M;return _.glyphInfoMap[x].glyphQuads.forEach(function(ie,de){y.push.apply(y,Ht()(B).concat([ie.tex.x,ie.tex.y+ie.tex.height,ie.tl.x,ie.tl.y],Ht()(B),[ie.tex.x+ie.tex.width,ie.tex.y+ie.tex.height,ie.tr.x,ie.tr.y],Ht()(B),[ie.tex.x+ie.tex.width,ie.tex.y,ie.br.x,ie.br.y],Ht()(B),[ie.tex.x,ie.tex.y,ie.bl.x,ie.bl.y])),A.push(0+de*4,1+de*4,2+de*4,2+de*4,3+de*4,0+de*4)}),{vertices:y,indices:A,size:7}}var ol=function(h){D()(x,h);var _=kn(x);function x(){var y;Y()(this,x);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return y=_.call.apply(_,[this].concat(M)),y.glyphInfo=void 0,y.glyphInfoMap={},y.texture=void 0,y.currentZoom=-1,y.extent=void 0,y.textureHeight=0,y.textCount=0,y.preTextStyle={},y.buildModels=function(){return y.initGlyph(),y.updateTexture(),y.filterGlyphs(),[y.layer.buildLayerModel({moduleName:"pointText",vertexShader:Nl,fragmentShader:ws,triangulation:Gu.bind(it()(y)),depth:{enable:!1},blend:y.getBlend()})]},y}return i()(x,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=M===void 0?1:M,ie=A.stroke,de=ie===void 0?"#fff":ie,Be=A.strokeWidth,zt=Be===void 0?0:Be,qt=A.strokeOpacity,Or=qt===void 0?1:qt,Nr=A.textAnchor,bn=Nr===void 0?"center":Nr,gn=A.textAllowOverlap,Fn=gn===void 0?!1:gn,Ta=A.halo,Ca=Ta===void 0?.5:Ta,Li=A.gamma,ai=Li===void 0?2:Li,ii=this.fontService,Qi=ii.canvas,wa=ii.mapping;return Object.keys(wa).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(wa).length),this.preTextStyle={textAnchor:bn,textAllowOverlap:Fn},{u_opacity:B,u_stroke_opacity:Or,u_sdf_map:this.texture,u_stroke:Object(Me.s)(de),u_halo_blur:Ca,u_gamma_scale:ai,u_sdf_map_size:[Qi.width,Qi.height],u_strokeWidth:zt}}},{key:"initModels",value:function(){this.layer.on("remapping",this.buildModels),this.extent=this.textExtent();var A=this.layer.getLayerConfig(),M=A.textAnchor,B=M===void 0?"center":M,ie=A.textAllowOverlap,de=ie===void 0?!0:ie;return this.preTextStyle={textAnchor:B,textAllowOverlap:de},this.buildModels()}},{key:"needUpdate",value:function(){var A=this.layer.getLayerConfig(),M=A.textAllowOverlap,B=M===void 0?!1:M,ie=this.mapService.getZoom(),de=this.mapService.getBounds(),Be=Object(Me.j)(this.extent,de);return!B&&(Math.abs(this.currentZoom-ie)>1||!Be)||B!==this.preTextStyle.textAllowOverlap?(this.reBuildModel(),!0):!1}},{key:"clearModels",value:function(){this.layer.off("remapping",this.buildModels)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:b.AttributeType.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:b.gl.STATIC_DRAW,data:[],type:b.gl.FLOAT},size:2,update:function(M,B,ie,de){return[ie[5],ie[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(M,B,ie,de){var Be=M.size,zt=Be===void 0?12:Be;return Array.isArray(zt)?[zt[0]]:[zt]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:b.AttributeType.Attribute,descriptor:{name:"a_tex",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:2,update:function(M,B,ie,de){return[ie[3],ie[4]]}}})}},{key:"textExtent",value:function(){var A=this.mapService.getBounds();return Object(Me.r)(A,.5)}},{key:"initTextFont",value:function(){var A=this.layer.getLayerConfig(),M=A.fontWeight,B=M===void 0?"400":M,ie=A.fontFamily,de=ie===void 0?"sans-serif":ie,Be=this.layer.getEncodedData(),zt=[];Be.forEach(function(qt){var Or=qt.shape,Nr=Or===void 0?"":Or;Nr=Nr.toString();var bn=il(Nr),gn;try{for(bn.s();!(gn=bn.n()).done;){var Fn=gn.value;zt.indexOf(Fn)===-1&&zt.push(Fn)}}catch(Ta){bn.e(Ta)}finally{bn.f()}}),this.fontService.setFontOptions({characterSet:zt,fontWeight:B,fontFamily:de})}},{key:"generateGlyphLayout",value:function(){var A=this,M=this.fontService.mapping,B=this.layer.getLayerConfig(),ie=B.spacing,de=ie===void 0?2:ie,Be=B.textAnchor,zt=Be===void 0?"center":Be,qt=B.textOffset,Or=this.layer.getEncodedData();this.glyphInfo=Or.map(function(Nr){var bn=Nr.shape,gn=bn===void 0?"":bn,Fn=Nr.coordinates,Ta=Nr.id,Ca=Nr.size,Li=Ca===void 0?1:Ca,ai=al(gn.toString(),M,Li,zt,"center",de,qt),ii=wi(ai,qt,!1);return Nr.shaping=ai,Nr.glyphQuads=ii,Nr.centroid=Xe(Fn),A.glyphInfoMap[Ta]={shaping:ai,glyphQuads:ii,centroid:Xe(Fn)},Nr})}},{key:"filterGlyphs",value:function(){var A=this,M=this.layer.getLayerConfig(),B=M.padding,ie=B===void 0?[4,4]:B,de=M.textAllowOverlap,Be=de===void 0?!1:de;if(Be)return;this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var zt=this.rendererService.getViewportSize(),qt=zt.width,Or=zt.height,Nr=new nl(qt,Or),bn=this.glyphInfo.filter(function(gn){var Fn=gn.shaping,Ta=gn.id,Ca=Ta===void 0?0:Ta,Li=gn.centroid,ai=gn.size,ii=ai/24,Qi=A.mapService.lngLatToContainer(Li),wa=Nr.placeCollisionBox({x1:Fn.left*ii-ie[0],x2:Fn.right*ii+ie[0],y1:Fn.top*ii-ie[1],y2:Fn.bottom*ii+ie[1],anchorPointX:Qi.x,anchorPointY:Qi.y}),qi=wa.box;return qi&&qi.length?(Nr.insertCollisionBox(qi,Ca),!0):!1});bn.forEach(function(gn){A.glyphInfoMap[gn.id]=gn})}},{key:"initGlyph",value:function(){this.initTextFont(),this.generateGlyphLayout()}},{key:"updateTexture",value:function(){var A=this.rendererService.createTexture2D,M=this.fontService.canvas;this.textureHeight=M.height,this.texture&&this.texture.destroy(),this.texture=A({data:M,mag:b.gl.LINEAR,min:b.gl.LINEAR,width:M.width,height:M.height})}},{key:"reBuildModel",value:function(){this.filterGlyphs(),this.layer.models=[this.layer.buildLayerModel({moduleName:"pointText",vertexShader:Nl,fragmentShader:ws,triangulation:Gu.bind(this),depth:{enable:!1},blend:this.getBlend()})]}}]),x}(Et),bf={fill:Ql,image:Qs,normal:tl,extrude:Ti,text:ol,icon:ql},is=bf;function Sl(h){var _=sl();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function sl(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ul=function(h){D()(x,h);var _=Sl(x);function x(){var y;Y()(this,x);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return y=_.call.apply(_,[this].concat(M)),y.type="PointLayer",y}return i()(x,[{key:"buildModels",value:function(){var A=this.getModelType();this.layerModel=new is[A](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var A=this.getModelType(),M={normal:{blend:"additive"},fill:{blend:"normal"},extrude:{},image:{},icon:{},text:{blend:"normal"}};return M[A]}},{key:"getModelType",value:function(){var A=this.getEncodedData(),M=this.getLayerConfig(),B=M.shape2d,ie=M.shape3d,de=this.iconService.getIconMap(),Be=A.find(function(qt){return qt.hasOwnProperty("shape")});if(Be){var zt=Be.shape;return zt==="dot"?"normal":(B==null?void 0:B.indexOf(zt))!==-1?"fill":(ie==null?void 0:ie.indexOf(zt))!==-1?"extrude":de.hasOwnProperty(zt)?"image":this.fontService.getGlyph(zt)!==""?"icon":"text"}else return"normal"}}]),x}(ne);function zi(h){var _=Ts();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function Ts(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var kl=`uniform float u_opacity: 1.0;
varying vec4 v_Color;

#pragma include "picking"

void main() {
  gl_FragColor = v_Color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,to=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,In=function(h){D()(x,h);var _=zi(x);function x(){return Y()(this,x),_.apply(this,arguments)}return i()(x,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=M===void 0?1:M;return{u_opacity:B}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygonExtrude",vertexShader:to,fragmentShader:kl,triangulation:da})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:b.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:b.gl.STATIC_DRAW,data:[],type:b.gl.FLOAT},size:3,update:function(M,B,ie,de,Be){return Be}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(M,B,ie,de){var Be=M.size,zt=Be===void 0?10:Be;return Array.isArray(zt)?[zt[0]]:[zt]}}})}}]),x}(Et);function zs(h){var _=ti();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function ti(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var jl=`uniform float u_opacity: 1.0;
varying vec4 v_Color;

#pragma include "picking"

void main() {
  gl_FragColor = v_Color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,du=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}

`,Us=function(h){D()(x,h);var _=zs(x);function x(){return Y()(this,x),_.apply(this,arguments)}return i()(x,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=M===void 0?1:M;return{u_opacity:B}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygon",vertexShader:du,fragmentShader:jl,triangulation:Wi,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){}}]),x}(Et),ll={fill:Us,line:as,extrude:In,text:ol,point_fill:Ql,point_image:Qs,point_normal:tl,point_extrude:Ti},qr=ll;function Ec(h){var _=os();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function os(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ro=function(h){D()(x,h);var _=Ec(x);function x(){var y;Y()(this,x);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return y=_.call.apply(_,[this].concat(M)),y.type="PolygonLayer",y}return i()(x,[{key:"buildModels",value:function(){var A=this.getModelType();this.layerModel=new qr[A](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var A,M=this.styleAttributeService.getLayerStyleAttribute("shape"),B=M==null||((A=M.scale)===null||A===void 0)?void 0:A.field;return B==="fill"?"fill":B==="extrude"?"extrude":B==="line"?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var A=this.getEncodedData(),M=this.getLayerConfig(),B=M.shape2d,ie=M.shape3d,de=this.iconService.getIconMap(),Be=A.find(function(qt){return qt.hasOwnProperty("shape")});if(Be){var zt=Be.shape;return zt==="dot"?"point_normal":(B==null?void 0:B.indexOf(zt))!==-1?"point_fill":(ie==null?void 0:ie.indexOf(zt))!==-1?"point_extrude":de.hasOwnProperty(zt)?"point_image":"text"}else return"fill"}}]),x}(ne);function Jo(h){var _=Os();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function Os(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Fl=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;

void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;
  if (value == u_noDataValue)
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
    gl_FragColor = vec4(0, 0, 0, 0);
  else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }


}
`,zc=`precision highp float;
uniform mat4 u_ModelMatrix;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
}
`,Bs=function(h){D()(x,h);var _=Jo(x);function x(){var y;Y()(this,x);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return y=_.call.apply(_,[this].concat(M)),y.texture=void 0,y.colorTexture=void 0,y}return i()(x,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=M===void 0?1:M,ie=A.clampLow,de=ie===void 0?!0:ie,Be=A.clampHigh,zt=Be===void 0?!0:Be,qt=A.noDataValue,Or=qt===void 0?-9999999:qt,Nr=A.domain,bn=Nr===void 0?[0,1]:Nr;return this.updateColorTexure(),{u_opacity:B||1,u_texture:this.texture,u_domain:bn,u_clampLow:de,u_clampHigh:typeof zt!="undefined"?zt:de,u_noDataValue:Or,u_colorTexture:this.colorTexture}}},{key:"initModels",value:function(){var A=this.layer.getSource(),M=this.rendererService.createTexture2D,B=A.data.dataArray[0];this.texture=M({data:B.data,width:B.width,height:B.height,format:b.gl.LUMINANCE,type:b.gl.FLOAT});var ie=this.layer.getLayerConfig(),de=ie.rampColors,Be=Object(Me.n)(de);return this.colorTexture=M({data:Be.data,width:Be.width,height:Be.height,flipY:!1}),[this.layer.buildLayerModel({moduleName:"RasterImageData",vertexShader:zc,fragmentShader:Fl,triangulation:ga,primitive:b.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:b.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:2,update:function(M,B,ie,de){return[ie[3],ie[4]]}}})}},{key:"updateColorTexure",value:function(){var A=this.rendererService.createTexture2D,M=this.layer.getLayerConfig(),B=M.rampColors,ie=Object(Me.n)(B);this.colorTexture=A({data:ie.data,width:ie.width,height:ie.height,flipY:!1})}}]),x}(Et),Cu={raster:Bs,raster3d:Bs},zl=Cu;function Ul(h){var _=af();return function(){var y=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(y,arguments,M)}else A=y.apply(this,arguments);return te()(this,A)}}function af(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Uc=function(h){D()(x,h);var _=Ul(x);function x(){var y;Y()(this,x);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return y=_.call.apply(_,[this].concat(M)),y.type="RasterLayer",y}return i()(x,[{key:"buildModels",value:function(){var A=this.getModelType();this.layerModel=new zl[A](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var A=this.getModelType(),M={raster:{},raster3d:{}};return M[A]}},{key:"getModelType",value:function(){return"raster"}}]),x}(ne),Lo,ss,Pa,eu,Ro,To,Al,cl;function pu(h,_){var x=Object.keys(h);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(h);_&&(y=y.filter(function(A){return Object.getOwnPropertyDescriptor(h,A).enumerable})),x.push.apply(x,y)}return x}function _s(h){for(var _=1;_<arguments.length;_++){var x=arguments[_]!=null?arguments[_]:{};_%2?pu(Object(x),!0).forEach(function(y){Pe()(h,y,x[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(x)):pu(Object(x)).forEach(function(y){Object.defineProperty(h,y,Object.getOwnPropertyDescriptor(x,y))})}return h}var Tc=(Lo=Object(ur.injectable)(),ss=Object(ur.inject)(b.TYPES.IGlobalConfigService),Pa=Object(ur.inject)(b.TYPES.ILogService),Lo(eu=(Ro=(cl=function(){function h(){Y()(this,h),De()(this,"configService",To,this),De()(this,"logger",Al,this)}return i()(h,[{key:"apply",value:function(x,y){var A=this,M=y.styleAttributeService;x.hooks.init.tap("DataMappingPlugin",function(){A.generateMaping(x,{styleAttributeService:M})}),x.hooks.beforeRenderData.tap("DataMappingPlugin",function(){return x.dataState.dataMappingNeedUpdate=!1,A.generateMaping(x,{styleAttributeService:M}),!0}),x.hooks.beforeRender.tap("DataMappingPlugin",function(){if(x.layerModelNeedUpdate)return;var B=M.getLayerStyleAttributes()||[],ie=M.getLayerStyleAttribute("filter"),de=x.getSource().data.dataArray,Be=B.filter(function(qt){return qt.needRemapping}),zt=de;(ie==null?void 0:ie.needRemapping)&&(ie==null?void 0:ie.scale)&&(zt=de.filter(function(qt){return A.applyAttributeMapping(ie,qt)[0]})),Be.length&&((ie==null?void 0:ie.needRemapping)?(x.setEncodedData(A.mapping(B,zt)),ie.needRemapping=!1):x.setEncodedData(A.mapping(Be,zt,x.getEncodedData())),A.logger.debug("remapping finished"),x.emit("remapping",null))})}},{key:"generateMaping",value:function(x,y){var A=this,M=y.styleAttributeService,B=M.getLayerStyleAttributes()||[],ie=M.getLayerStyleAttribute("filter"),de=x.getSource().data.dataArray,Be=de;(ie==null?void 0:ie.scale)&&(Be=de.filter(function(zt){return A.applyAttributeMapping(ie,zt)[0]})),x.setEncodedData(this.mapping(B,Be))}},{key:"mapping",value:function(x,y,A){var M=this;return y.map(function(B,ie){var de=A?A[ie]:{},Be=_s({id:B._id,coordinates:B.coordinates},de);return x.filter(function(zt){return zt.scale!==void 0}).forEach(function(zt){var qt=M.applyAttributeMapping(zt,B);zt.needRemapping=!1,zt.name==="color"&&(qt=qt.map(function(Or){return Object(Me.s)(Or)})),Be[zt.name]=Array.isArray(qt)&&qt.length===1?qt[0]:qt}),Be})}},{key:"applyAttributeMapping",value:function(x,y){var A;if(!x.scale)return[];var M=(x==null||((A=x.scale)===null||A===void 0)?void 0:A.scalers)||[],B=[];return M.forEach(function(ie){var de,Be=ie.field;(y.hasOwnProperty(Be)||((de=x.scale)===null||de===void 0?void 0:de.type)==="variable")&&B.push(y[Be])}),x.mapping?x.mapping(B):[]}}]),h}(),cl),To=Je()(Ro.prototype,"configService",[ss],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Al=Je()(Ro.prototype,"logger",[Pa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ro))||eu),Jn=o("rlAn"),jn,_c,us,Io=(jn=Object(ur.injectable)(),jn(_c=(us=function(){function h(){Y()(this,h),this.mapService=void 0}return i()(h,[{key:"apply",value:function(x){var y=this;this.mapService=x.getContainer().get(b.TYPES.IMapService),x.hooks.init.tap("DataSourcePlugin",function(){var A=x.sourceOption,M=A.data,B=A.options;x.setSource(new Jn.default(M,B)),y.updateClusterData(x)}),x.hooks.beforeRenderData.tap("DataSourcePlugin",function(){var A=y.updateClusterData(x),M=x.dataState.dataSourceNeedUpdate;return x.dataState.dataSourceNeedUpdate=!1,A||M})}},{key:"updateClusterData",value:function(x){var y=x.getSource(),A=y.cluster,M=y.clusterOptions,B=M.zoom,ie=B===void 0?0:B,de=M.maxZoom,Be=de===void 0?16:de,zt=this.mapService.getZoom()-1;return A&&Math.abs(ie-zt)>1&&Be>ie?(y.updateClusterData(Math.floor(zt)),!0):!1}}]),h}(),us))||_c),vo=o("7tbW"),Ss=o.n(vo),wu=o("4qC0"),rc=o.n(wu),Ka=o("J2iB"),no=o.n(Ka),fl=function(h,_){return h<_?-1:h>_?1:h>=_?0:NaN},mu=function(h){return h.length===1&&(h=hl(h)),{left:function(x,y,A,M){for(A==null&&(A=0),M==null&&(M=x.length);A<M;){var B=A+M>>>1;h(x[B],y)<0?A=B+1:M=B}return A},right:function(x,y,A,M){for(A==null&&(A=0),M==null&&(M=x.length);A<M;){var B=A+M>>>1;h(x[B],y)>0?M=B:A=B+1}return A}}};function hl(h){return function(_,x){return fl(h(_),x)}}var Ou=mu(fl),Ms=Ou.right,Bc=Ou.left,Vs=Ms,xf=function(h,_){_==null&&(_=Bl);for(var x=0,y=h.length-1,A=h[0],M=new Array(y<0?0:y);x<y;)M[x]=_(A,A=h[++x]);return M};function Bl(h,_){return[h,_]}var Vl=function(h,_,x){var y=h.length,A=_.length,M=new Array(y*A),B,ie,de,Be;for(x==null&&(x=Bl),B=de=0;B<y;++B)for(Be=h[B],ie=0;ie<A;++ie,++de)M[de]=x(Be,_[ie]);return M},Sc=function(h,_){return _<h?-1:_>h?1:_>=h?0:NaN},ls=function(h){return h===null?NaN:+h},Hu=function(h,_){var x=h.length,y=0,A=-1,M=0,B,ie,de=0;if(_==null)for(;++A<x;)isNaN(B=ls(h[A]))||(ie=B-M,M+=ie/++y,de+=ie*(B-M));else for(;++A<x;)isNaN(B=ls(_(h[A],A,h)))||(ie=B-M,M+=ie/++y,de+=ie*(B-M));if(y>1)return de/(y-1)},Vc=function(h,_){var x=Hu(h,_);return x&&Math.sqrt(x)},Cl=function(h,_){var x=h.length,y=-1,A,M,B;if(_==null){for(;++y<x;)if((A=h[y])!=null&&A>=A)for(M=B=A;++y<x;)(A=h[y])!=null&&(M>A&&(M=A),B<A&&(B=A))}else for(;++y<x;)if((A=_(h[y],y,h))!=null&&A>=A)for(M=B=A;++y<x;)(A=_(h[y],y,h))!=null&&(M>A&&(M=A),B<A&&(B=A));return[M,B]},Zu=Array.prototype,nc=Zu.slice,Wu=Zu.map,Ps=function(h){return function(){return h}},of=function(h){return h},ac=function(h,_,x){h=+h,_=+_,x=(A=arguments.length)<2?(_=h,h=0,1):A<3?1:+x;for(var y=-1,A=Math.max(0,Math.ceil((_-h)/x))|0,M=new Array(A);++y<A;)M[y]=h+y*x;return M},ic=Math.sqrt(50),oc=Math.sqrt(10),s=Math.sqrt(2),a=function(h,_,x){var y,A=-1,M,B,ie;if(_=+_,h=+h,x=+x,h===_&&x>0)return[h];if((y=_<h)&&(M=h,h=_,_=M),(ie=n(h,_,x))===0||!isFinite(ie))return[];if(ie>0)for(h=Math.ceil(h/ie),_=Math.floor(_/ie),B=new Array(M=Math.ceil(_-h+1));++A<M;)B[A]=(h+A)*ie;else for(h=Math.floor(h*ie),_=Math.ceil(_*ie),B=new Array(M=Math.ceil(h-_+1));++A<M;)B[A]=(h-A)/ie;return y&&B.reverse(),B};function n(h,_,x){var y=(_-h)/Math.max(0,x),A=Math.floor(Math.log(y)/Math.LN10),M=y/Math.pow(10,A);return A>=0?(M>=ic?10:M>=oc?5:M>=s?2:1)*Math.pow(10,A):-Math.pow(10,-A)/(M>=ic?10:M>=oc?5:M>=s?2:1)}function l(h,_,x){var y=Math.abs(_-h)/Math.max(0,x),A=Math.pow(10,Math.floor(Math.log(y)/Math.LN10)),M=y/A;return M>=ic?A*=10:M>=oc?A*=5:M>=s&&(A*=2),_<h?-A:A}var g=function(h){return Math.ceil(Math.log(h.length)/Math.LN2)+1},w=function(){var h=of,_=Cl,x=g;function y(A){var M,B=A.length,ie,de=new Array(B);for(M=0;M<B;++M)de[M]=h(A[M],M,A);var Be=_(de),zt=Be[0],qt=Be[1],Or=x(de,zt,qt);Array.isArray(Or)||(Or=l(zt,qt,Or),Or=ac(Math.ceil(zt/Or)*Or,qt,Or));for(var Nr=Or.length;Or[0]<=zt;)Or.shift(),--Nr;for(;Or[Nr-1]>qt;)Or.pop(),--Nr;var bn=new Array(Nr+1),gn;for(M=0;M<=Nr;++M)gn=bn[M]=[],gn.x0=M>0?Or[M-1]:zt,gn.x1=M<Nr?Or[M]:qt;for(M=0;M<B;++M)ie=de[M],zt<=ie&&ie<=qt&&bn[Vs(Or,ie,0,Nr)].push(A[M]);return bn}return y.value=function(A){return arguments.length?(h=typeof A=="function"?A:Ps(A),y):h},y.domain=function(A){return arguments.length?(_=typeof A=="function"?A:Ps([A[0],A[1]]),y):_},y.thresholds=function(A){return arguments.length?(x=typeof A=="function"?A:Array.isArray(A)?Ps(nc.call(A)):Ps(A),y):x},y},L=function(h,_,x){if(x==null&&(x=ls),!(y=h.length))return;if((_=+_)<=0||y<2)return+x(h[0],0,h);if(_>=1)return+x(h[y-1],y-1,h);var y,A=(y-1)*_,M=Math.floor(A),B=+x(h[M],M,h),ie=+x(h[M+1],M+1,h);return B+(ie-B)*(A-M)},z=function(h,_,x){return h=Wu.call(h,ls).sort(fl),Math.ceil((x-_)/(2*(L(h,.75)-L(h,.25))*Math.pow(h.length,-1/3)))},ue=function(h,_,x){return Math.ceil((x-_)/(3.5*Vc(h)*Math.pow(h.length,-1/3)))},Ee=function(h,_){var x=h.length,y=-1,A,M;if(_==null){for(;++y<x;)if((A=h[y])!=null&&A>=A)for(M=A;++y<x;)(A=h[y])!=null&&A>M&&(M=A)}else for(;++y<x;)if((A=_(h[y],y,h))!=null&&A>=A)for(M=A;++y<x;)(A=_(h[y],y,h))!=null&&A>M&&(M=A);return M},Ke=function(h,_){var x=h.length,y=x,A=-1,M,B=0;if(_==null)for(;++A<x;)isNaN(M=ls(h[A]))?--y:B+=M;else for(;++A<x;)isNaN(M=ls(_(h[A],A,h)))?--y:B+=M;if(y)return B/y},tt=function(h,_){var x=h.length,y=-1,A,M=[];if(_==null)for(;++y<x;)isNaN(A=ls(h[y]))||M.push(A);else for(;++y<x;)isNaN(A=ls(_(h[y],y,h)))||M.push(A);return L(M.sort(fl),.5)},rt=function(h){for(var _=h.length,x,y=-1,A=0,M,B;++y<_;)A+=h[y].length;for(M=new Array(A);--_>=0;)for(B=h[_],x=B.length;--x>=0;)M[--A]=B[x];return M},Ft=function(h,_){var x=h.length,y=-1,A,M;if(_==null){for(;++y<x;)if((A=h[y])!=null&&A>=A)for(M=A;++y<x;)(A=h[y])!=null&&M>A&&(M=A)}else for(;++y<x;)if((A=_(h[y],y,h))!=null&&A>=A)for(M=A;++y<x;)(A=_(h[y],y,h))!=null&&M>A&&(M=A);return M},Nt=function(h,_){for(var x=_.length,y=new Array(x);x--;)y[x]=h[_[x]];return y},Kt=function(h,_){if(!(x=h.length))return;var x,y=0,A=0,M,B=h[A];for(_==null&&(_=fl);++y<x;)(_(M=h[y],B)<0||_(B,B)!==0)&&(B=M,A=y);if(_(B,B)===0)return A},jt=function(h,_,x){for(var y=(x==null?h.length:x)-(_=_==null?0:+_),A,M;y;)M=Math.random()*y--|0,A=h[y+_],h[y+_]=h[M+_],h[M+_]=A;return h},Gt=function(h,_){var x=h.length,y=-1,A,M=0;if(_==null)for(;++y<x;)(A=+h[y])&&(M+=A);else for(;++y<x;)(A=+_(h[y],y,h))&&(M+=A);return M},nr=function(h){if(!(M=h.length))return[];for(var _=-1,x=Ft(h,rr),y=new Array(x);++_<x;)for(var A=-1,M,B=y[_]=new Array(M);++A<M;)B[A]=h[A][_];return y};function rr(h){return h.length}var Lr=function(){return nr(arguments)};function vr(h,_){switch(arguments.length){case 0:break;case 1:this.range(h);break;default:this.range(_).domain(h);break}return this}function Sr(h,_){switch(arguments.length){case 0:break;case 1:this.interpolator(h);break;default:this.interpolator(_).domain(h);break}return this}var Ar="$";function rn(){}rn.prototype=Xr.prototype={constructor:rn,has:function(_){return Ar+_ in this},get:function(_){return this[Ar+_]},set:function(_,x){return this[Ar+_]=x,this},remove:function(_){var x=Ar+_;return x in this&&delete this[x]},clear:function(){for(var _ in this)_[0]===Ar&&delete this[_]},keys:function(){var _=[];for(var x in this)x[0]===Ar&&_.push(x.slice(1));return _},values:function(){var _=[];for(var x in this)x[0]===Ar&&_.push(this[x]);return _},entries:function(){var _=[];for(var x in this)x[0]===Ar&&_.push({key:x.slice(1),value:this[x]});return _},size:function(){var _=0;for(var x in this)x[0]===Ar&&++_;return _},empty:function(){for(var _ in this)if(_[0]===Ar)return!1;return!0},each:function(_){for(var x in this)x[0]===Ar&&_(this[x],x.slice(1),this)}};function Xr(h,_){var x=new rn;if(h instanceof rn)h.each(function(ie,de){x.set(de,ie)});else if(Array.isArray(h)){var y=-1,A=h.length,M;if(_==null)for(;++y<A;)x.set(y,h[y]);else for(;++y<A;)x.set(_(M=h[y],y,h),M)}else if(h)for(var B in h)x.set(B,h[B]);return x}var mn=Xr,Ln=function(){var h=[],_=[],x,y,A;function M(ie,de,Be,zt){if(de>=h.length)return x!=null&&ie.sort(x),y!=null?y(ie):ie;for(var qt=-1,Or=ie.length,Nr=h[de++],bn,gn,Fn=mn(),Ta,Ca=Be();++qt<Or;)(Ta=Fn.get(bn=Nr(gn=ie[qt])+""))?Ta.push(gn):Fn.set(bn,[gn]);return Fn.each(function(Li,ai){zt(Ca,ai,M(Li,de,Be,zt))}),Ca}function B(ie,de){if(++de>h.length)return ie;var Be,zt=_[de-1];return y!=null&&de>=h.length?Be=ie.entries():(Be=[],ie.each(function(qt,Or){Be.push({key:Or,values:B(qt,de)})})),zt!=null?Be.sort(function(qt,Or){return zt(qt.key,Or.key)}):Be}return A={object:function(de){return M(de,0,qn,sa)},map:function(de){return M(de,0,Sa,Za)},entries:function(de){return B(M(de,0,Sa,Za),0)},key:function(de){return h.push(de),A},sortKeys:function(de){return _[h.length-1]=de,A},sortValues:function(de){return x=de,A},rollup:function(de){return y=de,A}}};function qn(){return{}}function sa(h,_,x){h[_]=x}function Sa(){return mn()}function Za(h,_,x){h.set(_,x)}function Sn(){}var ua=mn.prototype;Sn.prototype=ba.prototype={constructor:Sn,has:ua.has,add:function(_){return _+="",this[Ar+_]=_,this},remove:ua.remove,clear:ua.clear,values:ua.keys,size:ua.size,empty:ua.empty,each:ua.each};function ba(h,_){var x=new Sn;if(h instanceof Sn)h.each(function(M){x.add(M)});else if(h){var y=-1,A=h.length;if(_==null)for(;++y<A;)x.add(h[y]);else for(;++y<A;)x.add(_(h[y],y,h))}return x}var Zn=ba,Aa=function(h){var _=[];for(var x in h)_.push(x);return _},na=function(h){var _=[];for(var x in h)_.push(h[x]);return _},La=function(h){var _=[];for(var x in h)_.push({key:x,value:h[x]});return _},za=Array.prototype,Gi=za.map,_i=za.slice,Di={name:"implicit"};function gi(){var h=mn(),_=[],x=[],y=Di;function A(M){var B=M+"",ie=h.get(B);if(!ie){if(y!==Di)return y;h.set(B,ie=_.push(M))}return x[(ie-1)%x.length]}return A.domain=function(M){if(!arguments.length)return _.slice();_=[],h=mn();for(var B=-1,ie=M.length,de,Be;++B<ie;)h.has(Be=(de=M[B])+"")||h.set(Be,_.push(de));return A},A.range=function(M){return arguments.length?(x=_i.call(M),A):x.slice()},A.unknown=function(M){return arguments.length?(y=M,A):y},A.copy=function(){return gi(_,x).unknown(y)},vr.apply(A,arguments),A}function Ui(){var h=gi().unknown(void 0),_=h.domain,x=h.range,y=[0,1],A,M,B=!1,ie=0,de=0,Be=.5;delete h.unknown;function zt(){var qt=_().length,Or=y[1]<y[0],Nr=y[Or-0],bn=y[1-Or];A=(bn-Nr)/Math.max(1,qt-ie+de*2),B&&(A=Math.floor(A)),Nr+=(bn-Nr-A*(qt-ie))*Be,M=A*(1-ie),B&&(Nr=Math.round(Nr),M=Math.round(M));var gn=ac(qt).map(function(Fn){return Nr+A*Fn});return x(Or?gn.reverse():gn)}return h.domain=function(qt){return arguments.length?(_(qt),zt()):_()},h.range=function(qt){return arguments.length?(y=[+qt[0],+qt[1]],zt()):y.slice()},h.rangeRound=function(qt){return y=[+qt[0],+qt[1]],B=!0,zt()},h.bandwidth=function(){return M},h.step=function(){return A},h.round=function(qt){return arguments.length?(B=!!qt,zt()):B},h.padding=function(qt){return arguments.length?(ie=Math.min(1,de=+qt),zt()):ie},h.paddingInner=function(qt){return arguments.length?(ie=Math.min(1,qt),zt()):ie},h.paddingOuter=function(qt){return arguments.length?(de=+qt,zt()):de},h.align=function(qt){return arguments.length?(Be=Math.max(0,Math.min(1,qt)),zt()):Be},h.copy=function(){return Ui(_(),y).round(B).paddingInner(ie).paddingOuter(de).align(Be)},vr.apply(zt(),arguments)}function Qo(h){var _=h.copy;return h.padding=h.paddingOuter,delete h.paddingInner,delete h.paddingOuter,h.copy=function(){return Qo(_())},h}function qo(){return Qo(Ui.apply(null,arguments).paddingInner(1))}var vu=o("FmoU");function Mu(h,_,x,y,A){var M=h*h,B=M*h;return((1-3*h+3*M-B)*_+(4-6*M+3*B)*x+(1+3*h+3*M-3*B)*y+B*A)/6}var cs=function(h){var _=h.length-1;return function(x){var y=x<=0?x=0:x>=1?(x=1,_-1):Math.floor(x*_),A=h[y],M=h[y+1],B=y>0?h[y-1]:2*A-M,ie=y<_-1?h[y+2]:2*M-A;return Mu((x-y/_)*_,B,A,M,ie)}},Gs=function(h){var _=h.length;return function(x){var y=Math.floor(((x%=1)<0?++x:x)*_),A=h[(y+_-1)%_],M=h[y%_],B=h[(y+1)%_],ie=h[(y+2)%_];return Mu((x-y/_)*_,A,M,B,ie)}},Pu=function(h){return function(){return h}};function sc(h,_){return function(x){return h+x*_}}function tu(h,_,x){return h=Math.pow(h,x),_=Math.pow(_,x)-h,x=1/x,function(y){return Math.pow(h+y*_,x)}}function Xu(h,_){var x=_-h;return x?sc(h,x>180||x<-180?x-360*Math.round(x/360):x):Pu(isNaN(h)?_:h)}function uc(h){return(h=+h)===1?ru:function(_,x){return x-_?tu(_,x,h):Pu(isNaN(_)?x:_)}}function ru(h,_){var x=_-h;return x?sc(h,x):Pu(isNaN(h)?_:h)}var Lu=function h(_){var x=uc(_);function y(A,M){var B=x((A=Object(vu.b)(A)).r,(M=Object(vu.b)(M)).r),ie=x(A.g,M.g),de=x(A.b,M.b),Be=ru(A.opacity,M.opacity);return function(zt){return A.r=B(zt),A.g=ie(zt),A.b=de(zt),A.opacity=Be(zt),A+""}}return y.gamma=h,y}(1);function fs(h){return function(_){var x=_.length,y=new Array(x),A=new Array(x),M=new Array(x),B,ie;for(B=0;B<x;++B)ie=Object(vu.b)(_[B]),y[B]=ie.r||0,A[B]=ie.g||0,M[B]=ie.b||0;return y=h(y),A=h(A),M=h(M),ie.opacity=1,function(de){return ie.r=y(de),ie.g=A(de),ie.b=M(de),ie+""}}}var ao=fs(cs),Yu=fs(Gs),Gl=function(h,_){_||(_=[]);var x=h?Math.min(_.length,h.length):0,y=_.slice(),A;return function(M){for(A=0;A<x;++A)y[A]=h[A]*(1-M)+_[A]*M;return y}};function hs(h){return ArrayBuffer.isView(h)&&!(h instanceof DataView)}var Do=function(h,_){return(hs(_)?Gl:No)(h,_)};function No(h,_){var x=_?_.length:0,y=h?Math.min(x,h.length):0,A=new Array(y),M=new Array(x),B;for(B=0;B<y;++B)A[B]=lc(h[B],_[B]);for(;B<x;++B)M[B]=_[B];return function(ie){for(B=0;B<y;++B)M[B]=A[B](ie);return M}}var Ho=function(h,_){var x=new Date;return h=+h,_=+_,function(y){return x.setTime(h*(1-y)+_*y),x}},_o=function(h,_){return h=+h,_=+_,function(x){return h*(1-x)+_*x}},uo=function(h,_){var x={},y={},A;(h===null||typeof h!="object")&&(h={}),(_===null||typeof _!="object")&&(_={});for(A in _)A in h?x[A]=lc(h[A],_[A]):y[A]=_[A];return function(M){for(A in x)y[A]=x[A](M);return y}},Ls=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,nu=new RegExp(Ls.source,"g");function Hl(h){return function(){return h}}function Gc(h){return function(_){return h(_)+""}}var dl=function(h,_){var x=Ls.lastIndex=nu.lastIndex=0,y,A,M,B=-1,ie=[],de=[];for(h=h+"",_=_+"";(y=Ls.exec(h))&&(A=nu.exec(_));)(M=A.index)>x&&(M=_.slice(x,M),ie[B]?ie[B]+=M:ie[++B]=M),(y=y[0])===(A=A[0])?ie[B]?ie[B]+=A:ie[++B]=A:(ie[++B]=null,de.push({i:B,x:_o(y,A)})),x=nu.lastIndex;return x<_.length&&(M=_.slice(x),ie[B]?ie[B]+=M:ie[++B]=M),ie.length<2?de[0]?Gc(de[0].x):Hl(_):(_=de.length,function(Be){for(var zt=0,qt;zt<_;++zt)ie[(qt=de[zt]).i]=qt.x(Be);return ie.join("")})},lc=function(h,_){var x=typeof _,y;return _==null||x==="boolean"?Pu(_):(x==="number"?_o:x==="string"?(y=Object(vu.a)(_))?(_=y,Lu):dl:_ instanceof vu.a?Lu:_ instanceof Date?Ho:hs(_)?Gl:Array.isArray(_)?No:typeof _.valueOf!="function"&&typeof _.toString!="function"||isNaN(_)?uo:_o)(h,_)},pl=function(h,_){return h=+h,_=+_,function(x){return Math.round(h*(1-x)+_*x)}},Rs=function(h){return function(){return h}},go=function(h){return+h},Ac=[0,1];function ds(h){return h}function sf(h,_){return(_-=h=+h)?function(x){return(x-h)/_}:Rs(isNaN(_)?NaN:.5)}function Cf(h){var _=h[0],x=h[h.length-1],y;return _>x&&(y=_,_=x,x=y),function(A){return Math.max(_,Math.min(x,A))}}function wf(h,_,x){var y=h[0],A=h[1],M=_[0],B=_[1];return A<y?(y=sf(A,y),M=x(B,M)):(y=sf(y,A),M=x(M,B)),function(ie){return M(y(ie))}}function Cc(h,_,x){var y=Math.min(h.length,_.length)-1,A=new Array(y),M=new Array(y),B=-1;for(h[y]<h[0]&&(h=h.slice().reverse(),_=_.slice().reverse());++B<y;)A[B]=sf(h[B],h[B+1]),M[B]=x(_[B],_[B+1]);return function(ie){var de=Vs(h,ie,1,y)-1;return M[de](A[de](ie))}}function Ku(h,_){return _.domain(h.domain()).range(h.range()).interpolate(h.interpolate()).clamp(h.clamp()).unknown(h.unknown())}function Ef(){var h=Ac,_=Ac,x=lc,y,A,M,B=ds,ie,de,Be;function zt(){return ie=Math.min(h.length,_.length)>2?Cc:wf,de=Be=null,qt}function qt(Or){return isNaN(Or=+Or)?M:(de||(de=ie(h.map(y),_,x)))(y(B(Or)))}return qt.invert=function(Or){return B(A((Be||(Be=ie(_,h.map(y),_o)))(Or)))},qt.domain=function(Or){return arguments.length?(h=Gi.call(Or,go),B===ds||(B=Cf(h)),zt()):h.slice()},qt.range=function(Or){return arguments.length?(_=_i.call(Or),zt()):_.slice()},qt.rangeRound=function(Or){return _=_i.call(Or),x=pl,zt()},qt.clamp=function(Or){return arguments.length?(B=Or?Cf(h):ds,qt):B!==ds},qt.interpolate=function(Or){return arguments.length?(x=Or,zt()):x},qt.unknown=function(Or){return arguments.length?(M=Or,qt):M},function(Or,Nr){return y=Or,A=Nr,zt()}}function uf(h,_){return Ef()(h,_)}var Of=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ru(h){if(!(_=Of.exec(h)))throw new Error("invalid format: "+h);var _;return new cc({fill:_[1],align:_[2],sign:_[3],symbol:_[4],zero:_[5],width:_[6],comma:_[7],precision:_[8]&&_[8].slice(1),trim:_[9],type:_[10]})}Ru.prototype=cc.prototype;function cc(h){this.fill=h.fill===void 0?" ":h.fill+"",this.align=h.align===void 0?">":h.align+"",this.sign=h.sign===void 0?"-":h.sign+"",this.symbol=h.symbol===void 0?"":h.symbol+"",this.zero=!!h.zero,this.width=h.width===void 0?void 0:+h.width,this.comma=!!h.comma,this.precision=h.precision===void 0?void 0:+h.precision,this.trim=!!h.trim,this.type=h.type===void 0?"":h.type+""}cc.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};var Df=function(h){return Math.abs(h=Math.round(h))>=1e21?h.toLocaleString("en").replace(/,/g,""):h.toString(10)};function Hc(h,_){if((x=(h=_?h.toExponential(_-1):h.toExponential()).indexOf("e"))<0)return null;var x,y=h.slice(0,x);return[y.length>1?y[0]+y.slice(2):y,+h.slice(x+1)]}var wc=function(h){return h=Hc(Math.abs(h)),h?h[1]:NaN},Qf=function(h,_){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(wc(_)/3)))*3-wc(Math.abs(h)))},qf=function(h,_){return function(x,y){for(var A=x.length,M=[],B=0,ie=h[0],de=0;A>0&&ie>0&&!(de+ie+1>y&&(ie=Math.max(1,y-de)),M.push(x.substring(A-=ie,A+ie)),(de+=ie+1)>y);)ie=h[B=(B+1)%h.length];return M.reverse().join(_)}},eh=function(h){return function(_){return _.replace(/[0-9]/g,function(x){return h[+x]})}},th=function(h){e:for(var _=h.length,x=1,y=-1,A;x<_;++x)switch(h[x]){case".":y=A=x;break;case"0":y===0&&(y=x),A=x;break;default:if(!+h[x])break e;y>0&&(y=0);break}return y>0?h.slice(0,y)+h.slice(A+1):h},Mf,rh=function(h,_){var x=Hc(h,_);if(!x)return h+"";var y=x[0],A=x[1],M=A-(Mf=Math.max(-8,Math.min(8,Math.floor(A/3)))*3)+1,B=y.length;return M===B?y:M>B?y+new Array(M-B+1).join("0"):M>0?y.slice(0,M)+"."+y.slice(M):"0."+new Array(1-M).join("0")+Hc(h,Math.max(0,_+M-1))[0]},Zl=function(h,_){var x=Hc(h,_);if(!x)return h+"";var y=x[0],A=x[1];return A<0?"0."+new Array(-A).join("0")+y:y.length>A+1?y.slice(0,A+1)+"."+y.slice(A+1):y+new Array(A-y.length+2).join("0")},lf={"%":function(_,x){return(_*100).toFixed(x)},b:function(_){return Math.round(_).toString(2)},c:function(_){return _+""},d:Df,e:function(_,x){return _.toExponential(x)},f:function(_,x){return _.toFixed(x)},g:function(_,x){return _.toPrecision(x)},o:function(_){return Math.round(_).toString(8)},p:function(_,x){return Zl(_*100,x)},r:Zl,s:rh,X:function(_){return Math.round(_).toString(16).toUpperCase()},x:function(_){return Math.round(_).toString(16)}},io=function(h){return h},fc=Array.prototype.map,Tf=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"],Oc=function(h){var _=h.grouping===void 0||h.thousands===void 0?io:qf(fc.call(h.grouping,Number),h.thousands+""),x=h.currency===void 0?"":h.currency[0]+"",y=h.currency===void 0?"":h.currency[1]+"",A=h.decimal===void 0?".":h.decimal+"",M=h.numerals===void 0?io:eh(fc.call(h.numerals,String)),B=h.percent===void 0?"%":h.percent+"",ie=h.minus===void 0?"-":h.minus+"",de=h.nan===void 0?"NaN":h.nan+"";function Be(qt){qt=Ru(qt);var Or=qt.fill,Nr=qt.align,bn=qt.sign,gn=qt.symbol,Fn=qt.zero,Ta=qt.width,Ca=qt.comma,Li=qt.precision,ai=qt.trim,ii=qt.type;ii==="n"?(Ca=!0,ii="g"):lf[ii]||(Li===void 0&&(Li=12),ai=!0,ii="g"),(Fn||Or==="0"&&Nr==="=")&&(Fn=!0,Or="0",Nr="=");var Qi=gn==="$"?x:gn==="#"&&/[boxX]/.test(ii)?"0"+ii.toLowerCase():"",wa=gn==="$"?y:/[%p]/.test(ii)?B:"",qi=lf[ii],xo=/[defgprs%]/.test(ii);Li=Li===void 0?6:/[gprs]/.test(ii)?Math.max(1,Math.min(21,Li)):Math.max(0,Math.min(20,Li));function Xs(Wa){var As=Qi,Yo=wa,df,Ih,Pc;if(ii==="c")Yo=qi(Wa)+Yo,Wa="";else{Wa=+Wa;var xh=Wa<0||1/Wa<0;if(Wa=isNaN(Wa)?de:qi(Math.abs(Wa),Li),ai&&(Wa=th(Wa)),xh&&+Wa===0&&bn!=="+"&&(xh=!1),As=(xh?bn==="("?bn:ie:bn==="-"||bn==="("?"":bn)+As,Yo=(ii==="s"?Tf[8+Mf/3]:"")+Yo+(xh&&bn==="("?")":""),xo){for(df=-1,Ih=Wa.length;++df<Ih;)if(Pc=Wa.charCodeAt(df),48>Pc||Pc>57){Yo=(Pc===46?A+Wa.slice(df+1):Wa.slice(df))+Yo,Wa=Wa.slice(0,df);break}}}Ca&&!Fn&&(Wa=_(Wa,Infinity));var oh=As.length+Wa.length+Yo.length,Kc=oh<Ta?new Array(Ta-oh+1).join(Or):"";Ca&&Fn&&(Wa=_(Kc+Wa,Kc.length?Ta-Yo.length:Infinity),Kc="");switch(Nr){case"<":Wa=As+Wa+Yo+Kc;break;case"=":Wa=As+Kc+Wa+Yo;break;case"^":Wa=Kc.slice(0,oh=Kc.length>>1)+As+Wa+Yo+Kc.slice(oh);break;default:Wa=Kc+As+Wa+Yo;break}return M(Wa)}return Xs.toString=function(){return qt+""},Xs}function zt(qt,Or){var Nr=Be((qt=Ru(qt),qt.type="f",qt)),bn=Math.max(-8,Math.min(8,Math.floor(wc(Or)/3)))*3,gn=Math.pow(10,-bn),Fn=Tf[8+bn/3];return function(Ta){return Nr(gn*Ta)+Fn}}return{format:Be,formatPrefix:zt}},au,wl,_f;Nf({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function Nf(h){return au=Oc(h),wl=au.format,_f=au.formatPrefix,au}var Zc=function(h,_){return h=Math.abs(h),_=Math.abs(_)-h,Math.max(0,wc(_)-wc(h))+1},cf=function(h){return Math.max(0,-wc(Math.abs(h)))},Wc=function(h,_,x,y){var A=l(h,_,x),M;y=Ru(y==null?",f":y);switch(y.type){case"s":{var B=Math.max(Math.abs(h),Math.abs(_));return y.precision==null&&!isNaN(M=Qf(A,B))&&(y.precision=M),_f(y,B)}case"":case"e":case"g":case"p":case"r":{y.precision==null&&!isNaN(M=Zc(A,Math.max(Math.abs(h),Math.abs(_))))&&(y.precision=M-(y.type==="e"));break}case"f":case"%":{y.precision==null&&!isNaN(M=cf(A))&&(y.precision=M-(y.type==="%")*2);break}}return wl(y)};function ml(h){var _=h.domain;return h.ticks=function(x){var y=_();return a(y[0],y[y.length-1],x==null?10:x)},h.tickFormat=function(x,y){var A=_();return Wc(A[0],A[A.length-1],x==null?10:x,y)},h.nice=function(x){x==null&&(x=10);var y=_(),A=0,M=y.length-1,B=y[A],ie=y[M],de;return ie<B&&(de=B,B=ie,ie=de,de=A,A=M,M=de),de=n(B,ie,x),de>0?(B=Math.floor(B/de)*de,ie=Math.ceil(ie/de)*de,de=n(B,ie,x)):de<0&&(B=Math.ceil(B*de)/de,ie=Math.floor(ie*de)/de,de=n(B,ie,x)),de>0?(y[A]=Math.floor(B/de)*de,y[M]=Math.ceil(ie/de)*de,_(y)):de<0&&(y[A]=Math.ceil(B*de)/de,y[M]=Math.floor(ie*de)/de,_(y)),h},h}function re(){var h=uf(ds,ds);return h.copy=function(){return Ku(h,re())},vr.apply(h,arguments),ml(h)}function se(h){var _;function x(y){return isNaN(y=+y)?_:y}return x.invert=x,x.domain=x.range=function(y){return arguments.length?(h=Gi.call(y,go),x):h.slice()},x.unknown=function(y){return arguments.length?(_=y,x):_},x.copy=function(){return se(h).unknown(_)},h=arguments.length?Gi.call(h,go):[0,1],ml(x)}var N=function(h,_){h=h.slice();var x=0,y=h.length-1,A=h[x],M=h[y],B;return M<A&&(B=x,x=y,y=B,B=A,A=M,M=B),h[x]=_.floor(A),h[y]=_.ceil(M),h};function G(h){return Math.log(h)}function Ae(h){return Math.exp(h)}function ct(h){return-Math.log(-h)}function Xt(h){return-Math.exp(-h)}function sr(h){return isFinite(h)?+("1e"+h):h<0?0:h}function or(h){return h===10?sr:h===Math.E?Math.exp:function(_){return Math.pow(h,_)}}function Ir(h){return h===Math.E?Math.log:h===10&&Math.log10||h===2&&Math.log2||(h=Math.log(h),function(_){return Math.log(_)/h})}function an(h){return function(_){return-h(-_)}}function Gn(h){var _=h(G,Ae),x=_.domain,y=10,A,M;function B(){return A=Ir(y),M=or(y),x()[0]<0?(A=an(A),M=an(M),h(ct,Xt)):h(G,Ae),_}return _.base=function(ie){return arguments.length?(y=+ie,B()):y},_.domain=function(ie){return arguments.length?(x(ie),B()):x()},_.ticks=function(ie){var de=x(),Be=de[0],zt=de[de.length-1],qt;(qt=zt<Be)&&(Or=Be,Be=zt,zt=Or);var Or=A(Be),Nr=A(zt),bn,gn,Fn,Ta=ie==null?10:+ie,Ca=[];if(!(y%1)&&Nr-Or<Ta)if(Or=Math.round(Or)-1,Nr=Math.round(Nr)+1,Be>0)for(;Or<Nr;++Or)for(gn=1,bn=M(Or);gn<y;++gn){if(Fn=bn*gn,Fn<Be)continue;if(Fn>zt)break;Ca.push(Fn)}else for(;Or<Nr;++Or)for(gn=y-1,bn=M(Or);gn>=1;--gn){if(Fn=bn*gn,Fn<Be)continue;if(Fn>zt)break;Ca.push(Fn)}else Ca=a(Or,Nr,Math.min(Nr-Or,Ta)).map(M);return qt?Ca.reverse():Ca},_.tickFormat=function(ie,de){if(de==null&&(de=y===10?".0e":","),typeof de!="function"&&(de=wl(de)),ie===Infinity)return de;ie==null&&(ie=10);var Be=Math.max(1,y*ie/_.ticks().length);return function(zt){var qt=zt/M(Math.round(A(zt)));return qt*y<y-.5&&(qt*=y),qt<=Be?de(zt):""}},_.nice=function(){return x(N(x(),{floor:function(de){return M(Math.floor(A(de)))},ceil:function(de){return M(Math.ceil(A(de)))}}))},_}function ea(){var h=Gn(Ef()).domain([1,10]);return h.copy=function(){return Ku(h,ea()).base(h.base())},vr.apply(h,arguments),h}function la(h){return function(_){return Math.sign(_)*Math.log1p(Math.abs(_/h))}}function qa(h){return function(_){return Math.sign(_)*Math.expm1(Math.abs(_))*h}}function Fa(h){var _=1,x=h(la(_),qa(_));return x.constant=function(y){return arguments.length?h(la(_=+y),qa(_)):_},ml(x)}function yi(){var h=Fa(Ef());return h.copy=function(){return Ku(h,yi()).constant(h.constant())},vr.apply(h,arguments)}function Ja(h){return function(_){return _<0?-Math.pow(-_,h):Math.pow(_,h)}}function Bi(h){return h<0?-Math.sqrt(-h):Math.sqrt(h)}function So(h){return h<0?-h*h:h*h}function yo(h){var _=h(ds,ds),x=1;function y(){return x===1?h(ds,ds):x===.5?h(Bi,So):h(Ja(x),Ja(1/x))}return _.exponent=function(A){return arguments.length?(x=+A,y()):x},ml(_)}function Hi(){var h=yo(Ef());return h.copy=function(){return Ku(h,Hi()).exponent(h.exponent())},vr.apply(h,arguments),h}function ko(){return Hi.apply(null,arguments).exponent(.5)}function Qa(){var h=[],_=[],x=[],y;function A(){var B=0,ie=Math.max(1,_.length);for(x=new Array(ie-1);++B<ie;)x[B-1]=L(h,B/ie);return M}function M(B){return isNaN(B=+B)?y:_[Vs(x,B)]}return M.invertExtent=function(B){var ie=_.indexOf(B);return ie<0?[NaN,NaN]:[ie>0?x[ie-1]:h[0],ie<x.length?x[ie]:h[h.length-1]]},M.domain=function(B){if(!arguments.length)return h.slice();h=[];for(var ie=0,de=B.length,Be;ie<de;++ie)(Be=B[ie],Be!=null&&!isNaN(Be=+Be))&&h.push(Be);return h.sort(fl),A()},M.range=function(B){return arguments.length?(_=_i.call(B),A()):_.slice()},M.unknown=function(B){return arguments.length?(y=B,M):y},M.quantiles=function(){return x.slice()},M.copy=function(){return Qa().domain(h).range(_).unknown(y)},vr.apply(M,arguments)}function lo(){var h=0,_=1,x=1,y=[.5],A=[0,1],M;function B(de){return de<=de?A[Vs(y,de,0,x)]:M}function ie(){var de=-1;for(y=new Array(x);++de<x;)y[de]=((de+1)*_-(de-x)*h)/(x+1);return B}return B.domain=function(de){return arguments.length?(h=+de[0],_=+de[1],ie()):[h,_]},B.range=function(de){return arguments.length?(x=(A=_i.call(de)).length-1,ie()):A.slice()},B.invertExtent=function(de){var Be=A.indexOf(de);return Be<0?[NaN,NaN]:Be<1?[h,y[0]]:Be>=x?[y[x-1],_]:[y[Be-1],y[Be]]},B.unknown=function(de){return arguments.length&&(M=de),B},B.thresholds=function(){return y.slice()},B.copy=function(){return lo().domain([h,_]).range(A).unknown(M)},vr.apply(ml(B),arguments)}function iu(){var h=[.5],_=[0,1],x,y=1;function A(M){return M<=M?_[Vs(h,M,0,y)]:x}return A.domain=function(M){return arguments.length?(h=_i.call(M),y=Math.min(h.length,_.length-1),A):h.slice()},A.range=function(M){return arguments.length?(_=_i.call(M),y=Math.min(h.length,_.length-1),A):_.slice()},A.invertExtent=function(M){var B=_.indexOf(M);return[h[B-1],h[B]]},A.unknown=function(M){return arguments.length?(x=M,A):x},A.copy=function(){return iu().domain(h).range(_).unknown(x)},vr.apply(A,arguments)}var bi=new Date,Ni=new Date;function xa(h,_,x,y){function A(M){return h(M=arguments.length===0?new Date:new Date(+M)),M}return A.floor=function(M){return h(M=new Date(+M)),M},A.ceil=function(M){return h(M=new Date(M-1)),_(M,1),h(M),M},A.round=function(M){var B=A(M),ie=A.ceil(M);return M-B<ie-M?B:ie},A.offset=function(M,B){return _(M=new Date(+M),B==null?1:Math.floor(B)),M},A.range=function(M,B,ie){var de=[],Be;if(M=A.ceil(M),ie=ie==null?1:Math.floor(ie),!(M<B)||!(ie>0))return de;do de.push(Be=new Date(+M)),_(M,ie),h(M);while(Be<M&&M<B);return de},A.filter=function(M){return xa(function(B){if(B>=B)for(;h(B),!M(B);)B.setTime(B-1)},function(B,ie){if(B>=B)if(ie<0)for(;++ie<=0;)for(;_(B,-1),!M(B););else for(;--ie>=0;)for(;_(B,1),!M(B););})},x&&(A.count=function(M,B){return bi.setTime(+M),Ni.setTime(+B),h(bi),h(Ni),Math.floor(x(bi,Ni))},A.every=function(M){return M=Math.floor(M),!isFinite(M)||!(M>0)?null:M>1?A.filter(y?function(B){return y(B)%M===0}:function(B){return A.count(0,B)%M===0}):A}),A}var Ao=xa(function(h){h.setMonth(0,1),h.setHours(0,0,0,0)},function(h,_){h.setFullYear(h.getFullYear()+_)},function(h,_){return _.getFullYear()-h.getFullYear()},function(h){return h.getFullYear()});Ao.every=function(h){return!isFinite(h=Math.floor(h))||!(h>0)?null:xa(function(_){_.setFullYear(Math.floor(_.getFullYear()/h)*h),_.setMonth(0,1),_.setHours(0,0,0,0)},function(_,x){_.setFullYear(_.getFullYear()+x*h)})};var hc=Ao,kf=Ao.range,uh=xa(function(h){h.setDate(1),h.setHours(0,0,0,0)},function(h,_){h.setMonth(h.getMonth()+_)},function(h,_){return _.getMonth()-h.getMonth()+(_.getFullYear()-h.getFullYear())*12},function(h){return h.getMonth()}),jf=uh,Iu=uh.range,Ff=1e3,ff=6e4,zf=36e5,Th=864e5,lh=6048e5;function Sf(h){return xa(function(_){_.setDate(_.getDate()-(_.getDay()+7-h)%7),_.setHours(0,0,0,0)},function(_,x){_.setDate(_.getDate()+x*7)},function(_,x){return(x-_-(x.getTimezoneOffset()-_.getTimezoneOffset())*ff)/lh})}var Uf=Sf(0),Bf=Sf(1),ch=Sf(2),Vf=Sf(3),Pf=Sf(4),Wl=Sf(5),Dh=Sf(6),ye=Uf.range,je=Bf.range,Ot=ch.range,xr=Vf.range,Pr=Pf.range,Cr=Wl.range,Er=Dh.range,Zr=xa(function(h){h.setHours(0,0,0,0)},function(h,_){h.setDate(h.getDate()+_)},function(h,_){return(_-h-(_.getTimezoneOffset()-h.getTimezoneOffset())*ff)/Th},function(h){return h.getDate()-1}),on=Zr,en=Zr.range,Yr=xa(function(h){h.setTime(h-h.getMilliseconds()-h.getSeconds()*Ff-h.getMinutes()*ff)},function(h,_){h.setTime(+h+_*zf)},function(h,_){return(_-h)/zf},function(h){return h.getHours()}),cn=Yr,Tn=Yr.range,dn=xa(function(h){h.setTime(h-h.getMilliseconds()-h.getSeconds()*Ff)},function(h,_){h.setTime(+h+_*ff)},function(h,_){return(_-h)/ff},function(h){return h.getMinutes()}),nn=dn,Tr=dn.range,br=xa(function(h){h.setTime(h-h.getMilliseconds())},function(h,_){h.setTime(+h+_*Ff)},function(h,_){return(_-h)/Ff},function(h){return h.getUTCSeconds()}),Wr=br,wn=br.range,Rr=xa(function(){},function(h,_){h.setTime(+h+_)},function(h,_){return _-h});Rr.every=function(h){return h=Math.floor(h),!isFinite(h)||!(h>0)?null:h>1?xa(function(_){_.setTime(Math.floor(_/h)*h)},function(_,x){_.setTime(+_+x*h)},function(_,x){return(x-_)/h}):Rr};var ta=Rr,Jr=Rr.range;function Br(h){return xa(function(_){_.setUTCDate(_.getUTCDate()-(_.getUTCDay()+7-h)%7),_.setUTCHours(0,0,0,0)},function(_,x){_.setUTCDate(_.getUTCDate()+x*7)},function(_,x){return(x-_)/lh})}var Fr=Br(0),Kr=Br(1),Hn=Br(2),aa=Br(3),sn=Br(4),Gr=Br(5),jr=Br(6),ha=Fr.range,pa=Kr.range,Un=Hn.range,Ua=aa.range,Oa=sn.range,Da=Gr.range,fi=jr.range,jo=xa(function(h){h.setUTCHours(0,0,0,0)},function(h,_){h.setUTCDate(h.getUTCDate()+_)},function(h,_){return(_-h)/Th},function(h){return h.getUTCDate()-1}),ps=jo,ei=jo.range,co=xa(function(h){h.setUTCMonth(0,1),h.setUTCHours(0,0,0,0)},function(h,_){h.setUTCFullYear(h.getUTCFullYear()+_)},function(h,_){return _.getUTCFullYear()-h.getUTCFullYear()},function(h){return h.getUTCFullYear()});co.every=function(h){return!isFinite(h=Math.floor(h))||!(h>0)?null:xa(function(_){_.setUTCFullYear(Math.floor(_.getUTCFullYear()/h)*h),_.setUTCMonth(0,1),_.setUTCHours(0,0,0,0)},function(_,x){_.setUTCFullYear(_.getUTCFullYear()+x*h)})};var Mi=co,ms=co.range;function Zo(h){if(0<=h.y&&h.y<100){var _=new Date(-1,h.m,h.d,h.H,h.M,h.S,h.L);return _.setFullYear(h.y),_}return new Date(h.y,h.m,h.d,h.H,h.M,h.S,h.L)}function Wo(h){if(0<=h.y&&h.y<100){var _=new Date(Date.UTC(-1,h.m,h.d,h.H,h.M,h.S,h.L));return _.setUTCFullYear(h.y),_}return new Date(Date.UTC(h.y,h.m,h.d,h.H,h.M,h.S,h.L))}function es(h,_,x){return{y:h,m:_,d:x,H:0,M:0,S:0,L:0}}function Is(h){var _=h.dateTime,x=h.date,y=h.time,A=h.periods,M=h.days,B=h.shortDays,ie=h.months,de=h.shortMonths,Be=Ba(A),zt=Xo(A),qt=Ba(M),Or=Xo(M),Nr=Ba(B),bn=Xo(B),gn=Ba(ie),Fn=Xo(ie),Ta=Ba(de),Ca=Xo(de),Li={a:xh,A:oh,b:Kc,B:dd,c:null,d:ar,e:ar,f:Cn,g:Ns,G:dc,H:tr,I:pr,j:wr,L:$r,m:un,M:_n,p:sd,q:pd,Q:rd,s:ld,S:Kn,u:ka,U:Ei,V:Du,w:ou,W:Xl,x:null,X:null,y:Ds,Y:Yl,Z:yu,"%":td},ai={a:md,A:ud,b:vd,B:Vh,c:null,d:Mc,e:Mc,f:fh,g:Hh,G:_h,H:Co,I:_a,j:Ol,L:nh,m:Nh,M:pc,p:gd,q:Qh,Q:rd,s:ld,S:Gf,u:ah,U:hh,V:Zs,w:kh,W:Hf,x:null,X:null,y:Gh,Y:ed,Z:Zf,"%":td},ii={a:Xs,A:Wa,b:As,B:Yo,c:df,d:ae,e:ae,f:lt,g:j,G:T,H:Ie,I:Ie,j:$e,L:Ne,m:X,M:Oe,p:xo,q:k,Q:It,s:$t,S:ft,u:O,U:d,V:c,w:gu,W:p,x:Ih,X:Pc,y:j,Y:T,Z:I,"%":Ue};Li.x=Qi(x,Li),Li.X=Qi(y,Li),Li.c=Qi(_,Li),ai.x=Qi(x,ai),ai.X=Qi(y,ai),ai.c=Qi(_,ai);function Qi(ja,ji){return function(si){var Dn=[],Lc=-1,ys=0,$c=ja.length,Jc,Eh,yd;for(si instanceof Date||(si=new Date(+si));++Lc<$c;)ja.charCodeAt(Lc)===37&&(Dn.push(ja.slice(ys,Lc)),(Eh=Zi[Jc=ja.charAt(++Lc)])!=null?Jc=ja.charAt(++Lc):Eh=Jc==="e"?" ":"0",(yd=ji[Jc])&&(Jc=yd(si,Eh)),Dn.push(Jc),ys=Lc+1);return Dn.push(ja.slice(ys,Lc)),Dn.join("")}}function wa(ja,ji){return function(si){var Dn=es(1900,void 0,1),Lc=qi(Dn,ja,si+="",0),ys,$c;if(Lc!=si.length)return null;if("Q"in Dn)return new Date(Dn.Q);if("s"in Dn)return new Date(Dn.s*1e3+("L"in Dn?Dn.L:0));if(ji&&!("Z"in Dn)&&(Dn.Z=0),"p"in Dn&&(Dn.H=Dn.H%12+Dn.p*12),Dn.m===void 0&&(Dn.m="q"in Dn?Dn.q:0),"V"in Dn){if(Dn.V<1||Dn.V>53)return null;"w"in Dn||(Dn.w=1),"Z"in Dn?(ys=Wo(es(Dn.y,0,1)),$c=ys.getUTCDay(),ys=$c>4||$c===0?Kr.ceil(ys):Kr(ys),ys=ps.offset(ys,(Dn.V-1)*7),Dn.y=ys.getUTCFullYear(),Dn.m=ys.getUTCMonth(),Dn.d=ys.getUTCDate()+(Dn.w+6)%7):(ys=Zo(es(Dn.y,0,1)),$c=ys.getDay(),ys=$c>4||$c===0?Bf.ceil(ys):Bf(ys),ys=on.offset(ys,(Dn.V-1)*7),Dn.y=ys.getFullYear(),Dn.m=ys.getMonth(),Dn.d=ys.getDate()+(Dn.w+6)%7)}else("W"in Dn||"U"in Dn)&&("w"in Dn||(Dn.w="u"in Dn?Dn.u%7:"W"in Dn?1:0),$c="Z"in Dn?Wo(es(Dn.y,0,1)).getUTCDay():Zo(es(Dn.y,0,1)).getDay(),Dn.m=0,Dn.d="W"in Dn?(Dn.w+6)%7+Dn.W*7-($c+5)%7:Dn.w+Dn.U*7-($c+6)%7);return"Z"in Dn?(Dn.H+=Dn.Z/100|0,Dn.M+=Dn.Z%100,Wo(Dn)):Zo(Dn)}}function qi(ja,ji,si,Dn){for(var Lc=0,ys=ji.length,$c=si.length,Jc,Eh;Lc<ys;){if(Dn>=$c)return-1;if(Jc=ji.charCodeAt(Lc++),Jc===37){if(Jc=ji.charAt(Lc++),Eh=ii[Jc in Zi?ji.charAt(Lc++):Jc],!Eh||(Dn=Eh(ja,si,Dn))<0)return-1}else if(Jc!=si.charCodeAt(Dn++))return-1}return Dn}function xo(ja,ji,si){var Dn=Be.exec(ji.slice(si));return Dn?(ja.p=zt[Dn[0].toLowerCase()],si+Dn[0].length):-1}function Xs(ja,ji,si){var Dn=Nr.exec(ji.slice(si));return Dn?(ja.w=bn[Dn[0].toLowerCase()],si+Dn[0].length):-1}function Wa(ja,ji,si){var Dn=qt.exec(ji.slice(si));return Dn?(ja.w=Or[Dn[0].toLowerCase()],si+Dn[0].length):-1}function As(ja,ji,si){var Dn=Ta.exec(ji.slice(si));return Dn?(ja.m=Ca[Dn[0].toLowerCase()],si+Dn[0].length):-1}function Yo(ja,ji,si){var Dn=gn.exec(ji.slice(si));return Dn?(ja.m=Fn[Dn[0].toLowerCase()],si+Dn[0].length):-1}function df(ja,ji,si){return qi(ja,_,ji,si)}function Ih(ja,ji,si){return qi(ja,x,ji,si)}function Pc(ja,ji,si){return qi(ja,y,ji,si)}function xh(ja){return B[ja.getDay()]}function oh(ja){return M[ja.getDay()]}function Kc(ja){return de[ja.getMonth()]}function dd(ja){return ie[ja.getMonth()]}function sd(ja){return A[+(ja.getHours()>=12)]}function pd(ja){return 1+~~(ja.getMonth()/3)}function md(ja){return B[ja.getUTCDay()]}function ud(ja){return M[ja.getUTCDay()]}function vd(ja){return de[ja.getUTCMonth()]}function Vh(ja){return ie[ja.getUTCMonth()]}function gd(ja){return A[+(ja.getUTCHours()>=12)]}function Qh(ja){return 1+~~(ja.getUTCMonth()/3)}return{format:function(ji){var si=Qi(ji+="",Li);return si.toString=function(){return ji},si},parse:function(ji){var si=wa(ji+="",!1);return si.toString=function(){return ji},si},utcFormat:function(ji){var si=Qi(ji+="",ai);return si.toString=function(){return ji},si},utcParse:function(ji){var si=wa(ji+="",!0);return si.toString=function(){return ji},si}}}var Zi={"-":"",_:" ","0":"0"},ia=/^\s*\d+/,Hs=/^%/,xi=/[\\^$*+?|[\]().{}]/g;function An(h,_,x){var y=h<0?"-":"",A=(y?-h:h)+"",M=A.length;return y+(M<x?new Array(x-M+1).join(_)+A:A)}function Ra(h){return h.replace(xi,"\\$&")}function Ba(h){return new RegExp("^(?:"+h.map(Ra).join("|")+")","i")}function Xo(h){for(var _={},x=-1,y=h.length;++x<y;)_[h[x].toLowerCase()]=x;return _}function gu(h,_,x){var y=ia.exec(_.slice(x,x+1));return y?(h.w=+y[0],x+y[0].length):-1}function O(h,_,x){var y=ia.exec(_.slice(x,x+1));return y?(h.u=+y[0],x+y[0].length):-1}function d(h,_,x){var y=ia.exec(_.slice(x,x+2));return y?(h.U=+y[0],x+y[0].length):-1}function c(h,_,x){var y=ia.exec(_.slice(x,x+2));return y?(h.V=+y[0],x+y[0].length):-1}function p(h,_,x){var y=ia.exec(_.slice(x,x+2));return y?(h.W=+y[0],x+y[0].length):-1}function T(h,_,x){var y=ia.exec(_.slice(x,x+4));return y?(h.y=+y[0],x+y[0].length):-1}function j(h,_,x){var y=ia.exec(_.slice(x,x+2));return y?(h.y=+y[0]+(+y[0]>68?1900:2e3),x+y[0].length):-1}function I(h,_,x){var y=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(_.slice(x,x+6));return y?(h.Z=y[1]?0:-(y[2]+(y[3]||"00")),x+y[0].length):-1}function k(h,_,x){var y=ia.exec(_.slice(x,x+1));return y?(h.q=y[0]*3-3,x+y[0].length):-1}function X(h,_,x){var y=ia.exec(_.slice(x,x+2));return y?(h.m=y[0]-1,x+y[0].length):-1}function ae(h,_,x){var y=ia.exec(_.slice(x,x+2));return y?(h.d=+y[0],x+y[0].length):-1}function $e(h,_,x){var y=ia.exec(_.slice(x,x+3));return y?(h.m=0,h.d=+y[0],x+y[0].length):-1}function Ie(h,_,x){var y=ia.exec(_.slice(x,x+2));return y?(h.H=+y[0],x+y[0].length):-1}function Oe(h,_,x){var y=ia.exec(_.slice(x,x+2));return y?(h.M=+y[0],x+y[0].length):-1}function ft(h,_,x){var y=ia.exec(_.slice(x,x+2));return y?(h.S=+y[0],x+y[0].length):-1}function Ne(h,_,x){var y=ia.exec(_.slice(x,x+3));return y?(h.L=+y[0],x+y[0].length):-1}function lt(h,_,x){var y=ia.exec(_.slice(x,x+6));return y?(h.L=Math.floor(y[0]/1e3),x+y[0].length):-1}function Ue(h,_,x){var y=Hs.exec(_.slice(x,x+1));return y?x+y[0].length:-1}function It(h,_,x){var y=ia.exec(_.slice(x));return y?(h.Q=+y[0],x+y[0].length):-1}function $t(h,_,x){var y=ia.exec(_.slice(x));return y?(h.s=+y[0],x+y[0].length):-1}function ar(h,_){return An(h.getDate(),_,2)}function tr(h,_){return An(h.getHours(),_,2)}function pr(h,_){return An(h.getHours()%12||12,_,2)}function wr(h,_){return An(1+on.count(hc(h),h),_,3)}function $r(h,_){return An(h.getMilliseconds(),_,3)}function Cn(h,_){return $r(h,_)+"000"}function un(h,_){return An(h.getMonth()+1,_,2)}function _n(h,_){return An(h.getMinutes(),_,2)}function Kn(h,_){return An(h.getSeconds(),_,2)}function ka(h){var _=h.getDay();return _===0?7:_}function Ei(h,_){return An(Uf.count(hc(h)-1,h),_,2)}function Pi(h){var _=h.getDay();return _>=4||_===0?Pf(h):Pf.ceil(h)}function Du(h,_){return h=Pi(h),An(Pf.count(hc(h),h)+(hc(h).getDay()===4),_,2)}function ou(h){return h.getDay()}function Xl(h,_){return An(Bf.count(hc(h)-1,h),_,2)}function Ds(h,_){return An(h.getFullYear()%100,_,2)}function Ns(h,_){return h=Pi(h),An(h.getFullYear()%100,_,2)}function Yl(h,_){return An(h.getFullYear()%1e4,_,4)}function dc(h,_){var x=h.getDay();return h=x>=4||x===0?Pf(h):Pf.ceil(h),An(h.getFullYear()%1e4,_,4)}function yu(h){var _=h.getTimezoneOffset();return(_>0?"-":(_*=-1,"+"))+An(_/60|0,"0",2)+An(_%60,"0",2)}function Mc(h,_){return An(h.getUTCDate(),_,2)}function Co(h,_){return An(h.getUTCHours(),_,2)}function _a(h,_){return An(h.getUTCHours()%12||12,_,2)}function Ol(h,_){return An(1+ps.count(Mi(h),h),_,3)}function nh(h,_){return An(h.getUTCMilliseconds(),_,3)}function fh(h,_){return nh(h,_)+"000"}function Nh(h,_){return An(h.getUTCMonth()+1,_,2)}function pc(h,_){return An(h.getUTCMinutes(),_,2)}function Gf(h,_){return An(h.getUTCSeconds(),_,2)}function ah(h){var _=h.getUTCDay();return _===0?7:_}function hh(h,_){return An(Fr.count(Mi(h)-1,h),_,2)}function qh(h){var _=h.getUTCDay();return _>=4||_===0?sn(h):sn.ceil(h)}function Zs(h,_){return h=qh(h),An(sn.count(Mi(h),h)+(Mi(h).getUTCDay()===4),_,2)}function kh(h){return h.getUTCDay()}function Hf(h,_){return An(Kr.count(Mi(h)-1,h),_,2)}function Gh(h,_){return An(h.getUTCFullYear()%100,_,2)}function Hh(h,_){return h=qh(h),An(h.getUTCFullYear()%100,_,2)}function ed(h,_){return An(h.getUTCFullYear()%1e4,_,4)}function _h(h,_){var x=h.getUTCDay();return h=x>=4||x===0?sn(h):sn.ceil(h),An(h.getUTCFullYear()%1e4,_,4)}function Zf(){return"+0000"}function td(){return"%"}function rd(h){return+h}function ld(h){return Math.floor(+h/1e3)}var vs,Wf,cd,e,t;r({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function r(h){return vs=Is(h),Wf=vs.format,cd=vs.parse,e=vs.utcFormat,t=vs.utcParse,vs}var u=1e3,f=u*60,v=f*60,S=v*24,P=S*7,V=S*30,ee=S*365;function he(h){return new Date(h)}function _e(h){return h instanceof Date?+h:+new Date(+h)}function Ce(h,_,x,y,A,M,B,ie,de){var Be=uf(ds,ds),zt=Be.invert,qt=Be.domain,Or=de(".%L"),Nr=de(":%S"),bn=de("%I:%M"),gn=de("%I %p"),Fn=de("%a %d"),Ta=de("%b %d"),Ca=de("%B"),Li=de("%Y"),ai=[[B,1,u],[B,5,5*u],[B,15,15*u],[B,30,30*u],[M,1,f],[M,5,5*f],[M,15,15*f],[M,30,30*f],[A,1,v],[A,3,3*v],[A,6,6*v],[A,12,12*v],[y,1,S],[y,2,2*S],[x,1,P],[_,1,V],[_,3,3*V],[h,1,ee]];function ii(wa){return(B(wa)<wa?Or:M(wa)<wa?Nr:A(wa)<wa?bn:y(wa)<wa?gn:_(wa)<wa?x(wa)<wa?Fn:Ta:h(wa)<wa?Ca:Li)(wa)}function Qi(wa,qi,xo,Xs){if(wa==null&&(wa=10),typeof wa=="number"){var Wa=Math.abs(xo-qi)/wa,As=mu(function(Yo){return Yo[2]}).right(ai,Wa);As===ai.length?(Xs=l(qi/ee,xo/ee,wa),wa=h):As?(As=ai[Wa/ai[As-1][2]<ai[As][2]/Wa?As-1:As],Xs=As[1],wa=As[0]):(Xs=Math.max(l(qi,xo,wa),1),wa=ie)}return Xs==null?wa:wa.every(Xs)}return Be.invert=function(wa){return new Date(zt(wa))},Be.domain=function(wa){return arguments.length?qt(Gi.call(wa,_e)):qt().map(he)},Be.ticks=function(wa,qi){var xo=qt(),Xs=xo[0],Wa=xo[xo.length-1],As=Wa<Xs,Yo;return As&&(Yo=Xs,Xs=Wa,Wa=Yo),Yo=Qi(wa,Xs,Wa,qi),Yo=Yo?Yo.range(Xs,Wa+1):[],As?Yo.reverse():Yo},Be.tickFormat=function(wa,qi){return qi==null?ii:de(qi)},Be.nice=function(wa,qi){var xo=qt();return(wa=Qi(wa,xo[0],xo[xo.length-1],qi))?qt(N(xo,wa)):Be},Be.copy=function(){return Ku(Be,Ce(h,_,x,y,A,M,B,ie,de))},Be}var ut=function(){return vr.apply(Ce(hc,jf,Uf,on,cn,nn,Wr,ta,Wf).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},Pt=xa(function(h){h.setUTCDate(1),h.setUTCHours(0,0,0,0)},function(h,_){h.setUTCMonth(h.getUTCMonth()+_)},function(h,_){return _.getUTCMonth()-h.getUTCMonth()+(_.getUTCFullYear()-h.getUTCFullYear())*12},function(h){return h.getUTCMonth()}),St=Pt,Yt=Pt.range,Wt=xa(function(h){h.setUTCMinutes(0,0,0)},function(h,_){h.setTime(+h+_*zf)},function(h,_){return(_-h)/zf},function(h){return h.getUTCHours()}),ir=Wt,yr=Wt.range,_r=xa(function(h){h.setUTCSeconds(0,0)},function(h,_){h.setTime(+h+_*ff)},function(h,_){return(_-h)/ff},function(h){return h.getUTCMinutes()}),kr=_r,Dr=_r.range,pn=function(){return vr.apply(Ce(Mi,St,Fr,ps,ir,kr,Wr,ta,e).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)};function fn(){var h=0,_=1,x,y,A,M,B=ds,ie=!1,de;function Be(zt){return isNaN(zt=+zt)?de:B(A===0?.5:(zt=(M(zt)-x)*A,ie?Math.max(0,Math.min(1,zt)):zt))}return Be.domain=function(zt){return arguments.length?(x=M(h=+zt[0]),y=M(_=+zt[1]),A=x===y?0:1/(y-x),Be):[h,_]},Be.clamp=function(zt){return arguments.length?(ie=!!zt,Be):ie},Be.interpolator=function(zt){return arguments.length?(B=zt,Be):B},Be.unknown=function(zt){return arguments.length?(de=zt,Be):de},function(zt){return M=zt,x=zt(h),y=zt(_),A=x===y?0:1/(y-x),Be}}function Rn(h,_){return _.domain(h.domain()).interpolator(h.interpolator()).clamp(h.clamp()).unknown(h.unknown())}function Qn(){var h=ml(fn()(ds));return h.copy=function(){return Rn(h,Qn())},Sr.apply(h,arguments)}function Xn(){var h=Gn(fn()).domain([1,10]);return h.copy=function(){return Rn(h,Xn()).base(h.base())},Sr.apply(h,arguments)}function Nn(){var h=Fa(fn());return h.copy=function(){return Rn(h,Nn()).constant(h.constant())},Sr.apply(h,arguments)}function Ea(){var h=yo(fn());return h.copy=function(){return Rn(h,Ea()).exponent(h.exponent())},Sr.apply(h,arguments)}function ca(){return Ea.apply(null,arguments).exponent(.5)}function ra(){var h=[],_=ds;function x(y){if(!isNaN(y=+y))return _((Vs(h,y)-1)/(h.length-1))}return x.domain=function(y){if(!arguments.length)return h.slice();h=[];for(var A=0,M=y.length,B;A<M;++A)(B=y[A],B!=null&&!isNaN(B=+B))&&h.push(B);return h.sort(fl),x},x.interpolator=function(y){return arguments.length?(_=y,x):_},x.copy=function(){return ra(_).domain(h)},Sr.apply(x,arguments)}function $a(){var h=0,_=.5,x=1,y,A,M,B,ie,de=ds,Be,zt=!1,qt;function Or(Nr){return isNaN(Nr=+Nr)?qt:(Nr=.5+((Nr=+Be(Nr))-A)*(Nr<A?B:ie),de(zt?Math.max(0,Math.min(1,Nr)):Nr))}return Or.domain=function(Nr){return arguments.length?(y=Be(h=+Nr[0]),A=Be(_=+Nr[1]),M=Be(x=+Nr[2]),B=y===A?0:.5/(A-y),ie=A===M?0:.5/(M-A),Or):[h,_,x]},Or.clamp=function(Nr){return arguments.length?(zt=!!Nr,Or):zt},Or.interpolator=function(Nr){return arguments.length?(de=Nr,Or):de},Or.unknown=function(Nr){return arguments.length?(qt=Nr,Or):qt},function(Nr){return Be=Nr,y=Nr(h),A=Nr(_),M=Nr(x),B=y===A?0:.5/(A-y),ie=A===M?0:.5/(M-A),Or}}function Na(){var h=ml($a()(ds));return h.copy=function(){return Rn(h,Na())},Sr.apply(h,arguments)}function ki(){var h=Gn($a()).domain([.1,1,10]);return h.copy=function(){return Rn(h,ki()).base(h.base())},Sr.apply(h,arguments)}function ma(){var h=Fa($a());return h.copy=function(){return Rn(h,ma()).constant(h.constant())},Sr.apply(h,arguments)}function ri(){var h=yo($a());return h.copy=function(){return Rn(h,ri()).exponent(h.exponent())},Sr.apply(h,arguments)}function Fo(){return ri.apply(null,arguments).exponent(.5)}var mi,zo,Uo,ts,bu,rs,$u,su,Ju,uu=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,Ws=(mi={},Pe()(mi,b.ScaleTypes.LINEAR,re),Pe()(mi,b.ScaleTypes.POWER,Hi),Pe()(mi,b.ScaleTypes.LOG,ea),Pe()(mi,b.ScaleTypes.IDENTITY,se),Pe()(mi,b.ScaleTypes.TIME,ut),Pe()(mi,b.ScaleTypes.QUANTILE,Qa),Pe()(mi,b.ScaleTypes.QUANTIZE,lo),Pe()(mi,b.ScaleTypes.THRESHOLD,iu),Pe()(mi,b.ScaleTypes.CAT,gi),mi),lu=(zo=Object(ur.injectable)(),Uo=Object(ur.inject)(b.TYPES.IGlobalConfigService),ts=Object(ur.inject)(b.TYPES.ILogService),zo(bu=(rs=(Ju=function(){function h(){Y()(this,h),De()(this,"configService",$u,this),De()(this,"logger",su,this),this.scaleCache={},this.scaleOptions={}}return i()(h,[{key:"apply",value:function(x,y){var A=this,M=y.styleAttributeService;x.hooks.init.tap("FeatureScalePlugin",function(){A.scaleOptions=x.getScaleOptions();var B=M.getLayerStyleAttributes(),ie=x.getSource().data.dataArray;if(ie.length===0)return;A.caculateScalesForAttributes(B||[],ie)}),x.hooks.beforeRenderData.tap("FeatureScalePlugin",function(){A.scaleOptions=x.getScaleOptions();var B=M.getLayerStyleAttributes(),ie=x.getSource().data.dataArray;return A.caculateScalesForAttributes(B||[],ie),x.layerModelNeedUpdate=!0,!0}),x.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(x.layerModelNeedUpdate)return;A.scaleOptions=x.getScaleOptions();var B=M.getLayerStyleAttributes();if(B){var ie=x.getSource().data.dataArray;if(ie.length===0)return;var de=B.filter(function(Be){return Be.needRescale});de.length&&(A.caculateScalesForAttributes(de,ie),A.logger.debug("rescale finished"))}})}},{key:"isNumber",value:function(x){return!isNaN(parseFloat(x))&&isFinite(x)}},{key:"caculateScalesForAttributes",value:function(x,y){var A=this;this.scaleCache={},x.forEach(function(M){if(M.scale){var B=M.scale,ie=M.name;B.names=A.parseFields(M.scale.field||[]);var de=[];B.names.forEach(function(Be){de.push(A.getOrCreateScale(Be,M,y))}),de.some(function(Be){return Be.type===b.StyleScaleType.VARIABLE})?(B.type=b.StyleScaleType.VARIABLE,de.forEach(function(Be){if(!B.callback){var zt;if(B.values&&B.values!=="text"){var qt;if(((qt=Be.option)===null||qt===void 0?void 0:qt.type)==="linear"&&B.values.length>2){var Or=Be.scale.ticks(B.values.length);ie==="color"&&Be.scale.domain(Or)}Be.scale.range(B.values)}else((zt=Be.option)===null||zt===void 0?void 0:zt.type)==="cat"&&Be.scale.range(Be.option.domain)}})):(B.type=b.StyleScaleType.CONSTANT,B.defaultValues=de.map(function(Be,zt){return Be.scale(B.names[zt])})),B.scalers=de.map(function(Be){return{field:Be.field,func:Be.scale,option:Be.option}}),M.needRescale=!1}})}},{key:"getOrCreateScale",value:function(x,y,A){var M,B=[x,y.name].join("_"),ie=(M=y.scale)===null||M===void 0?void 0:M.values,de=this.createScale(x,y.name,ie,A);return de}},{key:"parseFields",value:function(x){return Array.isArray(x)?x:rc()(x)?x.split("*"):[x]}},{key:"createScale",value:function(x,y,A,M){var B,ie=this.scaleOptions[y]&&this.scaleOptions[y].field===x?this.scaleOptions[y]:this.scaleOptions[x],de={field:x,scale:void 0,type:b.StyleScaleType.VARIABLE,option:ie};if(!M||!M.length)return ie&&ie.type?de.scale=this.createDefaultScale(ie):(de.scale=gi([x]),de.type=b.StyleScaleType.CONSTANT),de;var Be=(B=M.find(function(Or){return!no()(Or[x])}))===null||B===void 0?void 0:B[x];if(this.isNumber(x)||no()(Be)&&!ie)de.scale=gi([x]),de.type=b.StyleScaleType.CONSTANT;else{var zt=ie&&ie.type||this.getDefaultType(Be);A==="text"&&(zt=b.ScaleTypes.CAT);var qt=this.createDefaultScaleConfig(zt,x,M);Object.assign(qt,ie),de.scale=this.createDefaultScale(qt),de.option=qt}return de}},{key:"getDefaultType",value:function(x){var y=b.ScaleTypes.LINEAR;return typeof x=="string"&&(y=uu.test(x)?b.ScaleTypes.TIME:b.ScaleTypes.CAT),y}},{key:"createDefaultScaleConfig",value:function(x,y,A){var M={type:x},B=(A==null?void 0:A.map(function(ie){return ie[y]}))||[];return x!==b.ScaleTypes.CAT&&x!==b.ScaleTypes.QUANTILE?M.domain=Cl(B):x===b.ScaleTypes.CAT?M.domain=Ss()(B):x===b.ScaleTypes.QUANTILE&&(M.domain=B),M}},{key:"createDefaultScale",value:function(x){var y=x.type,A=x.domain,M=Ws[y]();return A&&M.domain(A),M}}]),h}(),Ju),$u=Je()(rs.prototype,"configService",[Uo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),su=Je()(rs.prototype,"logger",[ts],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rs))||bu),hi,ni,Ji,fo,xu,bo,Bo,Nu;function li(h,_){var x=Object.keys(h);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(h);_&&(y=y.filter(function(A){return Object.getOwnPropertyDescriptor(h,A).enumerable})),x.push.apply(x,y)}return x}function Xf(h){for(var _=1;_<arguments.length;_++){var x=arguments[_]!=null?arguments[_]:{};_%2?li(Object(x),!0).forEach(function(y){Pe()(h,y,x[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(x)):li(Object(x)).forEach(function(y){Object.defineProperty(h,y,Object.getOwnPropertyDescriptor(x,y))})}return h}var Xc=(hi=Object(ur.injectable)(),ni=Object(ur.inject)(b.TYPES.ICameraService),Ji=Object(ur.inject)(b.TYPES.IRendererService),hi(fo=(xu=(Nu=function(){function h(){Y()(this,h),De()(this,"cameraService",bo,this),De()(this,"rendererService",Bo,this)}return i()(h,[{key:"apply",value:function(x){x.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){x.models.forEach(function(y){y.addUniforms(Xf({},x.layerModel.getAnimateUniforms()))})})}}]),h}(),Nu),bo=Je()(xu.prototype,"cameraService",[ni],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bo=Je()(xu.prototype,"rendererService",[Ji],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xu))||fo),hf,mc,ku=(hf=Object(ur.injectable)(),hf(mc=function(){function h(){Y()(this,h)}return i()(h,[{key:"apply",value:function(x){x.hooks.init.tap("LayerModelPlugin",function(){x.prepareBuildModel(),x.buildModels(),x.styleNeedUpdate=!1}),x.hooks.beforeRenderData.tap("DataSourcePlugin",function(){return x.prepareBuildModel(),x.clearModels(),x.buildModels(),x.layerModelNeedUpdate=!1,!1})}}]),h}())||mc),Lf,Rf,Yf=(Lf=Object(ur.injectable)(),Lf(Rf=function(){function h(){Y()(this,h)}return i()(h,[{key:"apply",value:function(x){x.hooks.afterInit.tap("LayerStylePlugin",function(){x.updateLayerConfig({});var y=x.getLayerConfig(),A=y.autoFit,M=y.fitBoundsOptions;A&&setTimeout(function(){x.fitBounds(M)},100)})}}]),h}())||Rf),Sh,Af;function Ah(h,_){var x=Object.keys(h);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(h);_&&(y=y.filter(function(A){return Object.getOwnPropertyDescriptor(h,A).enumerable})),x.push.apply(x,y)}return x}function Kf(h){for(var _=1;_<arguments.length;_++){var x=arguments[_]!=null?arguments[_]:{};_%2?Ah(Object(x),!0).forEach(function(y){Pe()(h,y,x[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(x)):Ah(Object(x)).forEach(function(y){Object.defineProperty(h,y,Object.getOwnPropertyDescriptor(x,y))})}return h}var dh={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},Zh={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},jh={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},Wh={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5},ph=["ambient","diffuse","specular"];function Ch(h){var _={u_DirectionalLights:new Array(3).fill(Kf({},jh)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(Kf({},Wh)),u_NumOfSpotLights:0};return(!h||!h.length)&&(h=[Zh]),h.forEach(function(x,y){var A=x.type,M=A===void 0?"directional":A,B=pe()(x,["type"]),ie=dh[M].lights,de=dh[M].num,Be=_[de];_[ie][Be]=Kf(Kf({},_[ie][Be]),B),_[de]++}),_}var Xh=(Sh=Object(ur.injectable)(),Sh(Af=function(){function h(){Y()(this,h)}return i()(h,[{key:"apply",value:function(x){x.hooks.beforeRender.tap("LightingPlugin",function(){var y=x.getLayerConfig(),A=y.enableLighting;A&&x.models.forEach(function(M){return M.addUniforms(Kf({},Ch()))})})}}]),h}())||Af),mh,$f,ih={NONE:0,ENCODE:1,HIGHLIGHT:2},Yh=(mh=Object(ur.injectable)(),mh($f=function(){function h(){Y()(this,h)}return i()(h,[{key:"apply",value:function(x,y){var A=y.rendererService,M=y.styleAttributeService;x.hooks.init.tap("PixelPickingPlugin",function(){var B=x.getLayerConfig(),ie=B.enablePicking;M.registerStyleAttribute({name:"pickingColor",type:b.AttributeType.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:b.gl.FLOAT},size:3,update:function(Be,zt){var qt=Be.id;return ie?Object(Me.l)(qt):[0,0,0]}}})}),x.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var B=x.getLayerConfig(),ie=B.enablePicking;ie&&x.isVisible()&&x.models.forEach(function(de){return de.addUniforms({u_PickingStage:ih.ENCODE})})}),x.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var B=x.getLayerConfig(),ie=B.enablePicking;ie&&x.isVisible()&&x.models.forEach(function(de){return de.addUniforms({u_PickingStage:ih.HIGHLIGHT})})}),x.hooks.beforeHighlight.tap("PixelPickingPlugin",function(B){var ie=x.getLayerConfig(),de=ie.highlightColor,Be=typeof de=="string"?Object(Me.s)(de):de||[1,0,0,1];x.updateLayerConfig({pickedFeatureID:Object(Me.k)(new Uint8Array(B))}),x.models.forEach(function(zt){return zt.addUniforms({u_PickingStage:ih.HIGHLIGHT,u_PickingColor:B,u_HighlightColor:Be.map(function(qt){return qt*255})})})}),x.hooks.beforeSelect.tap("PixelPickingPlugin",function(B){var ie=x.getLayerConfig(),de=ie.selectColor,Be=typeof de=="string"?Object(Me.s)(de):de||[1,0,0,1];x.updateLayerConfig({pickedFeatureID:Object(Me.k)(new Uint8Array(B))}),x.models.forEach(function(zt){return zt.addUniforms({u_PickingStage:ih.HIGHLIGHT,u_PickingColor:B,u_HighlightColor:Be.map(function(qt){return qt*255})})})})}}]),h}())||$f),Fh,vh,zh,wh,gh,Uh,Bh=(Fh=Object(ur.injectable)(),vh=Object(ur.inject)(b.TYPES.ILogService),Fh(zh=(wh=(Uh=function(){function h(){Y()(this,h),De()(this,"logger",gh,this)}return i()(h,[{key:"apply",value:function(x,y){var A=this,M=y.styleAttributeService;x.hooks.init.tap("RegisterStyleAttributePlugin",function(){A.registerBuiltinAttributes(M)})}},{key:"registerBuiltinAttributes",value:function(x){x.registerStyleAttribute({name:"position",type:b.AttributeType.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:b.gl.FLOAT},size:3,update:function(A,M,B){return B.length===2?[B[0],B[1],0]:[B[0],B[1],B[2]]}}}),x.registerStyleAttribute({name:"filter",type:b.AttributeType.Attribute,descriptor:{name:"filter",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(A,M){var B=A.filter;return B?[1]:[0]}}}),x.registerStyleAttribute({name:"color",type:b.AttributeType.Attribute,descriptor:{name:"a_Color",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:4,update:function(A,M){var B=A.color;return!B||!B.length?[1,1,1,1]:B}}})}}]),h}(),Uh),gh=Je()(wh.prototype,"logger",[vh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wh))||zh),Oh,Mh,yh,Ph,bh,If,Lh,Kh,$h,nd,ad=(Oh=Object(ur.injectable)(),Mh=Object(ur.inject)(b.TYPES.ICameraService),yh=Object(ur.inject)(b.TYPES.ICoordinateSystemService),Ph=Object(ur.inject)(b.TYPES.IRendererService),Oh(bh=(If=(nd=function(){function h(){Y()(this,h),De()(this,"cameraService",Lh,this),De()(this,"coordinateSystemService",Kh,this),De()(this,"rendererService",$h,this)}return i()(h,[{key:"apply",value:function(x){var y=this;x.hooks.beforeRender.tap("ShaderUniformPlugin",function(){y.coordinateSystemService.refresh();var A=y.rendererService.getViewportSize(),M=A.width,B=A.height;x.models.forEach(function(ie){var de;return ie.addUniforms((de={},Pe()(de,b.CameraUniform.ProjectionMatrix,y.cameraService.getProjectionMatrix()),Pe()(de,b.CameraUniform.ViewMatrix,y.cameraService.getViewMatrix()),Pe()(de,b.CameraUniform.ViewProjectionMatrix,y.cameraService.getViewProjectionMatrix()),Pe()(de,b.CameraUniform.Zoom,y.cameraService.getZoom()),Pe()(de,b.CameraUniform.ZoomScale,y.cameraService.getZoomScale()),Pe()(de,b.CameraUniform.FocalDistance,y.cameraService.getFocalDistance()),Pe()(de,b.CameraUniform.CameraPosition,y.cameraService.getCameraPosition()),Pe()(de,b.CoordinateUniform.CoordinateSystem,y.coordinateSystemService.getCoordinateSystem()),Pe()(de,b.CoordinateUniform.ViewportCenter,y.coordinateSystemService.getViewportCenter()),Pe()(de,b.CoordinateUniform.ViewportCenterProjection,y.coordinateSystemService.getViewportCenterProjection()),Pe()(de,b.CoordinateUniform.PixelsPerDegree,y.coordinateSystemService.getPixelsPerDegree()),Pe()(de,b.CoordinateUniform.PixelsPerDegree2,y.coordinateSystemService.getPixelsPerDegree2()),Pe()(de,b.CoordinateUniform.PixelsPerMeter,y.coordinateSystemService.getPixelsPerMeter()),Pe()(de,"u_ViewportSize",[M,B]),Pe()(de,"u_DevicePixelRatio",window.devicePixelRatio),Pe()(de,"u_ModelMatrix",[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Pe()(de,"u_PickingBuffer",x.getLayerConfig().pickingBuffer||0),de))})})}}]),h}(),nd),Lh=Je()(If.prototype,"cameraService",[Mh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kh=Je()(If.prototype,"coordinateSystemService",[yh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$h=Je()(If.prototype,"rendererService",[Ph],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),If))||bh),id,Jh,Ed=(id=Object(ur.injectable)(),id(Jh=function(){function h(){Y()(this,h)}return i()(h,[{key:"apply",value:function(x){x.hooks.beforeRender.tap("UpdateModelPlugin",function(){x.layerModel&&x.layerModel.needUpdate()})}}]),h}())||Jh),fd,Rh,gs,Yc,hd,Jf,od=(fd=Object(ur.injectable)(),Rh=Object(ur.inject)(b.TYPES.ILogService),fd(gs=(Yc=(Jf=function(){function h(){Y()(this,h),De()(this,"logger",hd,this)}return i()(h,[{key:"apply",value:function(x,y){var A=this,M=y.styleAttributeService;x.hooks.init.tap("UpdateStyleAttributePlugin",function(){A.initStyleAttribute(x,{styleAttributeService:M})}),x.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){if(x.layerModelNeedUpdate)return;A.updateStyleAtrribute(x,{styleAttributeService:M})})}},{key:"updateStyleAtrribute",value:function(x,y){var A=this,M=y.styleAttributeService,B=M.getLayerStyleAttributes()||[],ie=M.getLayerStyleAttribute("filter"),de=M.getLayerStyleAttribute("shape");if(ie&&ie.needRegenerateVertices||de&&de.needRegenerateVertices){x.layerModelNeedUpdate=!0,B.forEach(function(Be){return Be.needRegenerateVertices=!1});return}B.filter(function(Be){return Be.needRegenerateVertices}).forEach(function(Be){M.updateAttributeByFeatureRange(Be.name,x.getEncodedData(),Be.featureRange.startIndex,Be.featureRange.endIndex),Be.needRegenerateVertices=!1,A.logger.debug("regenerate vertex attributes: ".concat(Be.name," finished"))})}},{key:"initStyleAttribute",value:function(x,y){var A=this,M=y.styleAttributeService,B=M.getLayerStyleAttributes()||[];B.filter(function(ie){return ie.needRegenerateVertices}).forEach(function(ie){M.updateAttributeByFeatureRange(ie.name,x.getEncodedData(),ie.featureRange.startIndex,ie.featureRange.endIndex),ie.needRegenerateVertices=!1,A.logger.debug("init vertex attributes: ".concat(ie.name," finished"))})}}]),h}(),Jf),hd=Je()(Yc.prototype,"logger",[Rh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yc))||gs);b.container.bind(b.TYPES.ILayerPlugin).to(Io).inRequestScope(),b.container.bind(b.TYPES.ILayerPlugin).to(Bh).inRequestScope(),b.container.bind(b.TYPES.ILayerPlugin).to(lu).inRequestScope(),b.container.bind(b.TYPES.ILayerPlugin).to(Tc).inRequestScope(),b.container.bind(b.TYPES.ILayerPlugin).to(Yf).inRequestScope(),b.container.bind(b.TYPES.ILayerPlugin).to(od).inRequestScope(),b.container.bind(b.TYPES.ILayerPlugin).to(Ed).inRequestScope(),b.container.bind(b.TYPES.ILayerPlugin).to(nt).inRequestScope(),b.container.bind(b.TYPES.ILayerPlugin).to(ad).inRequestScope(),b.container.bind(b.TYPES.ILayerPlugin).to(Xc).inRequestScope(),b.container.bind(b.TYPES.ILayerPlugin).to(Xh).inRequestScope(),b.container.bind(b.TYPES.ILayerPlugin).to(Yh).inRequestScope(),b.container.bind(b.TYPES.ILayerPlugin).to(ku).inRequestScope()},t2Dn:function(ze,E,o){var b=o("hypo"),m=o("ljhN");function Y(F,i,Z){(Z!==void 0&&!m(F[i],Z)||Z===void 0&&!(i in F))&&b(F,i,Z)}ze.exports=Y},u6S6:function(ze,E,o){var b=o("6acW"),m=o("sgoq"),Y=m(function(F,i,Z){return i=i.toLowerCase(),F+(Z?b(i):i)});ze.exports=Y},uhBA:function(ze,E,o){"use strict";var b=Object.prototype.hasOwnProperty,m="~";function Y(){}Object.create&&(Y.prototype=Object.create(null),new Y().__proto__||(m=!1));function F($,te,fe){this.fn=$,this.context=te,this.once=fe||!1}function i($,te,fe,K,Ge){if(typeof fe!="function")throw new TypeError("The listener must be a function");var pe=new F(fe,K||$,Ge),Ze=m?m+te:te;return $._events[Ze]?$._events[Ze].fn?$._events[Ze]=[$._events[Ze],pe]:$._events[Ze].push(pe):($._events[Ze]=pe,$._eventsCount++),$}function Z($,te){--$._eventsCount===0?$._events=new Y:delete $._events[te]}function D(){this._events=new Y,this._eventsCount=0}D.prototype.eventNames=function(){var te=[],fe,K;if(this._eventsCount===0)return te;for(K in fe=this._events)b.call(fe,K)&&te.push(m?K.slice(1):K);return Object.getOwnPropertySymbols?te.concat(Object.getOwnPropertySymbols(fe)):te},D.prototype.listeners=function(te){var fe=m?m+te:te,K=this._events[fe];if(!K)return[];if(K.fn)return[K.fn];for(var Ge=0,pe=K.length,Ze=new Array(pe);Ge<pe;Ge++)Ze[Ge]=K[Ge].fn;return Ze},D.prototype.listenerCount=function(te){var fe=m?m+te:te,K=this._events[fe];return K?K.fn?1:K.length:0},D.prototype.emit=function(te,fe,K,Ge,pe,Ze){var Pe=m?m+te:te;if(!this._events[Pe])return!1;var mt=this._events[Pe],De=arguments.length,At,it;if(mt.fn){mt.once&&this.removeListener(te,mt.fn,void 0,!0);switch(De){case 1:return mt.fn.call(mt.context),!0;case 2:return mt.fn.call(mt.context,fe),!0;case 3:return mt.fn.call(mt.context,fe,K),!0;case 4:return mt.fn.call(mt.context,fe,K,Ge),!0;case 5:return mt.fn.call(mt.context,fe,K,Ge,pe),!0;case 6:return mt.fn.call(mt.context,fe,K,Ge,pe,Ze),!0}for(it=1,At=new Array(De-1);it<De;it++)At[it-1]=arguments[it];mt.fn.apply(mt.context,At)}else{var vt=mt.length,Je;for(it=0;it<vt;it++){mt[it].once&&this.removeListener(te,mt[it].fn,void 0,!0);switch(De){case 1:mt[it].fn.call(mt[it].context);break;case 2:mt[it].fn.call(mt[it].context,fe);break;case 3:mt[it].fn.call(mt[it].context,fe,K);break;case 4:mt[it].fn.call(mt[it].context,fe,K,Ge);break;default:if(!At)for(Je=1,At=new Array(De-1);Je<De;Je++)At[Je-1]=arguments[Je];mt[it].fn.apply(mt[it].context,At)}}}return!0},D.prototype.on=function(te,fe,K){return i(this,te,fe,K,!1)},D.prototype.once=function(te,fe,K){return i(this,te,fe,K,!0)},D.prototype.removeListener=function(te,fe,K,Ge){var pe=m?m+te:te;if(!this._events[pe])return this;if(!fe)return Z(this,pe),this;var Ze=this._events[pe];if(Ze.fn)Ze.fn===fe&&(!Ge||Ze.once)&&(!K||Ze.context===K)&&Z(this,pe);else{for(var Pe=0,mt=[],De=Ze.length;Pe<De;Pe++)(Ze[Pe].fn!==fe||Ge&&!Ze[Pe].once||K&&Ze[Pe].context!==K)&&mt.push(Ze[Pe]);mt.length?this._events[pe]=mt.length===1?mt[0]:mt:Z(this,pe)}return this},D.prototype.removeAllListeners=function(te){var fe;return te?(fe=m?m+te:te,this._events[fe]&&Z(this,fe)):(this._events=new Y,this._eventsCount=0),this},D.prototype.off=D.prototype.removeListener,D.prototype.addListener=D.prototype.on,D.prefixed=m,D.EventEmitter=D,ze.exports=D},ujMp:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("MON2");function m(te){if(typeof te=="function"){var fe=te;return fe.name}else{if(typeof te=="symbol")return te.toString();var fe=te;return fe}}E.getServiceIdentifierAsString=m;function Y(te,fe,K){var Ge="",pe=K(te,fe);return pe.length!==0&&(Ge=`
Registered bindings:`,pe.forEach(function(Ze){var Pe="Object";Ze.implementationType!==null&&(Pe=$(Ze.implementationType)),Ge=Ge+`
 `+Pe,Ze.constraint.metaData&&(Ge=Ge+" - "+Ze.constraint.metaData)})),Ge}E.listRegisteredBindingsForServiceIdentifier=Y;function F(te,fe){return te.parentRequest===null?!1:te.parentRequest.serviceIdentifier===fe?!0:F(te.parentRequest,fe)}function i(te){function fe(Ge,pe){pe===void 0&&(pe=[]);var Ze=m(Ge.serviceIdentifier);return pe.push(Ze),Ge.parentRequest!==null?fe(Ge.parentRequest,pe):pe}var K=fe(te);return K.reverse().join(" --> ")}function Z(te){te.childRequests.forEach(function(fe){if(F(fe,fe.serviceIdentifier)){var K=i(fe);throw new Error(b.CIRCULAR_DEPENDENCY+" "+K)}else Z(fe)})}E.circularDependencyToException=Z;function D(te,fe){if(fe.isTagged()||fe.isNamed()){var K="",Ge=fe.getNamedTag(),pe=fe.getCustomTags();return Ge!==null&&(K+=Ge.toString()+`
`),pe!==null&&pe.forEach(function(Ze){K+=Ze.toString()+`
`})," "+te+`
 `+te+" - "+K}else return" "+te}E.listMetadataForTarget=D;function $(te){if(te.name)return te.name;var fe=te.toString(),K=fe.match(/^function\s*([^\s(]+)/);return K?K[1]:"Anonymous function: "+fe}E.getFunctionName=$},"vN+2":function(ze,E){function o(){}ze.exports=o},"w/wX":function(ze,E,o){var b=o("QqLw"),m=o("ExA7"),Y="[object Set]";function F(i){return m(i)&&b(i)==Y}ze.exports=F},w26f:function(ze,E,o){(function(b){var m=200,Y="__lodash_hash_undefined__",F=1/0,i="[object Function]",Z="[object GeneratorFunction]",D=/[\\^$.*+?()[\]{}|]/g,$=/^\[object .+?Constructor\]$/,te=typeof b=="object"&&b&&b.Object===Object&&b,fe=typeof self=="object"&&self&&self.Object===Object&&self,K=te||fe||Function("return this")();function Ge(pt,yt){var Ht=pt?pt.length:0;return!!Ht&&Pe(pt,yt,0)>-1}function pe(pt,yt,Ht){for(var hr=-1,Hr=pt?pt.length:0;++hr<Hr;)if(Ht(yt,pt[hr]))return!0;return!1}function Ze(pt,yt,Ht,hr){for(var Hr=pt.length,gr=Ht+(hr?1:-1);hr?gr--:++gr<Hr;)if(yt(pt[gr],gr,pt))return gr;return-1}function Pe(pt,yt,Ht){if(yt!==yt)return Ze(pt,mt,Ht);for(var hr=Ht-1,Hr=pt.length;++hr<Hr;)if(pt[hr]===yt)return hr;return-1}function mt(pt){return pt!==pt}function De(pt,yt){return pt.has(yt)}function At(pt,yt){return pt==null?void 0:pt[yt]}function it(pt){var yt=!1;if(pt!=null&&typeof pt.toString!="function")try{yt=!!(pt+"")}catch(Ht){}return yt}function vt(pt){var yt=-1,Ht=Array(pt.size);return pt.forEach(function(hr){Ht[++yt]=hr}),Ht}var Je=Array.prototype,_t=Function.prototype,wt=Object.prototype,ke=K["__core-js_shared__"],Re=function(){var pt=/[^.]+$/.exec(ke&&ke.keys&&ke.keys.IE_PROTO||"");return pt?"Symbol(src)_1."+pt:""}(),Ve=_t.toString,dt=wt.hasOwnProperty,Me=wt.toString,ht=RegExp("^"+Ve.call(dt).replace(D,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Zt=Je.splice,Qt=ne(K,"Map"),ur=ne(K,"Set"),oe=ne(Object,"create");function Q(pt){var yt=-1,Ht=pt?pt.length:0;for(this.clear();++yt<Ht;){var hr=pt[yt];this.set(hr[0],hr[1])}}function H(){this.__data__=oe?oe(null):{}}function Se(pt){return this.has(pt)&&delete this.__data__[pt]}function be(pt){var yt=this.__data__;if(oe){var Ht=yt[pt];return Ht===Y?void 0:Ht}return dt.call(yt,pt)?yt[pt]:void 0}function Te(pt){var yt=this.__data__;return oe?yt[pt]!==void 0:dt.call(yt,pt)}function me(pt,yt){var Ht=this.__data__;return Ht[pt]=oe&&yt===void 0?Y:yt,this}Q.prototype.clear=H,Q.prototype.delete=Se,Q.prototype.get=be,Q.prototype.has=Te,Q.prototype.set=me;function nt(pt){var yt=-1,Ht=pt?pt.length:0;for(this.clear();++yt<Ht;){var hr=pt[yt];this.set(hr[0],hr[1])}}function Jt(){this.__data__=[]}function Mt(pt){var yt=this.__data__,Ht=Tt(yt,pt);if(Ht<0)return!1;var hr=yt.length-1;return Ht==hr?yt.pop():Zt.call(yt,Ht,1),!0}function ve(pt){var yt=this.__data__,Ht=Tt(yt,pt);return Ht<0?void 0:yt[Ht][1]}function ge(pt){return Tt(this.__data__,pt)>-1}function He(pt,yt){var Ht=this.__data__,hr=Tt(Ht,pt);return hr<0?Ht.push([pt,yt]):Ht[hr][1]=yt,this}nt.prototype.clear=Jt,nt.prototype.delete=Mt,nt.prototype.get=ve,nt.prototype.has=ge,nt.prototype.set=He;function ot(pt){var yt=-1,Ht=pt?pt.length:0;for(this.clear();++yt<Ht;){var hr=pt[yt];this.set(hr[0],hr[1])}}function we(){this.__data__={hash:new Q,map:new(Qt||nt),string:new Q}}function gt(pt){return Qe(this,pt).delete(pt)}function C(pt){return Qe(this,pt).get(pt)}function R(pt){return Qe(this,pt).has(pt)}function q(pt,yt){return Qe(this,pt).set(pt,yt),this}ot.prototype.clear=we,ot.prototype.delete=gt,ot.prototype.get=C,ot.prototype.has=R,ot.prototype.set=q;function ce(pt){var yt=-1,Ht=pt?pt.length:0;for(this.__data__=new ot;++yt<Ht;)this.add(pt[yt])}function We(pt){return this.__data__.set(pt,Y),this}function qe(pt){return this.__data__.has(pt)}ce.prototype.add=ce.prototype.push=We,ce.prototype.has=qe;function Tt(pt,yt){for(var Ht=pt.length;Ht--;)if(xt(pt[Ht][0],yt))return Ht;return-1}function at(pt){if(!Et(pt)||kt(pt))return!1;var yt=bt(pt)||it(pt)?ht:$;return yt.test(dr(pt))}function Ut(pt,yt,Ht){var hr=-1,Hr=Ge,gr=pt.length,Bn=!0,zn=[],oa=zn;if(Ht)Bn=!1,Hr=pe;else if(gr>=m){var $n=yt?null:J(pt);if($n)return vt($n);Bn=!1,Hr=De,oa=new ce}else oa=yt?[]:zn;e:for(;++hr<gr;){var Yn=pt[hr],On=yt?yt(Yn):Yn;if(Yn=Ht||Yn!==0?Yn:0,Bn&&On===On){for(var U=oa.length;U--;)if(oa[U]===On)continue e;yt&&oa.push(On),zn.push(Yn)}else Hr(oa,On,Ht)||(oa!==zn&&oa.push(On),zn.push(Yn))}return zn}var J=ur&&1/vt(new ur([,-0]))[1]==F?function(pt){return new ur(pt)}:Fe;function Qe(pt,yt){var Ht=pt.__data__;return et(yt)?Ht[typeof yt=="string"?"string":"hash"]:Ht.map}function ne(pt,yt){var Ht=At(pt,yt);return at(Ht)?Ht:void 0}function et(pt){var yt=typeof pt;return yt=="string"||yt=="number"||yt=="symbol"||yt=="boolean"?pt!=="__proto__":pt===null}function kt(pt){return!!Re&&Re in pt}function dr(pt){if(pt!=null){try{return Ve.call(pt)}catch(yt){}try{return pt+""}catch(yt){}}return""}function Ye(pt){return pt&&pt.length?Ut(pt):[]}function xt(pt,yt){return pt===yt||pt!==pt&&yt!==yt}function bt(pt){var yt=Et(pt)?Me.call(pt):"";return yt==i||yt==Z}function Et(pt){var yt=typeof pt;return!!pt&&(yt=="object"||yt=="function")}function Fe(){}ze.exports=Ye}).call(this,o("yLpj"))},wclG:function(ze,E,o){var b=o("pFRH"),m=o("88Gu"),Y=m(b);ze.exports=Y},wnjb:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("xfSm"),m=function(){function Y(){}return Y.prototype.getConstructorMetadata=function(F){var i=Reflect.getMetadata(b.PARAM_TYPES,F),Z=Reflect.getMetadata(b.TAGGED,F);return{compilerGeneratedMetadata:i,userGeneratedMetadata:Z||{}}},Y.prototype.getPropertiesMetadata=function(F){var i=Reflect.getMetadata(b.TAGGED_PROP,F)||[];return i},Y}();E.MetadataReader=m},wrZu:function(ze,E,o){var b=o("+K+b"),m=o("XYm9"),Y=o("b2z7"),F=o("otv/"),i=o("yP5f"),Z="[object Boolean]",D="[object Date]",$="[object Map]",te="[object Number]",fe="[object RegExp]",K="[object Set]",Ge="[object String]",pe="[object Symbol]",Ze="[object ArrayBuffer]",Pe="[object DataView]",mt="[object Float32Array]",De="[object Float64Array]",At="[object Int8Array]",it="[object Int16Array]",vt="[object Int32Array]",Je="[object Uint8Array]",_t="[object Uint8ClampedArray]",wt="[object Uint16Array]",ke="[object Uint32Array]";function Re(Ve,dt,Me){var ht=Ve.constructor;switch(dt){case Ze:return b(Ve);case Z:case D:return new ht(+Ve);case Pe:return m(Ve,Me);case mt:case De:case At:case it:case vt:case Je:case _t:case wt:case ke:return i(Ve,Me);case $:return new ht;case te:case Ge:return new ht(Ve);case fe:return Y(Ve);case K:return new ht;case pe:return F(Ve)}}ze.exports=Re},wy8a:function(ze,E,o){var b=o("KxBF");function m(Y,F,i){var Z=Y.length;return i=i===void 0?Z:i,!F&&i>=Z?Y:b(Y,F,i)}ze.exports=m},xfSm:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.NAMED_TAG="named",E.NAME_TAG="name",E.UNMANAGED_TAG="unmanaged",E.OPTIONAL_TAG="optional",E.INJECT_TAG="inject",E.MULTI_INJECT_TAG="multi_inject",E.TAGGED="inversify:tagged",E.TAGGED_PROP="inversify:tagged_props",E.PARAM_TYPES="inversify:paramtypes",E.DESIGN_PARAM_TYPES="design:paramtypes",E.POST_CONSTRUCT="post_construct"},xfeJ:function(ze,E){function o(b){return Function.toString.call(b).indexOf("[native code]")!==-1}ze.exports=o},xiII:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("d9O0"),m=function(){function Y(F,i,Z,D,$){this.id=b.id(),this.serviceIdentifier=F,this.parentContext=i,this.parentRequest=Z,this.target=$,this.childRequests=[],this.bindings=Array.isArray(D)?D:[D],this.requestScope=Z===null?new Map:null}return Y.prototype.addChildRequest=function(F,i,Z){var D=new Y(F,this.parentContext,this,i,Z);return this.childRequests.push(D),D},Y}();E.Request=m},xp6e:function(ze,E,o){"use strict";(function(b){o.d(E,"a",function(){return be}),o.d(E,"b",function(){return Jt}),o.d(E,"c",function(){return oe}),o.d(E,"d",function(){return nt});/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function m(Mt,ve,ge,He){function ot(we){return we instanceof ge?we:new ge(function(gt){gt(we)})}return new(ge||(ge=Promise))(function(we,gt){function C(ce){try{q(He.next(ce))}catch(We){gt(We)}}function R(ce){try{q(He.throw(ce))}catch(We){gt(We)}}function q(ce){ce.done?we(ce.value):ot(ce.value).then(C,R)}q((He=He.apply(Mt,ve||[])).next())})}function Y(Mt,ve){var ge={label:0,sent:function(){if(we[0]&1)throw we[1];return we[1]},trys:[],ops:[]},He,ot,we,gt;return gt={next:C(0),throw:C(1),return:C(2)},typeof Symbol=="function"&&(gt[Symbol.iterator]=function(){return this}),gt;function C(q){return function(ce){return R([q,ce])}}function R(q){if(He)throw new TypeError("Generator is already executing.");for(;ge;)try{if(He=1,ot&&(we=q[0]&2?ot.return:q[0]?ot.throw||((we=ot.return)&&we.call(ot),0):ot.next)&&!(we=we.call(ot,q[1])).done)return we;(ot=0,we)&&(q=[q[0]&2,we.value]);switch(q[0]){case 0:case 1:we=q;break;case 4:return ge.label++,{value:q[1],done:!1};case 5:ge.label++,ot=q[1],q=[0];continue;case 7:q=ge.ops.pop(),ge.trys.pop();continue;default:if(!(we=ge.trys,we=we.length>0&&we[we.length-1])&&(q[0]===6||q[0]===2)){ge=0;continue}if(q[0]===3&&(!we||q[1]>we[0]&&q[1]<we[3])){ge.label=q[1];break}if(q[0]===6&&ge.label<we[1]){ge.label=we[1],we=q;break}if(we&&ge.label<we[2]){ge.label=we[2],ge.ops.push(q);break}we[2]&&ge.ops.pop(),ge.trys.pop();continue}q=ve.call(Mt,ge)}catch(ce){q=[6,ce],ot=0}finally{He=we=0}if(q[0]&5)throw q[1];return{value:q[0]?q[1]:void 0,done:!0}}}function F(Mt,ve){var ge=typeof Symbol=="function"&&Mt[Symbol.iterator];if(!ge)return Mt;var He=ge.call(Mt),ot,we=[],gt;try{for(;(ve===void 0||ve-- >0)&&!(ot=He.next()).done;)we.push(ot.value)}catch(C){gt={error:C}}finally{try{ot&&!ot.done&&(ge=He.return)&&ge.call(He)}finally{if(gt)throw gt.error}}return we}function i(){for(var Mt=[],ve=0;ve<arguments.length;ve++)Mt=Mt.concat(F(arguments[ve]));return Mt}function Z(Mt){return Mt&&Mt.__esModule&&Object.prototype.hasOwnProperty.call(Mt,"default")?Mt.default:Mt}function D(Mt,ve){return ve={exports:{}},Mt(ve,ve.exports),ve.exports}var $=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=ge;function ge(He){return He&&typeof He.length=="number"&&He.length>=0&&He.length%1===0}Mt.exports=ve.default});Z($);var te=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=function(ge){return function(){for(var He=[],ot=arguments.length;ot--;)He[ot]=arguments[ot];var we=He.pop();return ge.call(this,He,we)}},Mt.exports=ve.default});Z(te);var fe=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.fallback=ot,ve.wrap=we;var ge=ve.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,He=ve.hasNextTick=typeof b=="object"&&typeof b.nextTick=="function";function ot(C){setTimeout(C,0)}function we(C){return function(R){for(var q=[],ce=arguments.length-1;ce-- >0;)q[ce]=arguments[ce+1];return C(function(){return R.apply(void 0,q)})}}var gt;ge?gt=setImmediate:He?gt=b.nextTick:gt=ot,ve.default=we(gt)});Z(fe);var K=fe.fallback,Ge=fe.wrap,pe=fe.hasSetImmediate,Ze=fe.hasNextTick,Pe=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=we;var ge=ot(te),He=ot(fe);function ot(R){return R&&R.__esModule?R:{default:R}}function we(R){return(0,mt.isAsync)(R)?function(){for(var q=[],ce=arguments.length;ce--;)q[ce]=arguments[ce];var We=q.pop(),qe=R.apply(this,q);return gt(qe,We)}:(0,ge.default)(function(q,ce){var We;try{We=R.apply(this,q)}catch(qe){return ce(qe)}if(We&&typeof We.then=="function")return gt(We,ce);ce(null,We)})}function gt(R,q){return R.then(function(ce){C(q,null,ce)},function(ce){C(q,ce&&ce.message?ce:new Error(ce))})}function C(R,q,ce){try{R(q,ce)}catch(We){(0,He.default)(function(qe){throw qe},We)}}Mt.exports=ve.default});Z(Pe);var mt=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.isAsyncIterable=ve.isAsyncGenerator=ve.isAsync=void 0;var ge=He(Pe);function He(R){return R&&R.__esModule?R:{default:R}}function ot(R){return R[Symbol.toStringTag]==="AsyncFunction"}function we(R){return R[Symbol.toStringTag]==="AsyncGenerator"}function gt(R){return typeof R[Symbol.asyncIterator]=="function"}function C(R){if(typeof R!="function")throw new Error("expected a function");return ot(R)?(0,ge.default)(R):R}ve.default=C,ve.isAsync=ot,ve.isAsyncGenerator=we,ve.isAsyncIterable=gt});Z(mt);var De=mt.isAsyncIterable,At=mt.isAsyncGenerator,it=mt.isAsync,vt=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=ge;function ge(He,ot){if(ot===void 0&&(ot=He.length),!ot)throw new Error("arity is undefined");function we(){for(var gt=this,C=[],R=arguments.length;R--;)C[R]=arguments[R];return typeof C[ot-1]=="function"?He.apply(this,C):new Promise(function(q,ce){C[ot-1]=function(We){for(var qe=[],Tt=arguments.length-1;Tt-- >0;)qe[Tt]=arguments[Tt+1];if(We)return ce(We);q(qe.length>1?qe:qe[0])},He.apply(gt,C)})}return Object.defineProperty(we,"name",{configurable:!0,value:"awaitable("+He.name+")"}),we}Mt.exports=ve.default});Z(vt);var Je=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0});var ge=we($),He=we(mt),ot=we(vt);function we(gt){return gt&&gt.__esModule?gt:{default:gt}}ve.default=(0,ot.default)(function(gt,C,R){var q=(0,ge.default)(C)?[]:{};gt(C,function(ce,We,qe){(0,He.default)(ce)(function(Tt){for(var at,Ut=[],J=arguments.length-1;J-- >0;)Ut[J]=arguments[J+1];Ut.length<2&&(at=Ut,Ut=at[0]),q[We]=Ut,qe(Tt)})},function(ce){return R(ce,q)})},3),Mt.exports=ve.default});Z(Je);var _t=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=ge;function ge(He){function ot(){for(var we=[],gt=arguments.length;gt--;)we[gt]=arguments[gt];if(He===null)return;var C=He;He=null,C.apply(this,we)}return Object.assign(ot,He),ot}Mt.exports=ve.default});Z(_t);var wt=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=function(ge){return ge[Symbol.iterator]&&ge[Symbol.iterator]()},Mt.exports=ve.default});Z(wt);var ke=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=R;var ge=ot($),He=ot(wt);function ot(q){return q&&q.__esModule?q:{default:q}}function we(q){var ce=-1,We=q.length;return function(){return++ce<We?{value:q[ce],key:ce}:null}}function gt(q){var ce=-1;return function(){var qe=q.next();return qe.done?null:(ce++,{value:qe.value,key:ce})}}function C(q){var ce=q?Object.keys(q):[],We=-1,qe=ce.length;return function(){var at=ce[++We];return We<qe?{value:q[at],key:at}:null}}function R(q){if((0,ge.default)(q))return we(q);var ce=(0,He.default)(q);return ce?gt(ce):C(q)}Mt.exports=ve.default});Z(ke);var Re=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=ge;function ge(He){return function(){for(var ot=[],we=arguments.length;we--;)ot[we]=arguments[we];if(He===null)throw new Error("Callback was already called.");var gt=He;He=null,gt.apply(this,ot)}}Mt.exports=ve.default});Z(Re);var Ve=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0});var ge={};ve.default=ge,Mt.exports=ve.default});Z(Ve);var dt=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=ot;var ge=He(Ve);function He(we){return we&&we.__esModule?we:{default:we}}function ot(we,gt,C,R){var q=!1,ce=!1,We=!1,qe=0,Tt=0;function at(){if(qe>=gt||We||q)return;We=!0,we.next().then(function(Qe){var ne=Qe.value,et=Qe.done;if(ce||q)return;if(We=!1,et){q=!0,qe<=0&&R(null);return}qe++,C(ne,Tt,Ut),Tt++,at()}).catch(J)}function Ut(Qe,ne){if(qe-=1,ce)return;if(Qe)return J(Qe);if(Qe===!1){q=!0,ce=!0;return}if(ne===ge.default||q&&qe<=0)return q=!0,R(null);at()}function J(Qe){if(ce)return;We=!1,q=!0,R(Qe)}at()}Mt.exports=ve.default});Z(dt);var Me=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0});var ge=C(_t),He=C(ke),ot=C(Re),we=C(dt),gt=C(Ve);function C(R){return R&&R.__esModule?R:{default:R}}ve.default=function(R){return function(q,ce,We){if(We=(0,ge.default)(We),R<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!q)return We(null);if((0,mt.isAsyncGenerator)(q))return(0,we.default)(q,R,ce,We);if((0,mt.isAsyncIterable)(q))return(0,we.default)(q[Symbol.asyncIterator](),R,ce,We);var qe=(0,He.default)(q),Tt=!1,at=!1,Ut=0,J=!1;function Qe(et,kt){if(at)return;if(Ut-=1,et)Tt=!0,We(et);else if(et===!1)Tt=!0,at=!0;else{if(kt===gt.default||Tt&&Ut<=0)return Tt=!0,We(null);J||ne()}}function ne(){for(J=!0;Ut<R&&!Tt;){var et=qe();if(et===null){Tt=!0,Ut<=0&&We(null);return}Ut+=1,ce(et.value,et.key,(0,ot.default)(Qe))}J=!1}ne()}},Mt.exports=ve.default});Z(Me);var ht=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0});var ge=we(Me),He=we(mt),ot=we(vt);function we(C){return C&&C.__esModule?C:{default:C}}function gt(C,R,q,ce){return(0,ge.default)(R)(C,(0,He.default)(q),ce)}ve.default=(0,ot.default)(gt,4),Mt.exports=ve.default});Z(ht);var Zt=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0});var ge=ot(ht),He=ot(vt);function ot(gt){return gt&&gt.__esModule?gt:{default:gt}}function we(gt,C,R){return(0,ge.default)(gt,1,C,R)}ve.default=(0,He.default)(we,3),Mt.exports=ve.default});Z(Zt);var Qt=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=we;var ge=ot(Je),He=ot(Zt);function ot(gt){return gt&&gt.__esModule?gt:{default:gt}}function we(gt,C){return(0,ge.default)(He.default,gt,C)}Mt.exports=ve.default}),ur=Z(Qt),oe=function(){function Mt(){for(var ve=arguments,ge=[],He=0;He<arguments.length;He++)ge[He]=ve[He];this.args=[],this.tasks=[]}return Mt.prototype.call=function(){for(var ve=arguments,ge=[],He=0;He<arguments.length;He++)ge[He]=ve[He];return this.args=ge,ur(this.tasks)},Mt.prototype.tap=function(ve,ge){var He=this;this.tasks.push(function(ot){ge.apply(void 0,i(He.args)),ot(null,ve)})},Mt}(),Q=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0});var ge=q($),He=q(Ve),ot=q(ht),we=q(_t),gt=q(Re),C=q(mt),R=q(vt);function q(Tt){return Tt&&Tt.__esModule?Tt:{default:Tt}}function ce(Tt,at,Ut){Ut=(0,we.default)(Ut);var J=0,Qe=0,ne=Tt.length,et=!1;ne===0&&Ut(null);function kt(dr,Ye){if(dr===!1&&(et=!0),et===!0)return;dr?Ut(dr):(++Qe===ne||Ye===He.default)&&Ut(null)}for(;J<ne;J++)at(Tt[J],J,(0,gt.default)(kt))}function We(Tt,at,Ut){return(0,ot.default)(Tt,Infinity,at,Ut)}function qe(Tt,at,Ut){var J=(0,ge.default)(Tt)?ce:We;return J(Tt,(0,C.default)(at),Ut)}ve.default=(0,R.default)(qe,3),Mt.exports=ve.default});Z(Q);var H=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=we;var ge=ot(Q),He=ot(Je);function ot(gt){return gt&&gt.__esModule?gt:{default:gt}}function we(gt,C){return(0,He.default)(ge.default,gt,C)}Mt.exports=ve.default}),Se=Z(H),be=function(){function Mt(){for(var ve=arguments,ge=[],He=0;He<arguments.length;He++)ge[He]=ve[He];this.tasks=[]}return Mt.prototype.promise=function(){for(var ve=arguments,ge=[],He=0;He<arguments.length;He++)ge[He]=ve[He];return Se(this.tasks)},Mt.prototype.tapPromise=function(ve,ge){var He=this;this.tasks.push(function(ot){return m(He,void 0,void 0,function(){return Y(this,function(we){switch(we.label){case 0:return[4,ge()];case 1:return we.sent(),ot(null,ve),[2]}})})})},Mt}(),Te=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0});var ge=gt(_t),He=gt(Re),ot=gt(mt),we=gt(vt);function gt(R){return R&&R.__esModule?R:{default:R}}function C(R,q){if(q=(0,ge.default)(q),!Array.isArray(R))return q(new Error("First argument to waterfall must be an array of functions"));if(!R.length)return q();var ce=0;function We(Tt){var at=(0,ot.default)(R[ce++]);at.apply(void 0,Tt.concat([(0,He.default)(qe)]))}function qe(Tt){for(var at=[],Ut=arguments.length-1;Ut-- >0;)at[Ut]=arguments[Ut+1];if(Tt===!1)return;if(Tt||ce===R.length)return q.apply(void 0,[Tt].concat(at));We(at)}We([])}ve.default=(0,we.default)(C),Mt.exports=ve.default}),me=Z(Te),nt=function(){function Mt(){for(var ve=arguments,ge=[],He=0;He<arguments.length;He++)ge[He]=ve[He];this.tasks=[]}return Mt.prototype.call=function(){for(var ve=arguments,ge=[],He=0;He<arguments.length;He++)ge[He]=ve[He];return me(this.tasks)},Mt.prototype.tap=function(ve,ge){this.tasks.length===0?this.tasks.push(function(He){var ot=ge();He(ot?null:!1,ot)}):this.tasks.push(function(He,ot){var we=ge();ot(we?null:!1,ve)})},Mt}(),Jt=function(){function Mt(){for(var ve=arguments,ge=[],He=0;He<arguments.length;He++)ge[He]=ve[He];this.tasks=[]}return Mt.prototype.call=function(){for(var ve=arguments,ge=[],He=0;He<arguments.length;He++)ge[He]=ve[He];return ur(this.tasks)},Mt.prototype.tap=function(ve,ge){this.tasks.push(function(He){var ot=ge();He(ot,ve)})},Mt}()}).call(this,o("Q2Ig"))},yG8O:function(ze,E){function o(b,m,Y,F){if(!Y)return;Object.defineProperty(b,m,{enumerable:Y.enumerable,configurable:Y.configurable,writable:Y.writable,value:Y.initializer?Y.initializer.call(F):void 0})}ze.exports=o},yHx3:function(ze,E){var o=Object.prototype,b=o.hasOwnProperty;function m(Y){var F=Y.length,i=new Y.constructor(F);return F&&typeof Y[0]=="string"&&b.call(Y,"index")&&(i.index=Y.index,i.input=Y.input),i}ze.exports=m},yLV6:function(ze,E,o){var b;/*! Hammer.JS - v2.0.7 - 2016-04-22
* http://hammerjs.github.io/
*
* Copyright (c) 2016 Jorik Tangelder;
* Licensed under the MIT license */(function(m,Y,F,i){"use strict";var Z=["","webkit","Moz","MS","ms","o"],D=Y.createElement("div"),$="function",te=Math.round,fe=Math.abs,K=Date.now;function Ge(Vt,Le,Dt){return setTimeout(vt(Vt,Dt),Le)}function pe(Vt,Le,Dt){return Array.isArray(Vt)?(Ze(Vt,Dt[Le],Dt),!0):!1}function Ze(Vt,Le,Dt){var mr;if(!Vt)return;if(Vt.forEach)Vt.forEach(Le,Dt);else if(Vt.length!==i)for(mr=0;mr<Vt.length;)Le.call(Dt,Vt[mr],mr,Vt),mr++;else for(mr in Vt)Vt.hasOwnProperty(mr)&&Le.call(Dt,Vt[mr],mr,Vt)}function Pe(Vt,Le,Dt){var mr="DEPRECATED METHOD: "+Le+`
`+Dt+` AT 
`;return function(){var Qr=new Error("get-stack-trace"),En=Qr&&Qr.stack?Qr.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Vn=m.console&&(m.console.warn||m.console.log);return Vn&&Vn.call(m.console,mr,En),Vt.apply(this,arguments)}}var mt;typeof Object.assign!="function"?mt=function(Le){if(Le===i||Le===null)throw new TypeError("Cannot convert undefined or null to object");for(var Dt=Object(Le),mr=1;mr<arguments.length;mr++){var Qr=arguments[mr];if(Qr!==i&&Qr!==null)for(var En in Qr)Qr.hasOwnProperty(En)&&(Dt[En]=Qr[En])}return Dt}:mt=Object.assign;var De=Pe(function(Le,Dt,mr){for(var Qr=Object.keys(Dt),En=0;En<Qr.length;)(!mr||mr&&Le[Qr[En]]===i)&&(Le[Qr[En]]=Dt[Qr[En]]),En++;return Le},"extend","Use `assign`."),At=Pe(function(Le,Dt){return De(Le,Dt,!0)},"merge","Use `assign`.");function it(Vt,Le,Dt){var mr=Le.prototype,Qr;Qr=Vt.prototype=Object.create(mr),Qr.constructor=Vt,Qr._super=mr,Dt&&mt(Qr,Dt)}function vt(Vt,Le){return function(){return Vt.apply(Le,arguments)}}function Je(Vt,Le){return typeof Vt==$?Vt.apply(Le&&Le[0]||i,Le):Vt}function _t(Vt,Le){return Vt===i?Le:Vt}function wt(Vt,Le,Dt){Ze(dt(Le),function(mr){Vt.addEventListener(mr,Dt,!1)})}function ke(Vt,Le,Dt){Ze(dt(Le),function(mr){Vt.removeEventListener(mr,Dt,!1)})}function Re(Vt,Le){for(;Vt;){if(Vt==Le)return!0;Vt=Vt.parentNode}return!1}function Ve(Vt,Le){return Vt.indexOf(Le)>-1}function dt(Vt){return Vt.trim().split(/\s+/g)}function Me(Vt,Le,Dt){if(Vt.indexOf&&!Dt)return Vt.indexOf(Le);for(var mr=0;mr<Vt.length;){if(Dt&&Vt[mr][Dt]==Le||!Dt&&Vt[mr]===Le)return mr;mr++}return-1}function ht(Vt){return Array.prototype.slice.call(Vt,0)}function Zt(Vt,Le,Dt){for(var mr=[],Qr=[],En=0;En<Vt.length;){var Vn=Le?Vt[En][Le]:Vt[En];Me(Qr,Vn)<0&&mr.push(Vt[En]),Qr[En]=Vn,En++}return Dt&&(Le?mr=mr.sort(function(po,mo){return po[Le]>mo[Le]}):mr=mr.sort()),mr}function Qt(Vt,Le){for(var Dt,mr,Qr=Le[0].toUpperCase()+Le.slice(1),En=0;En<Z.length;){if(Dt=Z[En],mr=Dt?Dt+Qr:Le,mr in Vt)return mr;En++}return i}var ur=1;function oe(){return ur++}function Q(Vt){var Le=Vt.ownerDocument||Vt;return Le.defaultView||Le.parentWindow||m}var H=/mobile|tablet|ip(ad|hone|od)|android/i,Se="ontouchstart"in m,be=Qt(m,"PointerEvent")!==i,Te=Se&&H.test(navigator.userAgent),me="touch",nt="pen",Jt="mouse",Mt="kinect",ve=25,ge=1,He=2,ot=4,we=8,gt=1,C=2,R=4,q=8,ce=16,We=C|R,qe=q|ce,Tt=We|qe,at=["x","y"],Ut=["clientX","clientY"];function J(Vt,Le){var Dt=this;this.manager=Vt,this.callback=Le,this.element=Vt.element,this.target=Vt.options.inputTarget,this.domHandler=function(mr){Je(Vt.options.enable,[Vt])&&Dt.handler(mr)},this.init()}J.prototype={handler:function(){},init:function(){this.evEl&&wt(this.element,this.evEl,this.domHandler),this.evTarget&&wt(this.target,this.evTarget,this.domHandler),this.evWin&&wt(Q(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&ke(this.element,this.evEl,this.domHandler),this.evTarget&&ke(this.target,this.evTarget,this.domHandler),this.evWin&&ke(Q(this.element),this.evWin,this.domHandler)}};function Qe(Vt){var Le,Dt=Vt.options.inputClass;return Dt?Le=Dt:be?Le=On:Te?Le=Xe:Se?Le=Vr:Le=Bn,new Le(Vt,ne)}function ne(Vt,Le,Dt){var mr=Dt.pointers.length,Qr=Dt.changedPointers.length,En=Le&ge&&mr-Qr===0,Vn=Le&(ot|we)&&mr-Qr===0;Dt.isFirst=!!En,Dt.isFinal=!!Vn,En&&(Vt.session={}),Dt.eventType=Le,et(Vt,Dt),Vt.emit("hammer.input",Dt),Vt.recognize(Dt),Vt.session.prevInput=Dt}function et(Vt,Le){var Dt=Vt.session,mr=Le.pointers,Qr=mr.length;Dt.firstInput||(Dt.firstInput=Ye(Le)),Qr>1&&!Dt.firstMultiple?Dt.firstMultiple=Ye(Le):Qr===1&&(Dt.firstMultiple=!1);var En=Dt.firstInput,Vn=Dt.firstMultiple,Ci=Vn?Vn.center:En.center,po=Le.center=xt(mr);Le.timeStamp=K(),Le.deltaTime=Le.timeStamp-En.timeStamp,Le.angle=pt(Ci,po),Le.distance=Fe(Ci,po),kt(Dt,Le),Le.offsetDirection=Et(Le.deltaX,Le.deltaY);var mo=bt(Le.deltaTime,Le.deltaX,Le.deltaY);Le.overallVelocityX=mo.x,Le.overallVelocityY=mo.y,Le.overallVelocity=fe(mo.x)>fe(mo.y)?mo.x:mo.y,Le.scale=Vn?Ht(Vn.pointers,mr):1,Le.rotation=Vn?yt(Vn.pointers,mr):0,Le.maxPointers=Dt.prevInput?Le.pointers.length>Dt.prevInput.maxPointers?Le.pointers.length:Dt.prevInput.maxPointers:Le.pointers.length,dr(Dt,Le);var Oo=Vt.element;Re(Le.srcEvent.target,Oo)&&(Oo=Le.srcEvent.target),Le.target=Oo}function kt(Vt,Le){var Dt=Le.center,mr=Vt.offsetDelta||{},Qr=Vt.prevDelta||{},En=Vt.prevInput||{};(Le.eventType===ge||En.eventType===ot)&&(Qr=Vt.prevDelta={x:En.deltaX||0,y:En.deltaY||0},mr=Vt.offsetDelta={x:Dt.x,y:Dt.y}),Le.deltaX=Qr.x+(Dt.x-mr.x),Le.deltaY=Qr.y+(Dt.y-mr.y)}function dr(Vt,Le){var Dt=Vt.lastInterval||Le,mr=Le.timeStamp-Dt.timeStamp,Qr,En,Vn,Ci;if(Le.eventType!=we&&(mr>ve||Dt.velocity===i)){var po=Le.deltaX-Dt.deltaX,mo=Le.deltaY-Dt.deltaY,Oo=bt(mr,po,mo);En=Oo.x,Vn=Oo.y,Qr=fe(Oo.x)>fe(Oo.y)?Oo.x:Oo.y,Ci=Et(po,mo),Vt.lastInterval=Le}else Qr=Dt.velocity,En=Dt.velocityX,Vn=Dt.velocityY,Ci=Dt.direction;Le.velocity=Qr,Le.velocityX=En,Le.velocityY=Vn,Le.direction=Ci}function Ye(Vt){for(var Le=[],Dt=0;Dt<Vt.pointers.length;)Le[Dt]={clientX:te(Vt.pointers[Dt].clientX),clientY:te(Vt.pointers[Dt].clientY)},Dt++;return{timeStamp:K(),pointers:Le,center:xt(Le),deltaX:Vt.deltaX,deltaY:Vt.deltaY}}function xt(Vt){var Le=Vt.length;if(Le===1)return{x:te(Vt[0].clientX),y:te(Vt[0].clientY)};for(var Dt=0,mr=0,Qr=0;Qr<Le;)Dt+=Vt[Qr].clientX,mr+=Vt[Qr].clientY,Qr++;return{x:te(Dt/Le),y:te(mr/Le)}}function bt(Vt,Le,Dt){return{x:Le/Vt||0,y:Dt/Vt||0}}function Et(Vt,Le){return Vt===Le?gt:fe(Vt)>=fe(Le)?Vt<0?C:R:Le<0?q:ce}function Fe(Vt,Le,Dt){Dt||(Dt=at);var mr=Le[Dt[0]]-Vt[Dt[0]],Qr=Le[Dt[1]]-Vt[Dt[1]];return Math.sqrt(mr*mr+Qr*Qr)}function pt(Vt,Le,Dt){Dt||(Dt=at);var mr=Le[Dt[0]]-Vt[Dt[0]],Qr=Le[Dt[1]]-Vt[Dt[1]];return Math.atan2(Qr,mr)*180/Math.PI}function yt(Vt,Le){return pt(Le[1],Le[0],Ut)+pt(Vt[1],Vt[0],Ut)}function Ht(Vt,Le){return Fe(Le[0],Le[1],Ut)/Fe(Vt[0],Vt[1],Ut)}var hr={mousedown:ge,mousemove:He,mouseup:ot},Hr="mousedown",gr="mousemove mouseup";function Bn(){this.evEl=Hr,this.evWin=gr,this.pressed=!1,J.apply(this,arguments)}it(Bn,J,{handler:function(Le){var Dt=hr[Le.type];if(Dt&ge&&Le.button===0&&(this.pressed=!0),Dt&He&&Le.which!==1&&(Dt=ot),!this.pressed)return;Dt&ot&&(this.pressed=!1),this.callback(this.manager,Dt,{pointers:[Le],changedPointers:[Le],pointerType:Jt,srcEvent:Le})}});var zn={pointerdown:ge,pointermove:He,pointerup:ot,pointercancel:we,pointerout:we},oa={2:me,3:nt,4:Jt,5:Mt},$n="pointerdown",Yn="pointermove pointerup pointercancel";m.MSPointerEvent&&!m.PointerEvent&&($n="MSPointerDown",Yn="MSPointerMove MSPointerUp MSPointerCancel");function On(){this.evEl=$n,this.evWin=Yn,J.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}it(On,J,{handler:function(Le){var Dt=this.store,mr=!1,Qr=Le.type.toLowerCase().replace("ms",""),En=zn[Qr],Vn=oa[Le.pointerType]||Le.pointerType,Ci=Vn==me,po=Me(Dt,Le.pointerId,"pointerId");if(En&ge&&(Le.button===0||Ci)?po<0&&(Dt.push(Le),po=Dt.length-1):En&(ot|we)&&(mr=!0),po<0)return;Dt[po]=Le,this.callback(this.manager,En,{pointers:Dt,changedPointers:[Le],pointerType:Vn,srcEvent:Le}),mr&&Dt.splice(po,1)}});var U={touchstart:ge,touchmove:He,touchend:ot,touchcancel:we},W="touchstart",le="touchstart touchmove touchend touchcancel";function xe(){this.evTarget=W,this.evWin=le,this.started=!1,J.apply(this,arguments)}it(xe,J,{handler:function(Le){var Dt=U[Le.type];if(Dt===ge&&(this.started=!0),!this.started)return;var mr=st.call(this,Le,Dt);Dt&(ot|we)&&mr[0].length-mr[1].length===0&&(this.started=!1),this.callback(this.manager,Dt,{pointers:mr[0],changedPointers:mr[1],pointerType:me,srcEvent:Le})}});function st(Vt,Le){var Dt=ht(Vt.touches),mr=ht(Vt.changedTouches);return Le&(ot|we)&&(Dt=Zt(Dt.concat(mr),"identifier",!0)),[Dt,mr]}var Ct={touchstart:ge,touchmove:He,touchend:ot,touchcancel:we},Bt="touchstart touchmove touchend touchcancel";function Xe(){this.evTarget=Bt,this.targetIds={},J.apply(this,arguments)}it(Xe,J,{handler:function(Le){var Dt=Ct[Le.type],mr=Lt.call(this,Le,Dt);if(!mr)return;this.callback(this.manager,Dt,{pointers:mr[0],changedPointers:mr[1],pointerType:me,srcEvent:Le})}});function Lt(Vt,Le){var Dt=ht(Vt.touches),mr=this.targetIds;if(Le&(ge|He)&&Dt.length===1)return mr[Dt[0].identifier]=!0,[Dt,Dt];var Qr,En,Vn=ht(Vt.changedTouches),Ci=[],po=this.target;if(En=Dt.filter(function(mo){return Re(mo.target,po)}),Le===ge)for(Qr=0;Qr<En.length;)mr[En[Qr].identifier]=!0,Qr++;for(Qr=0;Qr<Vn.length;)mr[Vn[Qr].identifier]&&Ci.push(Vn[Qr]),Le&(ot|we)&&delete mr[Vn[Qr].identifier],Qr++;return Ci.length?[Zt(En.concat(Ci),"identifier",!0),Ci]:void 0}var lr=2500,zr=25;function Vr(){J.apply(this,arguments);var Vt=vt(this.handler,this);this.touch=new Xe(this.manager,Vt),this.mouse=new Bn(this.manager,Vt),this.primaryTouch=null,this.lastTouches=[]}it(Vr,J,{handler:function(Le,Dt,mr){var Qr=mr.pointerType==me,En=mr.pointerType==Jt;if(En&&mr.sourceCapabilities&&mr.sourceCapabilities.firesTouchEvents)return;if(Qr)cr.call(this,Dt,mr);else if(En&&Mn.call(this,mr))return;this.callback(Le,Dt,mr)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function cr(Vt,Le){Vt&ge?(this.primaryTouch=Le.changedPointers[0].identifier,Ur.call(this,Le)):Vt&(ot|we)&&Ur.call(this,Le)}function Ur(Vt){var Le=Vt.changedPointers[0];if(Le.identifier===this.primaryTouch){var Dt={x:Le.clientX,y:Le.clientY};this.lastTouches.push(Dt);var mr=this.lastTouches,Qr=function(){var Vn=mr.indexOf(Dt);Vn>-1&&mr.splice(Vn,1)};setTimeout(Qr,lr)}}function Mn(Vt){for(var Le=Vt.srcEvent.clientX,Dt=Vt.srcEvent.clientY,mr=0;mr<this.lastTouches.length;mr++){var Qr=this.lastTouches[mr],En=Math.abs(Le-Qr.x),Vn=Math.abs(Dt-Qr.y);if(En<=zr&&Vn<=zr)return!0}return!1}var ln=Qt(D.style,"touchAction"),er=ln!==i,tn="compute",hn="auto",xn="manipulation",yn="none",vn="pan-x",Pn="pan-y",Va=Ia();function va(Vt,Le){this.manager=Vt,this.set(Le)}va.prototype={set:function(Le){Le==tn&&(Le=this.compute()),er&&this.manager.element.style&&Va[Le]&&(this.manager.element.style[ln]=Le),this.actions=Le.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Le=[];return Ze(this.manager.recognizers,function(Dt){Je(Dt.options.enable,[Dt])&&(Le=Le.concat(Dt.getTouchAction()))}),Ma(Le.join(" "))},preventDefaults:function(Le){var Dt=Le.srcEvent,mr=Le.offsetDirection;if(this.manager.session.prevented){Dt.preventDefault();return}var Qr=this.actions,En=Ve(Qr,yn)&&!Va[yn],Vn=Ve(Qr,Pn)&&!Va[Pn],Ci=Ve(Qr,vn)&&!Va[vn];if(En){var po=Le.pointers.length===1,mo=Le.distance<2,Oo=Le.deltaTime<250;if(po&&mo&&Oo)return}if(Ci&&Vn)return;if(En||Vn&&mr&We||Ci&&mr&qe)return this.preventSrc(Dt)},preventSrc:function(Le){this.manager.session.prevented=!0,Le.preventDefault()}};function Ma(Vt){if(Ve(Vt,yn))return yn;var Le=Ve(Vt,vn),Dt=Ve(Vt,Pn);return Le&&Dt?yn:Le||Dt?Le?vn:Pn:Ve(Vt,xn)?xn:hn}function Ia(){if(!er)return!1;var Vt={},Le=m.CSS&&m.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Dt){Vt[Dt]=Le?m.CSS.supports("touch-action",Dt):!0}),Vt}var Wi=1,da=2,di=4,ga=8,ya=ga,fa=16,Si=32;function ns(Vt){this.options=mt({},this.defaults,Vt||{}),this.id=oe(),this.manager=null,this.options.enable=_t(this.options.enable,!0),this.state=Wi,this.simultaneous={},this.requireFail=[]}ns.prototype={defaults:{},set:function(Le){return mt(this.options,Le),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Le){if(pe(Le,"recognizeWith",this))return this;var Dt=this.simultaneous;return Le=ju(Le,this),Dt[Le.id]||(Dt[Le.id]=Le,Le.recognizeWith(this)),this},dropRecognizeWith:function(Le){return pe(Le,"dropRecognizeWith",this)?this:(Le=ju(Le,this),delete this.simultaneous[Le.id],this)},requireFailure:function(Le){if(pe(Le,"requireFailure",this))return this;var Dt=this.requireFail;return Le=ju(Le,this),Me(Dt,Le)===-1&&(Dt.push(Le),Le.requireFailure(this)),this},dropRequireFailure:function(Le){if(pe(Le,"dropRequireFailure",this))return this;Le=ju(Le,this);var Dt=Me(this.requireFail,Le);return Dt>-1&&this.requireFail.splice(Dt,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Le){return!!this.simultaneous[Le.id]},emit:function(Le){var Dt=this,mr=this.state;function Qr(En){Dt.manager.emit(En,Le)}mr<ga&&Qr(Dt.options.event+Xi(mr)),Qr(Dt.options.event),Le.additionalEvent&&Qr(Le.additionalEvent),mr>=ga&&Qr(Dt.options.event+Xi(mr))},tryEmit:function(Le){if(this.canEmit())return this.emit(Le);this.state=Si},canEmit:function(){for(var Le=0;Le<this.requireFail.length;){if(!(this.requireFail[Le].state&(Si|Wi)))return!1;Le++}return!0},recognize:function(Le){var Dt=mt({},Le);if(!Je(this.options.enable,[this,Dt])){this.reset(),this.state=Si;return}this.state&(ya|fa|Si)&&(this.state=Wi),this.state=this.process(Dt),this.state&(da|di|ga|fa)&&this.tryEmit(Dt)},process:function(Le){},getTouchAction:function(){},reset:function(){}};function Xi(Vt){return Vt&fa?"cancel":Vt&ga?"end":Vt&di?"move":Vt&da?"start":""}function Vo(Vt){return Vt==ce?"down":Vt==q?"up":Vt==C?"left":Vt==R?"right":""}function ju(Vt,Le){var Dt=Le.manager;return Dt?Dt.get(Vt):Vt}function Ga(){ns.apply(this,arguments)}it(Ga,ns,{defaults:{pointers:1},attrTest:function(Le){var Dt=this.options.pointers;return Dt===0||Le.pointers.length===Dt},process:function(Le){var Dt=this.state,mr=Le.eventType,Qr=Dt&(da|di),En=this.attrTest(Le);return Qr&&(mr&we||!En)?Dt|fa:Qr||En?mr&ot?Dt|ga:Dt&da?Dt|di:da:Si}});function Ai(){Ga.apply(this,arguments),this.pX=null,this.pY=null}it(Ai,Ga,{defaults:{event:"pan",threshold:10,pointers:1,direction:Tt},getTouchAction:function(){var Le=this.options.direction,Dt=[];return Le&We&&Dt.push(Pn),Le&qe&&Dt.push(vn),Dt},directionTest:function(Le){var Dt=this.options,mr=!0,Qr=Le.distance,En=Le.direction,Vn=Le.deltaX,Ci=Le.deltaY;return En&Dt.direction||(Dt.direction&We?(En=Vn===0?gt:Vn<0?C:R,mr=Vn!=this.pX,Qr=Math.abs(Le.deltaX)):(En=Ci===0?gt:Ci<0?q:ce,mr=Ci!=this.pY,Qr=Math.abs(Le.deltaY))),Le.direction=En,mr&&Qr>Dt.threshold&&En&Dt.direction},attrTest:function(Le){return Ga.prototype.attrTest.call(this,Le)&&(this.state&da||!(this.state&da)&&this.directionTest(Le))},emit:function(Le){this.pX=Le.deltaX,this.pY=Le.deltaY;var Dt=Vo(Le.direction);Dt&&(Le.additionalEvent=this.options.event+Dt),this._super.emit.call(this,Le)}});function Ko(){Ga.apply(this,arguments)}it(Ko,Ga,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[yn]},attrTest:function(Le){return this._super.attrTest.call(this,Le)&&(Math.abs(Le.scale-1)>this.options.threshold||this.state&da)},emit:function(Le){if(Le.scale!==1){var Dt=Le.scale<1?"in":"out";Le.additionalEvent=this.options.event+Dt}this._super.emit.call(this,Le)}});function oi(){ns.apply(this,arguments),this._timer=null,this._input=null}it(oi,ns,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[hn]},process:function(Le){var Dt=this.options,mr=Le.pointers.length===Dt.pointers,Qr=Le.distance<Dt.threshold,En=Le.deltaTime>Dt.time;if(this._input=Le,!Qr||!mr||Le.eventType&(ot|we)&&!En)this.reset();else if(Le.eventType&ge)this.reset(),this._timer=Ge(function(){this.state=ya,this.tryEmit()},Dt.time,this);else if(Le.eventType&ot)return ya;return Si},reset:function(){clearTimeout(this._timer)},emit:function(Le){if(this.state!==ya)return;Le&&Le.eventType&ot?this.manager.emit(this.options.event+"up",Le):(this._input.timeStamp=K(),this.manager.emit(this.options.event,this._input))}});function Yi(){Ga.apply(this,arguments)}it(Yi,Ga,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[yn]},attrTest:function(Le){return this._super.attrTest.call(this,Le)&&(Math.abs(Le.rotation)>this.options.threshold||this.state&da)}});function wo(){Ga.apply(this,arguments)}it(wo,Ga,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:We|qe,pointers:1},getTouchAction:function(){return Ai.prototype.getTouchAction.call(this)},attrTest:function(Le){var Dt=this.options.direction,mr;return Dt&(We|qe)?mr=Le.overallVelocity:Dt&We?mr=Le.overallVelocityX:Dt&qe&&(mr=Le.overallVelocityY),this._super.attrTest.call(this,Le)&&Dt&Le.offsetDirection&&Le.distance>this.options.threshold&&Le.maxPointers==this.options.pointers&&fe(mr)>this.options.velocity&&Le.eventType&ot},emit:function(Le){var Dt=Vo(Le.offsetDirection);Dt&&this.manager.emit(this.options.event+Dt,Le),this.manager.emit(this.options.event,Le)}});function Ha(){ns.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}it(Ha,ns,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[xn]},process:function(Le){var Dt=this.options,mr=Le.pointers.length===Dt.pointers,Qr=Le.distance<Dt.threshold,En=Le.deltaTime<Dt.time;if(this.reset(),Le.eventType&ge&&this.count===0)return this.failTimeout();if(Qr&&En&&mr){if(Le.eventType!=ot)return this.failTimeout();var Vn=this.pTime?Le.timeStamp-this.pTime<Dt.interval:!0,Ci=!this.pCenter||Fe(this.pCenter,Le.center)<Dt.posThreshold;this.pTime=Le.timeStamp,this.pCenter=Le.center,!Ci||!Vn?this.count=1:this.count+=1,this._input=Le;var po=this.count%Dt.taps;if(po===0)return this.hasRequireFailures()?(this._timer=Ge(function(){this.state=ya,this.tryEmit()},Dt.interval,this),da):ya}return Si},failTimeout:function(){return this._timer=Ge(function(){this.state=Si},this.options.interval,this),Si},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ya&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function oo(Vt,Le){return Le=Le||{},Le.recognizers=_t(Le.recognizers,oo.defaults.preset),new $o(Vt,Le)}oo.VERSION="2.0.7",oo.defaults={domEvents:!1,touchAction:tn,enable:!0,inputTarget:null,inputClass:null,preset:[[Yi,{enable:!1}],[Ko,{enable:!1},["rotate"]],[wo,{direction:We}],[Ai,{direction:We},["swipe"]],[Ha],[Ha,{event:"doubletap",taps:2},["tap"]],[oi]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var so=1,Eu=2;function $o(Vt,Le){this.options=mt({},oo.defaults,Le||{}),this.options.inputTarget=this.options.inputTarget||Vt,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Vt,this.input=Qe(this),this.touchAction=new va(this,this.options.touchAction),Kl(this,!0),Ze(this.options.recognizers,function(Dt){var mr=this.add(new Dt[0](Dt[1]));Dt[2]&&mr.recognizeWith(Dt[2]),Dt[3]&&mr.requireFailure(Dt[3])},this)}$o.prototype={set:function(Le){return mt(this.options,Le),Le.touchAction&&this.touchAction.update(),Le.inputTarget&&(this.input.destroy(),this.input.target=Le.inputTarget,this.input.init()),this},stop:function(Le){this.session.stopped=Le?Eu:so},recognize:function(Le){var Dt=this.session;if(Dt.stopped)return;this.touchAction.preventDefaults(Le);var mr,Qr=this.recognizers,En=Dt.curRecognizer;(!En||En&&En.state&ya)&&(En=Dt.curRecognizer=null);for(var Vn=0;Vn<Qr.length;)mr=Qr[Vn],Dt.stopped!==Eu&&(!En||mr==En||mr.canRecognizeWith(En))?mr.recognize(Le):mr.reset(),!En&&mr.state&(da|di|ga)&&(En=Dt.curRecognizer=mr),Vn++},get:function(Le){if(Le instanceof ns)return Le;for(var Dt=this.recognizers,mr=0;mr<Dt.length;mr++)if(Dt[mr].options.event==Le)return Dt[mr];return null},add:function(Le){if(pe(Le,"add",this))return this;var Dt=this.get(Le.options.event);return Dt&&this.remove(Dt),this.recognizers.push(Le),Le.manager=this,this.touchAction.update(),Le},remove:function(Le){if(pe(Le,"remove",this))return this;if(Le=this.get(Le),Le){var Dt=this.recognizers,mr=Me(Dt,Le);mr!==-1&&(Dt.splice(mr,1),this.touchAction.update())}return this},on:function(Le,Dt){if(Le===i)return;if(Dt===i)return;var mr=this.handlers;return Ze(dt(Le),function(Qr){mr[Qr]=mr[Qr]||[],mr[Qr].push(Dt)}),this},off:function(Le,Dt){if(Le===i)return;var mr=this.handlers;return Ze(dt(Le),function(Qr){Dt?mr[Qr]&&mr[Qr].splice(Me(mr[Qr],Dt),1):delete mr[Qr]}),this},emit:function(Le,Dt){this.options.domEvents&&ks(Le,Dt);var mr=this.handlers[Le]&&this.handlers[Le].slice();if(!mr||!mr.length)return;Dt.type=Le,Dt.preventDefault=function(){Dt.srcEvent.preventDefault()};for(var Qr=0;Qr<mr.length;)mr[Qr](Dt),Qr++},destroy:function(){this.element&&Kl(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Kl(Vt,Le){var Dt=Vt.element;if(!Dt.style)return;var mr;Ze(Vt.options.cssProps,function(Qr,En){mr=Qt(Dt.style,En),Le?(Vt.oldCssProps[mr]=Dt.style[mr],Dt.style[mr]=Qr):Dt.style[mr]=Vt.oldCssProps[mr]||""}),Le||(Vt.oldCssProps={})}function ks(Vt,Le){var Dt=Y.createEvent("Event");Dt.initEvent(Vt,!0,!0),Dt.gesture=Le,Le.target.dispatchEvent(Dt)}mt(oo,{INPUT_START:ge,INPUT_MOVE:He,INPUT_END:ot,INPUT_CANCEL:we,STATE_POSSIBLE:Wi,STATE_BEGAN:da,STATE_CHANGED:di,STATE_ENDED:ga,STATE_RECOGNIZED:ya,STATE_CANCELLED:fa,STATE_FAILED:Si,DIRECTION_NONE:gt,DIRECTION_LEFT:C,DIRECTION_RIGHT:R,DIRECTION_UP:q,DIRECTION_DOWN:ce,DIRECTION_HORIZONTAL:We,DIRECTION_VERTICAL:qe,DIRECTION_ALL:Tt,Manager:$o,Input:J,TouchAction:va,TouchInput:Xe,MouseInput:Bn,PointerEventInput:On,TouchMouseInput:Vr,SingleTouchInput:xe,Recognizer:ns,AttrRecognizer:Ga,Tap:Ha,Pan:Ai,Swipe:wo,Pinch:Ko,Rotate:Yi,Press:oi,on:wt,off:ke,each:Ze,merge:At,extend:De,assign:mt,inherit:it,bindFn:vt,prefixed:Qt});var ho=typeof m!="undefined"?m:typeof self!="undefined"?self:{};ho.Hammer=oo,!(b=function(){return oo}.call(E,o,E,ze),b!==i&&(ze.exports=b))})(window,document,"Hammer")},yMAV:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=function(){function m(Y,F){this.parentContext=Y,this.rootRequest=F}return m}();E.Plan=b},yP5f:function(ze,E,o){var b=o("+K+b");function m(Y,F){var i=F?b(Y.buffer):Y.buffer;return new Y.constructor(i,Y.byteOffset,Y.length)}ze.exports=m},yU0y:function(ze,E,o){"use strict";o.d(E,"b",function(){return b}),o.d(E,"a",function(){return m}),o.d(E,"c",function(){return Y});var b=1e-6,m=typeof Float32Array!="undefined"?Float32Array:Array,Y=Math.random;function F($){m=$}var i=Math.PI/180;function Z($){return $*i}function D($,te){return Math.abs($-te)<=b*Math.max(1,Math.abs($),Math.abs(te))}Math.hypot||(Math.hypot=function(){for(var $=0,te=arguments.length;te--;)$+=arguments[te]*arguments[te];return Math.sqrt($)})},yXPU:function(ze,E){function o(m,Y,F,i,Z,D,$){try{var te=m[D]($),fe=te.value}catch(K){F(K);return}te.done?Y(fe):Promise.resolve(fe).then(i,Z)}function b(m){return function(){var Y=this,F=arguments;return new Promise(function(i,Z){var D=m.apply(Y,F);function $(fe){o(D,i,Z,$,te,"next",fe)}function te(fe){o(D,i,Z,$,te,"throw",fe)}$(void 0)})}}ze.exports=b},ycre:function(ze,E,o){var b=o("711d"),m=b("length");ze.exports=m},z4Hk:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=o("406g"),m=o("RR/i"),Y=function(){function F(i){this._binding=i}return F.prototype.when=function(i){return this._binding.constraint=i,new b.BindingOnSyntax(this._binding)},F.prototype.whenTargetNamed=function(i){return this._binding.constraint=m.namedConstraint(i),new b.BindingOnSyntax(this._binding)},F.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(i){var Z=i.target!==null&&!i.target.isNamed()&&!i.target.isTagged();return Z},new b.BindingOnSyntax(this._binding)},F.prototype.whenTargetTagged=function(i,Z){return this._binding.constraint=m.taggedConstraint(i)(Z),new b.BindingOnSyntax(this._binding)},F.prototype.whenInjectedInto=function(i){return this._binding.constraint=function(Z){return m.typeConstraint(i)(Z.parentRequest)},new b.BindingOnSyntax(this._binding)},F.prototype.whenParentNamed=function(i){return this._binding.constraint=function(Z){return m.namedConstraint(i)(Z.parentRequest)},new b.BindingOnSyntax(this._binding)},F.prototype.whenParentTagged=function(i,Z){return this._binding.constraint=function(D){return m.taggedConstraint(i)(Z)(D.parentRequest)},new b.BindingOnSyntax(this._binding)},F.prototype.whenAnyAncestorIs=function(i){return this._binding.constraint=function(Z){return m.traverseAncerstors(Z,m.typeConstraint(i))},new b.BindingOnSyntax(this._binding)},F.prototype.whenNoAncestorIs=function(i){return this._binding.constraint=function(Z){return!m.traverseAncerstors(Z,m.typeConstraint(i))},new b.BindingOnSyntax(this._binding)},F.prototype.whenAnyAncestorNamed=function(i){return this._binding.constraint=function(Z){return m.traverseAncerstors(Z,m.namedConstraint(i))},new b.BindingOnSyntax(this._binding)},F.prototype.whenNoAncestorNamed=function(i){return this._binding.constraint=function(Z){return!m.traverseAncerstors(Z,m.namedConstraint(i))},new b.BindingOnSyntax(this._binding)},F.prototype.whenAnyAncestorTagged=function(i,Z){return this._binding.constraint=function(D){return m.traverseAncerstors(D,m.taggedConstraint(i)(Z))},new b.BindingOnSyntax(this._binding)},F.prototype.whenNoAncestorTagged=function(i,Z){return this._binding.constraint=function(D){return!m.traverseAncerstors(D,m.taggedConstraint(i)(Z))},new b.BindingOnSyntax(this._binding)},F.prototype.whenAnyAncestorMatches=function(i){return this._binding.constraint=function(Z){return m.traverseAncerstors(Z,i)},new b.BindingOnSyntax(this._binding)},F.prototype.whenNoAncestorMatches=function(i){return this._binding.constraint=function(Z){return!m.traverseAncerstors(Z,i)},new b.BindingOnSyntax(this._binding)},F}();E.BindingWhenSyntax=Y},zEVN:function(ze,E,o){var b=o("Gi0A"),m=o("sEf8"),Y=o("mdPL"),F=Y&&Y.isMap,i=F?m(F):b;ze.exports=i},zZ0H:function(ze,E){function o(b){return b}ze.exports=o},zZPE:function(ze,E){var o="[object Object]";function b(Ge){var pe=!1;if(Ge!=null&&typeof Ge.toString!="function")try{pe=!!(Ge+"")}catch(Ze){}return pe}function m(Ge,pe){return function(Ze){return Ge(pe(Ze))}}var Y=Function.prototype,F=Object.prototype,i=Y.toString,Z=F.hasOwnProperty,D=i.call(Object),$=F.toString,te=m(Object.getPrototypeOf,Object);function fe(Ge){return!!Ge&&typeof Ge=="object"}function K(Ge){if(!fe(Ge)||$.call(Ge)!=o||b(Ge))return!1;var pe=te(Ge);if(pe===null)return!0;var Ze=Z.call(pe,"constructor")&&pe.constructor;return typeof Ze=="function"&&Ze instanceof Ze&&i.call(Ze)==D}ze.exports=K},zoYe:function(ze,E,o){var b=o("nmnc"),m=o("eUgh"),Y=o("Z0cm"),F=o("/9aa"),i=1/0,Z=b?b.prototype:void 0,D=Z?Z.toString:void 0;function $(te){if(typeof te=="string")return te;if(Y(te))return m(te,$)+"";if(F(te))return D?D.call(te):"";var fe=te+"";return fe=="0"&&1/te==-i?"-0":fe}ze.exports=$},zvhG:function(ze,E){ze.exports=o;function o(b,m,Y,F){this.cx=3*b,this.bx=3*(Y-b)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*m,this.by=3*(F-m)-this.cy,this.ay=1-this.cy-this.by,this.p1x=b,this.p1y=F,this.p2x=Y,this.p2y=F}o.prototype.sampleCurveX=function(b){return((this.ax*b+this.bx)*b+this.cx)*b},o.prototype.sampleCurveY=function(b){return((this.ay*b+this.by)*b+this.cy)*b},o.prototype.sampleCurveDerivativeX=function(b){return(3*this.ax*b+2*this.bx)*b+this.cx},o.prototype.solveCurveX=function(b,m){typeof m=="undefined"&&(m=1e-6);var Y,F,i,Z,D;for(i=b,D=0;D<8;D++){if(Z=this.sampleCurveX(i)-b,Math.abs(Z)<m)return i;var $=this.sampleCurveDerivativeX(i);if(Math.abs($)<1e-6)break;i=i-Z/$}if(Y=0,F=1,i=b,i<Y)return Y;if(i>F)return F;for(;Y<F;){if(Z=this.sampleCurveX(i),Math.abs(Z-b)<m)return i;b>Z?Y=i:F=i,i=(F-Y)*.5+Y}return i},o.prototype.solve=function(b,m){return this.sampleCurveY(this.solveCurveX(b,m))}},zxMA:function(ze,E,o){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var b=function(){function m(Y){this.str=Y}return m.prototype.startsWith=function(Y){return this.str.indexOf(Y)===0},m.prototype.endsWith=function(Y){var F="",i=Y.split("").reverse().join("");return F=this.str.split("").reverse().join(""),this.startsWith.call({str:F},i)},m.prototype.contains=function(Y){return this.str.indexOf(Y)!==-1},m.prototype.equals=function(Y){return this.str===Y},m.prototype.value=function(){return this.str},m}();E.QueryableString=b}}]);
